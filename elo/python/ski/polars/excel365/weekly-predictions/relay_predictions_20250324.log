INFO [2025-03-24 21:15:47] Starting relay predictions process
INFO [2025-03-24 21:16:18] Starting relay predictions process
INFO [2025-03-24 21:16:19] Loading weekend race data
INFO [2025-03-24 21:16:19] Tomorrow's date: 2025-03-25
INFO [2025-03-24 21:16:19] Found 1 men's relay races and 1 ladies' relay races
INFO [2025-03-24 21:16:19] Loading chrono data
INFO [2025-03-24 21:16:25] Loaded men's chrono with 105122 rows and 36 columns
INFO [2025-03-24 21:16:25] Loaded ladies' chrono with 78706 rows and 36 columns
INFO [2025-03-24 21:16:26] Created men's relay df with 9688 rows
INFO [2025-03-24 21:16:26] Created men's individual df with 92143 rows
INFO [2025-03-24 21:16:26] Created ladies' relay df with 8019 rows
INFO [2025-03-24 21:16:26] Created ladies' individual df with 68253 rows
INFO [2025-03-24 21:16:31] Training models for Leg 1
INFO [2025-03-24 21:16:31] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-24 21:16:31] Training podium model using glm
INFO [2025-03-24 21:16:31] Training win model using glm
INFO [2025-03-24 21:16:31] Training top5 model using glm
INFO [2025-03-24 21:16:31] Training top10 model using glm
INFO [2025-03-24 21:16:31] Top features for Leg 1 podium prediction:
INFO [2025-03-24 21:16:31] Training models for Leg 2
INFO [2025-03-24 21:16:31] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-24 21:16:31] Training podium model using glm
INFO [2025-03-24 21:16:31] Training win model using glm
INFO [2025-03-24 21:16:32] Training top5 model using glm
INFO [2025-03-24 21:16:32] Training top10 model using glm
INFO [2025-03-24 21:16:32] Top features for Leg 2 podium prediction:
INFO [2025-03-24 21:16:32] Training models for Leg 3
INFO [2025-03-24 21:16:32] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-24 21:16:32] Training podium model using glm
INFO [2025-03-24 21:16:32] Training win model using glm
INFO [2025-03-24 21:16:32] Training top5 model using glm
INFO [2025-03-24 21:16:32] Training top10 model using glm
INFO [2025-03-24 21:16:32] Top features for Leg 3 podium prediction:
INFO [2025-03-24 21:16:32] Training models for Leg 4
INFO [2025-03-24 21:16:32] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-24 21:16:32] Training podium model using glm
INFO [2025-03-24 21:16:32] Training win model using glm
INFO [2025-03-24 21:16:32] Training top5 model using glm
INFO [2025-03-24 21:16:32] Training top10 model using glm
INFO [2025-03-24 21:16:32] Top features for Leg 4 podium prediction:
INFO [2025-03-24 21:16:32] Training models for Leg 1
INFO [2025-03-24 21:16:32] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-24 21:16:32] Training podium model using glm
INFO [2025-03-24 21:16:33] Training win model using glm
INFO [2025-03-24 21:16:33] Training top5 model using glm
INFO [2025-03-24 21:16:33] Training top10 model using glm
INFO [2025-03-24 21:16:33] Top features for Leg 1 podium prediction:
INFO [2025-03-24 21:16:33] Training models for Leg 2
INFO [2025-03-24 21:16:33] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-24 21:16:33] Training podium model using glm
INFO [2025-03-24 21:16:33] Training win model using glm
INFO [2025-03-24 21:16:33] Training top5 model using glm
INFO [2025-03-24 21:16:33] Training top10 model using glm
INFO [2025-03-24 21:16:33] Top features for Leg 2 podium prediction:
INFO [2025-03-24 21:16:33] Training models for Leg 3
INFO [2025-03-24 21:16:33] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-24 21:16:33] Training podium model using glm
INFO [2025-03-24 21:16:33] Training win model using glm
INFO [2025-03-24 21:16:33] Training top5 model using glm
INFO [2025-03-24 21:16:33] Training top10 model using glm
INFO [2025-03-24 21:16:33] Top features for Leg 3 podium prediction:
INFO [2025-03-24 21:16:33] Training models for Leg 4
INFO [2025-03-24 21:16:33] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-24 21:16:33] Training podium model using glm
INFO [2025-03-24 21:16:34] Training win model using glm
INFO [2025-03-24 21:16:34] Training top5 model using glm
INFO [2025-03-24 21:16:34] Training top10 model using glm
INFO [2025-03-24 21:16:34] Top features for Leg 4 podium prediction:
INFO [2025-03-24 21:16:34] Processing men's relay predictions
INFO [2025-03-24 21:16:34] Loaded men relay teams startlist with 24 rows
INFO [2025-03-24 21:16:34] Loaded men relay individuals startlist with 96 rows
INFO [2025-03-24 21:16:34] Preparing current men skier data
INFO [2025-03-24 21:16:34] Found 9 Elo columns for current skiers
INFO [2025-03-24 21:16:34] Replaced NAs in Distance_Elo with first quartile: 1207.23243912712
INFO [2025-03-24 21:16:34] Replaced NAs in Distance_C_Elo with first quartile: 1233.40200699225
INFO [2025-03-24 21:16:34] Replaced NAs in Distance_F_Elo with first quartile: 1236.48554062178
INFO [2025-03-24 21:16:34] Replaced NAs in Sprint_Elo with first quartile: 1223.60107000698
INFO [2025-03-24 21:16:34] Replaced NAs in Sprint_C_Elo with first quartile: 1241.28715500947
INFO [2025-03-24 21:16:34] Replaced NAs in Sprint_F_Elo with first quartile: 1234.45151108772
INFO [2025-03-24 21:16:34] Replaced NAs in Classic_Elo with first quartile: 1241.52867310024
INFO [2025-03-24 21:16:34] Replaced NAs in Freestyle_Elo with first quartile: 1228.48649348109
INFO [2025-03-24 21:16:34] Replaced NAs in Distance_Pelo with first quartile: 1211.63035979047
INFO [2025-03-24 21:16:34] Replaced NAs in Distance_C_Pelo with first quartile: 1234.81091928129
INFO [2025-03-24 21:16:34] Replaced NAs in Distance_F_Pelo with first quartile: 1239.65331180248
INFO [2025-03-24 21:16:34] Replaced NAs in Sprint_Pelo with first quartile: 1240.94751821383
INFO [2025-03-24 21:16:34] Replaced NAs in Sprint_C_Pelo with first quartile: 1241.28715500947
INFO [2025-03-24 21:16:34] Replaced NAs in Sprint_F_Pelo with first quartile: 1252.45166310493
INFO [2025-03-24 21:16:34] Replaced NAs in Classic_Pelo with first quartile: 1243.63746068082
INFO [2025-03-24 21:16:34] Replaced NAs in Freestyle_Pelo with first quartile: 1249.30280713791
INFO [2025-03-24 21:16:34] Replaced NAs in Classic_Last_5 with first quartile: 0
INFO [2025-03-24 21:16:34] Replaced NAs in Freestyle_Last_5 with first quartile: 0
INFO [2025-03-24 21:16:34] Created Pelo_Pct from Elo with max value: 1946.6211651574
INFO [2025-03-24 21:16:34] Created Distance_Pelo_Pct from Distance_Elo with max value: 1869.1251911742
INFO [2025-03-24 21:16:34] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1777.16297253153
INFO [2025-03-24 21:16:34] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1695.2053212904
INFO [2025-03-24 21:16:34] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1886.80363942481
INFO [2025-03-24 21:16:34] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1711.08486899169
INFO [2025-03-24 21:16:34] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1792.65157560707
INFO [2025-03-24 21:16:34] Created Classic_Pelo_Pct from Classic_Elo with max value: 1807.56773496777
INFO [2025-03-24 21:16:34] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1814.60460629541
INFO [2025-03-24 21:16:34] Prepared data for 381 men skiers with 32 features
INFO [2025-03-24 21:16:34] Using FIS startlist for men's leg predictions
INFO [2025-03-24 21:16:34] Using FIS startlist for men
INFO [2025-03-24 21:16:34] Attempting Option 1: Team model coefficients
INFO [2025-03-24 21:16:34] Option 1 failed: No team_podium model found
INFO [2025-03-24 21:16:34] Option 1 failed: No team model
INFO [2025-03-24 21:16:34] Attempting Option 2: Individual model accuracy
INFO [2025-03-24 21:16:34] Leg 1 accuracy: 0.864745762711864
INFO [2025-03-24 21:16:34] Leg 2 accuracy: 0.841389051237093
INFO [2025-03-24 21:16:34] Leg 3 accuracy: 0.857262809273329
INFO [2025-03-24 21:16:34] Leg 4 accuracy: 0.888121955971167
INFO [2025-03-24 21:16:34] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-24 21:16:34] Leg importance weights: Leg 1: 0.25, Leg 2: 0.24, Leg 3: 0.25, Leg 4: 0.26
INFO [2025-03-24 21:16:34] Processing ladies's relay predictions
INFO [2025-03-24 21:16:34] Loaded ladies relay teams startlist with 20 rows
INFO [2025-03-24 21:16:34] Loaded ladies relay individuals startlist with 80 rows
INFO [2025-03-24 21:16:34] Preparing current ladies skier data
INFO [2025-03-24 21:16:34] Found 9 Elo columns for current skiers
INFO [2025-03-24 21:16:34] Replaced NAs in Distance_Elo with first quartile: 1237.38564383256
INFO [2025-03-24 21:16:34] Replaced NAs in Distance_C_Elo with first quartile: 1243.87329106944
INFO [2025-03-24 21:16:34] Replaced NAs in Distance_F_Elo with first quartile: 1256.69628195708
INFO [2025-03-24 21:16:34] Replaced NAs in Sprint_Elo with first quartile: 1246.32574824425
INFO [2025-03-24 21:16:34] Replaced NAs in Sprint_C_Elo with first quartile: 1257.67866787334
INFO [2025-03-24 21:16:34] Replaced NAs in Sprint_F_Elo with first quartile: 1244.84742904868
INFO [2025-03-24 21:16:34] Replaced NAs in Classic_Elo with first quartile: 1252.44868703669
INFO [2025-03-24 21:16:34] Replaced NAs in Freestyle_Elo with first quartile: 1244.44508230281
INFO [2025-03-24 21:16:34] Replaced NAs in Distance_Pelo with first quartile: 1241.11854419952
INFO [2025-03-24 21:16:34] Replaced NAs in Distance_C_Pelo with first quartile: 1245.57367555166
INFO [2025-03-24 21:16:34] Replaced NAs in Distance_F_Pelo with first quartile: 1259.54282973153
INFO [2025-03-24 21:16:34] Replaced NAs in Sprint_Pelo with first quartile: 1254.58885254623
INFO [2025-03-24 21:16:35] Replaced NAs in Sprint_C_Pelo with first quartile: 1257.58302026178
INFO [2025-03-24 21:16:35] Replaced NAs in Sprint_F_Pelo with first quartile: 1257.67755691493
INFO [2025-03-24 21:16:35] Replaced NAs in Classic_Pelo with first quartile: 1256.79275004544
INFO [2025-03-24 21:16:35] Replaced NAs in Freestyle_Pelo with first quartile: 1256.79999900008
INFO [2025-03-24 21:16:35] Replaced NAs in Classic_Last_5 with first quartile: 3.5
INFO [2025-03-24 21:16:35] Replaced NAs in Freestyle_Last_5 with first quartile: 2.4
INFO [2025-03-24 21:16:35] Created Pelo_Pct from Elo with max value: 1841.00191142018
INFO [2025-03-24 21:16:35] Created Distance_Pelo_Pct from Distance_Elo with max value: 1889.46974050597
INFO [2025-03-24 21:16:35] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1763.33572074398
INFO [2025-03-24 21:16:35] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1693.85026290322
INFO [2025-03-24 21:16:35] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1742.74758850835
INFO [2025-03-24 21:16:35] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1601.5820663103
INFO [2025-03-24 21:16:35] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1681.09824552997
INFO [2025-03-24 21:16:35] Created Classic_Pelo_Pct from Classic_Elo with max value: 1698.69428891549
INFO [2025-03-24 21:16:35] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1707.58410982918
INFO [2025-03-24 21:16:35] Prepared data for 255 ladies skiers with 32 features
INFO [2025-03-24 21:16:35] Using FIS startlist for ladies's leg predictions
INFO [2025-03-24 21:16:35] Using FIS startlist for ladies
INFO [2025-03-24 21:16:35] Attempting Option 1: Team model coefficients
INFO [2025-03-24 21:16:35] Option 1 failed: No team_podium model found
INFO [2025-03-24 21:16:35] Option 1 failed: No team model
INFO [2025-03-24 21:16:35] Attempting Option 2: Individual model accuracy
INFO [2025-03-24 21:16:35] Leg 1 accuracy: 0.737179487179487
INFO [2025-03-24 21:16:35] Leg 2 accuracy: 0.85
INFO [2025-03-24 21:16:35] Leg 3 accuracy: 0.82051282051282
INFO [2025-03-24 21:16:35] Leg 4 accuracy: 0.796969696969697
INFO [2025-03-24 21:16:35] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-24 21:16:35] Leg importance weights: Leg 1: 0.23, Leg 2: 0.27, Leg 3: 0.26, Leg 4: 0.25
INFO [2025-03-24 21:16:35] Resetting men's probabilities at or below the mode to zero
INFO [2025-03-24 21:16:35] No values appear more than twice for Win_Prob
INFO [2025-03-24 21:16:35] No values appear more than twice for Podium_Prob
INFO [2025-03-24 21:16:35] No values appear more than twice for Top5_Prob
INFO [2025-03-24 21:16:35] No values appear more than twice for Top10_Prob
INFO [2025-03-24 21:16:35] Resetting ladies' probabilities at or below the mode to zero
INFO [2025-03-24 21:16:35] No values appear more than twice for Win_Prob
INFO [2025-03-24 21:16:35] No values appear more than twice for Podium_Prob
INFO [2025-03-24 21:16:35] No values appear more than twice for Top5_Prob
INFO [2025-03-24 21:16:35] No values appear more than twice for Top10_Prob
INFO [2025-03-24 21:16:35] Normalizing men's team probabilities
INFO [2025-03-24 21:16:35] Normalized Win_Prob from sum of 0.71 to 1
INFO [2025-03-24 21:16:35] Normalized Podium_Prob from sum of 2.34 to 3
INFO [2025-03-24 21:16:35] Normalized Top5_Prob from sum of 4.2 to 5
INFO [2025-03-24 21:16:35] Normalized Top10_Prob from sum of 10.33 to 10
INFO [2025-03-24 21:16:35] Recalculated Expected_Points based on normalized probabilities
INFO [2025-03-24 21:16:35] Normalizing ladies' team probabilities
INFO [2025-03-24 21:16:35] Normalized Win_Prob from sum of 1.12 to 1
INFO [2025-03-24 21:16:35] Normalized Podium_Prob from sum of 3.25 to 3
INFO [2025-03-24 21:16:35] Normalized Top5_Prob from sum of 4.5 to 5
INFO [2025-03-24 21:16:35] Normalized Top10_Prob from sum of 9.34 to 10
INFO [2025-03-24 21:16:35] Recalculated Expected_Points based on normalized probabilities
INFO [2025-03-24 21:16:35] Optimizing fantasy relay team
INFO [2025-03-24 21:16:35] Fantasy team optimization complete. Selected 12 teams.
INFO [2025-03-24 21:16:35] Total price: 99826 of max 1e+05
INFO [2025-03-24 21:16:35] Expected total points: 868
INFO [2025-03-24 21:16:35] Men's teams: 6 ( 6 )
INFO [2025-03-24 21:16:35] Ladies' teams: 6 ( 6 )
INFO [2025-03-24 21:16:35] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250325/men_relay_points.xlsx
INFO [2025-03-24 21:16:35] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250325/men_relay_probabilities.xlsx
INFO [2025-03-24 21:16:35] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250325/ladies_relay_points.xlsx
INFO [2025-03-24 21:16:35] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250325/ladies_relay_probabilities.xlsx
INFO [2025-03-24 21:16:35] Saved fantasy team results to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250325/fantasy_relay_team.xlsx
INFO [2025-03-24 21:16:35] Relay predictions completed successfully
INFO [2025-03-24 21:18:44] Starting relay predictions process
INFO [2025-03-24 21:18:45] Loading weekend race data
INFO [2025-03-24 21:18:45] Tomorrow's date: 2025-03-25
INFO [2025-03-24 21:18:45] Found 1 men's relay races and 1 ladies' relay races
INFO [2025-03-24 21:18:45] Loading chrono data
INFO [2025-03-24 21:18:52] Loaded men's chrono with 105122 rows and 36 columns
INFO [2025-03-24 21:18:52] Loaded ladies' chrono with 78706 rows and 36 columns
INFO [2025-03-24 21:18:52] Created men's relay df with 9688 rows
INFO [2025-03-24 21:18:52] Created men's individual df with 92143 rows
INFO [2025-03-24 21:18:52] Created ladies' relay df with 8019 rows
INFO [2025-03-24 21:18:52] Created ladies' individual df with 68253 rows
INFO [2025-03-24 21:18:58] Training models for Leg 1
INFO [2025-03-24 21:18:58] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-24 21:18:58] Training podium model using glm
INFO [2025-03-24 21:18:58] Training win model using glm
INFO [2025-03-24 21:18:58] Training top5 model using glm
INFO [2025-03-24 21:18:58] Training top10 model using glm
INFO [2025-03-24 21:18:58] Top features for Leg 1 podium prediction:
INFO [2025-03-24 21:18:58] Training models for Leg 2
INFO [2025-03-24 21:18:58] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-24 21:18:58] Training podium model using glm
INFO [2025-03-24 21:18:58] Training win model using glm
INFO [2025-03-24 21:18:58] Training top5 model using glm
INFO [2025-03-24 21:18:58] Training top10 model using glm
INFO [2025-03-24 21:18:59] Top features for Leg 2 podium prediction:
INFO [2025-03-24 21:18:59] Training models for Leg 3
INFO [2025-03-24 21:18:59] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-24 21:18:59] Training podium model using glm
INFO [2025-03-24 21:18:59] Training win model using glm
INFO [2025-03-24 21:18:59] Training top5 model using glm
INFO [2025-03-24 21:18:59] Training top10 model using glm
INFO [2025-03-24 21:18:59] Top features for Leg 3 podium prediction:
INFO [2025-03-24 21:18:59] Training models for Leg 4
INFO [2025-03-24 21:18:59] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-24 21:18:59] Training podium model using glm
INFO [2025-03-24 21:18:59] Training win model using glm
INFO [2025-03-24 21:18:59] Training top5 model using glm
INFO [2025-03-24 21:18:59] Training top10 model using glm
INFO [2025-03-24 21:18:59] Top features for Leg 4 podium prediction:
INFO [2025-03-24 21:18:59] Training models for Leg 1
INFO [2025-03-24 21:18:59] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-24 21:18:59] Training podium model using glm
INFO [2025-03-24 21:18:59] Training win model using glm
INFO [2025-03-24 21:19:00] Training top5 model using glm
INFO [2025-03-24 21:19:00] Training top10 model using glm
INFO [2025-03-24 21:19:00] Top features for Leg 1 podium prediction:
INFO [2025-03-24 21:19:00] Training models for Leg 2
INFO [2025-03-24 21:19:00] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-24 21:19:00] Training podium model using glm
INFO [2025-03-24 21:19:00] Training win model using glm
INFO [2025-03-24 21:19:00] Training top5 model using glm
INFO [2025-03-24 21:19:00] Training top10 model using glm
INFO [2025-03-24 21:19:00] Top features for Leg 2 podium prediction:
INFO [2025-03-24 21:19:00] Training models for Leg 3
INFO [2025-03-24 21:19:00] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-24 21:19:00] Training podium model using glm
INFO [2025-03-24 21:19:00] Training win model using glm
INFO [2025-03-24 21:19:00] Training top5 model using glm
INFO [2025-03-24 21:19:00] Training top10 model using glm
INFO [2025-03-24 21:19:00] Top features for Leg 3 podium prediction:
INFO [2025-03-24 21:19:00] Training models for Leg 4
INFO [2025-03-24 21:19:00] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-24 21:19:00] Training podium model using glm
INFO [2025-03-24 21:19:01] Training win model using glm
INFO [2025-03-24 21:19:01] Training top5 model using glm
INFO [2025-03-24 21:19:01] Training top10 model using glm
INFO [2025-03-24 21:19:01] Top features for Leg 4 podium prediction:
INFO [2025-03-24 21:19:01] Processing men's relay predictions
INFO [2025-03-24 21:19:01] Loaded men relay teams startlist with 24 rows
INFO [2025-03-24 21:19:01] Loaded men relay individuals startlist with 96 rows
INFO [2025-03-24 21:19:01] Preparing current men skier data
INFO [2025-03-24 21:19:01] Found 9 Elo columns for current skiers
INFO [2025-03-24 21:19:01] Replaced NAs in Distance_Elo with first quartile: 1207.23243912712
INFO [2025-03-24 21:19:01] Replaced NAs in Distance_C_Elo with first quartile: 1233.40200699225
INFO [2025-03-24 21:19:01] Replaced NAs in Distance_F_Elo with first quartile: 1236.48554062178
INFO [2025-03-24 21:19:01] Replaced NAs in Sprint_Elo with first quartile: 1223.60107000698
INFO [2025-03-24 21:19:01] Replaced NAs in Sprint_C_Elo with first quartile: 1241.28715500947
INFO [2025-03-24 21:19:01] Replaced NAs in Sprint_F_Elo with first quartile: 1234.45151108772
INFO [2025-03-24 21:19:01] Replaced NAs in Classic_Elo with first quartile: 1241.52867310024
INFO [2025-03-24 21:19:01] Replaced NAs in Freestyle_Elo with first quartile: 1228.48649348109
INFO [2025-03-24 21:19:01] Replaced NAs in Distance_Pelo with first quartile: 1211.63035979047
INFO [2025-03-24 21:19:01] Replaced NAs in Distance_C_Pelo with first quartile: 1234.81091928129
INFO [2025-03-24 21:19:01] Replaced NAs in Distance_F_Pelo with first quartile: 1239.65331180248
INFO [2025-03-24 21:19:01] Replaced NAs in Sprint_Pelo with first quartile: 1240.94751821383
INFO [2025-03-24 21:19:01] Replaced NAs in Sprint_C_Pelo with first quartile: 1241.28715500947
INFO [2025-03-24 21:19:01] Replaced NAs in Sprint_F_Pelo with first quartile: 1252.45166310493
INFO [2025-03-24 21:19:01] Replaced NAs in Classic_Pelo with first quartile: 1243.63746068082
INFO [2025-03-24 21:19:01] Replaced NAs in Freestyle_Pelo with first quartile: 1249.30280713791
INFO [2025-03-24 21:19:01] Replaced NAs in Classic_Last_5 with first quartile: 0
INFO [2025-03-24 21:19:01] Replaced NAs in Freestyle_Last_5 with first quartile: 0
INFO [2025-03-24 21:19:01] Created Pelo_Pct from Elo with max value: 1946.6211651574
INFO [2025-03-24 21:19:01] Created Distance_Pelo_Pct from Distance_Elo with max value: 1869.1251911742
INFO [2025-03-24 21:19:01] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1777.16297253153
INFO [2025-03-24 21:19:01] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1695.2053212904
INFO [2025-03-24 21:19:01] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1886.80363942481
INFO [2025-03-24 21:19:01] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1711.08486899169
INFO [2025-03-24 21:19:01] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1792.65157560707
INFO [2025-03-24 21:19:01] Created Classic_Pelo_Pct from Classic_Elo with max value: 1807.56773496777
INFO [2025-03-24 21:19:01] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1814.60460629541
INFO [2025-03-24 21:19:01] Prepared data for 381 men skiers with 32 features
INFO [2025-03-24 21:19:01] Using FIS startlist for men's leg predictions
INFO [2025-03-24 21:19:01] Using FIS startlist for men
INFO [2025-03-24 21:19:01] Attempting Option 1: Team model coefficients
INFO [2025-03-24 21:19:01] Option 1 failed: No team_podium model found
INFO [2025-03-24 21:19:01] Option 1 failed: No team model
INFO [2025-03-24 21:19:01] Attempting Option 2: Individual model accuracy
INFO [2025-03-24 21:19:01] Leg 1 accuracy: 0.854576271186441
INFO [2025-03-24 21:19:01] Leg 2 accuracy: 0.841186440677966
INFO [2025-03-24 21:19:01] Leg 3 accuracy: 0.863804792518995
INFO [2025-03-24 21:19:01] Leg 4 accuracy: 0.888351841028638
INFO [2025-03-24 21:19:01] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-24 21:19:01] Leg importance weights: Leg 1: 0.25, Leg 2: 0.24, Leg 3: 0.25, Leg 4: 0.26
INFO [2025-03-24 21:19:01] Processing ladies's relay predictions
INFO [2025-03-24 21:19:01] Loaded ladies relay teams startlist with 20 rows
INFO [2025-03-24 21:19:01] Loaded ladies relay individuals startlist with 80 rows
INFO [2025-03-24 21:19:01] Preparing current ladies skier data
INFO [2025-03-24 21:19:01] Found 9 Elo columns for current skiers
INFO [2025-03-24 21:19:02] Replaced NAs in Distance_Elo with first quartile: 1237.38564383256
INFO [2025-03-24 21:19:02] Replaced NAs in Distance_C_Elo with first quartile: 1243.87329106944
INFO [2025-03-24 21:19:02] Replaced NAs in Distance_F_Elo with first quartile: 1256.69628195708
INFO [2025-03-24 21:19:02] Replaced NAs in Sprint_Elo with first quartile: 1246.32574824425
INFO [2025-03-24 21:19:02] Replaced NAs in Sprint_C_Elo with first quartile: 1257.67866787334
INFO [2025-03-24 21:19:02] Replaced NAs in Sprint_F_Elo with first quartile: 1244.84742904868
INFO [2025-03-24 21:19:02] Replaced NAs in Classic_Elo with first quartile: 1252.44868703669
INFO [2025-03-24 21:19:02] Replaced NAs in Freestyle_Elo with first quartile: 1244.44508230281
INFO [2025-03-24 21:19:02] Replaced NAs in Distance_Pelo with first quartile: 1241.11854419952
INFO [2025-03-24 21:19:02] Replaced NAs in Distance_C_Pelo with first quartile: 1245.57367555166
INFO [2025-03-24 21:19:02] Replaced NAs in Distance_F_Pelo with first quartile: 1259.54282973153
INFO [2025-03-24 21:19:02] Replaced NAs in Sprint_Pelo with first quartile: 1254.58885254623
INFO [2025-03-24 21:19:02] Replaced NAs in Sprint_C_Pelo with first quartile: 1257.58302026178
INFO [2025-03-24 21:19:02] Replaced NAs in Sprint_F_Pelo with first quartile: 1257.67755691493
INFO [2025-03-24 21:19:02] Replaced NAs in Classic_Pelo with first quartile: 1256.79275004544
INFO [2025-03-24 21:19:02] Replaced NAs in Freestyle_Pelo with first quartile: 1256.79999900008
INFO [2025-03-24 21:19:02] Replaced NAs in Classic_Last_5 with first quartile: 3.5
INFO [2025-03-24 21:19:02] Replaced NAs in Freestyle_Last_5 with first quartile: 2.4
INFO [2025-03-24 21:19:02] Created Pelo_Pct from Elo with max value: 1841.00191142018
INFO [2025-03-24 21:19:02] Created Distance_Pelo_Pct from Distance_Elo with max value: 1889.46974050597
INFO [2025-03-24 21:19:02] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1763.33572074398
INFO [2025-03-24 21:19:02] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1693.85026290322
INFO [2025-03-24 21:19:02] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1742.74758850835
INFO [2025-03-24 21:19:02] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1601.5820663103
INFO [2025-03-24 21:19:02] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1681.09824552997
INFO [2025-03-24 21:19:02] Created Classic_Pelo_Pct from Classic_Elo with max value: 1698.69428891549
INFO [2025-03-24 21:19:02] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1707.58410982918
INFO [2025-03-24 21:19:02] Prepared data for 255 ladies skiers with 32 features
INFO [2025-03-24 21:19:02] Using FIS startlist for ladies's leg predictions
INFO [2025-03-24 21:19:02] Using FIS startlist for ladies
INFO [2025-03-24 21:19:02] Attempting Option 1: Team model coefficients
INFO [2025-03-24 21:19:02] Option 1 failed: No team_podium model found
INFO [2025-03-24 21:19:02] Option 1 failed: No team model
INFO [2025-03-24 21:19:02] Attempting Option 2: Individual model accuracy
INFO [2025-03-24 21:19:02] Leg 1 accuracy: 0.801282051282051
INFO [2025-03-24 21:19:02] Leg 2 accuracy: 0.85
INFO [2025-03-24 21:19:02] Leg 3 accuracy: 0.784615384615385
INFO [2025-03-24 21:19:02] Leg 4 accuracy: 0.845454545454545
INFO [2025-03-24 21:19:02] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-24 21:19:02] Leg importance weights: Leg 1: 0.24, Leg 2: 0.26, Leg 3: 0.24, Leg 4: 0.26
INFO [2025-03-24 21:19:02] Resetting men's probabilities at or below the mode to zero
INFO [2025-03-24 21:19:02] No values appear more than twice for Win_Prob
INFO [2025-03-24 21:19:02] No values appear more than twice for Podium_Prob
INFO [2025-03-24 21:19:02] No values appear more than twice for Top5_Prob
INFO [2025-03-24 21:19:02] No values appear more than twice for Top10_Prob
INFO [2025-03-24 21:19:02] Resetting ladies' probabilities at or below the mode to zero
INFO [2025-03-24 21:19:02] No values appear more than twice for Win_Prob
INFO [2025-03-24 21:19:02] No values appear more than twice for Podium_Prob
INFO [2025-03-24 21:19:02] No values appear more than twice for Top5_Prob
INFO [2025-03-24 21:19:02] No values appear more than twice for Top10_Prob
INFO [2025-03-24 21:19:02] Normalizing men's team probabilities
INFO [2025-03-24 21:19:02] Normalized Win_Prob from sum of 0.72 to 1
INFO [2025-03-24 21:19:02] Normalized Podium_Prob from sum of 2.34 to 3
INFO [2025-03-24 21:19:02] Normalized Top5_Prob from sum of 4.2 to 5
INFO [2025-03-24 21:19:02] Normalized Top10_Prob from sum of 10.33 to 10
INFO [2025-03-24 21:19:02] Recalculated Expected_Points based on normalized probabilities
INFO [2025-03-24 21:19:02] Normalizing ladies' team probabilities
INFO [2025-03-24 21:19:02] Normalized Win_Prob from sum of 1.12 to 1
INFO [2025-03-24 21:19:02] Normalized Podium_Prob from sum of 3.26 to 3
INFO [2025-03-24 21:19:02] Normalized Top5_Prob from sum of 4.52 to 5
INFO [2025-03-24 21:19:02] Normalized Top10_Prob from sum of 9.34 to 10
INFO [2025-03-24 21:19:02] Recalculated Expected_Points based on normalized probabilities
INFO [2025-03-24 21:19:02] Optimizing fantasy relay team
INFO [2025-03-24 21:19:02] Fantasy team optimization complete. Selected 12 teams.
INFO [2025-03-24 21:19:02] Total price: 99826 of max 1e+05
INFO [2025-03-24 21:19:02] Expected total points: 865.1
INFO [2025-03-24 21:19:02] Men's teams: 6 ( 6 )
INFO [2025-03-24 21:19:02] Ladies' teams: 6 ( 6 )
INFO [2025-03-24 21:19:02] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250325/men_relay_points.xlsx
INFO [2025-03-24 21:19:02] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250325/men_relay_probabilities.xlsx
INFO [2025-03-24 21:19:02] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250325/ladies_relay_points.xlsx
INFO [2025-03-24 21:19:02] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250325/ladies_relay_probabilities.xlsx
INFO [2025-03-24 21:19:02] Saved fantasy team results to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250325/fantasy_relay_team.xlsx
INFO [2025-03-24 21:19:02] Relay predictions completed successfully
INFO [2025-03-24 21:23:19] Starting relay predictions process
INFO [2025-03-24 21:23:21] Loading weekend race data
INFO [2025-03-24 21:23:21] Tomorrow's date: 2025-03-25
INFO [2025-03-24 21:23:21] Found 1 men's relay races and 1 ladies' relay races
INFO [2025-03-24 21:23:21] Loading chrono data
INFO [2025-03-24 21:23:27] Loaded men's chrono with 105122 rows and 36 columns
INFO [2025-03-24 21:23:27] Loaded ladies' chrono with 78706 rows and 36 columns
INFO [2025-03-24 21:23:27] Created men's relay df with 9688 rows
INFO [2025-03-24 21:23:27] Created men's individual df with 92143 rows
INFO [2025-03-24 21:23:27] Created ladies' relay df with 8019 rows
INFO [2025-03-24 21:23:27] Created ladies' individual df with 68253 rows
INFO [2025-03-24 21:23:33] Training models for Leg 1
INFO [2025-03-24 21:23:33] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-24 21:23:33] Training podium model using glm
INFO [2025-03-24 21:23:33] Training win model using glm
INFO [2025-03-24 21:23:33] Training top5 model using glm
INFO [2025-03-24 21:23:33] Training top10 model using glm
INFO [2025-03-24 21:23:33] Top features for Leg 1 podium prediction:
INFO [2025-03-24 21:23:33] Training models for Leg 2
INFO [2025-03-24 21:23:33] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-24 21:23:33] Training podium model using glm
INFO [2025-03-24 21:23:34] Training win model using glm
INFO [2025-03-24 21:23:34] Training top5 model using glm
INFO [2025-03-24 21:23:34] Training top10 model using glm
INFO [2025-03-24 21:23:34] Top features for Leg 2 podium prediction:
INFO [2025-03-24 21:23:34] Training models for Leg 3
INFO [2025-03-24 21:23:34] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-24 21:23:34] Training podium model using glm
INFO [2025-03-24 21:23:34] Training win model using glm
INFO [2025-03-24 21:23:34] Training top5 model using glm
INFO [2025-03-24 21:23:34] Training top10 model using glm
INFO [2025-03-24 21:23:34] Top features for Leg 3 podium prediction:
INFO [2025-03-24 21:23:34] Training models for Leg 4
INFO [2025-03-24 21:23:34] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-24 21:23:34] Training podium model using glm
INFO [2025-03-24 21:23:34] Training win model using glm
INFO [2025-03-24 21:23:35] Training top5 model using glm
INFO [2025-03-24 21:23:35] Training top10 model using glm
INFO [2025-03-24 21:23:35] Top features for Leg 4 podium prediction:
INFO [2025-03-24 21:23:35] Training models for Leg 1
INFO [2025-03-24 21:23:35] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-24 21:23:35] Training podium model using glm
INFO [2025-03-24 21:23:35] Training win model using glm
INFO [2025-03-24 21:23:35] Training top5 model using glm
INFO [2025-03-24 21:23:35] Training top10 model using glm
INFO [2025-03-24 21:23:35] Top features for Leg 1 podium prediction:
INFO [2025-03-24 21:23:35] Training models for Leg 2
INFO [2025-03-24 21:23:35] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-24 21:23:35] Training podium model using glm
INFO [2025-03-24 21:23:35] Training win model using glm
INFO [2025-03-24 21:23:35] Training top5 model using glm
INFO [2025-03-24 21:23:35] Training top10 model using glm
INFO [2025-03-24 21:23:36] Top features for Leg 2 podium prediction:
INFO [2025-03-24 21:23:36] Training models for Leg 3
INFO [2025-03-24 21:23:36] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-24 21:23:36] Training podium model using glm
INFO [2025-03-24 21:23:36] Training win model using glm
INFO [2025-03-24 21:23:36] Training top5 model using glm
INFO [2025-03-24 21:23:36] Training top10 model using glm
INFO [2025-03-24 21:23:36] Top features for Leg 3 podium prediction:
INFO [2025-03-24 21:23:36] Training models for Leg 4
INFO [2025-03-24 21:23:36] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-24 21:23:36] Training podium model using glm
INFO [2025-03-24 21:23:36] Training win model using glm
INFO [2025-03-24 21:23:36] Training top5 model using glm
INFO [2025-03-24 21:23:36] Training top10 model using glm
INFO [2025-03-24 21:23:36] Top features for Leg 4 podium prediction:
INFO [2025-03-24 21:23:36] Processing men's relay predictions
INFO [2025-03-24 21:23:36] Loaded men relay teams startlist with 35 rows
INFO [2025-03-24 21:23:36] Loaded men relay individuals startlist with 306 rows
INFO [2025-03-24 21:23:36] Preparing current men skier data
INFO [2025-03-24 21:23:36] Found 9 Elo columns for current skiers
INFO [2025-03-24 21:23:37] Replaced NAs in Distance_Elo with first quartile: 1207.23243912712
INFO [2025-03-24 21:23:37] Replaced NAs in Distance_C_Elo with first quartile: 1233.40200699225
INFO [2025-03-24 21:23:37] Replaced NAs in Distance_F_Elo with first quartile: 1236.48554062178
INFO [2025-03-24 21:23:37] Replaced NAs in Sprint_Elo with first quartile: 1223.60107000698
INFO [2025-03-24 21:23:37] Replaced NAs in Sprint_C_Elo with first quartile: 1241.28715500947
INFO [2025-03-24 21:23:37] Replaced NAs in Sprint_F_Elo with first quartile: 1234.45151108772
INFO [2025-03-24 21:23:37] Replaced NAs in Classic_Elo with first quartile: 1241.52867310024
INFO [2025-03-24 21:23:37] Replaced NAs in Freestyle_Elo with first quartile: 1228.48649348109
INFO [2025-03-24 21:23:37] Replaced NAs in Distance_Pelo with first quartile: 1211.63035979047
INFO [2025-03-24 21:23:37] Replaced NAs in Distance_C_Pelo with first quartile: 1234.81091928129
INFO [2025-03-24 21:23:37] Replaced NAs in Distance_F_Pelo with first quartile: 1239.65331180248
INFO [2025-03-24 21:23:37] Replaced NAs in Sprint_Pelo with first quartile: 1240.94751821383
INFO [2025-03-24 21:23:37] Replaced NAs in Sprint_C_Pelo with first quartile: 1241.28715500947
INFO [2025-03-24 21:23:37] Replaced NAs in Sprint_F_Pelo with first quartile: 1252.45166310493
INFO [2025-03-24 21:23:37] Replaced NAs in Classic_Pelo with first quartile: 1243.63746068082
INFO [2025-03-24 21:23:37] Replaced NAs in Freestyle_Pelo with first quartile: 1249.30280713791
INFO [2025-03-24 21:23:37] Replaced NAs in Classic_Last_5 with first quartile: 0
INFO [2025-03-24 21:23:37] Replaced NAs in Freestyle_Last_5 with first quartile: 0
INFO [2025-03-24 21:23:37] Created Pelo_Pct from Elo with max value: 1946.6211651574
INFO [2025-03-24 21:23:37] Created Distance_Pelo_Pct from Distance_Elo with max value: 1869.1251911742
INFO [2025-03-24 21:23:37] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1777.16297253153
INFO [2025-03-24 21:23:37] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1695.2053212904
INFO [2025-03-24 21:23:37] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1886.80363942481
INFO [2025-03-24 21:23:37] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1711.08486899169
INFO [2025-03-24 21:23:37] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1792.65157560707
INFO [2025-03-24 21:23:37] Created Classic_Pelo_Pct from Classic_Elo with max value: 1807.56773496777
INFO [2025-03-24 21:23:37] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1814.60460629541
INFO [2025-03-24 21:23:37] Prepared data for 381 men skiers with 32 features
INFO [2025-03-24 21:23:37] No FIS startlist, predicting for all skiers in all legs
INFO [2025-03-24 21:23:37] No valid FIS startlist for men, building optimized teams
INFO [2025-03-24 21:23:37] Attempting Option 1: Team model coefficients
INFO [2025-03-24 21:23:37] Option 1 failed: argument "leg_models" is missing, with no default
INFO [2025-03-24 21:23:37] Attempting Option 2: Individual model accuracy
INFO [2025-03-24 21:23:37] Option 2 failed: argument "leg_models" is missing, with no default
INFO [2025-03-24 21:23:37] Using Option 3: Default leg importance weights
INFO [2025-03-24 21:23:37] Using leg importance weights for team optimization: Leg 1: 0.20, Leg 2: 0.20, Leg 3: 0.25, Leg 4: 0.35
INFO [2025-03-24 21:23:37] Optimizing team for Finland
INFO [2025-03-24 21:23:37] Optimizing team for Norway
INFO [2025-03-24 21:23:37] Optimizing team for Sweden
INFO [2025-03-24 21:23:37] Optimizing team for Ireland
INFO [2025-03-24 21:23:37] Optimizing team for Austria
INFO [2025-03-24 21:23:37] Optimizing team for France
INFO [2025-03-24 21:23:37] Optimizing team for Germany
INFO [2025-03-24 21:23:37] Optimizing team for Italy
INFO [2025-03-24 21:23:37] Optimizing team for Switzerland
INFO [2025-03-24 21:23:37] Optimizing team for USA
INFO [2025-03-24 21:23:38] Optimizing team for Canada
INFO [2025-03-24 21:23:38] Optimizing team for Estonia
INFO [2025-03-24 21:23:38] Optimizing team for Andorra
INFO [2025-03-24 21:23:38] Optimizing team for Czechia
INFO [2025-03-24 21:23:38] Optimizing team for Great Britain
INFO [2025-03-24 21:23:38] Optimizing team for Bulgaria
INFO [2025-03-24 21:23:38] Optimizing team for Armenia
INFO [2025-03-24 21:23:38] Optimizing team for Slovenia
INFO [2025-03-24 21:23:38] Optimizing team for Australia
INFO [2025-03-24 21:23:38] Optimizing team for Kazakhstan
INFO [2025-03-24 21:23:38] Optimizing team for Spain
INFO [2025-03-24 21:23:38] Optimizing team for Ukraine
INFO [2025-03-24 21:23:38] Optimizing team for Slovakia
INFO [2025-03-24 21:23:38] Optimizing team for Latvia
INFO [2025-03-24 21:23:38] Optimizing team for Hungary
INFO [2025-03-24 21:23:38] Optimizing team for Japan
INFO [2025-03-24 21:23:38] Optimizing team for Poland
INFO [2025-03-24 21:23:38] Optimizing team for Colombia
INFO [2025-03-24 21:23:38] Optimizing team for South Korea
INFO [2025-03-24 21:23:38] Optimizing team for China
INFO [2025-03-24 21:23:38] Optimizing team for Chile
INFO [2025-03-24 21:23:38] Optimizing team for Argentina
INFO [2025-03-24 21:23:38] Optimizing team for Croatia
INFO [2025-03-24 21:23:38] Optimizing team for Liechtenstein
INFO [2025-03-24 21:23:38] Optimizing team for Romania
INFO [2025-03-24 21:23:38] Optimizing team for Serbia
INFO [2025-03-24 21:23:38] Optimizing team for Thailand
INFO [2025-03-24 21:23:38] Optimizing team for Mongolia
INFO [2025-03-24 21:23:38] Optimizing team for North Macedonia
INFO [2025-03-24 21:23:38] Optimizing team for Belgium
INFO [2025-03-24 21:23:38] Optimizing team for Lithuania
INFO [2025-03-24 21:23:38] Optimizing team for Haiti
INFO [2025-03-24 21:23:38] Optimizing team for Bosnia&Herzegovina
INFO [2025-03-24 21:23:38] Optimizing team for Turkey
INFO [2025-03-24 21:23:38] Optimizing team for Denmark
INFO [2025-03-24 21:23:38] Optimizing team for Brazil
INFO [2025-03-24 21:23:38] Optimizing team for Iceland
INFO [2025-03-24 21:23:38] Optimizing team for Greece
INFO [2025-03-24 21:23:38] Optimizing team for Nigeria
INFO [2025-03-24 21:23:38] Optimizing team for Montenegro
INFO [2025-03-24 21:23:38] Optimizing team for Kyrgyzstan
INFO [2025-03-24 21:23:38] Optimizing team for India
INFO [2025-03-24 21:23:39] Optimizing team for Bolivia
INFO [2025-03-24 21:23:39] Optimizing team for Portugal
INFO [2025-03-24 21:23:39] Optimizing team for Lebanon
INFO [2025-03-24 21:23:39] Optimizing team for Iran
INFO [2025-03-24 21:23:39] Optimizing team for Mexico
INFO [2025-03-24 21:23:39] Optimizing team for Taiwan
INFO [2025-03-24 21:23:39] Optimizing team for Saudi Arabia
INFO [2025-03-24 21:23:39] Optimizing team for Peru
INFO [2025-03-24 21:23:39] Optimizing team for South Africa
INFO [2025-03-24 21:23:39] Optimizing team for San Marino
INFO [2025-03-24 21:23:39] Optimizing team for Israel
INFO [2025-03-24 21:23:39] Optimizing team for Ecuador
INFO [2025-03-24 21:23:39] Optimizing team for Venezuela
INFO [2025-03-24 21:23:39] Optimizing team for Trinidad & Tobago
INFO [2025-03-24 21:23:39] Optimizing team for Malta
INFO [2025-03-24 21:23:39] Matching optimized teams with startlist team names and prices
INFO [2025-03-24 21:23:39] Processing ladies's relay predictions
INFO [2025-03-24 21:23:39] Loaded ladies relay teams startlist with 20 rows
INFO [2025-03-24 21:23:39] Loaded ladies relay individuals startlist with 80 rows
INFO [2025-03-24 21:23:39] Preparing current ladies skier data
INFO [2025-03-24 21:23:39] Found 9 Elo columns for current skiers
INFO [2025-03-24 21:23:39] Replaced NAs in Distance_Elo with first quartile: 1237.38564383256
INFO [2025-03-24 21:23:39] Replaced NAs in Distance_C_Elo with first quartile: 1243.87329106944
INFO [2025-03-24 21:23:39] Replaced NAs in Distance_F_Elo with first quartile: 1256.69628195708
INFO [2025-03-24 21:23:39] Replaced NAs in Sprint_Elo with first quartile: 1246.32574824425
INFO [2025-03-24 21:23:39] Replaced NAs in Sprint_C_Elo with first quartile: 1257.67866787334
INFO [2025-03-24 21:23:39] Replaced NAs in Sprint_F_Elo with first quartile: 1244.84742904868
INFO [2025-03-24 21:23:39] Replaced NAs in Classic_Elo with first quartile: 1252.44868703669
INFO [2025-03-24 21:23:39] Replaced NAs in Freestyle_Elo with first quartile: 1244.44508230281
INFO [2025-03-24 21:23:39] Replaced NAs in Distance_Pelo with first quartile: 1241.11854419952
INFO [2025-03-24 21:23:39] Replaced NAs in Distance_C_Pelo with first quartile: 1245.57367555166
INFO [2025-03-24 21:23:39] Replaced NAs in Distance_F_Pelo with first quartile: 1259.54282973153
INFO [2025-03-24 21:23:39] Replaced NAs in Sprint_Pelo with first quartile: 1254.58885254623
INFO [2025-03-24 21:23:39] Replaced NAs in Sprint_C_Pelo with first quartile: 1257.58302026178
INFO [2025-03-24 21:23:39] Replaced NAs in Sprint_F_Pelo with first quartile: 1257.67755691493
INFO [2025-03-24 21:23:39] Replaced NAs in Classic_Pelo with first quartile: 1256.79275004544
INFO [2025-03-24 21:23:39] Replaced NAs in Freestyle_Pelo with first quartile: 1256.79999900008
INFO [2025-03-24 21:23:39] Replaced NAs in Classic_Last_5 with first quartile: 3.5
INFO [2025-03-24 21:23:39] Replaced NAs in Freestyle_Last_5 with first quartile: 2.4
INFO [2025-03-24 21:23:39] Created Pelo_Pct from Elo with max value: 1841.00191142018
INFO [2025-03-24 21:23:39] Created Distance_Pelo_Pct from Distance_Elo with max value: 1889.46974050597
INFO [2025-03-24 21:23:39] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1763.33572074398
INFO [2025-03-24 21:23:39] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1693.85026290322
INFO [2025-03-24 21:23:39] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1742.74758850835
INFO [2025-03-24 21:23:39] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1601.5820663103
INFO [2025-03-24 21:23:39] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1681.09824552997
INFO [2025-03-24 21:23:39] Created Classic_Pelo_Pct from Classic_Elo with max value: 1698.69428891549
INFO [2025-03-24 21:23:39] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1707.58410982918
INFO [2025-03-24 21:23:39] Prepared data for 255 ladies skiers with 32 features
INFO [2025-03-24 21:23:39] Using FIS startlist for ladies's leg predictions
INFO [2025-03-24 21:23:39] Using FIS startlist for ladies
INFO [2025-03-24 21:23:39] Attempting Option 1: Team model coefficients
INFO [2025-03-24 21:23:39] Option 1 failed: No team_podium model found
INFO [2025-03-24 21:23:39] Option 1 failed: No team model
INFO [2025-03-24 21:23:39] Attempting Option 2: Individual model accuracy
INFO [2025-03-24 21:23:39] Leg 1 accuracy: 0.783333333333333
INFO [2025-03-24 21:23:39] Leg 2 accuracy: 0.816666666666667
INFO [2025-03-24 21:23:39] Leg 3 accuracy: 0.801282051282051
INFO [2025-03-24 21:23:39] Leg 4 accuracy: 0.815151515151515
INFO [2025-03-24 21:23:39] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-24 21:23:39] Leg importance weights: Leg 1: 0.24, Leg 2: 0.25, Leg 3: 0.25, Leg 4: 0.25
INFO [2025-03-24 21:23:40] Resetting men's probabilities at or below the mode to zero
INFO [2025-03-24 21:23:40] Reset 35 values to 0 for Win_Prob (repeated values or values <  1e-04 )
INFO [2025-03-24 21:23:40] Repeated values: 0, 0, 0, 0, 0, 1e-04
INFO [2025-03-24 21:23:40] No values appear more than twice for Podium_Prob
INFO [2025-03-24 21:23:40] No values appear more than twice for Top5_Prob
INFO [2025-03-24 21:23:40] No values appear more than twice for Top10_Prob
INFO [2025-03-24 21:23:40] Resetting ladies' probabilities at or below the mode to zero
INFO [2025-03-24 21:23:40] Reset 3 values to 0 for Win_Prob (repeated values or values <  0 )
INFO [2025-03-24 21:23:40] Repeated values: 0
INFO [2025-03-24 21:23:40] No values appear more than twice for Podium_Prob
INFO [2025-03-24 21:23:40] No values appear more than twice for Top5_Prob
INFO [2025-03-24 21:23:40] No values appear more than twice for Top10_Prob
INFO [2025-03-24 21:23:40] Normalizing men's team probabilities
INFO [2025-03-24 21:23:40] Normalized Win_Prob from sum of 1.08 to 1
INFO [2025-03-24 21:23:40] Normalized Podium_Prob from sum of 3.91 to 3
INFO [2025-03-24 21:23:40] Normalized Top5_Prob from sum of 5.79 to 5
INFO [2025-03-24 21:23:40] Normalized Top10_Prob from sum of 14.97 to 10
INFO [2025-03-24 21:23:40] Recalculated Expected_Points based on normalized probabilities
INFO [2025-03-24 21:23:40] Normalizing ladies' team probabilities
INFO [2025-03-24 21:23:40] Normalized Win_Prob from sum of 1.12 to 1
INFO [2025-03-24 21:23:40] Normalized Podium_Prob from sum of 3.26 to 3
INFO [2025-03-24 21:23:40] Normalized Top5_Prob from sum of 4.51 to 5
INFO [2025-03-24 21:23:40] Normalized Top10_Prob from sum of 9.35 to 10
INFO [2025-03-24 21:23:40] Recalculated Expected_Points based on normalized probabilities
INFO [2025-03-24 21:23:40] Optimizing fantasy relay team
INFO [2025-03-24 21:23:40] Fantasy team optimization complete. Selected 12 teams.
INFO [2025-03-24 21:23:40] Total price: 99972 of max 1e+05
INFO [2025-03-24 21:23:40] Expected total points: 801.2
INFO [2025-03-24 21:23:40] Men's teams: 6 ( 6 )
INFO [2025-03-24 21:23:40] Ladies' teams: 6 ( 6 )
INFO [2025-03-24 21:23:40] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250325/men_relay_points.xlsx
INFO [2025-03-24 21:23:40] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250325/men_relay_probabilities.xlsx
INFO [2025-03-24 21:23:40] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250325/ladies_relay_points.xlsx
INFO [2025-03-24 21:23:40] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250325/ladies_relay_probabilities.xlsx
INFO [2025-03-24 21:23:40] Saved fantasy team results to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250325/fantasy_relay_team.xlsx
INFO [2025-03-24 21:23:40] Relay predictions completed successfully
INFO [2025-03-24 21:28:29] Starting relay predictions process
INFO [2025-03-24 21:28:31] Loading weekend race data
INFO [2025-03-24 21:28:31] Tomorrow's date: 2025-03-25
INFO [2025-03-24 21:28:31] Found 1 men's relay races and 1 ladies' relay races
INFO [2025-03-24 21:28:31] Loading chrono data
INFO [2025-03-24 21:28:37] Loaded men's chrono with 105122 rows and 36 columns
INFO [2025-03-24 21:28:37] Loaded ladies' chrono with 78706 rows and 36 columns
INFO [2025-03-24 21:28:37] Created men's relay df with 9688 rows
INFO [2025-03-24 21:28:37] Created men's individual df with 92143 rows
INFO [2025-03-24 21:28:37] Created ladies' relay df with 8019 rows
INFO [2025-03-24 21:28:37] Created ladies' individual df with 68253 rows
INFO [2025-03-24 21:28:43] Training models for Leg 1
INFO [2025-03-24 21:28:43] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-24 21:28:43] Training podium model using glm
INFO [2025-03-24 21:28:43] Training win model using glm
INFO [2025-03-24 21:28:43] Training top5 model using glm
INFO [2025-03-24 21:28:43] Training top10 model using glm
INFO [2025-03-24 21:28:44] Top features for Leg 1 podium prediction:
INFO [2025-03-24 21:28:44] Training models for Leg 2
INFO [2025-03-24 21:28:44] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-24 21:28:44] Training podium model using glm
INFO [2025-03-24 21:28:44] Training win model using glm
INFO [2025-03-24 21:28:44] Training top5 model using glm
INFO [2025-03-24 21:28:44] Training top10 model using glm
INFO [2025-03-24 21:28:44] Top features for Leg 2 podium prediction:
INFO [2025-03-24 21:28:44] Training models for Leg 3
INFO [2025-03-24 21:28:44] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-24 21:28:44] Training podium model using glm
INFO [2025-03-24 21:28:44] Training win model using glm
INFO [2025-03-24 21:28:44] Training top5 model using glm
INFO [2025-03-24 21:28:44] Training top10 model using glm
INFO [2025-03-24 21:28:44] Top features for Leg 3 podium prediction:
INFO [2025-03-24 21:28:44] Training models for Leg 4
INFO [2025-03-24 21:28:44] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-24 21:28:44] Training podium model using glm
INFO [2025-03-24 21:28:44] Training win model using glm
INFO [2025-03-24 21:28:44] Training top5 model using glm
INFO [2025-03-24 21:28:45] Training top10 model using glm
INFO [2025-03-24 21:28:45] Top features for Leg 4 podium prediction:
INFO [2025-03-24 21:28:45] Training models for Leg 1
INFO [2025-03-24 21:28:45] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-24 21:28:45] Training podium model using glm
INFO [2025-03-24 21:28:45] Training win model using glm
INFO [2025-03-24 21:28:45] Training top5 model using glm
INFO [2025-03-24 21:28:45] Training top10 model using glm
INFO [2025-03-24 21:28:45] Top features for Leg 1 podium prediction:
INFO [2025-03-24 21:28:45] Training models for Leg 2
INFO [2025-03-24 21:28:45] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-24 21:28:45] Training podium model using glm
INFO [2025-03-24 21:28:45] Training win model using glm
INFO [2025-03-24 21:28:45] Training top5 model using glm
INFO [2025-03-24 21:28:45] Training top10 model using glm
INFO [2025-03-24 21:28:45] Top features for Leg 2 podium prediction:
INFO [2025-03-24 21:28:45] Training models for Leg 3
INFO [2025-03-24 21:28:45] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-24 21:28:45] Training podium model using glm
INFO [2025-03-24 21:28:45] Training win model using glm
INFO [2025-03-24 21:28:46] Training top5 model using glm
INFO [2025-03-24 21:28:46] Training top10 model using glm
INFO [2025-03-24 21:28:46] Top features for Leg 3 podium prediction:
INFO [2025-03-24 21:28:46] Training models for Leg 4
INFO [2025-03-24 21:28:46] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-24 21:28:46] Training podium model using glm
INFO [2025-03-24 21:28:46] Training win model using glm
INFO [2025-03-24 21:28:46] Training top5 model using glm
INFO [2025-03-24 21:28:46] Training top10 model using glm
INFO [2025-03-24 21:28:46] Top features for Leg 4 podium prediction:
INFO [2025-03-24 21:28:46] Processing men's relay predictions
INFO [2025-03-24 21:28:46] Loaded men relay teams startlist with 35 rows
INFO [2025-03-24 21:28:46] Loaded men relay individuals startlist with 306 rows
INFO [2025-03-24 21:28:46] Preparing current men skier data
INFO [2025-03-24 21:28:46] Found 9 Elo columns for current skiers
INFO [2025-03-24 21:28:46] Replaced NAs in Distance_Elo with first quartile: 1207.23243912712
INFO [2025-03-24 21:28:46] Replaced NAs in Distance_C_Elo with first quartile: 1233.40200699225
INFO [2025-03-24 21:28:46] Replaced NAs in Distance_F_Elo with first quartile: 1236.48554062178
INFO [2025-03-24 21:28:46] Replaced NAs in Sprint_Elo with first quartile: 1223.60107000698
INFO [2025-03-24 21:28:46] Replaced NAs in Sprint_C_Elo with first quartile: 1241.28715500947
INFO [2025-03-24 21:28:46] Replaced NAs in Sprint_F_Elo with first quartile: 1234.45151108772
INFO [2025-03-24 21:28:46] Replaced NAs in Classic_Elo with first quartile: 1241.52867310024
INFO [2025-03-24 21:28:46] Replaced NAs in Freestyle_Elo with first quartile: 1228.48649348109
INFO [2025-03-24 21:28:46] Replaced NAs in Distance_Pelo with first quartile: 1211.63035979047
INFO [2025-03-24 21:28:46] Replaced NAs in Distance_C_Pelo with first quartile: 1234.81091928129
INFO [2025-03-24 21:28:46] Replaced NAs in Distance_F_Pelo with first quartile: 1239.65331180248
INFO [2025-03-24 21:28:46] Replaced NAs in Sprint_Pelo with first quartile: 1240.94751821383
INFO [2025-03-24 21:28:46] Replaced NAs in Sprint_C_Pelo with first quartile: 1241.28715500947
INFO [2025-03-24 21:28:46] Replaced NAs in Sprint_F_Pelo with first quartile: 1252.45166310493
INFO [2025-03-24 21:28:46] Replaced NAs in Classic_Pelo with first quartile: 1243.63746068082
INFO [2025-03-24 21:28:46] Replaced NAs in Freestyle_Pelo with first quartile: 1249.30280713791
INFO [2025-03-24 21:28:46] Replaced NAs in Classic_Last_5 with first quartile: 0
INFO [2025-03-24 21:28:46] Replaced NAs in Freestyle_Last_5 with first quartile: 0
INFO [2025-03-24 21:28:46] Created Pelo_Pct from Elo with max value: 1946.6211651574
INFO [2025-03-24 21:28:46] Created Distance_Pelo_Pct from Distance_Elo with max value: 1869.1251911742
INFO [2025-03-24 21:28:46] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1777.16297253153
INFO [2025-03-24 21:28:46] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1695.2053212904
INFO [2025-03-24 21:28:46] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1886.80363942481
INFO [2025-03-24 21:28:46] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1711.08486899169
INFO [2025-03-24 21:28:46] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1792.65157560707
INFO [2025-03-24 21:28:46] Created Classic_Pelo_Pct from Classic_Elo with max value: 1807.56773496777
INFO [2025-03-24 21:28:46] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1814.60460629541
INFO [2025-03-24 21:28:46] Prepared data for 381 men skiers with 32 features
INFO [2025-03-24 21:28:46] No FIS startlist, predicting for all skiers in all legs
INFO [2025-03-24 21:28:47] No valid FIS startlist for men, building optimized teams
INFO [2025-03-24 21:28:47] Attempting Option 1: Team model coefficients
INFO [2025-03-24 21:28:47] Option 1 failed: argument "leg_models" is missing, with no default
INFO [2025-03-24 21:28:47] Attempting Option 2: Individual model accuracy
INFO [2025-03-24 21:28:47] Option 2 failed: argument "leg_models" is missing, with no default
INFO [2025-03-24 21:28:47] Using Option 3: Default leg importance weights
INFO [2025-03-24 21:28:47] Using leg importance weights for team optimization: Leg 1: 0.20, Leg 2: 0.20, Leg 3: 0.25, Leg 4: 0.35
INFO [2025-03-24 21:28:47] Optimizing team for Finland
INFO [2025-03-24 21:28:47] Optimizing team for Norway
INFO [2025-03-24 21:28:47] Optimizing team for Sweden
INFO [2025-03-24 21:28:47] Optimizing team for Ireland
INFO [2025-03-24 21:28:47] Optimizing team for Austria
INFO [2025-03-24 21:28:47] Optimizing team for France
INFO [2025-03-24 21:28:47] Optimizing team for Germany
INFO [2025-03-24 21:28:47] Optimizing team for Italy
INFO [2025-03-24 21:28:47] Optimizing team for Switzerland
INFO [2025-03-24 21:28:47] Optimizing team for USA
INFO [2025-03-24 21:28:47] Optimizing team for Canada
INFO [2025-03-24 21:28:47] Optimizing team for Estonia
INFO [2025-03-24 21:28:48] Optimizing team for Andorra
INFO [2025-03-24 21:28:48] Optimizing team for Czechia
INFO [2025-03-24 21:28:48] Optimizing team for Great Britain
INFO [2025-03-24 21:28:48] Optimizing team for Bulgaria
INFO [2025-03-24 21:28:48] Optimizing team for Armenia
INFO [2025-03-24 21:28:48] Optimizing team for Slovenia
INFO [2025-03-24 21:28:48] Optimizing team for Australia
INFO [2025-03-24 21:28:48] Optimizing team for Kazakhstan
INFO [2025-03-24 21:28:48] Optimizing team for Spain
INFO [2025-03-24 21:28:48] Optimizing team for Ukraine
INFO [2025-03-24 21:28:48] Optimizing team for Slovakia
INFO [2025-03-24 21:28:48] Optimizing team for Latvia
INFO [2025-03-24 21:28:48] Optimizing team for Hungary
INFO [2025-03-24 21:28:48] Optimizing team for Japan
INFO [2025-03-24 21:28:48] Optimizing team for Poland
INFO [2025-03-24 21:28:48] Optimizing team for Colombia
INFO [2025-03-24 21:28:48] Optimizing team for South Korea
INFO [2025-03-24 21:28:48] Optimizing team for China
INFO [2025-03-24 21:28:48] Optimizing team for Chile
INFO [2025-03-24 21:28:48] Optimizing team for Argentina
INFO [2025-03-24 21:28:48] Optimizing team for Croatia
INFO [2025-03-24 21:28:48] Optimizing team for Liechtenstein
INFO [2025-03-24 21:28:48] Optimizing team for Romania
INFO [2025-03-24 21:28:48] Optimizing team for Serbia
INFO [2025-03-24 21:28:48] Optimizing team for Thailand
INFO [2025-03-24 21:28:48] Optimizing team for Mongolia
INFO [2025-03-24 21:28:48] Optimizing team for North Macedonia
INFO [2025-03-24 21:28:48] Optimizing team for Belgium
INFO [2025-03-24 21:28:48] Optimizing team for Lithuania
INFO [2025-03-24 21:28:48] Optimizing team for Haiti
INFO [2025-03-24 21:28:48] Optimizing team for Bosnia&Herzegovina
INFO [2025-03-24 21:28:48] Optimizing team for Turkey
INFO [2025-03-24 21:28:48] Optimizing team for Denmark
INFO [2025-03-24 21:28:48] Optimizing team for Brazil
INFO [2025-03-24 21:28:48] Optimizing team for Iceland
INFO [2025-03-24 21:28:48] Optimizing team for Greece
INFO [2025-03-24 21:28:48] Optimizing team for Nigeria
INFO [2025-03-24 21:28:48] Optimizing team for Montenegro
INFO [2025-03-24 21:28:48] Optimizing team for Kyrgyzstan
INFO [2025-03-24 21:28:48] Optimizing team for India
INFO [2025-03-24 21:28:48] Optimizing team for Bolivia
INFO [2025-03-24 21:28:48] Optimizing team for Portugal
INFO [2025-03-24 21:28:49] Optimizing team for Lebanon
INFO [2025-03-24 21:28:49] Optimizing team for Iran
INFO [2025-03-24 21:28:49] Optimizing team for Mexico
INFO [2025-03-24 21:28:49] Optimizing team for Taiwan
INFO [2025-03-24 21:28:49] Optimizing team for Saudi Arabia
INFO [2025-03-24 21:28:49] Optimizing team for Peru
INFO [2025-03-24 21:28:49] Optimizing team for South Africa
INFO [2025-03-24 21:28:49] Optimizing team for San Marino
INFO [2025-03-24 21:28:49] Optimizing team for Israel
INFO [2025-03-24 21:28:49] Optimizing team for Ecuador
INFO [2025-03-24 21:28:49] Optimizing team for Venezuela
INFO [2025-03-24 21:28:49] Optimizing team for Trinidad & Tobago
INFO [2025-03-24 21:28:49] Optimizing team for Malta
INFO [2025-03-24 21:28:49] Matching optimized teams with startlist team names and prices
INFO [2025-03-24 21:28:49] Processing ladies's relay predictions
INFO [2025-03-24 21:28:49] Loaded ladies relay teams startlist with 20 rows
INFO [2025-03-24 21:28:49] Loaded ladies relay individuals startlist with 80 rows
INFO [2025-03-24 21:28:49] Preparing current ladies skier data
INFO [2025-03-24 21:28:49] Found 9 Elo columns for current skiers
INFO [2025-03-24 21:28:49] Replaced NAs in Distance_Elo with first quartile: 1237.38564383256
INFO [2025-03-24 21:28:49] Replaced NAs in Distance_C_Elo with first quartile: 1243.87329106944
INFO [2025-03-24 21:28:49] Replaced NAs in Distance_F_Elo with first quartile: 1256.69628195708
INFO [2025-03-24 21:28:49] Replaced NAs in Sprint_Elo with first quartile: 1246.32574824425
INFO [2025-03-24 21:28:49] Replaced NAs in Sprint_C_Elo with first quartile: 1257.67866787334
INFO [2025-03-24 21:28:49] Replaced NAs in Sprint_F_Elo with first quartile: 1244.84742904868
INFO [2025-03-24 21:28:49] Replaced NAs in Classic_Elo with first quartile: 1252.44868703669
INFO [2025-03-24 21:28:49] Replaced NAs in Freestyle_Elo with first quartile: 1244.44508230281
INFO [2025-03-24 21:28:49] Replaced NAs in Distance_Pelo with first quartile: 1241.11854419952
INFO [2025-03-24 21:28:49] Replaced NAs in Distance_C_Pelo with first quartile: 1245.57367555166
INFO [2025-03-24 21:28:49] Replaced NAs in Distance_F_Pelo with first quartile: 1259.54282973153
INFO [2025-03-24 21:28:49] Replaced NAs in Sprint_Pelo with first quartile: 1254.58885254623
INFO [2025-03-24 21:28:49] Replaced NAs in Sprint_C_Pelo with first quartile: 1257.58302026178
INFO [2025-03-24 21:28:49] Replaced NAs in Sprint_F_Pelo with first quartile: 1257.67755691493
INFO [2025-03-24 21:28:49] Replaced NAs in Classic_Pelo with first quartile: 1256.79275004544
INFO [2025-03-24 21:28:49] Replaced NAs in Freestyle_Pelo with first quartile: 1256.79999900008
INFO [2025-03-24 21:28:49] Replaced NAs in Classic_Last_5 with first quartile: 3.5
INFO [2025-03-24 21:28:49] Replaced NAs in Freestyle_Last_5 with first quartile: 2.4
INFO [2025-03-24 21:28:49] Created Pelo_Pct from Elo with max value: 1841.00191142018
INFO [2025-03-24 21:28:49] Created Distance_Pelo_Pct from Distance_Elo with max value: 1889.46974050597
INFO [2025-03-24 21:28:49] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1763.33572074398
INFO [2025-03-24 21:28:49] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1693.85026290322
INFO [2025-03-24 21:28:49] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1742.74758850835
INFO [2025-03-24 21:28:49] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1601.5820663103
INFO [2025-03-24 21:28:49] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1681.09824552997
INFO [2025-03-24 21:28:49] Created Classic_Pelo_Pct from Classic_Elo with max value: 1698.69428891549
INFO [2025-03-24 21:28:49] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1707.58410982918
INFO [2025-03-24 21:28:49] Prepared data for 255 ladies skiers with 32 features
INFO [2025-03-24 21:28:49] Using FIS startlist for ladies's leg predictions
INFO [2025-03-24 21:28:49] Using FIS startlist for ladies
INFO [2025-03-24 21:28:49] Attempting Option 1: Team model coefficients
INFO [2025-03-24 21:28:49] Option 1 failed: No team_podium model found
INFO [2025-03-24 21:28:49] Option 1 failed: No team model
INFO [2025-03-24 21:28:49] Attempting Option 2: Individual model accuracy
INFO [2025-03-24 21:28:49] Leg 1 accuracy: 0.767948717948718
INFO [2025-03-24 21:28:49] Leg 2 accuracy: 0.85
INFO [2025-03-24 21:28:49] Leg 3 accuracy: 0.855128205128205
INFO [2025-03-24 21:28:49] Leg 4 accuracy: 0.765151515151515
INFO [2025-03-24 21:28:49] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-24 21:28:49] Leg importance weights: Leg 1: 0.24, Leg 2: 0.26, Leg 3: 0.26, Leg 4: 0.24
INFO [2025-03-24 21:28:49] Resetting men's probabilities at or below the mode to zero
INFO [2025-03-24 21:28:49] Reset 35 values to 0 for Win_Prob (repeated values or values <  1e-04 )
INFO [2025-03-24 21:28:49] Repeated values: 0, 0, 0, 0, 0, 1e-04
INFO [2025-03-24 21:28:49] No values appear more than twice for Podium_Prob
INFO [2025-03-24 21:28:49] No values appear more than twice for Top5_Prob
INFO [2025-03-24 21:28:49] No values appear more than twice for Top10_Prob
INFO [2025-03-24 21:28:49] Resetting ladies' probabilities at or below the mode to zero
INFO [2025-03-24 21:28:49] No values appear more than twice for Win_Prob
INFO [2025-03-24 21:28:49] No values appear more than twice for Podium_Prob
INFO [2025-03-24 21:28:49] No values appear more than twice for Top5_Prob
INFO [2025-03-24 21:28:49] No values appear more than twice for Top10_Prob
INFO [2025-03-24 21:28:49] Normalizing men's team probabilities
INFO [2025-03-24 21:28:49] Normalized Win_Prob from sum of 1.08 to 1
INFO [2025-03-24 21:28:49] Normalized Podium_Prob from sum of 3.91 to 3
INFO [2025-03-24 21:28:49] Normalized Top5_Prob from sum of 5.79 to 5
INFO [2025-03-24 21:28:49] Normalized Top10_Prob from sum of 14.97 to 10
INFO [2025-03-24 21:28:49] Normalizing ladies' team probabilities
INFO [2025-03-24 21:28:49] Normalized Win_Prob from sum of 1.11 to 1
INFO [2025-03-24 21:28:49] Normalized Podium_Prob from sum of 3.25 to 3
INFO [2025-03-24 21:28:49] Normalized Top5_Prob from sum of 4.49 to 5
INFO [2025-03-24 21:28:49] Normalized Top10_Prob from sum of 9.37 to 10
INFO [2025-03-24 21:28:49] Optimizing fantasy relay team
INFO [2025-03-24 21:28:50] Fantasy team optimization complete. Selected 12 teams.
INFO [2025-03-24 21:28:50] Total price: 99482 of max 1e+05
INFO [2025-03-24 21:28:50] Expected total points: 859.2
INFO [2025-03-24 21:28:50] Men's teams: 6 ( 6 )
INFO [2025-03-24 21:28:50] Ladies' teams: 6 ( 6 )
INFO [2025-03-24 21:28:50] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250325/men_relay_points.xlsx
INFO [2025-03-24 21:28:50] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250325/men_relay_probabilities.xlsx
INFO [2025-03-24 21:28:50] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250325/ladies_relay_points.xlsx
INFO [2025-03-24 21:28:50] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250325/ladies_relay_probabilities.xlsx
INFO [2025-03-24 21:28:50] Saved fantasy team results to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250325/fantasy_relay_team.xlsx
INFO [2025-03-24 21:28:50] Relay predictions completed successfully
INFO [2025-03-24 21:30:30] Loading weekend race data
INFO [2025-03-24 21:30:30] Tomorrow's date: 2025-03-25
INFO [2025-03-24 21:30:30] Found 1 men's relay races and 1 ladies' relay races
INFO [2025-03-24 21:30:30] Loading chrono data
INFO [2025-03-24 21:30:36] Loaded men's chrono with 105122 rows and 36 columns
INFO [2025-03-24 21:30:36] Loaded ladies' chrono with 78706 rows and 36 columns
INFO [2025-03-24 21:30:36] Created men's relay df with 9688 rows
INFO [2025-03-24 21:30:36] Created men's individual df with 92143 rows
INFO [2025-03-24 21:30:36] Created ladies' relay df with 8019 rows
INFO [2025-03-24 21:30:36] Created ladies' individual df with 68253 rows
INFO [2025-03-24 21:30:41] Training models for Leg 1
INFO [2025-03-24 21:30:41] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-24 21:30:41] Training podium model using glm
INFO [2025-03-24 21:30:41] Training win model using glm
INFO [2025-03-24 21:30:41] Training top5 model using glm
INFO [2025-03-24 21:30:41] Training top10 model using glm
INFO [2025-03-24 21:30:41] Top features for Leg 1 podium prediction:
INFO [2025-03-24 21:30:41] Training models for Leg 2
INFO [2025-03-24 21:30:41] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-24 21:30:41] Training podium model using glm
INFO [2025-03-24 21:30:41] Training win model using glm
INFO [2025-03-24 21:30:41] Training top5 model using glm
INFO [2025-03-24 21:30:41] Training top10 model using glm
INFO [2025-03-24 21:30:42] Top features for Leg 2 podium prediction:
INFO [2025-03-24 21:30:42] Training models for Leg 3
INFO [2025-03-24 21:30:42] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-24 21:30:42] Training podium model using glm
INFO [2025-03-24 21:30:42] Training win model using glm
INFO [2025-03-24 21:30:42] Training top5 model using glm
INFO [2025-03-24 21:30:42] Training top10 model using glm
INFO [2025-03-24 21:30:42] Top features for Leg 3 podium prediction:
INFO [2025-03-24 21:30:42] Training models for Leg 4
INFO [2025-03-24 21:30:42] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-24 21:30:42] Training podium model using glm
INFO [2025-03-24 21:30:42] Training win model using glm
INFO [2025-03-24 21:30:42] Training top5 model using glm
INFO [2025-03-24 21:30:42] Training top10 model using glm
INFO [2025-03-24 21:30:42] Top features for Leg 4 podium prediction:
INFO [2025-03-24 21:30:42] Training models for Leg 1
INFO [2025-03-24 21:30:42] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-24 21:30:42] Training podium model using glm
INFO [2025-03-24 21:30:42] Training win model using glm
INFO [2025-03-24 21:30:42] Training top5 model using glm
INFO [2025-03-24 21:30:42] Training top10 model using glm
INFO [2025-03-24 21:30:43] Top features for Leg 1 podium prediction:
INFO [2025-03-24 21:30:43] Training models for Leg 2
INFO [2025-03-24 21:30:43] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-24 21:30:43] Training podium model using glm
INFO [2025-03-24 21:30:43] Training win model using glm
INFO [2025-03-24 21:30:43] Training top5 model using glm
INFO [2025-03-24 21:30:43] Training top10 model using glm
INFO [2025-03-24 21:30:43] Top features for Leg 2 podium prediction:
INFO [2025-03-24 21:30:43] Training models for Leg 3
INFO [2025-03-24 21:30:43] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-24 21:30:43] Training podium model using glm
INFO [2025-03-24 21:30:43] Training win model using glm
INFO [2025-03-24 21:30:43] Training top5 model using glm
INFO [2025-03-24 21:30:43] Training top10 model using glm
INFO [2025-03-24 21:30:43] Top features for Leg 3 podium prediction:
INFO [2025-03-24 21:30:43] Training models for Leg 4
INFO [2025-03-24 21:30:43] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-24 21:30:43] Training podium model using glm
INFO [2025-03-24 21:30:43] Training win model using glm
INFO [2025-03-24 21:30:43] Training top5 model using glm
INFO [2025-03-24 21:30:43] Training top10 model using glm
INFO [2025-03-24 21:30:44] Top features for Leg 4 podium prediction:
INFO [2025-03-24 21:30:44] Processing men's relay predictions
INFO [2025-03-24 21:30:44] Loaded men relay teams startlist with 35 rows
INFO [2025-03-24 21:30:44] Loaded men relay individuals startlist with 306 rows
INFO [2025-03-24 21:30:44] Preparing current men skier data
INFO [2025-03-24 21:30:44] Found 9 Elo columns for current skiers
INFO [2025-03-24 21:30:44] Replaced NAs in Distance_Elo with first quartile: 1207.23243912712
INFO [2025-03-24 21:30:44] Replaced NAs in Distance_C_Elo with first quartile: 1233.40200699225
INFO [2025-03-24 21:30:44] Replaced NAs in Distance_F_Elo with first quartile: 1236.48554062178
INFO [2025-03-24 21:30:44] Replaced NAs in Sprint_Elo with first quartile: 1223.60107000698
INFO [2025-03-24 21:30:44] Replaced NAs in Sprint_C_Elo with first quartile: 1241.28715500947
INFO [2025-03-24 21:30:44] Replaced NAs in Sprint_F_Elo with first quartile: 1234.45151108772
INFO [2025-03-24 21:30:44] Replaced NAs in Classic_Elo with first quartile: 1241.52867310024
INFO [2025-03-24 21:30:44] Replaced NAs in Freestyle_Elo with first quartile: 1228.48649348109
INFO [2025-03-24 21:30:44] Replaced NAs in Distance_Pelo with first quartile: 1211.63035979047
INFO [2025-03-24 21:30:44] Replaced NAs in Distance_C_Pelo with first quartile: 1234.81091928129
INFO [2025-03-24 21:30:44] Replaced NAs in Distance_F_Pelo with first quartile: 1239.65331180248
INFO [2025-03-24 21:30:44] Replaced NAs in Sprint_Pelo with first quartile: 1240.94751821383
INFO [2025-03-24 21:30:44] Replaced NAs in Sprint_C_Pelo with first quartile: 1241.28715500947
INFO [2025-03-24 21:30:44] Replaced NAs in Sprint_F_Pelo with first quartile: 1252.45166310493
INFO [2025-03-24 21:30:44] Replaced NAs in Classic_Pelo with first quartile: 1243.63746068082
INFO [2025-03-24 21:30:44] Replaced NAs in Freestyle_Pelo with first quartile: 1249.30280713791
INFO [2025-03-24 21:30:44] Replaced NAs in Classic_Last_5 with first quartile: 0
INFO [2025-03-24 21:30:44] Replaced NAs in Freestyle_Last_5 with first quartile: 0
INFO [2025-03-24 21:30:44] Created Pelo_Pct from Elo with max value: 1946.6211651574
INFO [2025-03-24 21:30:44] Created Distance_Pelo_Pct from Distance_Elo with max value: 1869.1251911742
INFO [2025-03-24 21:30:44] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1777.16297253153
INFO [2025-03-24 21:30:44] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1695.2053212904
INFO [2025-03-24 21:30:44] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1886.80363942481
INFO [2025-03-24 21:30:44] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1711.08486899169
INFO [2025-03-24 21:30:44] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1792.65157560707
INFO [2025-03-24 21:30:44] Created Classic_Pelo_Pct from Classic_Elo with max value: 1807.56773496777
INFO [2025-03-24 21:30:44] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1814.60460629541
INFO [2025-03-24 21:30:44] Prepared data for 381 men skiers with 32 features
INFO [2025-03-24 21:30:44] No FIS startlist, predicting for all skiers in all legs
INFO [2025-03-24 21:30:44] No valid FIS startlist for men, building optimized teams
INFO [2025-03-24 21:30:44] Attempting Option 1: Team model coefficients
INFO [2025-03-24 21:30:44] Option 1 failed: argument "leg_models" is missing, with no default
INFO [2025-03-24 21:30:44] Attempting Option 2: Individual model accuracy
INFO [2025-03-24 21:30:44] Option 2 failed: argument "leg_models" is missing, with no default
INFO [2025-03-24 21:30:44] Using Option 3: Default leg importance weights
INFO [2025-03-24 21:30:44] Using leg importance weights for team optimization: Leg 1: 0.20, Leg 2: 0.20, Leg 3: 0.25, Leg 4: 0.35
INFO [2025-03-24 21:30:44] Optimizing team for Finland
INFO [2025-03-24 21:30:44] Optimizing team for Norway
INFO [2025-03-24 21:30:44] Optimizing team for Sweden
INFO [2025-03-24 21:30:44] Optimizing team for Ireland
INFO [2025-03-24 21:30:44] Optimizing team for Austria
INFO [2025-03-24 21:30:44] Optimizing team for France
INFO [2025-03-24 21:30:44] Optimizing team for Germany
INFO [2025-03-24 21:30:44] Optimizing team for Italy
INFO [2025-03-24 21:30:44] Optimizing team for Switzerland
INFO [2025-03-24 21:30:44] Optimizing team for USA
INFO [2025-03-24 21:30:44] Optimizing team for Canada
INFO [2025-03-24 21:30:45] Optimizing team for Estonia
INFO [2025-03-24 21:30:45] Optimizing team for Andorra
INFO [2025-03-24 21:30:45] Optimizing team for Czechia
INFO [2025-03-24 21:30:45] Optimizing team for Great Britain
INFO [2025-03-24 21:30:45] Optimizing team for Bulgaria
INFO [2025-03-24 21:30:45] Optimizing team for Armenia
INFO [2025-03-24 21:30:45] Optimizing team for Slovenia
INFO [2025-03-24 21:30:45] Optimizing team for Australia
INFO [2025-03-24 21:30:45] Optimizing team for Kazakhstan
INFO [2025-03-24 21:30:45] Optimizing team for Spain
INFO [2025-03-24 21:30:45] Optimizing team for Ukraine
INFO [2025-03-24 21:30:45] Optimizing team for Slovakia
INFO [2025-03-24 21:30:45] Optimizing team for Latvia
INFO [2025-03-24 21:30:45] Optimizing team for Hungary
INFO [2025-03-24 21:30:45] Optimizing team for Japan
INFO [2025-03-24 21:30:45] Optimizing team for Poland
INFO [2025-03-24 21:30:45] Optimizing team for Colombia
INFO [2025-03-24 21:30:45] Optimizing team for South Korea
INFO [2025-03-24 21:30:45] Optimizing team for China
INFO [2025-03-24 21:30:45] Optimizing team for Chile
INFO [2025-03-24 21:30:45] Optimizing team for Argentina
INFO [2025-03-24 21:30:45] Optimizing team for Croatia
INFO [2025-03-24 21:30:45] Optimizing team for Liechtenstein
INFO [2025-03-24 21:30:45] Optimizing team for Romania
INFO [2025-03-24 21:30:45] Optimizing team for Serbia
INFO [2025-03-24 21:30:45] Optimizing team for Thailand
INFO [2025-03-24 21:30:45] Optimizing team for Mongolia
INFO [2025-03-24 21:30:45] Optimizing team for North Macedonia
INFO [2025-03-24 21:30:45] Optimizing team for Belgium
INFO [2025-03-24 21:30:45] Optimizing team for Lithuania
INFO [2025-03-24 21:30:45] Optimizing team for Haiti
INFO [2025-03-24 21:30:45] Optimizing team for Bosnia&Herzegovina
INFO [2025-03-24 21:30:45] Optimizing team for Turkey
INFO [2025-03-24 21:30:45] Optimizing team for Denmark
INFO [2025-03-24 21:30:45] Optimizing team for Brazil
INFO [2025-03-24 21:30:45] Optimizing team for Iceland
INFO [2025-03-24 21:30:45] Optimizing team for Greece
INFO [2025-03-24 21:30:45] Optimizing team for Nigeria
INFO [2025-03-24 21:30:45] Optimizing team for Montenegro
INFO [2025-03-24 21:30:45] Optimizing team for Kyrgyzstan
INFO [2025-03-24 21:30:45] Optimizing team for India
INFO [2025-03-24 21:30:45] Optimizing team for Bolivia
INFO [2025-03-24 21:30:45] Optimizing team for Portugal
INFO [2025-03-24 21:30:45] Optimizing team for Lebanon
INFO [2025-03-24 21:30:45] Optimizing team for Iran
INFO [2025-03-24 21:30:45] Optimizing team for Mexico
INFO [2025-03-24 21:30:45] Optimizing team for Taiwan
INFO [2025-03-24 21:30:45] Optimizing team for Saudi Arabia
INFO [2025-03-24 21:30:45] Optimizing team for Peru
INFO [2025-03-24 21:30:45] Optimizing team for South Africa
INFO [2025-03-24 21:30:45] Optimizing team for San Marino
INFO [2025-03-24 21:30:45] Optimizing team for Israel
INFO [2025-03-24 21:30:45] Optimizing team for Ecuador
INFO [2025-03-24 21:30:45] Optimizing team for Venezuela
INFO [2025-03-24 21:30:45] Optimizing team for Trinidad & Tobago
INFO [2025-03-24 21:30:45] Optimizing team for Malta
INFO [2025-03-24 21:30:46] Matching optimized teams with startlist team names and prices
INFO [2025-03-24 21:30:46] Processing ladies's relay predictions
INFO [2025-03-24 21:30:46] Loaded ladies relay teams startlist with 20 rows
INFO [2025-03-24 21:30:46] Loaded ladies relay individuals startlist with 80 rows
INFO [2025-03-24 21:30:46] Preparing current ladies skier data
INFO [2025-03-24 21:30:46] Found 9 Elo columns for current skiers
INFO [2025-03-24 21:30:46] Replaced NAs in Distance_Elo with first quartile: 1237.38564383256
INFO [2025-03-24 21:30:46] Replaced NAs in Distance_C_Elo with first quartile: 1243.87329106944
INFO [2025-03-24 21:30:46] Replaced NAs in Distance_F_Elo with first quartile: 1256.69628195708
INFO [2025-03-24 21:30:46] Replaced NAs in Sprint_Elo with first quartile: 1246.32574824425
INFO [2025-03-24 21:30:46] Replaced NAs in Sprint_C_Elo with first quartile: 1257.67866787334
INFO [2025-03-24 21:30:46] Replaced NAs in Sprint_F_Elo with first quartile: 1244.84742904868
INFO [2025-03-24 21:30:46] Replaced NAs in Classic_Elo with first quartile: 1252.44868703669
INFO [2025-03-24 21:30:46] Replaced NAs in Freestyle_Elo with first quartile: 1244.44508230281
INFO [2025-03-24 21:30:46] Replaced NAs in Distance_Pelo with first quartile: 1241.11854419952
INFO [2025-03-24 21:30:46] Replaced NAs in Distance_C_Pelo with first quartile: 1245.57367555166
INFO [2025-03-24 21:30:46] Replaced NAs in Distance_F_Pelo with first quartile: 1259.54282973153
INFO [2025-03-24 21:30:46] Replaced NAs in Sprint_Pelo with first quartile: 1254.58885254623
INFO [2025-03-24 21:30:46] Replaced NAs in Sprint_C_Pelo with first quartile: 1257.58302026178
INFO [2025-03-24 21:30:46] Replaced NAs in Sprint_F_Pelo with first quartile: 1257.67755691493
INFO [2025-03-24 21:30:46] Replaced NAs in Classic_Pelo with first quartile: 1256.79275004544
INFO [2025-03-24 21:30:46] Replaced NAs in Freestyle_Pelo with first quartile: 1256.79999900008
INFO [2025-03-24 21:30:46] Replaced NAs in Classic_Last_5 with first quartile: 3.5
INFO [2025-03-24 21:30:46] Replaced NAs in Freestyle_Last_5 with first quartile: 2.4
INFO [2025-03-24 21:30:46] Created Pelo_Pct from Elo with max value: 1841.00191142018
INFO [2025-03-24 21:30:46] Created Distance_Pelo_Pct from Distance_Elo with max value: 1889.46974050597
INFO [2025-03-24 21:30:46] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1763.33572074398
INFO [2025-03-24 21:30:46] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1693.85026290322
INFO [2025-03-24 21:30:46] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1742.74758850835
INFO [2025-03-24 21:30:46] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1601.5820663103
INFO [2025-03-24 21:30:46] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1681.09824552997
INFO [2025-03-24 21:30:46] Created Classic_Pelo_Pct from Classic_Elo with max value: 1698.69428891549
INFO [2025-03-24 21:30:46] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1707.58410982918
INFO [2025-03-24 21:30:46] Prepared data for 255 ladies skiers with 32 features
INFO [2025-03-24 21:30:46] Using FIS startlist for ladies's leg predictions
INFO [2025-03-24 21:30:46] Using FIS startlist for ladies
INFO [2025-03-24 21:30:46] Attempting Option 1: Team model coefficients
INFO [2025-03-24 21:30:46] Option 1 failed: No team_podium model found
INFO [2025-03-24 21:30:46] Option 1 failed: No team model
INFO [2025-03-24 21:30:46] Attempting Option 2: Individual model accuracy
INFO [2025-03-24 21:30:46] Leg 1 accuracy: 0.787179487179487
INFO [2025-03-24 21:30:46] Leg 2 accuracy: 0.85
INFO [2025-03-24 21:30:46] Leg 3 accuracy: 0.821794871794872
INFO [2025-03-24 21:30:46] Leg 4 accuracy: 0.762121212121212
INFO [2025-03-24 21:30:46] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-24 21:30:46] Leg importance weights: Leg 1: 0.24, Leg 2: 0.26, Leg 3: 0.26, Leg 4: 0.24
INFO [2025-03-24 21:30:46] Resetting men's probabilities at or below the mode to zero
INFO [2025-03-24 21:30:46] Reset 35 values to 0 for Win_Prob (repeated values or values <  1e-04 )
INFO [2025-03-24 21:30:46] Repeated values: 0, 0, 0, 0, 0, 1e-04
INFO [2025-03-24 21:30:46] No values appear more than twice for Podium_Prob
INFO [2025-03-24 21:30:46] No values appear more than twice for Top5_Prob
INFO [2025-03-24 21:30:46] No values appear more than twice for Top10_Prob
INFO [2025-03-24 21:30:46] Resetting ladies' probabilities at or below the mode to zero
INFO [2025-03-24 21:30:46] No values appear more than twice for Win_Prob
INFO [2025-03-24 21:30:46] No values appear more than twice for Podium_Prob
INFO [2025-03-24 21:30:46] No values appear more than twice for Top5_Prob
INFO [2025-03-24 21:30:46] No values appear more than twice for Top10_Prob
INFO [2025-03-24 21:30:46] Normalizing men's team probabilities
INFO [2025-03-24 21:30:46] Normalized Win_Prob from sum of 1.08 to 1
INFO [2025-03-24 21:30:46] Normalized Podium_Prob from sum of 3.91 to 3
INFO [2025-03-24 21:30:46] Normalized Top5_Prob from sum of 5.79 to 5
INFO [2025-03-24 21:30:46] Normalized Top10_Prob from sum of 14.97 to 10
INFO [2025-03-24 21:30:46] Normalizing ladies' team probabilities
INFO [2025-03-24 21:30:46] Normalized Win_Prob from sum of 1.12 to 1
INFO [2025-03-24 21:30:46] Normalized Podium_Prob from sum of 3.26 to 3
INFO [2025-03-24 21:30:46] Normalized Top5_Prob from sum of 4.5 to 5
INFO [2025-03-24 21:30:46] Normalized Top10_Prob from sum of 9.37 to 10
INFO [2025-03-24 21:30:46] Optimizing fantasy relay team
INFO [2025-03-24 21:30:46] Fantasy team optimization complete. Selected 12 teams.
INFO [2025-03-24 21:30:46] Total price: 99482 of max 1e+05
INFO [2025-03-24 21:30:46] Expected total points: 859.1
INFO [2025-03-24 21:30:46] Men's teams: 6 ( 6 )
INFO [2025-03-24 21:30:46] Ladies' teams: 6 ( 6 )
INFO [2025-03-24 21:30:46] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250325/men_relay_points.xlsx
INFO [2025-03-24 21:30:46] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250325/men_relay_probabilities.xlsx
INFO [2025-03-24 21:30:46] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250325/ladies_relay_points.xlsx
INFO [2025-03-24 21:30:46] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250325/ladies_relay_probabilities.xlsx
INFO [2025-03-24 21:30:46] Saved fantasy team results to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250325/fantasy_relay_team.xlsx
INFO [2025-03-24 21:30:46] Relay predictions completed successfully
