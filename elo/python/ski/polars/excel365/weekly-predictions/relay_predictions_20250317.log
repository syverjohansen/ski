INFO [2025-03-17 08:14:18] Starting relay predictions process
INFO [2025-03-17 08:14:19] Loading weekend race data
INFO [2025-03-17 08:14:19] Tomorrow's date: 2025-03-18
INFO [2025-03-17 08:14:19] Found 0 men's relay races and 0 ladies' relay races
INFO [2025-03-17 08:14:19] Loading chrono data
INFO [2025-03-17 08:14:26] Loaded men's chrono with 104709 rows and 36 columns
INFO [2025-03-17 08:14:26] Loaded ladies' chrono with 78415 rows and 36 columns
INFO [2025-03-17 08:14:26] Created men's relay df with 9688 rows
INFO [2025-03-17 08:14:26] Created men's individual df with 91796 rows
INFO [2025-03-17 08:14:26] Created ladies' relay df with 8019 rows
INFO [2025-03-17 08:14:26] Created ladies' individual df with 68008 rows
INFO [2025-03-17 08:14:31] Training models for Leg 1
INFO [2025-03-17 08:14:31] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-17 08:14:31] Training podium model using xgbTree
INFO [2025-03-17 08:14:32] Training win model using xgbTree
INFO [2025-03-17 08:14:32] Training top5 model using xgbTree
INFO [2025-03-17 08:14:32] Training top10 model using xgbTree
INFO [2025-03-17 08:14:33] Top features for Leg 1 podium prediction:
INFO [2025-03-17 08:14:33] Training models for Leg 2
INFO [2025-03-17 08:14:33] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-17 08:14:33] Training podium model using xgbTree
INFO [2025-03-17 08:14:33] Training win model using xgbTree
INFO [2025-03-17 08:14:33] Training top5 model using xgbTree
INFO [2025-03-17 08:14:34] Training top10 model using xgbTree
INFO [2025-03-17 08:14:34] Top features for Leg 2 podium prediction:
INFO [2025-03-17 08:14:34] Training models for Leg 3
INFO [2025-03-17 08:14:34] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-17 08:14:34] Training podium model using xgbTree
INFO [2025-03-17 08:14:34] Training win model using xgbTree
INFO [2025-03-17 08:14:35] Training top5 model using xgbTree
INFO [2025-03-17 08:14:35] Training top10 model using xgbTree
INFO [2025-03-17 08:14:35] Top features for Leg 3 podium prediction:
INFO [2025-03-17 08:14:35] Training models for Leg 4
INFO [2025-03-17 08:14:35] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-17 08:14:35] Training podium model using xgbTree
INFO [2025-03-17 08:14:36] Training win model using xgbTree
INFO [2025-03-17 08:14:36] Training top5 model using xgbTree
INFO [2025-03-17 08:14:36] Training top10 model using xgbTree
INFO [2025-03-17 08:14:36] Top features for Leg 4 podium prediction:
INFO [2025-03-17 08:14:36] Training models for Leg 1
INFO [2025-03-17 08:14:36] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-17 08:14:36] Training podium model using xgbTree
INFO [2025-03-17 08:14:37] Training win model using xgbTree
INFO [2025-03-17 08:14:37] Training top5 model using xgbTree
INFO [2025-03-17 08:14:37] Training top10 model using xgbTree
INFO [2025-03-17 08:14:37] Top features for Leg 1 podium prediction:
INFO [2025-03-17 08:14:37] Training models for Leg 2
INFO [2025-03-17 08:14:37] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-17 08:14:37] Training podium model using xgbTree
INFO [2025-03-17 08:14:38] Training win model using xgbTree
INFO [2025-03-17 08:14:38] Training top5 model using xgbTree
INFO [2025-03-17 08:14:38] Training top10 model using xgbTree
INFO [2025-03-17 08:14:38] Top features for Leg 2 podium prediction:
INFO [2025-03-17 08:14:38] Training models for Leg 3
INFO [2025-03-17 08:14:38] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-17 08:14:38] Training podium model using xgbTree
INFO [2025-03-17 08:14:39] Training win model using xgbTree
INFO [2025-03-17 08:14:39] Training top5 model using xgbTree
INFO [2025-03-17 08:14:39] Training top10 model using xgbTree
INFO [2025-03-17 08:14:39] Top features for Leg 3 podium prediction:
INFO [2025-03-17 08:14:39] Training models for Leg 4
INFO [2025-03-17 08:14:39] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-17 08:14:39] Training podium model using xgbTree
INFO [2025-03-17 08:14:39] Training win model using xgbTree
INFO [2025-03-17 08:14:40] Training top5 model using xgbTree
INFO [2025-03-17 08:14:40] Training top10 model using xgbTree
INFO [2025-03-17 08:14:40] Top features for Leg 4 podium prediction:
INFO [2025-03-17 08:14:40] Processing men's relay predictions
INFO [2025-03-17 08:14:40] Loaded men relay teams startlist with 24 rows
INFO [2025-03-17 08:14:40] Loaded men relay individuals startlist with 96 rows
INFO [2025-03-17 08:14:40] Preparing current men skier data
INFO [2025-03-17 08:14:40] Found 9 Elo columns for current skiers
INFO [2025-03-17 08:14:40] Replaced NAs in Distance_Elo with first quartile: 1210.34903070123
INFO [2025-03-17 08:14:40] Replaced NAs in Distance_C_Elo with first quartile: 1228.28491180132
INFO [2025-03-17 08:14:40] Replaced NAs in Distance_F_Elo with first quartile: 1232.92687393963
INFO [2025-03-17 08:14:40] Replaced NAs in Sprint_Elo with first quartile: 1219.23085164112
INFO [2025-03-17 08:14:40] Replaced NAs in Sprint_C_Elo with first quartile: 1241.15705230634
INFO [2025-03-17 08:14:40] Replaced NAs in Sprint_F_Elo with first quartile: 1226.75938562454
INFO [2025-03-17 08:14:40] Replaced NAs in Classic_Elo with first quartile: 1240.75537238594
INFO [2025-03-17 08:14:40] Replaced NAs in Freestyle_Elo with first quartile: 1222.10670066235
INFO [2025-03-17 08:14:40] Replaced NAs in Distance_Pelo with first quartile: 1210.74873863424
INFO [2025-03-17 08:14:40] Replaced NAs in Distance_C_Pelo with first quartile: 1229.99748531218
INFO [2025-03-17 08:14:40] Replaced NAs in Distance_F_Pelo with first quartile: 1236.69249039986
INFO [2025-03-17 08:14:40] Replaced NAs in Sprint_Pelo with first quartile: 1237.59624724894
INFO [2025-03-17 08:14:40] Replaced NAs in Sprint_C_Pelo with first quartile: 1241.15705230634
INFO [2025-03-17 08:14:40] Replaced NAs in Sprint_F_Pelo with first quartile: 1254.21391795859
INFO [2025-03-17 08:14:40] Replaced NAs in Classic_Pelo with first quartile: 1243.28733690217
INFO [2025-03-17 08:14:40] Replaced NAs in Freestyle_Pelo with first quartile: 1242.67538984024
INFO [2025-03-17 08:14:40] Replaced NAs in Classic_Last_5 with first quartile: 0
INFO [2025-03-17 08:14:40] Replaced NAs in Freestyle_Last_5 with first quartile: 0
INFO [2025-03-17 08:14:40] Created Pelo_Pct from Elo with max value: 1936.67566595139
INFO [2025-03-17 08:14:40] Created Distance_Pelo_Pct from Distance_Elo with max value: 1844.07614946524
INFO [2025-03-17 08:14:40] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1772.68700688686
INFO [2025-03-17 08:14:40] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1704.82115321538
INFO [2025-03-17 08:14:40] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1882.4487927528
INFO [2025-03-17 08:14:40] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1711.09106628928
INFO [2025-03-17 08:14:40] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1797.07396691951
INFO [2025-03-17 08:14:40] Created Classic_Pelo_Pct from Classic_Elo with max value: 1803.94978393517
INFO [2025-03-17 08:14:40] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1804.47493286592
INFO [2025-03-17 08:14:40] Prepared data for 365 men skiers with 32 features
INFO [2025-03-17 08:14:41] Using FIS startlist for men's leg predictions
INFO [2025-03-17 08:14:41] Using FIS startlist for men
INFO [2025-03-17 08:14:41] Attempting Option 1: Team model coefficients
INFO [2025-03-17 08:14:41] Option 1 failed: No team_podium model found
INFO [2025-03-17 08:14:41] Option 1 failed: No team model
INFO [2025-03-17 08:14:41] Attempting Option 2: Individual model accuracy
INFO [2025-03-17 08:14:41] Leg 1 accuracy: 0.847909604519774
INFO [2025-03-17 08:14:41] Leg 2 accuracy: 0.851398792129359
INFO [2025-03-17 08:14:41] Leg 3 accuracy: 0.874137931034483
INFO [2025-03-17 08:14:41] Leg 4 accuracy: 0.895191895577635
INFO [2025-03-17 08:14:41] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-17 08:14:41] Leg importance weights: Leg 1: 0.24, Leg 2: 0.25, Leg 3: 0.25, Leg 4: 0.26
INFO [2025-03-17 08:14:41] Processing ladies's relay predictions
INFO [2025-03-17 08:14:41] Loaded ladies relay teams startlist with 20 rows
INFO [2025-03-17 08:14:41] Loaded ladies relay individuals startlist with 80 rows
INFO [2025-03-17 08:14:41] Preparing current ladies skier data
INFO [2025-03-17 08:14:41] Found 9 Elo columns for current skiers
INFO [2025-03-17 08:14:41] Replaced NAs in Distance_Elo with first quartile: 1237.24135379294
INFO [2025-03-17 08:14:41] Replaced NAs in Distance_C_Elo with first quartile: 1242.00162117671
INFO [2025-03-17 08:14:41] Replaced NAs in Distance_F_Elo with first quartile: 1257.26031057313
INFO [2025-03-17 08:14:41] Replaced NAs in Sprint_Elo with first quartile: 1238.78920518219
INFO [2025-03-17 08:14:41] Replaced NAs in Sprint_C_Elo with first quartile: 1257.67866787334
INFO [2025-03-17 08:14:41] Replaced NAs in Sprint_F_Elo with first quartile: 1237.87670663998
INFO [2025-03-17 08:14:41] Replaced NAs in Classic_Elo with first quartile: 1250.26853632078
INFO [2025-03-17 08:14:41] Replaced NAs in Freestyle_Elo with first quartile: 1236.42030772967
INFO [2025-03-17 08:14:41] Replaced NAs in Distance_Pelo with first quartile: 1242.1169240887
INFO [2025-03-17 08:14:41] Replaced NAs in Distance_C_Pelo with first quartile: 1243.5007326682
INFO [2025-03-17 08:14:41] Replaced NAs in Distance_F_Pelo with first quartile: 1259.23240340024
INFO [2025-03-17 08:14:41] Replaced NAs in Sprint_Pelo with first quartile: 1254.15703318668
INFO [2025-03-17 08:14:41] Replaced NAs in Sprint_C_Pelo with first quartile: 1257.58302026178
INFO [2025-03-17 08:14:41] Replaced NAs in Sprint_F_Pelo with first quartile: 1255.58157573541
INFO [2025-03-17 08:14:41] Replaced NAs in Classic_Pelo with first quartile: 1255.39340994292
INFO [2025-03-17 08:14:41] Replaced NAs in Freestyle_Pelo with first quartile: 1253.82185786105
INFO [2025-03-17 08:14:41] Replaced NAs in Classic_Last_5 with first quartile: 3.05
INFO [2025-03-17 08:14:41] Replaced NAs in Freestyle_Last_5 with first quartile: 3.36666666666667
INFO [2025-03-17 08:14:41] Created Pelo_Pct from Elo with max value: 1838.94642582206
INFO [2025-03-17 08:14:41] Created Distance_Pelo_Pct from Distance_Elo with max value: 1864.8112847824
INFO [2025-03-17 08:14:41] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1760.04499166882
INFO [2025-03-17 08:14:41] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1692.68476450479
INFO [2025-03-17 08:14:41] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1754.8999437313
INFO [2025-03-17 08:14:41] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1601.5820663103
INFO [2025-03-17 08:14:41] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1706.06395983697
INFO [2025-03-17 08:14:41] Created Classic_Pelo_Pct from Classic_Elo with max value: 1693.23571740607
INFO [2025-03-17 08:14:41] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1720.26593995458
INFO [2025-03-17 08:14:41] Prepared data for 242 ladies skiers with 32 features
INFO [2025-03-17 08:14:41] Using FIS startlist for ladies's leg predictions
INFO [2025-03-17 08:14:41] Using FIS startlist for ladies
INFO [2025-03-17 08:14:41] Attempting Option 1: Team model coefficients
INFO [2025-03-17 08:14:41] Option 1 failed: No team_podium model found
INFO [2025-03-17 08:14:41] Option 1 failed: No team model
INFO [2025-03-17 08:14:41] Attempting Option 2: Individual model accuracy
INFO [2025-03-17 08:14:41] Leg 1 accuracy: 0.821794871794872
INFO [2025-03-17 08:14:41] Leg 2 accuracy: 0.866666666666667
INFO [2025-03-17 08:14:41] Leg 3 accuracy: 0.833333333333333
INFO [2025-03-17 08:14:41] Leg 4 accuracy: 0.848484848484849
INFO [2025-03-17 08:14:41] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-17 08:14:41] Leg importance weights: Leg 1: 0.24, Leg 2: 0.26, Leg 3: 0.25, Leg 4: 0.25
INFO [2025-03-17 08:14:41] Resetting men's probabilities at or below the mode to zero
INFO [2025-03-17 08:14:41] Reset 19 values to 0 for Win_Prob (repeated values or values <  0.0965 )
INFO [2025-03-17 08:14:41] Repeated values: 0.0965
INFO [2025-03-17 08:14:41] Reset 11 values to 0 for Podium_Prob (repeated values or values <  0.0806 )
INFO [2025-03-17 08:14:41] Repeated values: 0.0798, 0.08, 0.0806
INFO [2025-03-17 08:14:41] Reset 8 values to 0 for Top5_Prob (repeated values or values <  0.1143 )
INFO [2025-03-17 08:14:41] Repeated values: 0.1143
INFO [2025-03-17 08:14:41] No values appear more than twice for Top10_Prob
INFO [2025-03-17 08:14:41] Resetting ladies' probabilities at or below the mode to zero
INFO [2025-03-17 08:14:41] Reset 14 values to 0 for Win_Prob (repeated values or values <  0.1363 )
INFO [2025-03-17 08:14:41] Repeated values: 0.1363
INFO [2025-03-17 08:14:41] Reset 10 values to 0 for Podium_Prob (repeated values or values <  0.1401 )
INFO [2025-03-17 08:14:41] Repeated values: 0.1401
INFO [2025-03-17 08:14:41] Reset 10 values to 0 for Top5_Prob (repeated values or values <  0.1494 )
INFO [2025-03-17 08:14:41] Repeated values: 0.1494
INFO [2025-03-17 08:14:41] Reset 18 values to 0 for Top10_Prob (repeated values or values <  0.9188 )
INFO [2025-03-17 08:14:41] Repeated values: 0.9188
INFO [2025-03-17 08:14:41] Normalizing men's team probabilities
INFO [2025-03-17 08:14:41] Normalized Win_Prob from sum of 1.11 to 1
INFO [2025-03-17 08:14:41] Normalized Podium_Prob from sum of 2.98 to 3
INFO [2025-03-17 08:14:41] Normalized Top5_Prob from sum of 4.98 to 5
INFO [2025-03-17 08:14:41] Normalized Top10_Prob from sum of 10.47 to 10
INFO [2025-03-17 08:14:41] Recalculated Expected_Points based on normalized probabilities
INFO [2025-03-17 08:14:41] Normalizing ladies' team probabilities
INFO [2025-03-17 08:14:41] Normalized Win_Prob from sum of 1.45 to 1
INFO [2025-03-17 08:14:41] Normalized Podium_Prob from sum of 3.44 to 3
INFO [2025-03-17 08:14:41] Normalized Top5_Prob from sum of 5.2 to 5
INFO [2025-03-17 08:14:41] Normalized Top10_Prob from sum of 1.85 to 10
INFO [2025-03-17 08:14:41] Recalculated Expected_Points based on normalized probabilities
INFO [2025-03-17 08:14:41] Optimizing fantasy relay team
INFO [2025-03-17 08:14:41] Fantasy team optimization complete. Selected 9 teams.
INFO [2025-03-17 08:14:41] Total price: 99818 of max 1e+05
INFO [2025-03-17 08:14:41] Expected total points: 1200.7
INFO [2025-03-17 08:14:41] Men's teams: 6 ( 6 )
INFO [2025-03-17 08:14:41] Ladies' teams: 3 ( 3 )
INFO [2025-03-17 08:14:41] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250318/men_relay_points.xlsx
INFO [2025-03-17 08:14:41] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250318/men_relay_probabilities.xlsx
INFO [2025-03-17 08:14:41] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250318/ladies_relay_points.xlsx
INFO [2025-03-17 08:14:41] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250318/ladies_relay_probabilities.xlsx
INFO [2025-03-17 08:14:41] Saved fantasy team results to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250318/fantasy_relay_team.xlsx
INFO [2025-03-17 08:14:41] Relay predictions completed successfully
INFO [2025-03-17 08:15:30] Loading weekend race data
INFO [2025-03-17 08:15:30] Tomorrow's date: 2025-03-18
INFO [2025-03-17 08:15:30] Found 0 men's relay races and 0 ladies' relay races
INFO [2025-03-17 08:15:30] Loading chrono data
INFO [2025-03-17 08:15:36] Loaded men's chrono with 104709 rows and 36 columns
INFO [2025-03-17 08:15:36] Loaded ladies' chrono with 78415 rows and 36 columns
INFO [2025-03-17 08:15:36] Created men's relay df with 9688 rows
INFO [2025-03-17 08:15:36] Created men's individual df with 91796 rows
INFO [2025-03-17 08:15:36] Created ladies' relay df with 8019 rows
INFO [2025-03-17 08:15:36] Created ladies' individual df with 68008 rows
INFO [2025-03-17 08:15:41] Training models for Leg 1
INFO [2025-03-17 08:15:41] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-17 08:15:41] Training podium model using glm
INFO [2025-03-17 08:15:41] Training win model using glm
INFO [2025-03-17 08:15:41] Training top5 model using glm
INFO [2025-03-17 08:15:41] Training top10 model using glm
INFO [2025-03-17 08:15:41] Top features for Leg 1 podium prediction:
INFO [2025-03-17 08:15:41] Training models for Leg 2
INFO [2025-03-17 08:15:41] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-17 08:15:41] Training podium model using glm
INFO [2025-03-17 08:15:41] Training win model using glm
INFO [2025-03-17 08:15:41] Training top5 model using glm
INFO [2025-03-17 08:15:41] Training top10 model using glm
INFO [2025-03-17 08:15:41] Top features for Leg 2 podium prediction:
INFO [2025-03-17 08:15:41] Training models for Leg 3
INFO [2025-03-17 08:15:41] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-17 08:15:41] Training podium model using glm
INFO [2025-03-17 08:15:41] Training win model using glm
INFO [2025-03-17 08:15:41] Training top5 model using glm
INFO [2025-03-17 08:15:42] Training top10 model using glm
INFO [2025-03-17 08:15:42] Top features for Leg 3 podium prediction:
INFO [2025-03-17 08:15:42] Training models for Leg 4
INFO [2025-03-17 08:15:42] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-17 08:15:42] Training podium model using glm
INFO [2025-03-17 08:15:42] Training win model using glm
INFO [2025-03-17 08:15:42] Training top5 model using glm
INFO [2025-03-17 08:15:42] Training top10 model using glm
INFO [2025-03-17 08:15:42] Top features for Leg 4 podium prediction:
INFO [2025-03-17 08:15:42] Training models for Leg 1
INFO [2025-03-17 08:15:42] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-17 08:15:42] Training podium model using glm
INFO [2025-03-17 08:15:42] Training win model using glm
INFO [2025-03-17 08:15:42] Training top5 model using glm
INFO [2025-03-17 08:15:42] Training top10 model using glm
INFO [2025-03-17 08:15:42] Top features for Leg 1 podium prediction:
INFO [2025-03-17 08:15:42] Training models for Leg 2
INFO [2025-03-17 08:15:42] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-17 08:15:42] Training podium model using glm
INFO [2025-03-17 08:15:42] Training win model using glm
INFO [2025-03-17 08:15:43] Training top5 model using glm
INFO [2025-03-17 08:15:43] Training top10 model using glm
INFO [2025-03-17 08:15:43] Top features for Leg 2 podium prediction:
INFO [2025-03-17 08:15:43] Training models for Leg 3
INFO [2025-03-17 08:15:43] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-17 08:15:43] Training podium model using glm
INFO [2025-03-17 08:15:43] Training win model using glm
INFO [2025-03-17 08:15:43] Training top5 model using glm
INFO [2025-03-17 08:15:43] Training top10 model using glm
INFO [2025-03-17 08:15:43] Top features for Leg 3 podium prediction:
INFO [2025-03-17 08:15:43] Training models for Leg 4
INFO [2025-03-17 08:15:43] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-17 08:15:43] Training podium model using glm
INFO [2025-03-17 08:15:43] Training win model using glm
INFO [2025-03-17 08:15:43] Training top5 model using glm
INFO [2025-03-17 08:15:43] Training top10 model using glm
INFO [2025-03-17 08:15:43] Top features for Leg 4 podium prediction:
INFO [2025-03-17 08:15:43] Processing men's relay predictions
INFO [2025-03-17 08:15:43] Loaded men relay teams startlist with 24 rows
INFO [2025-03-17 08:15:43] Loaded men relay individuals startlist with 96 rows
INFO [2025-03-17 08:15:43] Preparing current men skier data
INFO [2025-03-17 08:15:43] Found 9 Elo columns for current skiers
INFO [2025-03-17 08:15:44] Replaced NAs in Distance_Elo with first quartile: 1210.34903070123
INFO [2025-03-17 08:15:44] Replaced NAs in Distance_C_Elo with first quartile: 1228.28491180132
INFO [2025-03-17 08:15:44] Replaced NAs in Distance_F_Elo with first quartile: 1232.92687393963
INFO [2025-03-17 08:15:44] Replaced NAs in Sprint_Elo with first quartile: 1219.23085164112
INFO [2025-03-17 08:15:44] Replaced NAs in Sprint_C_Elo with first quartile: 1241.15705230634
INFO [2025-03-17 08:15:44] Replaced NAs in Sprint_F_Elo with first quartile: 1226.75938562454
INFO [2025-03-17 08:15:44] Replaced NAs in Classic_Elo with first quartile: 1240.75537238594
INFO [2025-03-17 08:15:44] Replaced NAs in Freestyle_Elo with first quartile: 1222.10670066235
INFO [2025-03-17 08:15:44] Replaced NAs in Distance_Pelo with first quartile: 1210.74873863424
INFO [2025-03-17 08:15:44] Replaced NAs in Distance_C_Pelo with first quartile: 1229.99748531218
INFO [2025-03-17 08:15:44] Replaced NAs in Distance_F_Pelo with first quartile: 1236.69249039986
INFO [2025-03-17 08:15:44] Replaced NAs in Sprint_Pelo with first quartile: 1237.59624724894
INFO [2025-03-17 08:15:44] Replaced NAs in Sprint_C_Pelo with first quartile: 1241.15705230634
INFO [2025-03-17 08:15:44] Replaced NAs in Sprint_F_Pelo with first quartile: 1254.21391795859
INFO [2025-03-17 08:15:44] Replaced NAs in Classic_Pelo with first quartile: 1243.28733690217
INFO [2025-03-17 08:15:44] Replaced NAs in Freestyle_Pelo with first quartile: 1242.67538984024
INFO [2025-03-17 08:15:44] Replaced NAs in Classic_Last_5 with first quartile: 0
INFO [2025-03-17 08:15:44] Replaced NAs in Freestyle_Last_5 with first quartile: 0
INFO [2025-03-17 08:15:44] Created Pelo_Pct from Elo with max value: 1936.67566595139
INFO [2025-03-17 08:15:44] Created Distance_Pelo_Pct from Distance_Elo with max value: 1844.07614946524
INFO [2025-03-17 08:15:44] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1772.68700688686
INFO [2025-03-17 08:15:44] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1704.82115321538
INFO [2025-03-17 08:15:44] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1882.4487927528
INFO [2025-03-17 08:15:44] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1711.09106628928
INFO [2025-03-17 08:15:44] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1797.07396691951
INFO [2025-03-17 08:15:44] Created Classic_Pelo_Pct from Classic_Elo with max value: 1803.94978393517
INFO [2025-03-17 08:15:44] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1804.47493286592
INFO [2025-03-17 08:15:44] Prepared data for 365 men skiers with 32 features
INFO [2025-03-17 08:15:44] Using FIS startlist for men's leg predictions
INFO [2025-03-17 08:15:44] Using FIS startlist for men
INFO [2025-03-17 08:15:44] Attempting Option 1: Team model coefficients
INFO [2025-03-17 08:15:44] Option 1 failed: No team_podium model found
INFO [2025-03-17 08:15:44] Option 1 failed: No team model
INFO [2025-03-17 08:15:44] Attempting Option 2: Individual model accuracy
INFO [2025-03-17 08:15:44] Leg 1 accuracy: 0.848022598870056
INFO [2025-03-17 08:15:44] Leg 2 accuracy: 0.854728229105786
INFO [2025-03-17 08:15:44] Leg 3 accuracy: 0.843448275862069
INFO [2025-03-17 08:15:44] Leg 4 accuracy: 0.888067406974479
INFO [2025-03-17 08:15:44] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-17 08:15:44] Leg importance weights: Leg 1: 0.25, Leg 2: 0.25, Leg 3: 0.25, Leg 4: 0.26
INFO [2025-03-17 08:15:44] Processing ladies's relay predictions
INFO [2025-03-17 08:15:44] Loaded ladies relay teams startlist with 20 rows
INFO [2025-03-17 08:15:44] Loaded ladies relay individuals startlist with 80 rows
INFO [2025-03-17 08:15:44] Preparing current ladies skier data
INFO [2025-03-17 08:15:44] Found 9 Elo columns for current skiers
INFO [2025-03-17 08:15:44] Replaced NAs in Distance_Elo with first quartile: 1237.24135379294
INFO [2025-03-17 08:15:44] Replaced NAs in Distance_C_Elo with first quartile: 1242.00162117671
INFO [2025-03-17 08:15:44] Replaced NAs in Distance_F_Elo with first quartile: 1257.26031057313
INFO [2025-03-17 08:15:44] Replaced NAs in Sprint_Elo with first quartile: 1238.78920518219
INFO [2025-03-17 08:15:44] Replaced NAs in Sprint_C_Elo with first quartile: 1257.67866787334
INFO [2025-03-17 08:15:44] Replaced NAs in Sprint_F_Elo with first quartile: 1237.87670663998
INFO [2025-03-17 08:15:44] Replaced NAs in Classic_Elo with first quartile: 1250.26853632078
INFO [2025-03-17 08:15:44] Replaced NAs in Freestyle_Elo with first quartile: 1236.42030772967
INFO [2025-03-17 08:15:44] Replaced NAs in Distance_Pelo with first quartile: 1242.1169240887
INFO [2025-03-17 08:15:44] Replaced NAs in Distance_C_Pelo with first quartile: 1243.5007326682
INFO [2025-03-17 08:15:44] Replaced NAs in Distance_F_Pelo with first quartile: 1259.23240340024
INFO [2025-03-17 08:15:44] Replaced NAs in Sprint_Pelo with first quartile: 1254.15703318668
INFO [2025-03-17 08:15:44] Replaced NAs in Sprint_C_Pelo with first quartile: 1257.58302026178
INFO [2025-03-17 08:15:44] Replaced NAs in Sprint_F_Pelo with first quartile: 1255.58157573541
INFO [2025-03-17 08:15:44] Replaced NAs in Classic_Pelo with first quartile: 1255.39340994292
INFO [2025-03-17 08:15:44] Replaced NAs in Freestyle_Pelo with first quartile: 1253.82185786105
INFO [2025-03-17 08:15:44] Replaced NAs in Classic_Last_5 with first quartile: 3.05
INFO [2025-03-17 08:15:44] Replaced NAs in Freestyle_Last_5 with first quartile: 3.36666666666667
INFO [2025-03-17 08:15:44] Created Pelo_Pct from Elo with max value: 1838.94642582206
INFO [2025-03-17 08:15:44] Created Distance_Pelo_Pct from Distance_Elo with max value: 1864.8112847824
INFO [2025-03-17 08:15:44] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1760.04499166882
INFO [2025-03-17 08:15:44] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1692.68476450479
INFO [2025-03-17 08:15:44] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1754.8999437313
INFO [2025-03-17 08:15:44] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1601.5820663103
INFO [2025-03-17 08:15:44] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1706.06395983697
INFO [2025-03-17 08:15:44] Created Classic_Pelo_Pct from Classic_Elo with max value: 1693.23571740607
INFO [2025-03-17 08:15:44] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1720.26593995458
INFO [2025-03-17 08:15:44] Prepared data for 242 ladies skiers with 32 features
INFO [2025-03-17 08:15:44] Using FIS startlist for ladies's leg predictions
INFO [2025-03-17 08:15:44] Using FIS startlist for ladies
INFO [2025-03-17 08:15:44] Attempting Option 1: Team model coefficients
INFO [2025-03-17 08:15:44] Option 1 failed: No team_podium model found
INFO [2025-03-17 08:15:44] Option 1 failed: No team model
INFO [2025-03-17 08:15:44] Attempting Option 2: Individual model accuracy
INFO [2025-03-17 08:15:44] Leg 1 accuracy: 0.806410256410256
INFO [2025-03-17 08:15:44] Leg 2 accuracy: 0.833333333333333
INFO [2025-03-17 08:15:44] Leg 3 accuracy: 0.803846153846154
INFO [2025-03-17 08:15:44] Leg 4 accuracy: 0.798484848484848
INFO [2025-03-17 08:15:44] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-17 08:15:44] Leg importance weights: Leg 1: 0.25, Leg 2: 0.26, Leg 3: 0.25, Leg 4: 0.25
INFO [2025-03-17 08:15:44] Resetting men's probabilities at or below the mode to zero
INFO [2025-03-17 08:15:44] No values appear more than twice for Win_Prob
INFO [2025-03-17 08:15:44] No values appear more than twice for Podium_Prob
INFO [2025-03-17 08:15:44] No values appear more than twice for Top5_Prob
INFO [2025-03-17 08:15:44] No values appear more than twice for Top10_Prob
INFO [2025-03-17 08:15:44] Resetting ladies' probabilities at or below the mode to zero
INFO [2025-03-17 08:15:44] No values appear more than twice for Win_Prob
INFO [2025-03-17 08:15:44] No values appear more than twice for Podium_Prob
INFO [2025-03-17 08:15:44] No values appear more than twice for Top5_Prob
INFO [2025-03-17 08:15:44] No values appear more than twice for Top10_Prob
INFO [2025-03-17 08:15:44] Normalizing men's team probabilities
INFO [2025-03-17 08:15:44] Normalized Win_Prob from sum of 0.7 to 1
INFO [2025-03-17 08:15:44] Normalized Podium_Prob from sum of 2.33 to 3
INFO [2025-03-17 08:15:44] Normalized Top5_Prob from sum of 4.3 to 5
INFO [2025-03-17 08:15:44] Normalized Top10_Prob from sum of 10.46 to 10
INFO [2025-03-17 08:15:44] Recalculated Expected_Points based on normalized probabilities
INFO [2025-03-17 08:15:44] Normalizing ladies' team probabilities
INFO [2025-03-17 08:15:44] Normalized Win_Prob from sum of 1.15 to 1
INFO [2025-03-17 08:15:44] Normalized Podium_Prob from sum of 3.21 to 3
INFO [2025-03-17 08:15:44] Normalized Top5_Prob from sum of 4.65 to 5
INFO [2025-03-17 08:15:44] Normalized Top10_Prob from sum of 10.09 to 10
INFO [2025-03-17 08:15:44] Recalculated Expected_Points based on normalized probabilities
INFO [2025-03-17 08:15:44] Optimizing fantasy relay team
INFO [2025-03-17 08:15:44] Fantasy team optimization complete. Selected 12 teams.
INFO [2025-03-17 08:15:44] Total price: 99826 of max 1e+05
INFO [2025-03-17 08:15:44] Expected total points: 848.5
INFO [2025-03-17 08:15:44] Men's teams: 6 ( 6 )
INFO [2025-03-17 08:15:44] Ladies' teams: 6 ( 6 )
INFO [2025-03-17 08:15:44] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250318/men_relay_points.xlsx
INFO [2025-03-17 08:15:44] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250318/men_relay_probabilities.xlsx
INFO [2025-03-17 08:15:44] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250318/ladies_relay_points.xlsx
INFO [2025-03-17 08:15:44] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250318/ladies_relay_probabilities.xlsx
INFO [2025-03-17 08:15:44] Saved fantasy team results to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250318/fantasy_relay_team.xlsx
INFO [2025-03-17 08:15:44] Relay predictions completed successfully
