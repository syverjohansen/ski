INFO [2025-03-29 11:41:00] Starting relay predictions process
INFO [2025-03-29 11:41:21] Loading weekend race data
INFO [2025-03-29 11:41:21] Tomorrow's date: 2025-03-29
INFO [2025-03-29 11:41:21] Found 1 men's relay races and 1 ladies' relay races
INFO [2025-03-29 11:41:22] Loading chrono data
INFO [2025-03-29 11:41:27] Loaded men's chrono with 105122 rows and 36 columns
INFO [2025-03-29 11:41:27] Loaded ladies' chrono with 78706 rows and 36 columns
INFO [2025-03-29 11:41:27] Created men's relay df with 9688 rows
INFO [2025-03-29 11:41:27] Created men's individual df with 92143 rows
INFO [2025-03-29 11:41:27] Created ladies' relay df with 8019 rows
INFO [2025-03-29 11:41:27] Created ladies' individual df with 68253 rows
INFO [2025-03-29 11:41:32] Training models for Leg 1
INFO [2025-03-29 11:41:32] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 11:41:32] Training podium model using glm
INFO [2025-03-29 11:41:32] Training win model using glm
INFO [2025-03-29 11:41:32] Training top5 model using glm
INFO [2025-03-29 11:41:32] Training top10 model using glm
INFO [2025-03-29 11:41:32] Top features for Leg 1 podium prediction:
INFO [2025-03-29 11:41:32] Training models for Leg 2
INFO [2025-03-29 11:41:32] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 11:41:32] Training podium model using glm
INFO [2025-03-29 11:41:32] Training win model using glm
INFO [2025-03-29 11:41:32] Training top5 model using glm
INFO [2025-03-29 11:41:33] Training top10 model using glm
INFO [2025-03-29 11:41:33] Top features for Leg 2 podium prediction:
INFO [2025-03-29 11:41:33] Training models for Leg 3
INFO [2025-03-29 11:41:33] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 11:41:33] Training podium model using glm
INFO [2025-03-29 11:41:33] Training win model using glm
INFO [2025-03-29 11:41:33] Training top5 model using glm
INFO [2025-03-29 11:41:33] Training top10 model using glm
INFO [2025-03-29 11:41:33] Top features for Leg 3 podium prediction:
INFO [2025-03-29 11:41:33] Training models for Leg 4
INFO [2025-03-29 11:41:33] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 11:41:33] Training podium model using glm
INFO [2025-03-29 11:41:33] Training win model using glm
INFO [2025-03-29 11:41:33] Training top5 model using glm
INFO [2025-03-29 11:41:33] Training top10 model using glm
INFO [2025-03-29 11:41:33] Top features for Leg 4 podium prediction:
INFO [2025-03-29 11:41:33] Training models for Leg 1
INFO [2025-03-29 11:41:33] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 11:41:33] Training podium model using glm
INFO [2025-03-29 11:41:33] Training win model using glm
INFO [2025-03-29 11:41:33] Training top5 model using glm
INFO [2025-03-29 11:41:34] Training top10 model using glm
INFO [2025-03-29 11:41:34] Top features for Leg 1 podium prediction:
INFO [2025-03-29 11:41:34] Training models for Leg 2
INFO [2025-03-29 11:41:34] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 11:41:34] Training podium model using glm
INFO [2025-03-29 11:41:34] Training win model using glm
INFO [2025-03-29 11:41:34] Training top5 model using glm
INFO [2025-03-29 11:41:34] Training top10 model using glm
INFO [2025-03-29 11:41:34] Top features for Leg 2 podium prediction:
INFO [2025-03-29 11:41:34] Training models for Leg 3
INFO [2025-03-29 11:41:34] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 11:41:34] Training podium model using glm
INFO [2025-03-29 11:41:34] Training win model using glm
INFO [2025-03-29 11:41:34] Training top5 model using glm
INFO [2025-03-29 11:41:34] Training top10 model using glm
INFO [2025-03-29 11:41:34] Top features for Leg 3 podium prediction:
INFO [2025-03-29 11:41:34] Training models for Leg 4
INFO [2025-03-29 11:41:34] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 11:41:34] Training podium model using glm
INFO [2025-03-29 11:41:34] Training win model using glm
INFO [2025-03-29 11:41:34] Training top5 model using glm
INFO [2025-03-29 11:41:34] Training top10 model using glm
INFO [2025-03-29 11:41:35] Top features for Leg 4 podium prediction:
INFO [2025-03-29 11:41:35] Processing men's relay predictions
INFO [2025-03-29 11:41:35] Loaded men relay teams startlist with 24 rows
INFO [2025-03-29 11:41:35] Loaded men relay individuals startlist with 96 rows
INFO [2025-03-29 11:41:35] Preparing current men skier data
INFO [2025-03-29 11:41:35] Found 9 Elo columns for current skiers
INFO [2025-03-29 11:41:35] Replaced NAs in Distance_Elo with first quartile: 1207.23243912712
INFO [2025-03-29 11:41:35] Replaced NAs in Distance_C_Elo with first quartile: 1233.40200699225
INFO [2025-03-29 11:41:35] Replaced NAs in Distance_F_Elo with first quartile: 1236.48554062178
INFO [2025-03-29 11:41:35] Replaced NAs in Sprint_Elo with first quartile: 1223.60107000698
INFO [2025-03-29 11:41:35] Replaced NAs in Sprint_C_Elo with first quartile: 1241.28715500947
INFO [2025-03-29 11:41:35] Replaced NAs in Sprint_F_Elo with first quartile: 1234.45151108772
INFO [2025-03-29 11:41:35] Replaced NAs in Classic_Elo with first quartile: 1241.52867310024
INFO [2025-03-29 11:41:35] Replaced NAs in Freestyle_Elo with first quartile: 1228.48649348109
INFO [2025-03-29 11:41:35] Replaced NAs in Distance_Pelo with first quartile: 1211.63035979047
INFO [2025-03-29 11:41:35] Replaced NAs in Distance_C_Pelo with first quartile: 1234.81091928129
INFO [2025-03-29 11:41:35] Replaced NAs in Distance_F_Pelo with first quartile: 1239.65331180248
INFO [2025-03-29 11:41:35] Replaced NAs in Sprint_Pelo with first quartile: 1240.94751821383
INFO [2025-03-29 11:41:35] Replaced NAs in Sprint_C_Pelo with first quartile: 1241.28715500947
INFO [2025-03-29 11:41:35] Replaced NAs in Sprint_F_Pelo with first quartile: 1252.45166310493
INFO [2025-03-29 11:41:35] Replaced NAs in Classic_Pelo with first quartile: 1243.63746068082
INFO [2025-03-29 11:41:35] Replaced NAs in Freestyle_Pelo with first quartile: 1249.30280713791
INFO [2025-03-29 11:41:35] Replaced NAs in Classic_Last_5 with first quartile: 0
INFO [2025-03-29 11:41:35] Replaced NAs in Freestyle_Last_5 with first quartile: 0
INFO [2025-03-29 11:41:35] Created Pelo_Pct from Elo with max value: 1946.6211651574
INFO [2025-03-29 11:41:35] Created Distance_Pelo_Pct from Distance_Elo with max value: 1869.1251911742
INFO [2025-03-29 11:41:35] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1777.16297253153
INFO [2025-03-29 11:41:35] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1695.2053212904
INFO [2025-03-29 11:41:35] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1886.80363942481
INFO [2025-03-29 11:41:35] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1711.08486899169
INFO [2025-03-29 11:41:35] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1792.65157560707
INFO [2025-03-29 11:41:35] Created Classic_Pelo_Pct from Classic_Elo with max value: 1807.56773496777
INFO [2025-03-29 11:41:35] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1814.60460629541
INFO [2025-03-29 11:41:35] Prepared data for 381 men skiers with 33 features
INFO [2025-03-29 11:41:35] Using FIS startlist for men's leg predictions
INFO [2025-03-29 11:41:35] Using FIS startlist for men
INFO [2025-03-29 11:41:35] Attempting Option 1: Team model coefficients
INFO [2025-03-29 11:41:35] Option 1 failed: No team_podium model found
INFO [2025-03-29 11:41:35] Option 1 failed: No team model
INFO [2025-03-29 11:41:35] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 11:41:35] Leg 1 accuracy: 0.864802259887006
INFO [2025-03-29 11:41:35] Leg 2 accuracy: 0.841285797779077
INFO [2025-03-29 11:41:35] Leg 3 accuracy: 0.870878628482369
INFO [2025-03-29 11:41:35] Leg 4 accuracy: 0.891973504773037
INFO [2025-03-29 11:41:35] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 11:41:35] Leg importance weights: Leg 1: 0.25, Leg 2: 0.24, Leg 3: 0.25, Leg 4: 0.26
INFO [2025-03-29 11:41:35] Processing ladies's relay predictions
INFO [2025-03-29 11:41:35] Loaded ladies relay teams startlist with 20 rows
INFO [2025-03-29 11:41:35] Loaded ladies relay individuals startlist with 80 rows
INFO [2025-03-29 11:41:35] Preparing current ladies skier data
INFO [2025-03-29 11:41:35] Found 9 Elo columns for current skiers
INFO [2025-03-29 11:41:35] Replaced NAs in Distance_Elo with first quartile: 1237.38564383256
INFO [2025-03-29 11:41:35] Replaced NAs in Distance_C_Elo with first quartile: 1243.87329106944
INFO [2025-03-29 11:41:35] Replaced NAs in Distance_F_Elo with first quartile: 1256.69628195708
INFO [2025-03-29 11:41:35] Replaced NAs in Sprint_Elo with first quartile: 1246.32574824425
INFO [2025-03-29 11:41:35] Replaced NAs in Sprint_C_Elo with first quartile: 1257.67866787334
INFO [2025-03-29 11:41:35] Replaced NAs in Sprint_F_Elo with first quartile: 1244.84742904868
INFO [2025-03-29 11:41:35] Replaced NAs in Classic_Elo with first quartile: 1252.44868703669
INFO [2025-03-29 11:41:35] Replaced NAs in Freestyle_Elo with first quartile: 1244.44508230281
INFO [2025-03-29 11:41:35] Replaced NAs in Distance_Pelo with first quartile: 1241.11854419952
INFO [2025-03-29 11:41:35] Replaced NAs in Distance_C_Pelo with first quartile: 1245.57367555166
INFO [2025-03-29 11:41:35] Replaced NAs in Distance_F_Pelo with first quartile: 1259.54282973153
INFO [2025-03-29 11:41:35] Replaced NAs in Sprint_Pelo with first quartile: 1254.58885254623
INFO [2025-03-29 11:41:35] Replaced NAs in Sprint_C_Pelo with first quartile: 1257.58302026178
INFO [2025-03-29 11:41:35] Replaced NAs in Sprint_F_Pelo with first quartile: 1257.67755691493
INFO [2025-03-29 11:41:35] Replaced NAs in Classic_Pelo with first quartile: 1256.79275004544
INFO [2025-03-29 11:41:35] Replaced NAs in Freestyle_Pelo with first quartile: 1256.79999900008
INFO [2025-03-29 11:41:35] Replaced NAs in Classic_Last_5 with first quartile: 3.5
INFO [2025-03-29 11:41:35] Replaced NAs in Freestyle_Last_5 with first quartile: 2.4
INFO [2025-03-29 11:41:35] Created Pelo_Pct from Elo with max value: 1841.00191142018
INFO [2025-03-29 11:41:35] Created Distance_Pelo_Pct from Distance_Elo with max value: 1889.46974050597
INFO [2025-03-29 11:41:35] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1763.33572074398
INFO [2025-03-29 11:41:35] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1693.85026290322
INFO [2025-03-29 11:41:35] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1742.74758850835
INFO [2025-03-29 11:41:35] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1601.5820663103
INFO [2025-03-29 11:41:35] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1681.09824552997
INFO [2025-03-29 11:41:35] Created Classic_Pelo_Pct from Classic_Elo with max value: 1698.69428891549
INFO [2025-03-29 11:41:35] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1707.58410982918
INFO [2025-03-29 11:41:35] Prepared data for 255 ladies skiers with 33 features
INFO [2025-03-29 11:41:35] Using FIS startlist for ladies's leg predictions
INFO [2025-03-29 11:41:35] Using FIS startlist for ladies
INFO [2025-03-29 11:41:35] Attempting Option 1: Team model coefficients
INFO [2025-03-29 11:41:35] Option 1 failed: No team_podium model found
INFO [2025-03-29 11:41:35] Option 1 failed: No team model
INFO [2025-03-29 11:41:35] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 11:41:35] Leg 1 accuracy: 0.835897435897436
INFO [2025-03-29 11:41:35] Leg 2 accuracy: 0.85
INFO [2025-03-29 11:41:35] Leg 3 accuracy: 0.803846153846154
INFO [2025-03-29 11:41:35] Leg 4 accuracy: 0.798484848484848
INFO [2025-03-29 11:41:35] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 11:41:35] Leg importance weights: Leg 1: 0.25, Leg 2: 0.26, Leg 3: 0.24, Leg 4: 0.24
INFO [2025-03-29 11:41:35] Resetting men's probabilities at or below the mode to zero
INFO [2025-03-29 11:41:35] No values appear more than twice for Win_Prob
INFO [2025-03-29 11:41:35] No values appear more than twice for Podium_Prob
INFO [2025-03-29 11:41:35] No values appear more than twice for Top5_Prob
INFO [2025-03-29 11:41:35] No values appear more than twice for Top10_Prob
INFO [2025-03-29 11:41:35] Resetting ladies' probabilities at or below the mode to zero
INFO [2025-03-29 11:41:36] Reset 3 values to 0 for Win_Prob (repeated values or values <  0 )
INFO [2025-03-29 11:41:36] Repeated values: 0
INFO [2025-03-29 11:41:36] No values appear more than twice for Podium_Prob
INFO [2025-03-29 11:41:36] No values appear more than twice for Top5_Prob
INFO [2025-03-29 11:41:36] No values appear more than twice for Top10_Prob
INFO [2025-03-29 11:41:36] Normalizing men's team probabilities
INFO [2025-03-29 11:41:36] Normalized Win_Prob from sum of 0.71 to 1
INFO [2025-03-29 11:41:36] Normalized Podium_Prob from sum of 2.34 to 3
INFO [2025-03-29 11:41:36] Normalized Top5_Prob from sum of 4.2 to 5
INFO [2025-03-29 11:41:36] Normalized Top10_Prob from sum of 10.33 to 10
INFO [2025-03-29 11:41:36] Normalizing ladies' team probabilities
INFO [2025-03-29 11:41:36] Normalized Win_Prob from sum of 1.12 to 1
INFO [2025-03-29 11:41:36] Normalized Podium_Prob from sum of 3.27 to 3
INFO [2025-03-29 11:41:36] Normalized Top5_Prob from sum of 4.51 to 5
INFO [2025-03-29 11:41:36] Normalized Top10_Prob from sum of 9.37 to 10
INFO [2025-03-29 11:41:36] Optimizing fantasy relay team
INFO [2025-03-29 11:41:36] Fantasy team optimization complete. Selected 12 teams.
INFO [2025-03-29 11:41:36] Total price: 99826 of max 1e+05
INFO [2025-03-29 11:41:36] Expected total points: 814.1
INFO [2025-03-29 11:41:36] Men's teams: 6 ( 6 )
INFO [2025-03-29 11:41:36] Ladies' teams: 6 ( 6 )
INFO [2025-03-29 11:41:36] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_points.xlsx
INFO [2025-03-29 11:41:36] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_probabilities.xlsx
INFO [2025-03-29 11:41:36] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_points.xlsx
INFO [2025-03-29 11:41:36] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_probabilities.xlsx
INFO [2025-03-29 11:41:36] Saved fantasy team results to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/fantasy_relay_team.xlsx
INFO [2025-03-29 11:41:36] Relay predictions completed successfully
INFO [2025-03-29 11:41:48] Starting relay predictions process
INFO [2025-03-29 11:41:48] Loading weekend race data
INFO [2025-03-29 11:41:48] Tomorrow's date: 2025-03-29
INFO [2025-03-29 11:41:48] Found 1 men's relay races and 1 ladies' relay races
INFO [2025-03-29 11:41:48] Loading chrono data
INFO [2025-03-29 11:41:54] Loaded men's chrono with 105122 rows and 36 columns
INFO [2025-03-29 11:41:54] Loaded ladies' chrono with 78706 rows and 36 columns
INFO [2025-03-29 11:41:54] Created men's relay df with 9688 rows
INFO [2025-03-29 11:41:54] Created men's individual df with 92143 rows
INFO [2025-03-29 11:41:54] Created ladies' relay df with 8019 rows
INFO [2025-03-29 11:41:54] Created ladies' individual df with 68253 rows
INFO [2025-03-29 11:41:59] Training models for Leg 1
INFO [2025-03-29 11:41:59] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 11:41:59] Training podium model using glm
INFO [2025-03-29 11:42:00] Training win model using glm
INFO [2025-03-29 11:42:00] Training top5 model using glm
INFO [2025-03-29 11:42:00] Training top10 model using glm
INFO [2025-03-29 11:42:00] Top features for Leg 1 podium prediction:
INFO [2025-03-29 11:42:00] Training models for Leg 2
INFO [2025-03-29 11:42:00] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 11:42:00] Training podium model using glm
INFO [2025-03-29 11:42:00] Training win model using glm
INFO [2025-03-29 11:42:00] Training top5 model using glm
INFO [2025-03-29 11:42:00] Training top10 model using glm
INFO [2025-03-29 11:42:00] Top features for Leg 2 podium prediction:
INFO [2025-03-29 11:42:00] Training models for Leg 3
INFO [2025-03-29 11:42:00] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 11:42:00] Training podium model using glm
INFO [2025-03-29 11:42:00] Training win model using glm
INFO [2025-03-29 11:42:00] Training top5 model using glm
INFO [2025-03-29 11:42:00] Training top10 model using glm
INFO [2025-03-29 11:42:00] Top features for Leg 3 podium prediction:
INFO [2025-03-29 11:42:00] Training models for Leg 4
INFO [2025-03-29 11:42:00] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 11:42:00] Training podium model using glm
INFO [2025-03-29 11:42:00] Training win model using glm
INFO [2025-03-29 11:42:01] Training top5 model using glm
INFO [2025-03-29 11:42:01] Training top10 model using glm
INFO [2025-03-29 11:42:01] Top features for Leg 4 podium prediction:
INFO [2025-03-29 11:42:01] Training models for Leg 1
INFO [2025-03-29 11:42:01] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 11:42:01] Training podium model using glm
INFO [2025-03-29 11:42:01] Training win model using glm
INFO [2025-03-29 11:42:01] Training top5 model using glm
INFO [2025-03-29 11:42:01] Training top10 model using glm
INFO [2025-03-29 11:42:01] Top features for Leg 1 podium prediction:
INFO [2025-03-29 11:42:01] Training models for Leg 2
INFO [2025-03-29 11:42:01] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 11:42:01] Training podium model using glm
INFO [2025-03-29 11:42:01] Training win model using glm
INFO [2025-03-29 11:42:01] Training top5 model using glm
INFO [2025-03-29 11:42:01] Training top10 model using glm
INFO [2025-03-29 11:42:01] Top features for Leg 2 podium prediction:
INFO [2025-03-29 11:42:01] Training models for Leg 3
INFO [2025-03-29 11:42:01] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 11:42:01] Training podium model using glm
INFO [2025-03-29 11:42:02] Training win model using glm
INFO [2025-03-29 11:42:02] Training top5 model using glm
INFO [2025-03-29 11:42:02] Training top10 model using glm
INFO [2025-03-29 11:42:02] Top features for Leg 3 podium prediction:
INFO [2025-03-29 11:42:02] Training models for Leg 4
INFO [2025-03-29 11:42:02] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 11:42:02] Training podium model using glm
INFO [2025-03-29 11:42:02] Training win model using glm
INFO [2025-03-29 11:42:02] Training top5 model using glm
INFO [2025-03-29 11:42:02] Training top10 model using glm
INFO [2025-03-29 11:42:02] Top features for Leg 4 podium prediction:
INFO [2025-03-29 11:42:02] Processing men's relay predictions
INFO [2025-03-29 11:42:02] Loaded men relay teams startlist with 24 rows
INFO [2025-03-29 11:42:02] Loaded men relay individuals startlist with 96 rows
INFO [2025-03-29 11:42:02] Preparing current men skier data
INFO [2025-03-29 11:42:02] Found 9 Elo columns for current skiers
INFO [2025-03-29 11:42:03] Replaced NAs in Distance_Elo with first quartile: 1207.23243912712
INFO [2025-03-29 11:42:03] Replaced NAs in Distance_C_Elo with first quartile: 1233.40200699225
INFO [2025-03-29 11:42:03] Replaced NAs in Distance_F_Elo with first quartile: 1236.48554062178
INFO [2025-03-29 11:42:03] Replaced NAs in Sprint_Elo with first quartile: 1223.60107000698
INFO [2025-03-29 11:42:03] Replaced NAs in Sprint_C_Elo with first quartile: 1241.28715500947
INFO [2025-03-29 11:42:03] Replaced NAs in Sprint_F_Elo with first quartile: 1234.45151108772
INFO [2025-03-29 11:42:03] Replaced NAs in Classic_Elo with first quartile: 1241.52867310024
INFO [2025-03-29 11:42:03] Replaced NAs in Freestyle_Elo with first quartile: 1228.48649348109
INFO [2025-03-29 11:42:03] Replaced NAs in Distance_Pelo with first quartile: 1211.63035979047
INFO [2025-03-29 11:42:03] Replaced NAs in Distance_C_Pelo with first quartile: 1234.81091928129
INFO [2025-03-29 11:42:03] Replaced NAs in Distance_F_Pelo with first quartile: 1239.65331180248
INFO [2025-03-29 11:42:03] Replaced NAs in Sprint_Pelo with first quartile: 1240.94751821383
INFO [2025-03-29 11:42:03] Replaced NAs in Sprint_C_Pelo with first quartile: 1241.28715500947
INFO [2025-03-29 11:42:03] Replaced NAs in Sprint_F_Pelo with first quartile: 1252.45166310493
INFO [2025-03-29 11:42:03] Replaced NAs in Classic_Pelo with first quartile: 1243.63746068082
INFO [2025-03-29 11:42:03] Replaced NAs in Freestyle_Pelo with first quartile: 1249.30280713791
INFO [2025-03-29 11:42:03] Replaced NAs in Classic_Last_5 with first quartile: 0
INFO [2025-03-29 11:42:03] Replaced NAs in Freestyle_Last_5 with first quartile: 0
INFO [2025-03-29 11:42:03] Created Pelo_Pct from Elo with max value: 1946.6211651574
INFO [2025-03-29 11:42:03] Created Distance_Pelo_Pct from Distance_Elo with max value: 1869.1251911742
INFO [2025-03-29 11:42:03] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1777.16297253153
INFO [2025-03-29 11:42:03] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1695.2053212904
INFO [2025-03-29 11:42:03] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1886.80363942481
INFO [2025-03-29 11:42:03] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1711.08486899169
INFO [2025-03-29 11:42:03] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1792.65157560707
INFO [2025-03-29 11:42:03] Created Classic_Pelo_Pct from Classic_Elo with max value: 1807.56773496777
INFO [2025-03-29 11:42:03] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1814.60460629541
INFO [2025-03-29 11:42:03] Prepared data for 381 men skiers with 33 features
INFO [2025-03-29 11:42:03] Using FIS startlist for men's leg predictions
INFO [2025-03-29 11:42:03] Using FIS startlist for men
INFO [2025-03-29 11:42:03] Attempting Option 1: Team model coefficients
INFO [2025-03-29 11:42:03] Option 1 failed: No team_podium model found
INFO [2025-03-29 11:42:03] Option 1 failed: No team model
INFO [2025-03-29 11:42:03] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 11:42:03] Leg 1 accuracy: 0.858233002142996
INFO [2025-03-29 11:42:03] Leg 2 accuracy: 0.854673680109098
INFO [2025-03-29 11:42:03] Leg 3 accuracy: 0.870931229300604
INFO [2025-03-29 11:42:03] Leg 4 accuracy: 0.888010909799338
INFO [2025-03-29 11:42:03] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 11:42:03] Leg importance weights: Leg 1: 0.25, Leg 2: 0.25, Leg 3: 0.25, Leg 4: 0.26
INFO [2025-03-29 11:42:03] Processing ladies's relay predictions
INFO [2025-03-29 11:42:03] Loaded ladies relay teams startlist with 20 rows
INFO [2025-03-29 11:42:03] Loaded ladies relay individuals startlist with 80 rows
INFO [2025-03-29 11:42:03] Preparing current ladies skier data
INFO [2025-03-29 11:42:03] Found 9 Elo columns for current skiers
INFO [2025-03-29 11:42:03] Replaced NAs in Distance_Elo with first quartile: 1237.38564383256
INFO [2025-03-29 11:42:03] Replaced NAs in Distance_C_Elo with first quartile: 1243.87329106944
INFO [2025-03-29 11:42:03] Replaced NAs in Distance_F_Elo with first quartile: 1256.69628195708
INFO [2025-03-29 11:42:03] Replaced NAs in Sprint_Elo with first quartile: 1246.32574824425
INFO [2025-03-29 11:42:03] Replaced NAs in Sprint_C_Elo with first quartile: 1257.67866787334
INFO [2025-03-29 11:42:03] Replaced NAs in Sprint_F_Elo with first quartile: 1244.84742904868
INFO [2025-03-29 11:42:03] Replaced NAs in Classic_Elo with first quartile: 1252.44868703669
INFO [2025-03-29 11:42:03] Replaced NAs in Freestyle_Elo with first quartile: 1244.44508230281
INFO [2025-03-29 11:42:03] Replaced NAs in Distance_Pelo with first quartile: 1241.11854419952
INFO [2025-03-29 11:42:03] Replaced NAs in Distance_C_Pelo with first quartile: 1245.57367555166
INFO [2025-03-29 11:42:03] Replaced NAs in Distance_F_Pelo with first quartile: 1259.54282973153
INFO [2025-03-29 11:42:03] Replaced NAs in Sprint_Pelo with first quartile: 1254.58885254623
INFO [2025-03-29 11:42:03] Replaced NAs in Sprint_C_Pelo with first quartile: 1257.58302026178
INFO [2025-03-29 11:42:03] Replaced NAs in Sprint_F_Pelo with first quartile: 1257.67755691493
INFO [2025-03-29 11:42:03] Replaced NAs in Classic_Pelo with first quartile: 1256.79275004544
INFO [2025-03-29 11:42:03] Replaced NAs in Freestyle_Pelo with first quartile: 1256.79999900008
INFO [2025-03-29 11:42:03] Replaced NAs in Classic_Last_5 with first quartile: 3.5
INFO [2025-03-29 11:42:03] Replaced NAs in Freestyle_Last_5 with first quartile: 2.4
INFO [2025-03-29 11:42:03] Created Pelo_Pct from Elo with max value: 1841.00191142018
INFO [2025-03-29 11:42:03] Created Distance_Pelo_Pct from Distance_Elo with max value: 1889.46974050597
INFO [2025-03-29 11:42:03] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1763.33572074398
INFO [2025-03-29 11:42:03] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1693.85026290322
INFO [2025-03-29 11:42:03] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1742.74758850835
INFO [2025-03-29 11:42:03] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1601.5820663103
INFO [2025-03-29 11:42:03] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1681.09824552997
INFO [2025-03-29 11:42:03] Created Classic_Pelo_Pct from Classic_Elo with max value: 1698.69428891549
INFO [2025-03-29 11:42:03] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1707.58410982918
INFO [2025-03-29 11:42:03] Prepared data for 255 ladies skiers with 33 features
INFO [2025-03-29 11:42:03] Using FIS startlist for ladies's leg predictions
INFO [2025-03-29 11:42:03] Using FIS startlist for ladies
INFO [2025-03-29 11:42:03] Attempting Option 1: Team model coefficients
INFO [2025-03-29 11:42:03] Option 1 failed: No team_podium model found
INFO [2025-03-29 11:42:03] Option 1 failed: No team model
INFO [2025-03-29 11:42:03] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 11:42:03] Leg 1 accuracy: 0.752564102564103
INFO [2025-03-29 11:42:03] Leg 2 accuracy: 0.833333333333333
INFO [2025-03-29 11:42:03] Leg 3 accuracy: 0.835897435897436
INFO [2025-03-29 11:42:03] Leg 4 accuracy: 0.78030303030303
INFO [2025-03-29 11:42:03] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 11:42:03] Leg importance weights: Leg 1: 0.24, Leg 2: 0.26, Leg 3: 0.26, Leg 4: 0.24
INFO [2025-03-29 11:42:03] Resetting men's probabilities at or below the mode to zero
INFO [2025-03-29 11:42:03] No values appear more than twice for Win_Prob
INFO [2025-03-29 11:42:03] No values appear more than twice for Podium_Prob
INFO [2025-03-29 11:42:03] No values appear more than twice for Top5_Prob
INFO [2025-03-29 11:42:03] No values appear more than twice for Top10_Prob
INFO [2025-03-29 11:42:03] Resetting ladies' probabilities at or below the mode to zero
INFO [2025-03-29 11:42:03] No values appear more than twice for Win_Prob
INFO [2025-03-29 11:42:03] No values appear more than twice for Podium_Prob
INFO [2025-03-29 11:42:03] No values appear more than twice for Top5_Prob
INFO [2025-03-29 11:42:03] No values appear more than twice for Top10_Prob
INFO [2025-03-29 11:42:03] Normalizing men's team probabilities
INFO [2025-03-29 11:42:03] Normalized Win_Prob from sum of 0.72 to 1
INFO [2025-03-29 11:42:03] Normalized Podium_Prob from sum of 2.34 to 3
INFO [2025-03-29 11:42:03] Normalized Top5_Prob from sum of 4.2 to 5
INFO [2025-03-29 11:42:03] Normalized Top10_Prob from sum of 10.33 to 10
INFO [2025-03-29 11:42:03] Normalizing ladies' team probabilities
INFO [2025-03-29 11:42:03] Normalized Win_Prob from sum of 1.11 to 1
INFO [2025-03-29 11:42:03] Normalized Podium_Prob from sum of 3.25 to 3
INFO [2025-03-29 11:42:03] Normalized Top5_Prob from sum of 4.49 to 5
INFO [2025-03-29 11:42:03] Normalized Top10_Prob from sum of 9.35 to 10
INFO [2025-03-29 11:42:03] Optimizing fantasy relay team
INFO [2025-03-29 11:42:04] Fantasy team optimization complete. Selected 12 teams.
INFO [2025-03-29 11:42:04] Total price: 99826 of max 1e+05
INFO [2025-03-29 11:42:04] Expected total points: 815.6
INFO [2025-03-29 11:42:04] Men's teams: 6 ( 6 )
INFO [2025-03-29 11:42:04] Ladies' teams: 6 ( 6 )
INFO [2025-03-29 11:42:04] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_points.xlsx
INFO [2025-03-29 11:42:04] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_probabilities.xlsx
INFO [2025-03-29 11:42:04] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_points.xlsx
INFO [2025-03-29 11:42:04] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_probabilities.xlsx
INFO [2025-03-29 11:42:04] Saved fantasy team results to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/fantasy_relay_team.xlsx
INFO [2025-03-29 11:42:04] Relay predictions completed successfully
INFO [2025-03-29 12:11:54] Starting relay predictions process
INFO [2025-03-29 12:11:55] Loading weekend race data
INFO [2025-03-29 12:11:55] Tomorrow's date: 2025-03-29
INFO [2025-03-29 12:11:55] Found 1 men's relay races and 1 ladies' relay races
INFO [2025-03-29 12:11:55] Loading chrono data
INFO [2025-03-29 12:12:00] Loaded men's chrono with 105122 rows and 36 columns
INFO [2025-03-29 12:12:00] Loaded ladies' chrono with 78706 rows and 36 columns
INFO [2025-03-29 12:12:00] Created men's relay df with 9688 rows
INFO [2025-03-29 12:12:00] Created men's individual df with 92143 rows
INFO [2025-03-29 12:12:00] Created ladies' relay df with 8019 rows
INFO [2025-03-29 12:12:00] Created ladies' individual df with 68253 rows
INFO [2025-03-29 12:12:05] Training models for Leg 1
INFO [2025-03-29 12:12:05] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:12:05] Training podium model using glm
INFO [2025-03-29 12:12:05] Training win model using glm
INFO [2025-03-29 12:12:05] Training top5 model using glm
INFO [2025-03-29 12:12:05] Training top10 model using glm
INFO [2025-03-29 12:12:05] Top features for Leg 1 podium prediction:
INFO [2025-03-29 12:12:05] Training models for Leg 2
INFO [2025-03-29 12:12:05] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:12:05] Training podium model using glm
INFO [2025-03-29 12:12:05] Training win model using glm
INFO [2025-03-29 12:12:05] Training top5 model using glm
INFO [2025-03-29 12:12:05] Training top10 model using glm
INFO [2025-03-29 12:12:05] Top features for Leg 2 podium prediction:
INFO [2025-03-29 12:12:05] Training models for Leg 3
INFO [2025-03-29 12:12:05] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:12:05] Training podium model using glm
INFO [2025-03-29 12:12:05] Training win model using glm
INFO [2025-03-29 12:12:06] Training top5 model using glm
INFO [2025-03-29 12:12:06] Training top10 model using glm
INFO [2025-03-29 12:12:06] Top features for Leg 3 podium prediction:
INFO [2025-03-29 12:12:06] Training models for Leg 4
INFO [2025-03-29 12:12:06] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:12:06] Training podium model using glm
INFO [2025-03-29 12:12:06] Training win model using glm
INFO [2025-03-29 12:12:06] Training top5 model using glm
INFO [2025-03-29 12:12:06] Training top10 model using glm
INFO [2025-03-29 12:12:06] Top features for Leg 4 podium prediction:
INFO [2025-03-29 12:12:06] Training models for Leg 1
INFO [2025-03-29 12:12:06] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:12:06] Training podium model using glm
INFO [2025-03-29 12:12:06] Training win model using glm
INFO [2025-03-29 12:12:06] Training top5 model using glm
INFO [2025-03-29 12:12:06] Training top10 model using glm
INFO [2025-03-29 12:12:06] Top features for Leg 1 podium prediction:
INFO [2025-03-29 12:12:06] Training models for Leg 2
INFO [2025-03-29 12:12:06] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:12:06] Training podium model using glm
INFO [2025-03-29 12:12:07] Training win model using glm
INFO [2025-03-29 12:12:07] Training top5 model using glm
INFO [2025-03-29 12:12:07] Training top10 model using glm
INFO [2025-03-29 12:12:07] Top features for Leg 2 podium prediction:
INFO [2025-03-29 12:12:07] Training models for Leg 3
INFO [2025-03-29 12:12:07] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:12:07] Training podium model using glm
INFO [2025-03-29 12:12:07] Training win model using glm
INFO [2025-03-29 12:12:07] Training top5 model using glm
INFO [2025-03-29 12:12:07] Training top10 model using glm
INFO [2025-03-29 12:12:07] Top features for Leg 3 podium prediction:
INFO [2025-03-29 12:12:07] Training models for Leg 4
INFO [2025-03-29 12:12:07] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:12:07] Training podium model using glm
INFO [2025-03-29 12:12:07] Training win model using glm
INFO [2025-03-29 12:12:07] Training top5 model using glm
INFO [2025-03-29 12:12:07] Training top10 model using glm
INFO [2025-03-29 12:12:07] Top features for Leg 4 podium prediction:
INFO [2025-03-29 12:12:07] Processing men's relay predictions
INFO [2025-03-29 12:12:07] Loaded men relay teams startlist with 24 rows
INFO [2025-03-29 12:12:07] Loaded men relay individuals startlist with 96 rows
INFO [2025-03-29 12:12:07] Preparing current men skier data
INFO [2025-03-29 12:12:07] Found 9 Elo columns for current skiers
INFO [2025-03-29 12:12:08] Replaced NAs in Distance_Elo with first quartile: 1207.23243912712
INFO [2025-03-29 12:12:08] Replaced NAs in Distance_C_Elo with first quartile: 1233.40200699225
INFO [2025-03-29 12:12:08] Replaced NAs in Distance_F_Elo with first quartile: 1236.48554062178
INFO [2025-03-29 12:12:08] Replaced NAs in Sprint_Elo with first quartile: 1223.60107000698
INFO [2025-03-29 12:12:08] Replaced NAs in Sprint_C_Elo with first quartile: 1241.28715500947
INFO [2025-03-29 12:12:08] Replaced NAs in Sprint_F_Elo with first quartile: 1234.45151108772
INFO [2025-03-29 12:12:08] Replaced NAs in Classic_Elo with first quartile: 1241.52867310024
INFO [2025-03-29 12:12:08] Replaced NAs in Freestyle_Elo with first quartile: 1228.48649348109
INFO [2025-03-29 12:12:08] Replaced NAs in Distance_Pelo with first quartile: 1211.63035979047
INFO [2025-03-29 12:12:08] Replaced NAs in Distance_C_Pelo with first quartile: 1234.81091928129
INFO [2025-03-29 12:12:08] Replaced NAs in Distance_F_Pelo with first quartile: 1239.65331180248
INFO [2025-03-29 12:12:08] Replaced NAs in Sprint_Pelo with first quartile: 1240.94751821383
INFO [2025-03-29 12:12:08] Replaced NAs in Sprint_C_Pelo with first quartile: 1241.28715500947
INFO [2025-03-29 12:12:08] Replaced NAs in Sprint_F_Pelo with first quartile: 1252.45166310493
INFO [2025-03-29 12:12:08] Replaced NAs in Classic_Pelo with first quartile: 1243.63746068082
INFO [2025-03-29 12:12:08] Replaced NAs in Freestyle_Pelo with first quartile: 1249.30280713791
INFO [2025-03-29 12:12:08] Replaced NAs in Classic_Last_5 with first quartile: 0
INFO [2025-03-29 12:12:08] Replaced NAs in Freestyle_Last_5 with first quartile: 0
INFO [2025-03-29 12:12:08] Created Pelo_Pct from Elo with max value: 1946.6211651574
INFO [2025-03-29 12:12:08] Created Distance_Pelo_Pct from Distance_Elo with max value: 1869.1251911742
INFO [2025-03-29 12:12:08] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1777.16297253153
INFO [2025-03-29 12:12:08] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1695.2053212904
INFO [2025-03-29 12:12:08] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1886.80363942481
INFO [2025-03-29 12:12:08] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1711.08486899169
INFO [2025-03-29 12:12:08] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1792.65157560707
INFO [2025-03-29 12:12:08] Created Classic_Pelo_Pct from Classic_Elo with max value: 1807.56773496777
INFO [2025-03-29 12:12:08] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1814.60460629541
INFO [2025-03-29 12:12:08] Prepared data for 381 men skiers with 33 features
INFO [2025-03-29 12:12:08] Using FIS startlist for men's leg predictions
INFO [2025-03-29 12:12:08] Using FIS startlist for men
INFO [2025-03-29 12:12:08] Attempting Option 1: Team model coefficients
INFO [2025-03-29 12:12:08] Option 1 failed: No team_podium model found
INFO [2025-03-29 12:12:08] Option 1 failed: No team model
INFO [2025-03-29 12:12:08] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 12:12:08] Leg 1 accuracy: 0.85795051626729
INFO [2025-03-29 12:12:08] Leg 2 accuracy: 0.837892070913696
INFO [2025-03-29 12:12:08] Leg 3 accuracy: 0.867931034482759
INFO [2025-03-29 12:12:08] Leg 4 accuracy: 0.888178453146308
INFO [2025-03-29 12:12:08] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 12:12:08] Leg importance weights: Leg 1: 0.25, Leg 2: 0.24, Leg 3: 0.25, Leg 4: 0.26
INFO [2025-03-29 12:12:08] Processing ladies's relay predictions
INFO [2025-03-29 12:12:08] Loaded ladies relay teams startlist with 20 rows
INFO [2025-03-29 12:12:08] Loaded ladies relay individuals startlist with 80 rows
INFO [2025-03-29 12:12:08] Preparing current ladies skier data
INFO [2025-03-29 12:12:08] Found 9 Elo columns for current skiers
INFO [2025-03-29 12:12:08] Replaced NAs in Distance_Elo with first quartile: 1237.38564383256
INFO [2025-03-29 12:12:08] Replaced NAs in Distance_C_Elo with first quartile: 1243.87329106944
INFO [2025-03-29 12:12:08] Replaced NAs in Distance_F_Elo with first quartile: 1256.69628195708
INFO [2025-03-29 12:12:08] Replaced NAs in Sprint_Elo with first quartile: 1246.32574824425
INFO [2025-03-29 12:12:08] Replaced NAs in Sprint_C_Elo with first quartile: 1257.67866787334
INFO [2025-03-29 12:12:08] Replaced NAs in Sprint_F_Elo with first quartile: 1244.84742904868
INFO [2025-03-29 12:12:08] Replaced NAs in Classic_Elo with first quartile: 1252.44868703669
INFO [2025-03-29 12:12:08] Replaced NAs in Freestyle_Elo with first quartile: 1244.44508230281
INFO [2025-03-29 12:12:08] Replaced NAs in Distance_Pelo with first quartile: 1241.11854419952
INFO [2025-03-29 12:12:08] Replaced NAs in Distance_C_Pelo with first quartile: 1245.57367555166
INFO [2025-03-29 12:12:08] Replaced NAs in Distance_F_Pelo with first quartile: 1259.54282973153
INFO [2025-03-29 12:12:08] Replaced NAs in Sprint_Pelo with first quartile: 1254.58885254623
INFO [2025-03-29 12:12:08] Replaced NAs in Sprint_C_Pelo with first quartile: 1257.58302026178
INFO [2025-03-29 12:12:08] Replaced NAs in Sprint_F_Pelo with first quartile: 1257.67755691493
INFO [2025-03-29 12:12:08] Replaced NAs in Classic_Pelo with first quartile: 1256.79275004544
INFO [2025-03-29 12:12:08] Replaced NAs in Freestyle_Pelo with first quartile: 1256.79999900008
INFO [2025-03-29 12:12:08] Replaced NAs in Classic_Last_5 with first quartile: 3.5
INFO [2025-03-29 12:12:08] Replaced NAs in Freestyle_Last_5 with first quartile: 2.4
INFO [2025-03-29 12:12:08] Created Pelo_Pct from Elo with max value: 1841.00191142018
INFO [2025-03-29 12:12:08] Created Distance_Pelo_Pct from Distance_Elo with max value: 1889.46974050597
INFO [2025-03-29 12:12:08] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1763.33572074398
INFO [2025-03-29 12:12:08] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1693.85026290322
INFO [2025-03-29 12:12:08] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1742.74758850835
INFO [2025-03-29 12:12:08] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1601.5820663103
INFO [2025-03-29 12:12:08] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1681.09824552997
INFO [2025-03-29 12:12:08] Created Classic_Pelo_Pct from Classic_Elo with max value: 1698.69428891549
INFO [2025-03-29 12:12:08] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1707.58410982918
INFO [2025-03-29 12:12:08] Prepared data for 255 ladies skiers with 33 features
INFO [2025-03-29 12:12:08] Using FIS startlist for ladies's leg predictions
INFO [2025-03-29 12:12:08] Using FIS startlist for ladies
INFO [2025-03-29 12:12:08] Attempting Option 1: Team model coefficients
INFO [2025-03-29 12:12:08] Option 1 failed: No team_podium model found
INFO [2025-03-29 12:12:08] Option 1 failed: No team model
INFO [2025-03-29 12:12:08] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 12:12:08] Leg 1 accuracy: 0.785897435897436
INFO [2025-03-29 12:12:08] Leg 2 accuracy: 0.833333333333333
INFO [2025-03-29 12:12:08] Leg 3 accuracy: 0.785897435897436
INFO [2025-03-29 12:12:08] Leg 4 accuracy: 0.778787878787879
INFO [2025-03-29 12:12:08] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 12:12:08] Leg importance weights: Leg 1: 0.25, Leg 2: 0.26, Leg 3: 0.25, Leg 4: 0.24
INFO [2025-03-29 12:12:08] Resetting men's probabilities at or below the mode to zero
INFO [2025-03-29 12:12:08] No values appear more than twice for Win_Prob
INFO [2025-03-29 12:12:08] No values appear more than twice for Podium_Prob
INFO [2025-03-29 12:12:08] No values appear more than twice for Top5_Prob
INFO [2025-03-29 12:12:08] No values appear more than twice for Top10_Prob
INFO [2025-03-29 12:12:08] Resetting ladies' probabilities at or below the mode to zero
INFO [2025-03-29 12:12:08] No values appear more than twice for Win_Prob
INFO [2025-03-29 12:12:08] No values appear more than twice for Podium_Prob
INFO [2025-03-29 12:12:08] No values appear more than twice for Top5_Prob
INFO [2025-03-29 12:12:08] No values appear more than twice for Top10_Prob
INFO [2025-03-29 12:12:08] Normalizing men's team probabilities
INFO [2025-03-29 12:12:08] Normalized Win_Prob from sum of 0.71 to 1
INFO [2025-03-29 12:12:08] Normalized Podium_Prob from sum of 2.34 to 3
INFO [2025-03-29 12:12:08] Normalized Top5_Prob from sum of 4.2 to 5
INFO [2025-03-29 12:12:08] Normalized Top10_Prob from sum of 10.33 to 10
INFO [2025-03-29 12:12:08] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 12:12:08] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 12:12:08] Normalizing ladies' team probabilities
INFO [2025-03-29 12:12:08] Normalized Win_Prob from sum of 1.12 to 1
INFO [2025-03-29 12:12:08] Normalized Podium_Prob from sum of 3.26 to 3
INFO [2025-03-29 12:12:08] Normalized Top5_Prob from sum of 4.51 to 5
INFO [2025-03-29 12:12:08] Normalized Top10_Prob from sum of 9.36 to 10
INFO [2025-03-29 12:12:08] Capped 2 values at 1 for Top5_Prob
INFO [2025-03-29 12:12:08] Capped 5 values at 1 for Top10_Prob
INFO [2025-03-29 12:12:08] Final capping of probabilities to maximum of 1
INFO [2025-03-29 12:12:08] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 12:12:08] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 12:12:08] Capped 2 values at 1 for Top5_Prob
INFO [2025-03-29 12:12:08] Capped 5 values at 1 for Top10_Prob
INFO [2025-03-29 12:12:08] Optimizing fantasy relay team
INFO [2025-03-29 12:12:08] Fantasy team optimization complete. Selected 12 teams.
INFO [2025-03-29 12:12:08] Total price: 99826 of max 1e+05
INFO [2025-03-29 12:12:08] Expected total points: 814.5
INFO [2025-03-29 12:12:08] Men's teams: 6 ( 6 )
INFO [2025-03-29 12:12:08] Ladies' teams: 6 ( 6 )
INFO [2025-03-29 12:12:08] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_points.xlsx
INFO [2025-03-29 12:12:08] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_probabilities.xlsx
INFO [2025-03-29 12:12:08] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_points.xlsx
INFO [2025-03-29 12:12:08] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_probabilities.xlsx
INFO [2025-03-29 12:12:09] Saved fantasy team results to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/fantasy_relay_team.xlsx
INFO [2025-03-29 12:12:09] Relay predictions completed successfully
INFO [2025-03-29 12:16:17] Starting relay predictions process
INFO [2025-03-29 12:16:17] Loading weekend race data
INFO [2025-03-29 12:16:17] Tomorrow's date: 2025-03-29
INFO [2025-03-29 12:16:17] Found 1 men's relay races and 1 ladies' relay races
INFO [2025-03-29 12:16:17] Loading chrono data
INFO [2025-03-29 12:16:22] Loaded men's chrono with 105122 rows and 36 columns
INFO [2025-03-29 12:16:22] Loaded ladies' chrono with 78706 rows and 36 columns
INFO [2025-03-29 12:16:23] Created men's relay df with 9688 rows
INFO [2025-03-29 12:16:23] Created men's individual df with 92143 rows
INFO [2025-03-29 12:16:23] Created ladies' relay df with 8019 rows
INFO [2025-03-29 12:16:23] Created ladies' individual df with 68253 rows
INFO [2025-03-29 12:16:27] Training models for Leg 1
INFO [2025-03-29 12:16:27] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:16:27] Training podium model using glm
INFO [2025-03-29 12:16:27] Training win model using glm
INFO [2025-03-29 12:16:27] Training top5 model using glm
INFO [2025-03-29 12:16:27] Training top10 model using glm
INFO [2025-03-29 12:16:27] Top features for Leg 1 podium prediction:
INFO [2025-03-29 12:16:27] Training models for Leg 2
INFO [2025-03-29 12:16:27] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:16:27] Training podium model using glm
INFO [2025-03-29 12:16:27] Training win model using glm
INFO [2025-03-29 12:16:28] Training top5 model using glm
INFO [2025-03-29 12:16:28] Training top10 model using glm
INFO [2025-03-29 12:16:28] Top features for Leg 2 podium prediction:
INFO [2025-03-29 12:16:28] Training models for Leg 3
INFO [2025-03-29 12:16:28] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:16:28] Training podium model using glm
INFO [2025-03-29 12:16:28] Training win model using glm
INFO [2025-03-29 12:16:28] Training top5 model using glm
INFO [2025-03-29 12:16:28] Training top10 model using glm
INFO [2025-03-29 12:16:28] Top features for Leg 3 podium prediction:
INFO [2025-03-29 12:16:28] Training models for Leg 4
INFO [2025-03-29 12:16:28] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:16:28] Training podium model using glm
INFO [2025-03-29 12:16:28] Training win model using glm
INFO [2025-03-29 12:16:28] Training top5 model using glm
INFO [2025-03-29 12:16:28] Training top10 model using glm
INFO [2025-03-29 12:16:28] Top features for Leg 4 podium prediction:
INFO [2025-03-29 12:16:28] Training models for Leg 1
INFO [2025-03-29 12:16:28] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:16:28] Training podium model using glm
INFO [2025-03-29 12:16:28] Training win model using glm
INFO [2025-03-29 12:16:29] Training top5 model using glm
INFO [2025-03-29 12:16:29] Training top10 model using glm
INFO [2025-03-29 12:16:29] Top features for Leg 1 podium prediction:
INFO [2025-03-29 12:16:29] Training models for Leg 2
INFO [2025-03-29 12:16:29] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:16:29] Training podium model using glm
INFO [2025-03-29 12:16:29] Training win model using glm
INFO [2025-03-29 12:16:29] Training top5 model using glm
INFO [2025-03-29 12:16:29] Training top10 model using glm
INFO [2025-03-29 12:16:29] Top features for Leg 2 podium prediction:
INFO [2025-03-29 12:16:29] Training models for Leg 3
INFO [2025-03-29 12:16:29] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:16:29] Training podium model using glm
INFO [2025-03-29 12:16:29] Training win model using glm
INFO [2025-03-29 12:16:29] Training top5 model using glm
INFO [2025-03-29 12:16:29] Training top10 model using glm
INFO [2025-03-29 12:16:29] Top features for Leg 3 podium prediction:
INFO [2025-03-29 12:16:29] Training models for Leg 4
INFO [2025-03-29 12:16:29] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:16:29] Training podium model using glm
INFO [2025-03-29 12:16:29] Training win model using glm
INFO [2025-03-29 12:16:29] Training top5 model using glm
INFO [2025-03-29 12:16:30] Training top10 model using glm
INFO [2025-03-29 12:16:30] Top features for Leg 4 podium prediction:
INFO [2025-03-29 12:16:30] Processing men's relay predictions
INFO [2025-03-29 12:16:30] Loaded men relay teams startlist with 24 rows
INFO [2025-03-29 12:16:30] Loaded men relay individuals startlist with 96 rows
INFO [2025-03-29 12:16:30] Preparing current men skier data
INFO [2025-03-29 12:16:30] Found 9 Elo columns for current skiers
INFO [2025-03-29 12:16:30] Replaced NAs in Distance_Elo with first quartile: 1207.23243912712
INFO [2025-03-29 12:16:30] Replaced NAs in Distance_C_Elo with first quartile: 1233.40200699225
INFO [2025-03-29 12:16:30] Replaced NAs in Distance_F_Elo with first quartile: 1236.48554062178
INFO [2025-03-29 12:16:30] Replaced NAs in Sprint_Elo with first quartile: 1223.60107000698
INFO [2025-03-29 12:16:30] Replaced NAs in Sprint_C_Elo with first quartile: 1241.28715500947
INFO [2025-03-29 12:16:30] Replaced NAs in Sprint_F_Elo with first quartile: 1234.45151108772
INFO [2025-03-29 12:16:30] Replaced NAs in Classic_Elo with first quartile: 1241.52867310024
INFO [2025-03-29 12:16:30] Replaced NAs in Freestyle_Elo with first quartile: 1228.48649348109
INFO [2025-03-29 12:16:30] Replaced NAs in Distance_Pelo with first quartile: 1211.63035979047
INFO [2025-03-29 12:16:30] Replaced NAs in Distance_C_Pelo with first quartile: 1234.81091928129
INFO [2025-03-29 12:16:30] Replaced NAs in Distance_F_Pelo with first quartile: 1239.65331180248
INFO [2025-03-29 12:16:30] Replaced NAs in Sprint_Pelo with first quartile: 1240.94751821383
INFO [2025-03-29 12:16:30] Replaced NAs in Sprint_C_Pelo with first quartile: 1241.28715500947
INFO [2025-03-29 12:16:30] Replaced NAs in Sprint_F_Pelo with first quartile: 1252.45166310493
INFO [2025-03-29 12:16:30] Replaced NAs in Classic_Pelo with first quartile: 1243.63746068082
INFO [2025-03-29 12:16:30] Replaced NAs in Freestyle_Pelo with first quartile: 1249.30280713791
INFO [2025-03-29 12:16:30] Replaced NAs in Classic_Last_5 with first quartile: 0
INFO [2025-03-29 12:16:30] Replaced NAs in Freestyle_Last_5 with first quartile: 0
INFO [2025-03-29 12:16:30] Created Pelo_Pct from Elo with max value: 1946.6211651574
INFO [2025-03-29 12:16:30] Created Distance_Pelo_Pct from Distance_Elo with max value: 1869.1251911742
INFO [2025-03-29 12:16:30] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1777.16297253153
INFO [2025-03-29 12:16:30] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1695.2053212904
INFO [2025-03-29 12:16:30] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1886.80363942481
INFO [2025-03-29 12:16:30] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1711.08486899169
INFO [2025-03-29 12:16:30] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1792.65157560707
INFO [2025-03-29 12:16:30] Created Classic_Pelo_Pct from Classic_Elo with max value: 1807.56773496777
INFO [2025-03-29 12:16:30] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1814.60460629541
INFO [2025-03-29 12:16:30] Prepared data for 381 men skiers with 33 features
INFO [2025-03-29 12:16:30] Using FIS startlist for men's leg predictions
INFO [2025-03-29 12:16:30] Using FIS startlist for men
INFO [2025-03-29 12:16:30] Attempting Option 1: Team model coefficients
INFO [2025-03-29 12:16:30] Option 1 failed: No team_podium model found
INFO [2025-03-29 12:16:30] Option 1 failed: No team model
INFO [2025-03-29 12:16:30] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 12:16:30] Leg 1 accuracy: 0.868418079096045
INFO [2025-03-29 12:16:30] Leg 2 accuracy: 0.841223456068576
INFO [2025-03-29 12:16:30] Leg 3 accuracy: 0.867366062731346
INFO [2025-03-29 12:16:30] Leg 4 accuracy: 0.888281706604325
INFO [2025-03-29 12:16:30] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 12:16:30] Leg importance weights: Leg 1: 0.25, Leg 2: 0.24, Leg 3: 0.25, Leg 4: 0.26
INFO [2025-03-29 12:16:30] Processing ladies's relay predictions
INFO [2025-03-29 12:16:30] Loaded ladies relay teams startlist with 20 rows
INFO [2025-03-29 12:16:30] Loaded ladies relay individuals startlist with 80 rows
INFO [2025-03-29 12:16:30] Preparing current ladies skier data
INFO [2025-03-29 12:16:30] Found 9 Elo columns for current skiers
INFO [2025-03-29 12:16:30] Replaced NAs in Distance_Elo with first quartile: 1237.38564383256
INFO [2025-03-29 12:16:30] Replaced NAs in Distance_C_Elo with first quartile: 1243.87329106944
INFO [2025-03-29 12:16:30] Replaced NAs in Distance_F_Elo with first quartile: 1256.69628195708
INFO [2025-03-29 12:16:30] Replaced NAs in Sprint_Elo with first quartile: 1246.32574824425
INFO [2025-03-29 12:16:30] Replaced NAs in Sprint_C_Elo with first quartile: 1257.67866787334
INFO [2025-03-29 12:16:30] Replaced NAs in Sprint_F_Elo with first quartile: 1244.84742904868
INFO [2025-03-29 12:16:30] Replaced NAs in Classic_Elo with first quartile: 1252.44868703669
INFO [2025-03-29 12:16:30] Replaced NAs in Freestyle_Elo with first quartile: 1244.44508230281
INFO [2025-03-29 12:16:30] Replaced NAs in Distance_Pelo with first quartile: 1241.11854419952
INFO [2025-03-29 12:16:30] Replaced NAs in Distance_C_Pelo with first quartile: 1245.57367555166
INFO [2025-03-29 12:16:30] Replaced NAs in Distance_F_Pelo with first quartile: 1259.54282973153
INFO [2025-03-29 12:16:30] Replaced NAs in Sprint_Pelo with first quartile: 1254.58885254623
INFO [2025-03-29 12:16:30] Replaced NAs in Sprint_C_Pelo with first quartile: 1257.58302026178
INFO [2025-03-29 12:16:30] Replaced NAs in Sprint_F_Pelo with first quartile: 1257.67755691493
INFO [2025-03-29 12:16:30] Replaced NAs in Classic_Pelo with first quartile: 1256.79275004544
INFO [2025-03-29 12:16:30] Replaced NAs in Freestyle_Pelo with first quartile: 1256.79999900008
INFO [2025-03-29 12:16:30] Replaced NAs in Classic_Last_5 with first quartile: 3.5
INFO [2025-03-29 12:16:30] Replaced NAs in Freestyle_Last_5 with first quartile: 2.4
INFO [2025-03-29 12:16:30] Created Pelo_Pct from Elo with max value: 1841.00191142018
INFO [2025-03-29 12:16:30] Created Distance_Pelo_Pct from Distance_Elo with max value: 1889.46974050597
INFO [2025-03-29 12:16:30] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1763.33572074398
INFO [2025-03-29 12:16:30] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1693.85026290322
INFO [2025-03-29 12:16:30] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1742.74758850835
INFO [2025-03-29 12:16:30] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1601.5820663103
INFO [2025-03-29 12:16:30] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1681.09824552997
INFO [2025-03-29 12:16:30] Created Classic_Pelo_Pct from Classic_Elo with max value: 1698.69428891549
INFO [2025-03-29 12:16:30] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1707.58410982918
INFO [2025-03-29 12:16:30] Prepared data for 255 ladies skiers with 33 features
INFO [2025-03-29 12:16:30] Using FIS startlist for ladies's leg predictions
INFO [2025-03-29 12:16:31] Using FIS startlist for ladies
INFO [2025-03-29 12:16:31] Attempting Option 1: Team model coefficients
INFO [2025-03-29 12:16:31] Option 1 failed: No team_podium model found
INFO [2025-03-29 12:16:31] Option 1 failed: No team model
INFO [2025-03-29 12:16:31] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 12:16:31] Leg 1 accuracy: 0.82051282051282
INFO [2025-03-29 12:16:31] Leg 2 accuracy: 0.85
INFO [2025-03-29 12:16:31] Leg 3 accuracy: 0.802564102564103
INFO [2025-03-29 12:16:31] Leg 4 accuracy: 0.815151515151515
INFO [2025-03-29 12:16:31] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 12:16:31] Leg importance weights: Leg 1: 0.25, Leg 2: 0.26, Leg 3: 0.24, Leg 4: 0.25
INFO [2025-03-29 12:16:31] Resetting men's probabilities at or below the mode to zero
INFO [2025-03-29 12:16:31] No values appear more than twice for Win_Prob
INFO [2025-03-29 12:16:31] No values appear more than twice for Podium_Prob
INFO [2025-03-29 12:16:31] No values appear more than twice for Top5_Prob
INFO [2025-03-29 12:16:31] No values appear more than twice for Top10_Prob
INFO [2025-03-29 12:16:31] Resetting ladies' probabilities at or below the mode to zero
INFO [2025-03-29 12:16:31] Reset 3 values to 0 for Win_Prob (repeated values or values <  0 )
INFO [2025-03-29 12:16:31] Repeated values: 0
INFO [2025-03-29 12:16:31] No values appear more than twice for Podium_Prob
INFO [2025-03-29 12:16:31] No values appear more than twice for Top5_Prob
INFO [2025-03-29 12:16:31] No values appear more than twice for Top10_Prob
INFO [2025-03-29 12:16:31] Normalizing men's team probabilities
INFO [2025-03-29 12:16:31] Normalized Win_Prob from sum of 0.71 to 1
INFO [2025-03-29 12:16:31] Normalized Podium_Prob from sum of 2.34 to 3
INFO [2025-03-29 12:16:31] Normalized Top5_Prob from sum of 4.2 to 5
INFO [2025-03-29 12:16:31] Normalized Top10_Prob from sum of 10.33 to 10
INFO [2025-03-29 12:16:31] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 12:16:31] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 12:16:31] Normalizing ladies' team probabilities
INFO [2025-03-29 12:16:31] Normalized Win_Prob from sum of 1.12 to 1
INFO [2025-03-29 12:16:31] Normalized Podium_Prob from sum of 3.27 to 3
INFO [2025-03-29 12:16:31] Normalized Top5_Prob from sum of 4.51 to 5
INFO [2025-03-29 12:16:31] Normalized Top10_Prob from sum of 9.36 to 10
INFO [2025-03-29 12:16:31] Capped 2 values at 1 for Top5_Prob
INFO [2025-03-29 12:16:31] Capped 5 values at 1 for Top10_Prob
INFO [2025-03-29 12:16:31] Final capping of probabilities to maximum of 1
INFO [2025-03-29 12:16:31] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 12:16:31] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 12:16:31] Capped 2 values at 1 for Top5_Prob
INFO [2025-03-29 12:16:31] Capped 5 values at 1 for Top10_Prob
INFO [2025-03-29 12:16:31] Optimizing fantasy relay team
INFO [2025-03-29 12:16:31] Fantasy team optimization complete. Selected 12 teams.
INFO [2025-03-29 12:16:31] Total price: 99826 of max 1e+05
INFO [2025-03-29 12:16:31] Expected total points: 813.5
INFO [2025-03-29 12:16:31] Men's teams: 6 ( 6 )
INFO [2025-03-29 12:16:31] Ladies' teams: 6 ( 6 )
INFO [2025-03-29 12:16:31] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_points.xlsx
INFO [2025-03-29 12:16:31] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_probabilities.xlsx
INFO [2025-03-29 12:16:31] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_points.xlsx
INFO [2025-03-29 12:16:31] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_probabilities.xlsx
INFO [2025-03-29 12:16:31] Saved fantasy team results to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/fantasy_relay_team.xlsx
INFO [2025-03-29 12:16:31] Relay predictions completed successfully
INFO [2025-03-29 12:19:08] Starting relay predictions process
INFO [2025-03-29 12:19:08] Loading weekend race data
INFO [2025-03-29 12:19:08] Tomorrow's date: 2025-03-29
INFO [2025-03-29 12:19:08] Found 1 men's relay races and 1 ladies' relay races
INFO [2025-03-29 12:19:08] Loading chrono data
INFO [2025-03-29 12:19:14] Loaded men's chrono with 105122 rows and 36 columns
INFO [2025-03-29 12:19:14] Loaded ladies' chrono with 78706 rows and 36 columns
INFO [2025-03-29 12:19:14] Created men's relay df with 9688 rows
INFO [2025-03-29 12:19:14] Created men's individual df with 92143 rows
INFO [2025-03-29 12:19:14] Created ladies' relay df with 8019 rows
INFO [2025-03-29 12:19:14] Created ladies' individual df with 68253 rows
INFO [2025-03-29 12:19:19] Training models for Leg 1
INFO [2025-03-29 12:19:19] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:19:19] Training podium model using glm
INFO [2025-03-29 12:19:19] Training win model using glm
INFO [2025-03-29 12:19:19] Training top5 model using glm
INFO [2025-03-29 12:19:19] Training top10 model using glm
INFO [2025-03-29 12:19:20] Top features for Leg 1 podium prediction:
INFO [2025-03-29 12:19:20] Training models for Leg 2
INFO [2025-03-29 12:19:20] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:19:20] Training podium model using glm
INFO [2025-03-29 12:19:20] Training win model using glm
INFO [2025-03-29 12:19:20] Training top5 model using glm
INFO [2025-03-29 12:19:20] Training top10 model using glm
INFO [2025-03-29 12:19:20] Top features for Leg 2 podium prediction:
INFO [2025-03-29 12:19:20] Training models for Leg 3
INFO [2025-03-29 12:19:20] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:19:20] Training podium model using glm
INFO [2025-03-29 12:19:20] Training win model using glm
INFO [2025-03-29 12:19:20] Training top5 model using glm
INFO [2025-03-29 12:19:20] Training top10 model using glm
INFO [2025-03-29 12:19:20] Top features for Leg 3 podium prediction:
INFO [2025-03-29 12:19:20] Training models for Leg 4
INFO [2025-03-29 12:19:20] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:19:20] Training podium model using glm
INFO [2025-03-29 12:19:20] Training win model using glm
INFO [2025-03-29 12:19:20] Training top5 model using glm
INFO [2025-03-29 12:19:20] Training top10 model using glm
INFO [2025-03-29 12:19:21] Top features for Leg 4 podium prediction:
INFO [2025-03-29 12:19:21] Training models for Leg 1
INFO [2025-03-29 12:19:21] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:19:21] Training podium model using glm
INFO [2025-03-29 12:19:21] Training win model using glm
INFO [2025-03-29 12:19:21] Training top5 model using glm
INFO [2025-03-29 12:19:21] Training top10 model using glm
INFO [2025-03-29 12:19:21] Top features for Leg 1 podium prediction:
INFO [2025-03-29 12:19:21] Training models for Leg 2
INFO [2025-03-29 12:19:21] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:19:21] Training podium model using glm
INFO [2025-03-29 12:19:21] Training win model using glm
INFO [2025-03-29 12:19:21] Training top5 model using glm
INFO [2025-03-29 12:19:21] Training top10 model using glm
INFO [2025-03-29 12:19:21] Top features for Leg 2 podium prediction:
INFO [2025-03-29 12:19:21] Training models for Leg 3
INFO [2025-03-29 12:19:21] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:19:21] Training podium model using glm
INFO [2025-03-29 12:19:21] Training win model using glm
INFO [2025-03-29 12:19:21] Training top5 model using glm
INFO [2025-03-29 12:19:21] Training top10 model using glm
INFO [2025-03-29 12:19:22] Top features for Leg 3 podium prediction:
INFO [2025-03-29 12:19:22] Training models for Leg 4
INFO [2025-03-29 12:19:22] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:19:22] Training podium model using glm
INFO [2025-03-29 12:19:22] Training win model using glm
INFO [2025-03-29 12:19:22] Training top5 model using glm
INFO [2025-03-29 12:19:22] Training top10 model using glm
INFO [2025-03-29 12:19:22] Top features for Leg 4 podium prediction:
INFO [2025-03-29 12:19:22] Processing men's relay predictions
INFO [2025-03-29 12:19:22] Loaded men relay teams startlist with 24 rows
INFO [2025-03-29 12:19:22] Loaded men relay individuals startlist with 96 rows
INFO [2025-03-29 12:19:22] Preparing current men skier data
INFO [2025-03-29 12:19:22] Found 9 Elo columns for current skiers
INFO [2025-03-29 12:19:22] Replaced NAs in Distance_Elo with first quartile: 1207.23243912712
INFO [2025-03-29 12:19:22] Replaced NAs in Distance_C_Elo with first quartile: 1233.40200699225
INFO [2025-03-29 12:19:22] Replaced NAs in Distance_F_Elo with first quartile: 1236.48554062178
INFO [2025-03-29 12:19:22] Replaced NAs in Sprint_Elo with first quartile: 1223.60107000698
INFO [2025-03-29 12:19:22] Replaced NAs in Sprint_C_Elo with first quartile: 1241.28715500947
INFO [2025-03-29 12:19:22] Replaced NAs in Sprint_F_Elo with first quartile: 1234.45151108772
INFO [2025-03-29 12:19:22] Replaced NAs in Classic_Elo with first quartile: 1241.52867310024
INFO [2025-03-29 12:19:22] Replaced NAs in Freestyle_Elo with first quartile: 1228.48649348109
INFO [2025-03-29 12:19:22] Replaced NAs in Distance_Pelo with first quartile: 1211.63035979047
INFO [2025-03-29 12:19:22] Replaced NAs in Distance_C_Pelo with first quartile: 1234.81091928129
INFO [2025-03-29 12:19:22] Replaced NAs in Distance_F_Pelo with first quartile: 1239.65331180248
INFO [2025-03-29 12:19:22] Replaced NAs in Sprint_Pelo with first quartile: 1240.94751821383
INFO [2025-03-29 12:19:22] Replaced NAs in Sprint_C_Pelo with first quartile: 1241.28715500947
INFO [2025-03-29 12:19:22] Replaced NAs in Sprint_F_Pelo with first quartile: 1252.45166310493
INFO [2025-03-29 12:19:22] Replaced NAs in Classic_Pelo with first quartile: 1243.63746068082
INFO [2025-03-29 12:19:22] Replaced NAs in Freestyle_Pelo with first quartile: 1249.30280713791
INFO [2025-03-29 12:19:22] Replaced NAs in Classic_Last_5 with first quartile: 0
INFO [2025-03-29 12:19:22] Replaced NAs in Freestyle_Last_5 with first quartile: 0
INFO [2025-03-29 12:19:22] Created Pelo_Pct from Elo with max value: 1946.6211651574
INFO [2025-03-29 12:19:22] Created Distance_Pelo_Pct from Distance_Elo with max value: 1869.1251911742
INFO [2025-03-29 12:19:22] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1777.16297253153
INFO [2025-03-29 12:19:22] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1695.2053212904
INFO [2025-03-29 12:19:22] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1886.80363942481
INFO [2025-03-29 12:19:22] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1711.08486899169
INFO [2025-03-29 12:19:22] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1792.65157560707
INFO [2025-03-29 12:19:22] Created Classic_Pelo_Pct from Classic_Elo with max value: 1807.56773496777
INFO [2025-03-29 12:19:22] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1814.60460629541
INFO [2025-03-29 12:19:22] Prepared data for 381 men skiers with 33 features
INFO [2025-03-29 12:19:22] Using FIS startlist for men's leg predictions
INFO [2025-03-29 12:19:22] Using FIS startlist for men
INFO [2025-03-29 12:19:22] Attempting Option 1: Team model coefficients
INFO [2025-03-29 12:19:22] Option 1 failed: No team_podium model found
INFO [2025-03-29 12:19:22] Option 1 failed: No team model
INFO [2025-03-29 12:19:22] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 12:19:22] Leg 1 accuracy: 0.858361581920904
INFO [2025-03-29 12:19:22] Leg 2 accuracy: 0.838182349503214
INFO [2025-03-29 12:19:22] Leg 3 accuracy: 0.863997662185856
INFO [2025-03-29 12:19:22] Leg 4 accuracy: 0.884962010520164
INFO [2025-03-29 12:19:22] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 12:19:22] Leg importance weights: Leg 1: 0.25, Leg 2: 0.24, Leg 3: 0.25, Leg 4: 0.26
INFO [2025-03-29 12:19:22] Processing ladies's relay predictions
INFO [2025-03-29 12:19:22] Loaded ladies relay teams startlist with 20 rows
INFO [2025-03-29 12:19:22] Loaded ladies relay individuals startlist with 80 rows
INFO [2025-03-29 12:19:22] Preparing current ladies skier data
INFO [2025-03-29 12:19:22] Found 9 Elo columns for current skiers
INFO [2025-03-29 12:19:23] Replaced NAs in Distance_Elo with first quartile: 1237.38564383256
INFO [2025-03-29 12:19:23] Replaced NAs in Distance_C_Elo with first quartile: 1243.87329106944
INFO [2025-03-29 12:19:23] Replaced NAs in Distance_F_Elo with first quartile: 1256.69628195708
INFO [2025-03-29 12:19:23] Replaced NAs in Sprint_Elo with first quartile: 1246.32574824425
INFO [2025-03-29 12:19:23] Replaced NAs in Sprint_C_Elo with first quartile: 1257.67866787334
INFO [2025-03-29 12:19:23] Replaced NAs in Sprint_F_Elo with first quartile: 1244.84742904868
INFO [2025-03-29 12:19:23] Replaced NAs in Classic_Elo with first quartile: 1252.44868703669
INFO [2025-03-29 12:19:23] Replaced NAs in Freestyle_Elo with first quartile: 1244.44508230281
INFO [2025-03-29 12:19:23] Replaced NAs in Distance_Pelo with first quartile: 1241.11854419952
INFO [2025-03-29 12:19:23] Replaced NAs in Distance_C_Pelo with first quartile: 1245.57367555166
INFO [2025-03-29 12:19:23] Replaced NAs in Distance_F_Pelo with first quartile: 1259.54282973153
INFO [2025-03-29 12:19:23] Replaced NAs in Sprint_Pelo with first quartile: 1254.58885254623
INFO [2025-03-29 12:19:23] Replaced NAs in Sprint_C_Pelo with first quartile: 1257.58302026178
INFO [2025-03-29 12:19:23] Replaced NAs in Sprint_F_Pelo with first quartile: 1257.67755691493
INFO [2025-03-29 12:19:23] Replaced NAs in Classic_Pelo with first quartile: 1256.79275004544
INFO [2025-03-29 12:19:23] Replaced NAs in Freestyle_Pelo with first quartile: 1256.79999900008
INFO [2025-03-29 12:19:23] Replaced NAs in Classic_Last_5 with first quartile: 3.5
INFO [2025-03-29 12:19:23] Replaced NAs in Freestyle_Last_5 with first quartile: 2.4
INFO [2025-03-29 12:19:23] Created Pelo_Pct from Elo with max value: 1841.00191142018
INFO [2025-03-29 12:19:23] Created Distance_Pelo_Pct from Distance_Elo with max value: 1889.46974050597
INFO [2025-03-29 12:19:23] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1763.33572074398
INFO [2025-03-29 12:19:23] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1693.85026290322
INFO [2025-03-29 12:19:23] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1742.74758850835
INFO [2025-03-29 12:19:23] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1601.5820663103
INFO [2025-03-29 12:19:23] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1681.09824552997
INFO [2025-03-29 12:19:23] Created Classic_Pelo_Pct from Classic_Elo with max value: 1698.69428891549
INFO [2025-03-29 12:19:23] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1707.58410982918
INFO [2025-03-29 12:19:23] Prepared data for 255 ladies skiers with 33 features
INFO [2025-03-29 12:19:23] Using FIS startlist for ladies's leg predictions
INFO [2025-03-29 12:19:23] Using FIS startlist for ladies
INFO [2025-03-29 12:19:23] Attempting Option 1: Team model coefficients
INFO [2025-03-29 12:19:23] Option 1 failed: No team_podium model found
INFO [2025-03-29 12:19:23] Option 1 failed: No team model
INFO [2025-03-29 12:19:23] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 12:19:23] Leg 1 accuracy: 0.756410256410256
INFO [2025-03-29 12:19:23] Leg 2 accuracy: 0.85
INFO [2025-03-29 12:19:23] Leg 3 accuracy: 0.802564102564103
INFO [2025-03-29 12:19:23] Leg 4 accuracy: 0.745454545454545
INFO [2025-03-29 12:19:23] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 12:19:23] Leg importance weights: Leg 1: 0.24, Leg 2: 0.27, Leg 3: 0.25, Leg 4: 0.24
INFO [2025-03-29 12:19:23] Resetting men's probabilities at or below the mode to zero
INFO [2025-03-29 12:19:23] No values appear more than twice for Win_Prob
INFO [2025-03-29 12:19:23] No values appear more than twice for Podium_Prob
INFO [2025-03-29 12:19:23] No values appear more than twice for Top5_Prob
INFO [2025-03-29 12:19:23] No values appear more than twice for Top10_Prob
INFO [2025-03-29 12:19:23] Resetting ladies' probabilities at or below the mode to zero
INFO [2025-03-29 12:19:23] No values appear more than twice for Win_Prob
INFO [2025-03-29 12:19:23] No values appear more than twice for Podium_Prob
INFO [2025-03-29 12:19:23] No values appear more than twice for Top5_Prob
INFO [2025-03-29 12:19:23] No values appear more than twice for Top10_Prob
INFO [2025-03-29 12:19:23] Normalizing men's team probabilities
INFO [2025-03-29 12:19:23] Normalized Win_Prob from sum of 0.71 to 1
INFO [2025-03-29 12:19:23] Normalized Podium_Prob from sum of 2.34 to 3
INFO [2025-03-29 12:19:23] Normalized Top5_Prob from sum of 4.2 to 5
INFO [2025-03-29 12:19:23] Normalized Top10_Prob from sum of 10.33 to 10
INFO [2025-03-29 12:19:23] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 12:19:23] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 12:19:23] Normalizing ladies' team probabilities
INFO [2025-03-29 12:19:23] Normalized Win_Prob from sum of 1.12 to 1
INFO [2025-03-29 12:19:23] Normalized Podium_Prob from sum of 3.26 to 3
INFO [2025-03-29 12:19:23] Normalized Top5_Prob from sum of 4.5 to 5
INFO [2025-03-29 12:19:23] Normalized Top10_Prob from sum of 9.36 to 10
INFO [2025-03-29 12:19:23] Capped 2 values at 1 for Top5_Prob
INFO [2025-03-29 12:19:23] Capped 5 values at 1 for Top10_Prob
INFO [2025-03-29 12:19:23] Final capping of probabilities to maximum of 1
INFO [2025-03-29 12:19:23] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 12:19:23] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 12:19:23] Capped 2 values at 1 for Top5_Prob
INFO [2025-03-29 12:19:23] Capped 5 values at 1 for Top10_Prob
INFO [2025-03-29 12:19:23] Optimizing fantasy relay team
INFO [2025-03-29 12:19:23] Fantasy team optimization complete. Selected 12 teams.
INFO [2025-03-29 12:19:23] Total price: 99826 of max 1e+05
INFO [2025-03-29 12:19:23] Expected total points: 816.5
INFO [2025-03-29 12:19:23] Men's teams: 6 ( 6 )
INFO [2025-03-29 12:19:23] Ladies' teams: 6 ( 6 )
INFO [2025-03-29 12:19:23] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_points.xlsx
INFO [2025-03-29 12:19:23] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_probabilities.xlsx
INFO [2025-03-29 12:19:23] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_points.xlsx
INFO [2025-03-29 12:19:23] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_probabilities.xlsx
INFO [2025-03-29 12:19:23] Saved fantasy team results to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/fantasy_relay_team.xlsx
INFO [2025-03-29 12:19:23] Relay predictions completed successfully
INFO [2025-03-29 12:22:22] Starting relay predictions process
INFO [2025-03-29 12:22:22] Loading weekend race data
INFO [2025-03-29 12:22:22] Tomorrow's date: 2025-03-29
INFO [2025-03-29 12:22:22] Found 1 men's relay races and 1 ladies' relay races
INFO [2025-03-29 12:22:22] Loading chrono data
INFO [2025-03-29 12:22:28] Loaded men's chrono with 105122 rows and 36 columns
INFO [2025-03-29 12:22:28] Loaded ladies' chrono with 78706 rows and 36 columns
INFO [2025-03-29 12:22:28] Created men's relay df with 9688 rows
INFO [2025-03-29 12:22:28] Created men's individual df with 92143 rows
INFO [2025-03-29 12:22:28] Created ladies' relay df with 8019 rows
INFO [2025-03-29 12:22:28] Created ladies' individual df with 68253 rows
INFO [2025-03-29 12:22:33] Training models for Leg 1
INFO [2025-03-29 12:22:33] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:22:33] Training podium model using glm
INFO [2025-03-29 12:22:33] Training win model using glm
INFO [2025-03-29 12:22:33] Training top5 model using glm
INFO [2025-03-29 12:22:33] Training top10 model using glm
INFO [2025-03-29 12:22:33] Top features for Leg 1 podium prediction:
INFO [2025-03-29 12:22:33] Training models for Leg 2
INFO [2025-03-29 12:22:33] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:22:33] Training podium model using glm
INFO [2025-03-29 12:22:33] Training win model using glm
INFO [2025-03-29 12:22:33] Training top5 model using glm
INFO [2025-03-29 12:22:33] Training top10 model using glm
INFO [2025-03-29 12:22:33] Top features for Leg 2 podium prediction:
INFO [2025-03-29 12:22:33] Training models for Leg 3
INFO [2025-03-29 12:22:33] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:22:33] Training podium model using glm
INFO [2025-03-29 12:22:33] Training win model using glm
INFO [2025-03-29 12:22:33] Training top5 model using glm
INFO [2025-03-29 12:22:33] Training top10 model using glm
INFO [2025-03-29 12:22:34] Top features for Leg 3 podium prediction:
INFO [2025-03-29 12:22:34] Training models for Leg 4
INFO [2025-03-29 12:22:34] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:22:34] Training podium model using glm
INFO [2025-03-29 12:22:34] Training win model using glm
INFO [2025-03-29 12:22:34] Training top5 model using glm
INFO [2025-03-29 12:22:34] Training top10 model using glm
INFO [2025-03-29 12:22:34] Top features for Leg 4 podium prediction:
INFO [2025-03-29 12:22:34] Training models for Leg 1
INFO [2025-03-29 12:22:34] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:22:34] Training podium model using glm
INFO [2025-03-29 12:22:34] Training win model using glm
INFO [2025-03-29 12:22:34] Training top5 model using glm
INFO [2025-03-29 12:22:34] Training top10 model using glm
INFO [2025-03-29 12:22:34] Top features for Leg 1 podium prediction:
INFO [2025-03-29 12:22:34] Training models for Leg 2
INFO [2025-03-29 12:22:34] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:22:34] Training podium model using glm
INFO [2025-03-29 12:22:34] Training win model using glm
INFO [2025-03-29 12:22:34] Training top5 model using glm
INFO [2025-03-29 12:22:34] Training top10 model using glm
INFO [2025-03-29 12:22:35] Top features for Leg 2 podium prediction:
INFO [2025-03-29 12:22:35] Training models for Leg 3
INFO [2025-03-29 12:22:35] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:22:35] Training podium model using glm
INFO [2025-03-29 12:22:35] Training win model using glm
INFO [2025-03-29 12:22:35] Training top5 model using glm
INFO [2025-03-29 12:22:35] Training top10 model using glm
INFO [2025-03-29 12:22:35] Top features for Leg 3 podium prediction:
INFO [2025-03-29 12:22:35] Training models for Leg 4
INFO [2025-03-29 12:22:35] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:22:35] Training podium model using glm
INFO [2025-03-29 12:22:35] Training win model using glm
INFO [2025-03-29 12:22:35] Training top5 model using glm
INFO [2025-03-29 12:22:35] Training top10 model using glm
INFO [2025-03-29 12:22:35] Top features for Leg 4 podium prediction:
INFO [2025-03-29 12:22:35] Processing men's relay predictions
INFO [2025-03-29 12:22:35] Loaded men relay teams startlist with 24 rows
INFO [2025-03-29 12:22:35] Loaded men relay individuals startlist with 96 rows
INFO [2025-03-29 12:22:35] Preparing current men skier data
INFO [2025-03-29 12:22:35] Found 9 Elo columns for current skiers
INFO [2025-03-29 12:22:35] Replaced NAs in Distance_Elo with first quartile: 1207.23243912712
INFO [2025-03-29 12:22:35] Replaced NAs in Distance_C_Elo with first quartile: 1233.40200699225
INFO [2025-03-29 12:22:35] Replaced NAs in Distance_F_Elo with first quartile: 1236.48554062178
INFO [2025-03-29 12:22:35] Replaced NAs in Sprint_Elo with first quartile: 1223.60107000698
INFO [2025-03-29 12:22:35] Replaced NAs in Sprint_C_Elo with first quartile: 1241.28715500947
INFO [2025-03-29 12:22:35] Replaced NAs in Sprint_F_Elo with first quartile: 1234.45151108772
INFO [2025-03-29 12:22:35] Replaced NAs in Classic_Elo with first quartile: 1241.52867310024
INFO [2025-03-29 12:22:35] Replaced NAs in Freestyle_Elo with first quartile: 1228.48649348109
INFO [2025-03-29 12:22:35] Replaced NAs in Distance_Pelo with first quartile: 1211.63035979047
INFO [2025-03-29 12:22:35] Replaced NAs in Distance_C_Pelo with first quartile: 1234.81091928129
INFO [2025-03-29 12:22:35] Replaced NAs in Distance_F_Pelo with first quartile: 1239.65331180248
INFO [2025-03-29 12:22:35] Replaced NAs in Sprint_Pelo with first quartile: 1240.94751821383
INFO [2025-03-29 12:22:35] Replaced NAs in Sprint_C_Pelo with first quartile: 1241.28715500947
INFO [2025-03-29 12:22:35] Replaced NAs in Sprint_F_Pelo with first quartile: 1252.45166310493
INFO [2025-03-29 12:22:35] Replaced NAs in Classic_Pelo with first quartile: 1243.63746068082
INFO [2025-03-29 12:22:35] Replaced NAs in Freestyle_Pelo with first quartile: 1249.30280713791
INFO [2025-03-29 12:22:35] Replaced NAs in Classic_Last_5 with first quartile: 0
INFO [2025-03-29 12:22:35] Replaced NAs in Freestyle_Last_5 with first quartile: 0
INFO [2025-03-29 12:22:35] Created Pelo_Pct from Elo with max value: 1946.6211651574
INFO [2025-03-29 12:22:35] Created Distance_Pelo_Pct from Distance_Elo with max value: 1869.1251911742
INFO [2025-03-29 12:22:35] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1777.16297253153
INFO [2025-03-29 12:22:35] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1695.2053212904
INFO [2025-03-29 12:22:35] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1886.80363942481
INFO [2025-03-29 12:22:35] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1711.08486899169
INFO [2025-03-29 12:22:35] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1792.65157560707
INFO [2025-03-29 12:22:35] Created Classic_Pelo_Pct from Classic_Elo with max value: 1807.56773496777
INFO [2025-03-29 12:22:35] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1814.60460629541
INFO [2025-03-29 12:22:35] Prepared data for 381 men skiers with 33 features
INFO [2025-03-29 12:22:35] Using FIS startlist for men's leg predictions
INFO [2025-03-29 12:22:36] Using FIS startlist for men
INFO [2025-03-29 12:22:36] Attempting Option 1: Team model coefficients
INFO [2025-03-29 12:22:36] Option 1 failed: No team_podium model found
INFO [2025-03-29 12:22:36] Option 1 failed: No team model
INFO [2025-03-29 12:22:36] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 12:22:36] Leg 1 accuracy: 0.854843171634522
INFO [2025-03-29 12:22:36] Leg 2 accuracy: 0.861694915254237
INFO [2025-03-29 12:22:36] Leg 3 accuracy: 0.867142022209234
INFO [2025-03-29 12:22:36] Leg 4 accuracy: 0.884847067991428
INFO [2025-03-29 12:22:36] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 12:22:36] Leg importance weights: Leg 1: 0.25, Leg 2: 0.25, Leg 3: 0.25, Leg 4: 0.26
INFO [2025-03-29 12:22:36] Processing ladies's relay predictions
INFO [2025-03-29 12:22:36] Loaded ladies relay teams startlist with 20 rows
INFO [2025-03-29 12:22:36] Loaded ladies relay individuals startlist with 80 rows
INFO [2025-03-29 12:22:36] Preparing current ladies skier data
INFO [2025-03-29 12:22:36] Found 9 Elo columns for current skiers
INFO [2025-03-29 12:22:36] Replaced NAs in Distance_Elo with first quartile: 1237.38564383256
INFO [2025-03-29 12:22:36] Replaced NAs in Distance_C_Elo with first quartile: 1243.87329106944
INFO [2025-03-29 12:22:36] Replaced NAs in Distance_F_Elo with first quartile: 1256.69628195708
INFO [2025-03-29 12:22:36] Replaced NAs in Sprint_Elo with first quartile: 1246.32574824425
INFO [2025-03-29 12:22:36] Replaced NAs in Sprint_C_Elo with first quartile: 1257.67866787334
INFO [2025-03-29 12:22:36] Replaced NAs in Sprint_F_Elo with first quartile: 1244.84742904868
INFO [2025-03-29 12:22:36] Replaced NAs in Classic_Elo with first quartile: 1252.44868703669
INFO [2025-03-29 12:22:36] Replaced NAs in Freestyle_Elo with first quartile: 1244.44508230281
INFO [2025-03-29 12:22:36] Replaced NAs in Distance_Pelo with first quartile: 1241.11854419952
INFO [2025-03-29 12:22:36] Replaced NAs in Distance_C_Pelo with first quartile: 1245.57367555166
INFO [2025-03-29 12:22:36] Replaced NAs in Distance_F_Pelo with first quartile: 1259.54282973153
INFO [2025-03-29 12:22:36] Replaced NAs in Sprint_Pelo with first quartile: 1254.58885254623
INFO [2025-03-29 12:22:36] Replaced NAs in Sprint_C_Pelo with first quartile: 1257.58302026178
INFO [2025-03-29 12:22:36] Replaced NAs in Sprint_F_Pelo with first quartile: 1257.67755691493
INFO [2025-03-29 12:22:36] Replaced NAs in Classic_Pelo with first quartile: 1256.79275004544
INFO [2025-03-29 12:22:36] Replaced NAs in Freestyle_Pelo with first quartile: 1256.79999900008
INFO [2025-03-29 12:22:36] Replaced NAs in Classic_Last_5 with first quartile: 3.5
INFO [2025-03-29 12:22:36] Replaced NAs in Freestyle_Last_5 with first quartile: 2.4
INFO [2025-03-29 12:22:36] Created Pelo_Pct from Elo with max value: 1841.00191142018
INFO [2025-03-29 12:22:36] Created Distance_Pelo_Pct from Distance_Elo with max value: 1889.46974050597
INFO [2025-03-29 12:22:36] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1763.33572074398
INFO [2025-03-29 12:22:36] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1693.85026290322
INFO [2025-03-29 12:22:36] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1742.74758850835
INFO [2025-03-29 12:22:36] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1601.5820663103
INFO [2025-03-29 12:22:36] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1681.09824552997
INFO [2025-03-29 12:22:36] Created Classic_Pelo_Pct from Classic_Elo with max value: 1698.69428891549
INFO [2025-03-29 12:22:36] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1707.58410982918
INFO [2025-03-29 12:22:36] Prepared data for 255 ladies skiers with 33 features
INFO [2025-03-29 12:22:36] Using FIS startlist for ladies's leg predictions
INFO [2025-03-29 12:22:36] Using FIS startlist for ladies
INFO [2025-03-29 12:22:36] Attempting Option 1: Team model coefficients
INFO [2025-03-29 12:22:36] Option 1 failed: No team_podium model found
INFO [2025-03-29 12:22:36] Option 1 failed: No team model
INFO [2025-03-29 12:22:36] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 12:22:36] Leg 1 accuracy: 0.802564102564103
INFO [2025-03-29 12:22:36] Leg 2 accuracy: 0.833333333333333
INFO [2025-03-29 12:22:36] Leg 3 accuracy: 0.802564102564103
INFO [2025-03-29 12:22:36] Leg 4 accuracy: 0.781818181818182
INFO [2025-03-29 12:22:36] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 12:22:36] Leg importance weights: Leg 1: 0.25, Leg 2: 0.26, Leg 3: 0.25, Leg 4: 0.24
INFO [2025-03-29 12:22:36] Resetting men's probabilities at or below the mode to zero
INFO [2025-03-29 12:22:36] No values appear more than twice for Win_Prob
INFO [2025-03-29 12:22:36] No values appear more than twice for Podium_Prob
INFO [2025-03-29 12:22:36] No values appear more than twice for Top5_Prob
INFO [2025-03-29 12:22:36] No values appear more than twice for Top10_Prob
INFO [2025-03-29 12:22:36] Resetting ladies' probabilities at or below the mode to zero
INFO [2025-03-29 12:22:36] Reset 3 values to 0 for Win_Prob (repeated values or values <  0 )
INFO [2025-03-29 12:22:36] Repeated values: 0
INFO [2025-03-29 12:22:36] No values appear more than twice for Podium_Prob
INFO [2025-03-29 12:22:36] No values appear more than twice for Top5_Prob
INFO [2025-03-29 12:22:36] No values appear more than twice for Top10_Prob
INFO [2025-03-29 12:22:36] Normalizing men's team probabilities
INFO [2025-03-29 12:22:36] Normalized Win_Prob from sum of 0.72 to 1
INFO [2025-03-29 12:22:36] Normalized Podium_Prob from sum of 2.35 to 3
INFO [2025-03-29 12:22:36] Normalized Top5_Prob from sum of 4.21 to 5
INFO [2025-03-29 12:22:36] Normalized Top10_Prob from sum of 10.33 to 10
INFO [2025-03-29 12:22:36] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 12:22:36] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 12:22:36] Normalizing ladies' team probabilities
INFO [2025-03-29 12:22:36] Normalized Win_Prob from sum of 1.12 to 1
INFO [2025-03-29 12:22:36] Normalized Podium_Prob from sum of 3.26 to 3
INFO [2025-03-29 12:22:36] Normalized Top5_Prob from sum of 4.51 to 5
INFO [2025-03-29 12:22:36] Normalized Top10_Prob from sum of 9.37 to 10
INFO [2025-03-29 12:22:36] Capped 2 values at 1 for Top5_Prob
INFO [2025-03-29 12:22:36] Capped 5 values at 1 for Top10_Prob
INFO [2025-03-29 12:22:36] Final capping of probabilities to maximum of 1
INFO [2025-03-29 12:22:36] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 12:22:36] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 12:22:36] Capped 2 values at 1 for Top5_Prob
INFO [2025-03-29 12:22:36] Capped 5 values at 1 for Top10_Prob
INFO [2025-03-29 12:22:36] Optimizing fantasy relay team
INFO [2025-03-29 12:22:36] Fantasy team optimization complete. Selected 12 teams.
INFO [2025-03-29 12:22:36] Total price: 99826 of max 1e+05
INFO [2025-03-29 12:22:36] Expected total points: 815.2
INFO [2025-03-29 12:22:36] Men's teams: 6 ( 6 )
INFO [2025-03-29 12:22:36] Ladies' teams: 6 ( 6 )
INFO [2025-03-29 12:22:36] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_points.xlsx
INFO [2025-03-29 12:22:36] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_probabilities.xlsx
INFO [2025-03-29 12:22:36] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_points.xlsx
INFO [2025-03-29 12:22:36] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_probabilities.xlsx
INFO [2025-03-29 12:22:36] Saved fantasy team results to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/fantasy_relay_team.xlsx
INFO [2025-03-29 12:22:36] Relay predictions completed successfully
INFO [2025-03-29 12:26:48] Starting relay predictions process
INFO [2025-03-29 12:26:48] Loading weekend race data
INFO [2025-03-29 12:26:48] Tomorrow's date: 2025-03-29
INFO [2025-03-29 12:26:48] Found 1 men's relay races and 1 ladies' relay races
INFO [2025-03-29 12:26:48] Loading chrono data
INFO [2025-03-29 12:26:54] Loaded men's chrono with 105122 rows and 36 columns
INFO [2025-03-29 12:26:54] Loaded ladies' chrono with 78706 rows and 36 columns
INFO [2025-03-29 12:26:54] Created men's relay df with 9688 rows
INFO [2025-03-29 12:26:54] Created men's individual df with 92143 rows
INFO [2025-03-29 12:26:54] Created ladies' relay df with 8019 rows
INFO [2025-03-29 12:26:54] Created ladies' individual df with 68253 rows
INFO [2025-03-29 12:26:59] Training models for Leg 1
INFO [2025-03-29 12:26:59] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:26:59] Training podium model using glm
INFO [2025-03-29 12:26:59] Training win model using glm
INFO [2025-03-29 12:26:59] Training top5 model using glm
INFO [2025-03-29 12:26:59] Training top10 model using glm
INFO [2025-03-29 12:26:59] Top features for Leg 1 podium prediction:
INFO [2025-03-29 12:26:59] Training models for Leg 2
INFO [2025-03-29 12:26:59] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:26:59] Training podium model using glm
INFO [2025-03-29 12:26:59] Training win model using glm
INFO [2025-03-29 12:26:59] Training top5 model using glm
INFO [2025-03-29 12:26:59] Training top10 model using glm
INFO [2025-03-29 12:26:59] Top features for Leg 2 podium prediction:
INFO [2025-03-29 12:26:59] Training models for Leg 3
INFO [2025-03-29 12:26:59] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:26:59] Training podium model using glm
INFO [2025-03-29 12:26:59] Training win model using glm
INFO [2025-03-29 12:26:59] Training top5 model using glm
INFO [2025-03-29 12:27:00] Training top10 model using glm
INFO [2025-03-29 12:27:00] Top features for Leg 3 podium prediction:
INFO [2025-03-29 12:27:00] Training models for Leg 4
INFO [2025-03-29 12:27:00] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:27:00] Training podium model using glm
INFO [2025-03-29 12:27:00] Training win model using glm
INFO [2025-03-29 12:27:00] Training top5 model using glm
INFO [2025-03-29 12:27:00] Training top10 model using glm
INFO [2025-03-29 12:27:00] Top features for Leg 4 podium prediction:
INFO [2025-03-29 12:27:00] Training models for Leg 1
INFO [2025-03-29 12:27:00] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:27:00] Training podium model using glm
INFO [2025-03-29 12:27:00] Training win model using glm
INFO [2025-03-29 12:27:00] Training top5 model using glm
INFO [2025-03-29 12:27:00] Training top10 model using glm
INFO [2025-03-29 12:27:00] Top features for Leg 1 podium prediction:
INFO [2025-03-29 12:27:00] Training models for Leg 2
INFO [2025-03-29 12:27:00] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:27:00] Training podium model using glm
INFO [2025-03-29 12:27:00] Training win model using glm
INFO [2025-03-29 12:27:00] Training top5 model using glm
INFO [2025-03-29 12:27:01] Training top10 model using glm
INFO [2025-03-29 12:27:01] Top features for Leg 2 podium prediction:
INFO [2025-03-29 12:27:01] Training models for Leg 3
INFO [2025-03-29 12:27:01] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:27:01] Training podium model using glm
INFO [2025-03-29 12:27:01] Training win model using glm
INFO [2025-03-29 12:27:01] Training top5 model using glm
INFO [2025-03-29 12:27:01] Training top10 model using glm
INFO [2025-03-29 12:27:01] Top features for Leg 3 podium prediction:
INFO [2025-03-29 12:27:01] Training models for Leg 4
INFO [2025-03-29 12:27:01] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:27:01] Training podium model using glm
INFO [2025-03-29 12:27:01] Training win model using glm
INFO [2025-03-29 12:27:01] Training top5 model using glm
INFO [2025-03-29 12:27:01] Training top10 model using glm
INFO [2025-03-29 12:27:01] Top features for Leg 4 podium prediction:
INFO [2025-03-29 12:27:01] Processing men's relay predictions
INFO [2025-03-29 12:27:01] Loaded men relay teams startlist with 24 rows
INFO [2025-03-29 12:27:01] Loaded men relay individuals startlist with 96 rows
INFO [2025-03-29 12:27:01] Preparing current men skier data
INFO [2025-03-29 12:27:01] Found 9 Elo columns for current skiers
INFO [2025-03-29 12:27:02] Replaced NAs in Distance_Elo with first quartile: 1207.23243912712
INFO [2025-03-29 12:27:02] Replaced NAs in Distance_C_Elo with first quartile: 1233.40200699225
INFO [2025-03-29 12:27:02] Replaced NAs in Distance_F_Elo with first quartile: 1236.48554062178
INFO [2025-03-29 12:27:02] Replaced NAs in Sprint_Elo with first quartile: 1223.60107000698
INFO [2025-03-29 12:27:02] Replaced NAs in Sprint_C_Elo with first quartile: 1241.28715500947
INFO [2025-03-29 12:27:02] Replaced NAs in Sprint_F_Elo with first quartile: 1234.45151108772
INFO [2025-03-29 12:27:02] Replaced NAs in Classic_Elo with first quartile: 1241.52867310024
INFO [2025-03-29 12:27:02] Replaced NAs in Freestyle_Elo with first quartile: 1228.48649348109
INFO [2025-03-29 12:27:02] Replaced NAs in Distance_Pelo with first quartile: 1211.63035979047
INFO [2025-03-29 12:27:02] Replaced NAs in Distance_C_Pelo with first quartile: 1234.81091928129
INFO [2025-03-29 12:27:02] Replaced NAs in Distance_F_Pelo with first quartile: 1239.65331180248
INFO [2025-03-29 12:27:02] Replaced NAs in Sprint_Pelo with first quartile: 1240.94751821383
INFO [2025-03-29 12:27:02] Replaced NAs in Sprint_C_Pelo with first quartile: 1241.28715500947
INFO [2025-03-29 12:27:02] Replaced NAs in Sprint_F_Pelo with first quartile: 1252.45166310493
INFO [2025-03-29 12:27:02] Replaced NAs in Classic_Pelo with first quartile: 1243.63746068082
INFO [2025-03-29 12:27:02] Replaced NAs in Freestyle_Pelo with first quartile: 1249.30280713791
INFO [2025-03-29 12:27:02] Replaced NAs in Classic_Last_5 with first quartile: 0
INFO [2025-03-29 12:27:02] Replaced NAs in Freestyle_Last_5 with first quartile: 0
INFO [2025-03-29 12:27:02] Created Pelo_Pct from Elo with max value: 1946.6211651574
INFO [2025-03-29 12:27:02] Created Distance_Pelo_Pct from Distance_Elo with max value: 1869.1251911742
INFO [2025-03-29 12:27:02] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1777.16297253153
INFO [2025-03-29 12:27:02] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1695.2053212904
INFO [2025-03-29 12:27:02] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1886.80363942481
INFO [2025-03-29 12:27:02] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1711.08486899169
INFO [2025-03-29 12:27:02] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1792.65157560707
INFO [2025-03-29 12:27:02] Created Classic_Pelo_Pct from Classic_Elo with max value: 1807.56773496777
INFO [2025-03-29 12:27:02] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1814.60460629541
INFO [2025-03-29 12:27:02] Prepared data for 381 men skiers with 33 features
INFO [2025-03-29 12:27:02] Using FIS startlist for men's leg predictions
INFO [2025-03-29 12:27:02] Using FIS startlist for men
INFO [2025-03-29 12:27:02] Attempting Option 1: Team model coefficients
INFO [2025-03-29 12:27:02] Option 1 failed: No team_podium model found
INFO [2025-03-29 12:27:02] Option 1 failed: No team model
INFO [2025-03-29 12:27:02] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 12:27:02] Leg 1 accuracy: 0.851796220533801
INFO [2025-03-29 12:27:02] Leg 2 accuracy: 0.851622832651471
INFO [2025-03-29 12:27:02] Leg 3 accuracy: 0.870358464835379
INFO [2025-03-29 12:27:02] Leg 4 accuracy: 0.891338398597312
INFO [2025-03-29 12:27:02] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 12:27:02] Leg importance weights: Leg 1: 0.25, Leg 2: 0.25, Leg 3: 0.25, Leg 4: 0.26
INFO [2025-03-29 12:27:02] Processing ladies's relay predictions
INFO [2025-03-29 12:27:02] Loaded ladies relay teams startlist with 20 rows
INFO [2025-03-29 12:27:02] Loaded ladies relay individuals startlist with 80 rows
INFO [2025-03-29 12:27:02] Preparing current ladies skier data
INFO [2025-03-29 12:27:02] Found 9 Elo columns for current skiers
INFO [2025-03-29 12:27:02] Replaced NAs in Distance_Elo with first quartile: 1237.38564383256
INFO [2025-03-29 12:27:02] Replaced NAs in Distance_C_Elo with first quartile: 1243.87329106944
INFO [2025-03-29 12:27:02] Replaced NAs in Distance_F_Elo with first quartile: 1256.69628195708
INFO [2025-03-29 12:27:02] Replaced NAs in Sprint_Elo with first quartile: 1246.32574824425
INFO [2025-03-29 12:27:02] Replaced NAs in Sprint_C_Elo with first quartile: 1257.67866787334
INFO [2025-03-29 12:27:02] Replaced NAs in Sprint_F_Elo with first quartile: 1244.84742904868
INFO [2025-03-29 12:27:02] Replaced NAs in Classic_Elo with first quartile: 1252.44868703669
INFO [2025-03-29 12:27:02] Replaced NAs in Freestyle_Elo with first quartile: 1244.44508230281
INFO [2025-03-29 12:27:02] Replaced NAs in Distance_Pelo with first quartile: 1241.11854419952
INFO [2025-03-29 12:27:02] Replaced NAs in Distance_C_Pelo with first quartile: 1245.57367555166
INFO [2025-03-29 12:27:02] Replaced NAs in Distance_F_Pelo with first quartile: 1259.54282973153
INFO [2025-03-29 12:27:02] Replaced NAs in Sprint_Pelo with first quartile: 1254.58885254623
INFO [2025-03-29 12:27:02] Replaced NAs in Sprint_C_Pelo with first quartile: 1257.58302026178
INFO [2025-03-29 12:27:02] Replaced NAs in Sprint_F_Pelo with first quartile: 1257.67755691493
INFO [2025-03-29 12:27:02] Replaced NAs in Classic_Pelo with first quartile: 1256.79275004544
INFO [2025-03-29 12:27:02] Replaced NAs in Freestyle_Pelo with first quartile: 1256.79999900008
INFO [2025-03-29 12:27:02] Replaced NAs in Classic_Last_5 with first quartile: 3.5
INFO [2025-03-29 12:27:02] Replaced NAs in Freestyle_Last_5 with first quartile: 2.4
INFO [2025-03-29 12:27:02] Created Pelo_Pct from Elo with max value: 1841.00191142018
INFO [2025-03-29 12:27:02] Created Distance_Pelo_Pct from Distance_Elo with max value: 1889.46974050597
INFO [2025-03-29 12:27:02] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1763.33572074398
INFO [2025-03-29 12:27:02] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1693.85026290322
INFO [2025-03-29 12:27:02] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1742.74758850835
INFO [2025-03-29 12:27:02] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1601.5820663103
INFO [2025-03-29 12:27:02] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1681.09824552997
INFO [2025-03-29 12:27:02] Created Classic_Pelo_Pct from Classic_Elo with max value: 1698.69428891549
INFO [2025-03-29 12:27:02] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1707.58410982918
INFO [2025-03-29 12:27:02] Prepared data for 255 ladies skiers with 33 features
INFO [2025-03-29 12:27:02] Using FIS startlist for ladies's leg predictions
INFO [2025-03-29 12:27:02] Using FIS startlist for ladies
INFO [2025-03-29 12:27:02] Attempting Option 1: Team model coefficients
INFO [2025-03-29 12:27:02] Option 1 failed: No team_podium model found
INFO [2025-03-29 12:27:02] Option 1 failed: No team model
INFO [2025-03-29 12:27:02] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 12:27:02] Leg 1 accuracy: 0.755128205128205
INFO [2025-03-29 12:27:02] Leg 2 accuracy: 0.833333333333333
INFO [2025-03-29 12:27:02] Leg 3 accuracy: 0.803846153846154
INFO [2025-03-29 12:27:02] Leg 4 accuracy: 0.816666666666667
INFO [2025-03-29 12:27:02] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 12:27:02] Leg importance weights: Leg 1: 0.24, Leg 2: 0.26, Leg 3: 0.25, Leg 4: 0.25
INFO [2025-03-29 12:27:02] Resetting men's probabilities at or below the mode to zero
INFO [2025-03-29 12:27:02] No values appear more than twice for Win_Prob
INFO [2025-03-29 12:27:02] No values appear more than twice for Podium_Prob
INFO [2025-03-29 12:27:02] No values appear more than twice for Top5_Prob
INFO [2025-03-29 12:27:02] No values appear more than twice for Top10_Prob
INFO [2025-03-29 12:27:02] Resetting ladies' probabilities at or below the mode to zero
INFO [2025-03-29 12:27:02] No values appear more than twice for Win_Prob
INFO [2025-03-29 12:27:02] No values appear more than twice for Podium_Prob
INFO [2025-03-29 12:27:02] No values appear more than twice for Top5_Prob
INFO [2025-03-29 12:27:02] No values appear more than twice for Top10_Prob
INFO [2025-03-29 12:27:02] Normalizing men's team probabilities
INFO [2025-03-29 12:27:02] Normalized Win_Prob from sum of 0.72 to 1
INFO [2025-03-29 12:27:02] Normalized Podium_Prob from sum of 2.34 to 3
INFO [2025-03-29 12:27:02] Normalized Top5_Prob from sum of 4.2 to 5
INFO [2025-03-29 12:27:02] Normalized Top10_Prob from sum of 10.33 to 10
INFO [2025-03-29 12:27:02] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 12:27:02] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 12:27:02] Normalizing ladies' team probabilities
INFO [2025-03-29 12:27:02] Normalized Win_Prob from sum of 1.12 to 1
INFO [2025-03-29 12:27:02] Normalized Podium_Prob from sum of 3.26 to 3
INFO [2025-03-29 12:27:02] Normalized Top5_Prob from sum of 4.5 to 5
INFO [2025-03-29 12:27:02] Normalized Top10_Prob from sum of 9.34 to 10
INFO [2025-03-29 12:27:02] Capped 2 values at 1 for Top5_Prob
INFO [2025-03-29 12:27:02] Capped 5 values at 1 for Top10_Prob
INFO [2025-03-29 12:27:02] Final capping of probabilities to maximum of 1
INFO [2025-03-29 12:27:02] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 12:27:02] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 12:27:02] Capped 2 values at 1 for Top5_Prob
INFO [2025-03-29 12:27:02] Capped 5 values at 1 for Top10_Prob
INFO [2025-03-29 12:27:02] Optimizing fantasy relay team
INFO [2025-03-29 12:27:02] Fantasy team optimization complete. Selected 12 teams.
INFO [2025-03-29 12:27:02] Total price: 99826 of max 1e+05
INFO [2025-03-29 12:27:02] Expected total points: 814.1
INFO [2025-03-29 12:27:02] Men's teams: 6 ( 6 )
INFO [2025-03-29 12:27:02] Ladies' teams: 6 ( 6 )
INFO [2025-03-29 12:27:02] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_points.xlsx
INFO [2025-03-29 12:27:02] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_probabilities.xlsx
INFO [2025-03-29 12:27:02] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_points.xlsx
INFO [2025-03-29 12:27:02] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_probabilities.xlsx
INFO [2025-03-29 12:27:03] Saved fantasy team results to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/fantasy_relay_team.xlsx
INFO [2025-03-29 12:27:03] Relay predictions completed successfully
INFO [2025-03-29 12:28:05] Starting relay predictions process
INFO [2025-03-29 12:28:05] Loading weekend race data
INFO [2025-03-29 12:28:05] Tomorrow's date: 2025-03-29
INFO [2025-03-29 12:28:05] Found 1 men's relay races and 1 ladies' relay races
INFO [2025-03-29 12:28:05] Loading chrono data
INFO [2025-03-29 12:28:10] Loaded men's chrono with 105122 rows and 36 columns
INFO [2025-03-29 12:28:10] Loaded ladies' chrono with 78706 rows and 36 columns
INFO [2025-03-29 12:28:10] Created men's relay df with 9688 rows
INFO [2025-03-29 12:28:10] Created men's individual df with 92143 rows
INFO [2025-03-29 12:28:10] Created ladies' relay df with 8019 rows
INFO [2025-03-29 12:28:10] Created ladies' individual df with 68253 rows
INFO [2025-03-29 12:28:15] Training models for Leg 1
INFO [2025-03-29 12:28:15] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:28:15] Training podium model using glm
INFO [2025-03-29 12:28:15] Training win model using glm
INFO [2025-03-29 12:28:15] Training top5 model using glm
INFO [2025-03-29 12:28:15] Training top10 model using glm
INFO [2025-03-29 12:28:15] Top features for Leg 1 podium prediction:
INFO [2025-03-29 12:28:15] Training models for Leg 2
INFO [2025-03-29 12:28:15] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:28:15] Training podium model using glm
INFO [2025-03-29 12:28:15] Training win model using glm
INFO [2025-03-29 12:28:15] Training top5 model using glm
INFO [2025-03-29 12:28:16] Training top10 model using glm
INFO [2025-03-29 12:28:16] Top features for Leg 2 podium prediction:
INFO [2025-03-29 12:28:16] Training models for Leg 3
INFO [2025-03-29 12:28:16] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:28:16] Training podium model using glm
INFO [2025-03-29 12:28:16] Training win model using glm
INFO [2025-03-29 12:28:16] Training top5 model using glm
INFO [2025-03-29 12:28:16] Training top10 model using glm
INFO [2025-03-29 12:28:16] Top features for Leg 3 podium prediction:
INFO [2025-03-29 12:28:16] Training models for Leg 4
INFO [2025-03-29 12:28:16] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:28:16] Training podium model using glm
INFO [2025-03-29 12:28:16] Training win model using glm
INFO [2025-03-29 12:28:16] Training top5 model using glm
INFO [2025-03-29 12:28:16] Training top10 model using glm
INFO [2025-03-29 12:28:16] Top features for Leg 4 podium prediction:
INFO [2025-03-29 12:28:16] Training models for Leg 1
INFO [2025-03-29 12:28:16] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:28:16] Training podium model using glm
INFO [2025-03-29 12:28:16] Training win model using glm
INFO [2025-03-29 12:28:16] Training top5 model using glm
INFO [2025-03-29 12:28:17] Training top10 model using glm
INFO [2025-03-29 12:28:17] Top features for Leg 1 podium prediction:
INFO [2025-03-29 12:28:17] Training models for Leg 2
INFO [2025-03-29 12:28:17] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:28:17] Training podium model using glm
INFO [2025-03-29 12:28:17] Training win model using glm
INFO [2025-03-29 12:28:17] Training top5 model using glm
INFO [2025-03-29 12:28:17] Training top10 model using glm
INFO [2025-03-29 12:28:17] Top features for Leg 2 podium prediction:
INFO [2025-03-29 12:28:17] Training models for Leg 3
INFO [2025-03-29 12:28:17] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:28:17] Training podium model using glm
INFO [2025-03-29 12:28:17] Training win model using glm
INFO [2025-03-29 12:28:17] Training top5 model using glm
INFO [2025-03-29 12:28:17] Training top10 model using glm
INFO [2025-03-29 12:28:17] Top features for Leg 3 podium prediction:
INFO [2025-03-29 12:28:17] Training models for Leg 4
INFO [2025-03-29 12:28:17] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:28:17] Training podium model using glm
INFO [2025-03-29 12:28:17] Training win model using glm
INFO [2025-03-29 12:28:17] Training top5 model using glm
INFO [2025-03-29 12:28:17] Training top10 model using glm
INFO [2025-03-29 12:28:18] Top features for Leg 4 podium prediction:
INFO [2025-03-29 12:28:18] Processing men's relay predictions
INFO [2025-03-29 12:28:18] Loaded men relay teams startlist with 24 rows
INFO [2025-03-29 12:28:18] Loaded men relay individuals startlist with 96 rows
INFO [2025-03-29 12:28:18] Preparing current men skier data
INFO [2025-03-29 12:28:18] Found 9 Elo columns for current skiers
INFO [2025-03-29 12:28:18] Replaced NAs in Distance_Elo with first quartile: 1207.23243912712
INFO [2025-03-29 12:28:18] Replaced NAs in Distance_C_Elo with first quartile: 1233.40200699225
INFO [2025-03-29 12:28:18] Replaced NAs in Distance_F_Elo with first quartile: 1236.48554062178
INFO [2025-03-29 12:28:18] Replaced NAs in Sprint_Elo with first quartile: 1223.60107000698
INFO [2025-03-29 12:28:18] Replaced NAs in Sprint_C_Elo with first quartile: 1241.28715500947
INFO [2025-03-29 12:28:18] Replaced NAs in Sprint_F_Elo with first quartile: 1234.45151108772
INFO [2025-03-29 12:28:18] Replaced NAs in Classic_Elo with first quartile: 1241.52867310024
INFO [2025-03-29 12:28:18] Replaced NAs in Freestyle_Elo with first quartile: 1228.48649348109
INFO [2025-03-29 12:28:18] Replaced NAs in Distance_Pelo with first quartile: 1211.63035979047
INFO [2025-03-29 12:28:18] Replaced NAs in Distance_C_Pelo with first quartile: 1234.81091928129
INFO [2025-03-29 12:28:18] Replaced NAs in Distance_F_Pelo with first quartile: 1239.65331180248
INFO [2025-03-29 12:28:18] Replaced NAs in Sprint_Pelo with first quartile: 1240.94751821383
INFO [2025-03-29 12:28:18] Replaced NAs in Sprint_C_Pelo with first quartile: 1241.28715500947
INFO [2025-03-29 12:28:18] Replaced NAs in Sprint_F_Pelo with first quartile: 1252.45166310493
INFO [2025-03-29 12:28:18] Replaced NAs in Classic_Pelo with first quartile: 1243.63746068082
INFO [2025-03-29 12:28:18] Replaced NAs in Freestyle_Pelo with first quartile: 1249.30280713791
INFO [2025-03-29 12:28:18] Replaced NAs in Classic_Last_5 with first quartile: 0
INFO [2025-03-29 12:28:18] Replaced NAs in Freestyle_Last_5 with first quartile: 0
INFO [2025-03-29 12:28:18] Created Pelo_Pct from Elo with max value: 1946.6211651574
INFO [2025-03-29 12:28:18] Created Distance_Pelo_Pct from Distance_Elo with max value: 1869.1251911742
INFO [2025-03-29 12:28:18] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1777.16297253153
INFO [2025-03-29 12:28:18] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1695.2053212904
INFO [2025-03-29 12:28:18] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1886.80363942481
INFO [2025-03-29 12:28:18] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1711.08486899169
INFO [2025-03-29 12:28:18] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1792.65157560707
INFO [2025-03-29 12:28:18] Created Classic_Pelo_Pct from Classic_Elo with max value: 1807.56773496777
INFO [2025-03-29 12:28:18] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1814.60460629541
INFO [2025-03-29 12:28:18] Prepared data for 381 men skiers with 33 features
INFO [2025-03-29 12:28:18] Using FIS startlist for men's leg predictions
INFO [2025-03-29 12:28:18] Using FIS startlist for men
INFO [2025-03-29 12:28:18] Attempting Option 1: Team model coefficients
INFO [2025-03-29 12:28:18] Option 1 failed: No team_podium model found
INFO [2025-03-29 12:28:18] Option 1 failed: No team model
INFO [2025-03-29 12:28:18] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 12:28:18] Leg 1 accuracy: 0.861468926553672
INFO [2025-03-29 12:28:18] Leg 2 accuracy: 0.851165010714982
INFO [2025-03-29 12:28:18] Leg 3 accuracy: 0.867426456263394
INFO [2025-03-29 12:28:18] Leg 4 accuracy: 0.888008961620884
INFO [2025-03-29 12:28:18] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 12:28:18] Leg importance weights: Leg 1: 0.25, Leg 2: 0.25, Leg 3: 0.25, Leg 4: 0.26
INFO [2025-03-29 12:28:18] Processing ladies's relay predictions
INFO [2025-03-29 12:28:18] Loaded ladies relay teams startlist with 20 rows
INFO [2025-03-29 12:28:18] Loaded ladies relay individuals startlist with 80 rows
INFO [2025-03-29 12:28:18] Preparing current ladies skier data
INFO [2025-03-29 12:28:18] Found 9 Elo columns for current skiers
INFO [2025-03-29 12:28:18] Replaced NAs in Distance_Elo with first quartile: 1237.38564383256
INFO [2025-03-29 12:28:18] Replaced NAs in Distance_C_Elo with first quartile: 1243.87329106944
INFO [2025-03-29 12:28:18] Replaced NAs in Distance_F_Elo with first quartile: 1256.69628195708
INFO [2025-03-29 12:28:18] Replaced NAs in Sprint_Elo with first quartile: 1246.32574824425
INFO [2025-03-29 12:28:18] Replaced NAs in Sprint_C_Elo with first quartile: 1257.67866787334
INFO [2025-03-29 12:28:18] Replaced NAs in Sprint_F_Elo with first quartile: 1244.84742904868
INFO [2025-03-29 12:28:18] Replaced NAs in Classic_Elo with first quartile: 1252.44868703669
INFO [2025-03-29 12:28:18] Replaced NAs in Freestyle_Elo with first quartile: 1244.44508230281
INFO [2025-03-29 12:28:18] Replaced NAs in Distance_Pelo with first quartile: 1241.11854419952
INFO [2025-03-29 12:28:18] Replaced NAs in Distance_C_Pelo with first quartile: 1245.57367555166
INFO [2025-03-29 12:28:18] Replaced NAs in Distance_F_Pelo with first quartile: 1259.54282973153
INFO [2025-03-29 12:28:18] Replaced NAs in Sprint_Pelo with first quartile: 1254.58885254623
INFO [2025-03-29 12:28:18] Replaced NAs in Sprint_C_Pelo with first quartile: 1257.58302026178
INFO [2025-03-29 12:28:18] Replaced NAs in Sprint_F_Pelo with first quartile: 1257.67755691493
INFO [2025-03-29 12:28:18] Replaced NAs in Classic_Pelo with first quartile: 1256.79275004544
INFO [2025-03-29 12:28:18] Replaced NAs in Freestyle_Pelo with first quartile: 1256.79999900008
INFO [2025-03-29 12:28:18] Replaced NAs in Classic_Last_5 with first quartile: 3.5
INFO [2025-03-29 12:28:18] Replaced NAs in Freestyle_Last_5 with first quartile: 2.4
INFO [2025-03-29 12:28:18] Created Pelo_Pct from Elo with max value: 1841.00191142018
INFO [2025-03-29 12:28:18] Created Distance_Pelo_Pct from Distance_Elo with max value: 1889.46974050597
INFO [2025-03-29 12:28:18] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1763.33572074398
INFO [2025-03-29 12:28:18] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1693.85026290322
INFO [2025-03-29 12:28:18] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1742.74758850835
INFO [2025-03-29 12:28:18] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1601.5820663103
INFO [2025-03-29 12:28:18] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1681.09824552997
INFO [2025-03-29 12:28:18] Created Classic_Pelo_Pct from Classic_Elo with max value: 1698.69428891549
INFO [2025-03-29 12:28:18] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1707.58410982918
INFO [2025-03-29 12:28:18] Prepared data for 255 ladies skiers with 33 features
INFO [2025-03-29 12:28:18] Using FIS startlist for ladies's leg predictions
INFO [2025-03-29 12:28:18] Using FIS startlist for ladies
INFO [2025-03-29 12:28:18] Attempting Option 1: Team model coefficients
INFO [2025-03-29 12:28:18] Option 1 failed: No team_podium model found
INFO [2025-03-29 12:28:18] Option 1 failed: No team model
INFO [2025-03-29 12:28:18] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 12:28:18] Leg 1 accuracy: 0.769230769230769
INFO [2025-03-29 12:28:18] Leg 2 accuracy: 0.833333333333333
INFO [2025-03-29 12:28:18] Leg 3 accuracy: 0.787179487179487
INFO [2025-03-29 12:28:18] Leg 4 accuracy: 0.795454545454545
INFO [2025-03-29 12:28:18] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 12:28:18] Leg importance weights: Leg 1: 0.24, Leg 2: 0.26, Leg 3: 0.25, Leg 4: 0.25
INFO [2025-03-29 12:28:18] Resetting men's probabilities at or below the mode to zero
INFO [2025-03-29 12:28:19] No values appear more than twice for Win_Prob
INFO [2025-03-29 12:28:19] No values appear more than twice for Podium_Prob
INFO [2025-03-29 12:28:19] No values appear more than twice for Top5_Prob
INFO [2025-03-29 12:28:19] No values appear more than twice for Top10_Prob
INFO [2025-03-29 12:28:19] Resetting ladies' probabilities at or below the mode to zero
INFO [2025-03-29 12:28:19] No values appear more than twice for Win_Prob
INFO [2025-03-29 12:28:19] No values appear more than twice for Podium_Prob
INFO [2025-03-29 12:28:19] No values appear more than twice for Top5_Prob
INFO [2025-03-29 12:28:19] No values appear more than twice for Top10_Prob
INFO [2025-03-29 12:28:19] Normalizing men's team probabilities
INFO [2025-03-29 12:28:19] Normalized Win_Prob from sum of 0.72 to 1
INFO [2025-03-29 12:28:19] Normalized Podium_Prob from sum of 2.34 to 3
INFO [2025-03-29 12:28:19] Normalized Top5_Prob from sum of 4.2 to 5
INFO [2025-03-29 12:28:19] Normalized Top10_Prob from sum of 10.33 to 10
INFO [2025-03-29 12:28:19] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 12:28:19] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 12:28:19] Normalizing ladies' team probabilities
INFO [2025-03-29 12:28:19] Normalized Win_Prob from sum of 1.12 to 1
INFO [2025-03-29 12:28:19] Normalized Podium_Prob from sum of 3.26 to 3
INFO [2025-03-29 12:28:19] Normalized Top5_Prob from sum of 4.51 to 5
INFO [2025-03-29 12:28:19] Normalized Top10_Prob from sum of 9.35 to 10
INFO [2025-03-29 12:28:19] Capped 2 values at 1 for Top5_Prob
INFO [2025-03-29 12:28:19] Capped 5 values at 1 for Top10_Prob
INFO [2025-03-29 12:28:19] Final capping of probabilities to maximum of 1
INFO [2025-03-29 12:28:19] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 12:28:19] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 12:28:19] Capped 2 values at 1 for Top5_Prob
INFO [2025-03-29 12:28:19] Capped 5 values at 1 for Top10_Prob
INFO [2025-03-29 12:28:19] Optimizing fantasy relay team
INFO [2025-03-29 12:28:19] Fantasy team optimization complete. Selected 12 teams.
INFO [2025-03-29 12:28:19] Total price: 99826 of max 1e+05
INFO [2025-03-29 12:28:19] Expected total points: 814.3
INFO [2025-03-29 12:28:19] Men's teams: 6 ( 6 )
INFO [2025-03-29 12:28:19] Ladies' teams: 6 ( 6 )
INFO [2025-03-29 12:28:19] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_points.xlsx
INFO [2025-03-29 12:28:19] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_probabilities.xlsx
INFO [2025-03-29 12:28:19] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_points.xlsx
INFO [2025-03-29 12:28:19] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_probabilities.xlsx
INFO [2025-03-29 12:28:19] Saved fantasy team results to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/fantasy_relay_team.xlsx
INFO [2025-03-29 12:28:19] Relay predictions completed successfully
INFO [2025-03-29 12:31:03] Starting relay predictions process
INFO [2025-03-29 12:31:03] Loading weekend race data
INFO [2025-03-29 12:31:03] Tomorrow's date: 2025-03-29
INFO [2025-03-29 12:31:03] Found 1 men's relay races and 1 ladies' relay races
INFO [2025-03-29 12:31:03] Loading chrono data
INFO [2025-03-29 12:31:09] Loaded men's chrono with 105122 rows and 36 columns
INFO [2025-03-29 12:31:09] Loaded ladies' chrono with 78706 rows and 36 columns
INFO [2025-03-29 12:31:09] Created men's relay df with 9688 rows
INFO [2025-03-29 12:31:09] Created men's individual df with 92143 rows
INFO [2025-03-29 12:31:09] Created ladies' relay df with 8019 rows
INFO [2025-03-29 12:31:09] Created ladies' individual df with 68253 rows
INFO [2025-03-29 12:31:13] Training models for Leg 1
INFO [2025-03-29 12:31:13] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:31:13] Training podium model using glm
INFO [2025-03-29 12:31:13] Training win model using glm
INFO [2025-03-29 12:31:14] Training top5 model using glm
INFO [2025-03-29 12:31:14] Training top10 model using glm
INFO [2025-03-29 12:31:14] Top features for Leg 1 podium prediction:
INFO [2025-03-29 12:31:14] Training models for Leg 2
INFO [2025-03-29 12:31:14] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:31:14] Training podium model using glm
INFO [2025-03-29 12:31:14] Training win model using glm
INFO [2025-03-29 12:31:14] Training top5 model using glm
INFO [2025-03-29 12:31:14] Training top10 model using glm
INFO [2025-03-29 12:31:14] Top features for Leg 2 podium prediction:
INFO [2025-03-29 12:31:14] Training models for Leg 3
INFO [2025-03-29 12:31:14] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:31:14] Training podium model using glm
INFO [2025-03-29 12:31:14] Training win model using glm
INFO [2025-03-29 12:31:14] Training top5 model using glm
INFO [2025-03-29 12:31:14] Training top10 model using glm
INFO [2025-03-29 12:31:14] Top features for Leg 3 podium prediction:
INFO [2025-03-29 12:31:14] Training models for Leg 4
INFO [2025-03-29 12:31:14] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:31:14] Training podium model using glm
INFO [2025-03-29 12:31:15] Training win model using glm
INFO [2025-03-29 12:31:15] Training top5 model using glm
INFO [2025-03-29 12:31:15] Training top10 model using glm
INFO [2025-03-29 12:31:15] Top features for Leg 4 podium prediction:
INFO [2025-03-29 12:31:15] Training models for Leg 1
INFO [2025-03-29 12:31:15] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:31:15] Training podium model using glm
INFO [2025-03-29 12:31:15] Training win model using glm
INFO [2025-03-29 12:31:15] Training top5 model using glm
INFO [2025-03-29 12:31:15] Training top10 model using glm
INFO [2025-03-29 12:31:15] Top features for Leg 1 podium prediction:
INFO [2025-03-29 12:31:15] Training models for Leg 2
INFO [2025-03-29 12:31:15] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:31:15] Training podium model using glm
INFO [2025-03-29 12:31:15] Training win model using glm
INFO [2025-03-29 12:31:15] Training top5 model using glm
INFO [2025-03-29 12:31:15] Training top10 model using glm
INFO [2025-03-29 12:31:15] Top features for Leg 2 podium prediction:
INFO [2025-03-29 12:31:15] Training models for Leg 3
INFO [2025-03-29 12:31:15] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:31:15] Training podium model using glm
INFO [2025-03-29 12:31:16] Training win model using glm
INFO [2025-03-29 12:31:16] Training top5 model using glm
INFO [2025-03-29 12:31:16] Training top10 model using glm
INFO [2025-03-29 12:31:16] Top features for Leg 3 podium prediction:
INFO [2025-03-29 12:31:16] Training models for Leg 4
INFO [2025-03-29 12:31:16] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:31:16] Training podium model using glm
INFO [2025-03-29 12:31:16] Training win model using glm
INFO [2025-03-29 12:31:16] Training top5 model using glm
INFO [2025-03-29 12:31:16] Training top10 model using glm
INFO [2025-03-29 12:31:16] Top features for Leg 4 podium prediction:
INFO [2025-03-29 12:31:16] Processing men's relay predictions
INFO [2025-03-29 12:31:16] Loaded men relay teams startlist with 24 rows
INFO [2025-03-29 12:31:16] Loaded men relay individuals startlist with 96 rows
INFO [2025-03-29 12:31:16] Preparing current men skier data
INFO [2025-03-29 12:31:16] Found 9 Elo columns for current skiers
INFO [2025-03-29 12:31:16] Replaced NAs in Distance_Elo with first quartile: 1207.23243912712
INFO [2025-03-29 12:31:16] Replaced NAs in Distance_C_Elo with first quartile: 1233.40200699225
INFO [2025-03-29 12:31:16] Replaced NAs in Distance_F_Elo with first quartile: 1236.48554062178
INFO [2025-03-29 12:31:16] Replaced NAs in Sprint_Elo with first quartile: 1223.60107000698
INFO [2025-03-29 12:31:16] Replaced NAs in Sprint_C_Elo with first quartile: 1241.28715500947
INFO [2025-03-29 12:31:16] Replaced NAs in Sprint_F_Elo with first quartile: 1234.45151108772
INFO [2025-03-29 12:31:16] Replaced NAs in Classic_Elo with first quartile: 1241.52867310024
INFO [2025-03-29 12:31:16] Replaced NAs in Freestyle_Elo with first quartile: 1228.48649348109
INFO [2025-03-29 12:31:16] Replaced NAs in Distance_Pelo with first quartile: 1211.63035979047
INFO [2025-03-29 12:31:16] Replaced NAs in Distance_C_Pelo with first quartile: 1234.81091928129
INFO [2025-03-29 12:31:16] Replaced NAs in Distance_F_Pelo with first quartile: 1239.65331180248
INFO [2025-03-29 12:31:16] Replaced NAs in Sprint_Pelo with first quartile: 1240.94751821383
INFO [2025-03-29 12:31:16] Replaced NAs in Sprint_C_Pelo with first quartile: 1241.28715500947
INFO [2025-03-29 12:31:16] Replaced NAs in Sprint_F_Pelo with first quartile: 1252.45166310493
INFO [2025-03-29 12:31:16] Replaced NAs in Classic_Pelo with first quartile: 1243.63746068082
INFO [2025-03-29 12:31:16] Replaced NAs in Freestyle_Pelo with first quartile: 1249.30280713791
INFO [2025-03-29 12:31:16] Replaced NAs in Classic_Last_5 with first quartile: 0
INFO [2025-03-29 12:31:16] Replaced NAs in Freestyle_Last_5 with first quartile: 0
INFO [2025-03-29 12:31:16] Created Pelo_Pct from Elo with max value: 1946.6211651574
INFO [2025-03-29 12:31:16] Created Distance_Pelo_Pct from Distance_Elo with max value: 1869.1251911742
INFO [2025-03-29 12:31:16] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1777.16297253153
INFO [2025-03-29 12:31:16] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1695.2053212904
INFO [2025-03-29 12:31:16] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1886.80363942481
INFO [2025-03-29 12:31:16] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1711.08486899169
INFO [2025-03-29 12:31:16] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1792.65157560707
INFO [2025-03-29 12:31:16] Created Classic_Pelo_Pct from Classic_Elo with max value: 1807.56773496777
INFO [2025-03-29 12:31:16] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1814.60460629541
INFO [2025-03-29 12:31:16] Prepared data for 381 men skiers with 33 features
INFO [2025-03-29 12:31:16] Using FIS startlist for men's leg predictions
INFO [2025-03-29 12:31:17] Using FIS startlist for men
INFO [2025-03-29 12:31:17] Attempting Option 1: Team model coefficients
INFO [2025-03-29 12:31:17] Option 1 failed: No team_podium model found
INFO [2025-03-29 12:31:17] Option 1 failed: No team model
INFO [2025-03-29 12:31:17] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 12:31:17] Leg 1 accuracy: 0.854615234755504
INFO [2025-03-29 12:31:17] Leg 2 accuracy: 0.840995519189558
INFO [2025-03-29 12:31:17] Leg 3 accuracy: 0.860358464835379
INFO [2025-03-29 12:31:17] Leg 4 accuracy: 0.885008766803039
INFO [2025-03-29 12:31:17] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 12:31:17] Leg importance weights: Leg 1: 0.25, Leg 2: 0.24, Leg 3: 0.25, Leg 4: 0.26
INFO [2025-03-29 12:31:17] Processing ladies's relay predictions
INFO [2025-03-29 12:31:17] Loaded ladies relay teams startlist with 20 rows
INFO [2025-03-29 12:31:17] Loaded ladies relay individuals startlist with 80 rows
INFO [2025-03-29 12:31:17] Preparing current ladies skier data
INFO [2025-03-29 12:31:17] Found 9 Elo columns for current skiers
INFO [2025-03-29 12:31:17] Replaced NAs in Distance_Elo with first quartile: 1237.38564383256
INFO [2025-03-29 12:31:17] Replaced NAs in Distance_C_Elo with first quartile: 1243.87329106944
INFO [2025-03-29 12:31:17] Replaced NAs in Distance_F_Elo with first quartile: 1256.69628195708
INFO [2025-03-29 12:31:17] Replaced NAs in Sprint_Elo with first quartile: 1246.32574824425
INFO [2025-03-29 12:31:17] Replaced NAs in Sprint_C_Elo with first quartile: 1257.67866787334
INFO [2025-03-29 12:31:17] Replaced NAs in Sprint_F_Elo with first quartile: 1244.84742904868
INFO [2025-03-29 12:31:17] Replaced NAs in Classic_Elo with first quartile: 1252.44868703669
INFO [2025-03-29 12:31:17] Replaced NAs in Freestyle_Elo with first quartile: 1244.44508230281
INFO [2025-03-29 12:31:17] Replaced NAs in Distance_Pelo with first quartile: 1241.11854419952
INFO [2025-03-29 12:31:17] Replaced NAs in Distance_C_Pelo with first quartile: 1245.57367555166
INFO [2025-03-29 12:31:17] Replaced NAs in Distance_F_Pelo with first quartile: 1259.54282973153
INFO [2025-03-29 12:31:17] Replaced NAs in Sprint_Pelo with first quartile: 1254.58885254623
INFO [2025-03-29 12:31:17] Replaced NAs in Sprint_C_Pelo with first quartile: 1257.58302026178
INFO [2025-03-29 12:31:17] Replaced NAs in Sprint_F_Pelo with first quartile: 1257.67755691493
INFO [2025-03-29 12:31:17] Replaced NAs in Classic_Pelo with first quartile: 1256.79275004544
INFO [2025-03-29 12:31:17] Replaced NAs in Freestyle_Pelo with first quartile: 1256.79999900008
INFO [2025-03-29 12:31:17] Replaced NAs in Classic_Last_5 with first quartile: 3.5
INFO [2025-03-29 12:31:17] Replaced NAs in Freestyle_Last_5 with first quartile: 2.4
INFO [2025-03-29 12:31:17] Created Pelo_Pct from Elo with max value: 1841.00191142018
INFO [2025-03-29 12:31:17] Created Distance_Pelo_Pct from Distance_Elo with max value: 1889.46974050597
INFO [2025-03-29 12:31:17] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1763.33572074398
INFO [2025-03-29 12:31:17] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1693.85026290322
INFO [2025-03-29 12:31:17] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1742.74758850835
INFO [2025-03-29 12:31:17] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1601.5820663103
INFO [2025-03-29 12:31:17] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1681.09824552997
INFO [2025-03-29 12:31:17] Created Classic_Pelo_Pct from Classic_Elo with max value: 1698.69428891549
INFO [2025-03-29 12:31:17] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1707.58410982918
INFO [2025-03-29 12:31:17] Prepared data for 255 ladies skiers with 33 features
INFO [2025-03-29 12:31:17] Using FIS startlist for ladies's leg predictions
INFO [2025-03-29 12:31:17] Using FIS startlist for ladies
INFO [2025-03-29 12:31:17] Attempting Option 1: Team model coefficients
INFO [2025-03-29 12:31:17] Option 1 failed: No team_podium model found
INFO [2025-03-29 12:31:17] Option 1 failed: No team model
INFO [2025-03-29 12:31:17] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 12:31:17] Leg 1 accuracy: 0.721794871794872
INFO [2025-03-29 12:31:17] Leg 2 accuracy: 0.866666666666667
INFO [2025-03-29 12:31:17] Leg 3 accuracy: 0.835897435897436
INFO [2025-03-29 12:31:17] Leg 4 accuracy: 0.762121212121212
INFO [2025-03-29 12:31:17] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 12:31:17] Leg importance weights: Leg 1: 0.23, Leg 2: 0.27, Leg 3: 0.26, Leg 4: 0.24
INFO [2025-03-29 12:31:17] Resetting men's probabilities at or below the mode to zero
INFO [2025-03-29 12:31:17] No values appear more than twice for Win_Prob
INFO [2025-03-29 12:31:17] No values appear more than twice for Podium_Prob
INFO [2025-03-29 12:31:17] No values appear more than twice for Top5_Prob
INFO [2025-03-29 12:31:17] No values appear more than twice for Top10_Prob
INFO [2025-03-29 12:31:17] Resetting ladies' probabilities at or below the mode to zero
INFO [2025-03-29 12:31:17] No values appear more than twice for Win_Prob
INFO [2025-03-29 12:31:17] No values appear more than twice for Podium_Prob
INFO [2025-03-29 12:31:17] No values appear more than twice for Top5_Prob
INFO [2025-03-29 12:31:17] No values appear more than twice for Top10_Prob
INFO [2025-03-29 12:31:17] Normalizing men's team probabilities
INFO [2025-03-29 12:31:17] Normalized Win_Prob from sum of 0.72 to 1
INFO [2025-03-29 12:31:17] Normalized Podium_Prob from sum of 2.34 to 3
INFO [2025-03-29 12:31:17] Normalized Top5_Prob from sum of 4.2 to 5
INFO [2025-03-29 12:31:17] Normalized Top10_Prob from sum of 10.33 to 10
INFO [2025-03-29 12:31:17] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 12:31:17] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 12:31:17] Normalizing ladies' team probabilities
INFO [2025-03-29 12:31:17] Normalized Win_Prob from sum of 1.12 to 1
INFO [2025-03-29 12:31:17] Normalized Podium_Prob from sum of 3.25 to 3
INFO [2025-03-29 12:31:17] Normalized Top5_Prob from sum of 4.49 to 5
INFO [2025-03-29 12:31:17] Normalized Top10_Prob from sum of 9.35 to 10
INFO [2025-03-29 12:31:17] Capped 2 values at 1 for Top5_Prob
INFO [2025-03-29 12:31:17] Capped 5 values at 1 for Top10_Prob
INFO [2025-03-29 12:31:17] Final capping of probabilities to maximum of 1
INFO [2025-03-29 12:31:17] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 12:31:17] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 12:31:17] Capped 2 values at 1 for Top5_Prob
INFO [2025-03-29 12:31:17] Capped 5 values at 1 for Top10_Prob
INFO [2025-03-29 12:31:17] Optimizing fantasy relay team
INFO [2025-03-29 12:31:17] Fantasy team optimization complete. Selected 12 teams.
INFO [2025-03-29 12:31:17] Total price: 99826 of max 1e+05
INFO [2025-03-29 12:31:17] Expected total points: 817.1
INFO [2025-03-29 12:31:17] Men's teams: 6 ( 6 )
INFO [2025-03-29 12:31:17] Ladies' teams: 6 ( 6 )
INFO [2025-03-29 12:31:17] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_points.xlsx
INFO [2025-03-29 12:31:17] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_probabilities.xlsx
INFO [2025-03-29 12:31:17] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_points.xlsx
INFO [2025-03-29 12:31:17] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_probabilities.xlsx
INFO [2025-03-29 12:31:18] Saved fantasy team results to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/fantasy_relay_team.xlsx
INFO [2025-03-29 12:31:18] Relay predictions completed successfully
INFO [2025-03-29 12:32:09] Starting relay predictions process
INFO [2025-03-29 12:32:10] Loading weekend race data
INFO [2025-03-29 12:32:10] Tomorrow's date: 2025-03-29
INFO [2025-03-29 12:32:10] Found 1 men's relay races and 1 ladies' relay races
INFO [2025-03-29 12:32:10] Loading chrono data
INFO [2025-03-29 12:32:15] Loaded men's chrono with 105122 rows and 36 columns
INFO [2025-03-29 12:32:15] Loaded ladies' chrono with 78706 rows and 36 columns
INFO [2025-03-29 12:32:15] Created men's relay df with 9688 rows
INFO [2025-03-29 12:32:15] Created men's individual df with 92143 rows
INFO [2025-03-29 12:32:15] Created ladies' relay df with 8019 rows
INFO [2025-03-29 12:32:15] Created ladies' individual df with 68253 rows
INFO [2025-03-29 12:32:20] Training models for Leg 1
INFO [2025-03-29 12:32:20] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:32:20] Training podium model using glm
INFO [2025-03-29 12:32:20] Training win model using glm
INFO [2025-03-29 12:32:20] Training top5 model using glm
INFO [2025-03-29 12:32:20] Training top10 model using glm
INFO [2025-03-29 12:32:20] Top features for Leg 1 podium prediction:
INFO [2025-03-29 12:32:20] Training models for Leg 2
INFO [2025-03-29 12:32:20] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:32:20] Training podium model using glm
INFO [2025-03-29 12:32:20] Training win model using glm
INFO [2025-03-29 12:32:20] Training top5 model using glm
INFO [2025-03-29 12:32:20] Training top10 model using glm
INFO [2025-03-29 12:32:20] Top features for Leg 2 podium prediction:
INFO [2025-03-29 12:32:20] Training models for Leg 3
INFO [2025-03-29 12:32:20] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:32:20] Training podium model using glm
INFO [2025-03-29 12:32:20] Training win model using glm
INFO [2025-03-29 12:32:21] Training top5 model using glm
INFO [2025-03-29 12:32:21] Training top10 model using glm
INFO [2025-03-29 12:32:21] Top features for Leg 3 podium prediction:
INFO [2025-03-29 12:32:21] Training models for Leg 4
INFO [2025-03-29 12:32:21] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:32:21] Training podium model using glm
INFO [2025-03-29 12:32:21] Training win model using glm
INFO [2025-03-29 12:32:21] Training top5 model using glm
INFO [2025-03-29 12:32:21] Training top10 model using glm
INFO [2025-03-29 12:32:21] Top features for Leg 4 podium prediction:
INFO [2025-03-29 12:32:21] Training models for Leg 1
INFO [2025-03-29 12:32:21] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:32:21] Training podium model using glm
INFO [2025-03-29 12:32:21] Training win model using glm
INFO [2025-03-29 12:32:21] Training top5 model using glm
INFO [2025-03-29 12:32:21] Training top10 model using glm
INFO [2025-03-29 12:32:21] Top features for Leg 1 podium prediction:
INFO [2025-03-29 12:32:21] Training models for Leg 2
INFO [2025-03-29 12:32:21] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:32:21] Training podium model using glm
INFO [2025-03-29 12:32:21] Training win model using glm
INFO [2025-03-29 12:32:22] Training top5 model using glm
INFO [2025-03-29 12:32:22] Training top10 model using glm
INFO [2025-03-29 12:32:22] Top features for Leg 2 podium prediction:
INFO [2025-03-29 12:32:22] Training models for Leg 3
INFO [2025-03-29 12:32:22] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:32:22] Training podium model using glm
INFO [2025-03-29 12:32:22] Training win model using glm
INFO [2025-03-29 12:32:22] Training top5 model using glm
INFO [2025-03-29 12:32:22] Training top10 model using glm
INFO [2025-03-29 12:32:22] Top features for Leg 3 podium prediction:
INFO [2025-03-29 12:32:22] Training models for Leg 4
INFO [2025-03-29 12:32:22] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:32:22] Training podium model using glm
INFO [2025-03-29 12:32:22] Training win model using glm
INFO [2025-03-29 12:32:22] Training top5 model using glm
INFO [2025-03-29 12:32:22] Training top10 model using glm
INFO [2025-03-29 12:32:22] Top features for Leg 4 podium prediction:
INFO [2025-03-29 12:32:22] Processing men's relay predictions
INFO [2025-03-29 12:32:22] Loaded men relay teams startlist with 24 rows
INFO [2025-03-29 12:32:22] Loaded men relay individuals startlist with 96 rows
INFO [2025-03-29 12:32:22] Preparing current men skier data
INFO [2025-03-29 12:32:22] Found 9 Elo columns for current skiers
INFO [2025-03-29 12:32:23] Replaced NAs in Distance_Elo with first quartile: 1207.23243912712
INFO [2025-03-29 12:32:23] Replaced NAs in Distance_C_Elo with first quartile: 1233.40200699225
INFO [2025-03-29 12:32:23] Replaced NAs in Distance_F_Elo with first quartile: 1236.48554062178
INFO [2025-03-29 12:32:23] Replaced NAs in Sprint_Elo with first quartile: 1223.60107000698
INFO [2025-03-29 12:32:23] Replaced NAs in Sprint_C_Elo with first quartile: 1241.28715500947
INFO [2025-03-29 12:32:23] Replaced NAs in Sprint_F_Elo with first quartile: 1234.45151108772
INFO [2025-03-29 12:32:23] Replaced NAs in Classic_Elo with first quartile: 1241.52867310024
INFO [2025-03-29 12:32:23] Replaced NAs in Freestyle_Elo with first quartile: 1228.48649348109
INFO [2025-03-29 12:32:23] Replaced NAs in Distance_Pelo with first quartile: 1211.63035979047
INFO [2025-03-29 12:32:23] Replaced NAs in Distance_C_Pelo with first quartile: 1234.81091928129
INFO [2025-03-29 12:32:23] Replaced NAs in Distance_F_Pelo with first quartile: 1239.65331180248
INFO [2025-03-29 12:32:23] Replaced NAs in Sprint_Pelo with first quartile: 1240.94751821383
INFO [2025-03-29 12:32:23] Replaced NAs in Sprint_C_Pelo with first quartile: 1241.28715500947
INFO [2025-03-29 12:32:23] Replaced NAs in Sprint_F_Pelo with first quartile: 1252.45166310493
INFO [2025-03-29 12:32:23] Replaced NAs in Classic_Pelo with first quartile: 1243.63746068082
INFO [2025-03-29 12:32:23] Replaced NAs in Freestyle_Pelo with first quartile: 1249.30280713791
INFO [2025-03-29 12:32:23] Replaced NAs in Classic_Last_5 with first quartile: 0
INFO [2025-03-29 12:32:23] Replaced NAs in Freestyle_Last_5 with first quartile: 0
INFO [2025-03-29 12:32:23] Created Pelo_Pct from Elo with max value: 1946.6211651574
INFO [2025-03-29 12:32:23] Created Distance_Pelo_Pct from Distance_Elo with max value: 1869.1251911742
INFO [2025-03-29 12:32:23] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1777.16297253153
INFO [2025-03-29 12:32:23] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1695.2053212904
INFO [2025-03-29 12:32:23] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1886.80363942481
INFO [2025-03-29 12:32:23] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1711.08486899169
INFO [2025-03-29 12:32:23] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1792.65157560707
INFO [2025-03-29 12:32:23] Created Classic_Pelo_Pct from Classic_Elo with max value: 1807.56773496777
INFO [2025-03-29 12:32:23] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1814.60460629541
INFO [2025-03-29 12:32:23] Prepared data for 381 men skiers with 33 features
INFO [2025-03-29 12:32:23] Using FIS startlist for men's leg predictions
INFO [2025-03-29 12:32:23] Using FIS startlist for men
INFO [2025-03-29 12:32:23] Attempting Option 1: Team model coefficients
INFO [2025-03-29 12:32:23] Option 1 failed: No team_podium model found
INFO [2025-03-29 12:32:23] Option 1 failed: No team model
INFO [2025-03-29 12:32:23] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 12:32:23] Leg 1 accuracy: 0.854689265536723
INFO [2025-03-29 12:32:23] Leg 2 accuracy: 0.837853107344633
INFO [2025-03-29 12:32:23] Leg 3 accuracy: 0.863978180401325
INFO [2025-03-29 12:32:23] Leg 4 accuracy: 0.884745762711864
INFO [2025-03-29 12:32:23] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 12:32:23] Leg importance weights: Leg 1: 0.25, Leg 2: 0.24, Leg 3: 0.25, Leg 4: 0.26
INFO [2025-03-29 12:32:23] Processing ladies's relay predictions
INFO [2025-03-29 12:32:23] Loaded ladies relay teams startlist with 20 rows
INFO [2025-03-29 12:32:23] Loaded ladies relay individuals startlist with 80 rows
INFO [2025-03-29 12:32:23] Preparing current ladies skier data
INFO [2025-03-29 12:32:23] Found 9 Elo columns for current skiers
INFO [2025-03-29 12:32:23] Replaced NAs in Distance_Elo with first quartile: 1237.38564383256
INFO [2025-03-29 12:32:23] Replaced NAs in Distance_C_Elo with first quartile: 1243.87329106944
INFO [2025-03-29 12:32:23] Replaced NAs in Distance_F_Elo with first quartile: 1256.69628195708
INFO [2025-03-29 12:32:23] Replaced NAs in Sprint_Elo with first quartile: 1246.32574824425
INFO [2025-03-29 12:32:23] Replaced NAs in Sprint_C_Elo with first quartile: 1257.67866787334
INFO [2025-03-29 12:32:23] Replaced NAs in Sprint_F_Elo with first quartile: 1244.84742904868
INFO [2025-03-29 12:32:23] Replaced NAs in Classic_Elo with first quartile: 1252.44868703669
INFO [2025-03-29 12:32:23] Replaced NAs in Freestyle_Elo with first quartile: 1244.44508230281
INFO [2025-03-29 12:32:23] Replaced NAs in Distance_Pelo with first quartile: 1241.11854419952
INFO [2025-03-29 12:32:23] Replaced NAs in Distance_C_Pelo with first quartile: 1245.57367555166
INFO [2025-03-29 12:32:23] Replaced NAs in Distance_F_Pelo with first quartile: 1259.54282973153
INFO [2025-03-29 12:32:23] Replaced NAs in Sprint_Pelo with first quartile: 1254.58885254623
INFO [2025-03-29 12:32:23] Replaced NAs in Sprint_C_Pelo with first quartile: 1257.58302026178
INFO [2025-03-29 12:32:23] Replaced NAs in Sprint_F_Pelo with first quartile: 1257.67755691493
INFO [2025-03-29 12:32:23] Replaced NAs in Classic_Pelo with first quartile: 1256.79275004544
INFO [2025-03-29 12:32:23] Replaced NAs in Freestyle_Pelo with first quartile: 1256.79999900008
INFO [2025-03-29 12:32:23] Replaced NAs in Classic_Last_5 with first quartile: 3.5
INFO [2025-03-29 12:32:23] Replaced NAs in Freestyle_Last_5 with first quartile: 2.4
INFO [2025-03-29 12:32:23] Created Pelo_Pct from Elo with max value: 1841.00191142018
INFO [2025-03-29 12:32:23] Created Distance_Pelo_Pct from Distance_Elo with max value: 1889.46974050597
INFO [2025-03-29 12:32:23] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1763.33572074398
INFO [2025-03-29 12:32:23] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1693.85026290322
INFO [2025-03-29 12:32:23] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1742.74758850835
INFO [2025-03-29 12:32:23] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1601.5820663103
INFO [2025-03-29 12:32:23] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1681.09824552997
INFO [2025-03-29 12:32:23] Created Classic_Pelo_Pct from Classic_Elo with max value: 1698.69428891549
INFO [2025-03-29 12:32:23] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1707.58410982918
INFO [2025-03-29 12:32:23] Prepared data for 255 ladies skiers with 33 features
INFO [2025-03-29 12:32:23] Using FIS startlist for ladies's leg predictions
INFO [2025-03-29 12:32:23] Using FIS startlist for ladies
INFO [2025-03-29 12:32:23] Attempting Option 1: Team model coefficients
INFO [2025-03-29 12:32:23] Option 1 failed: No team_podium model found
INFO [2025-03-29 12:32:23] Option 1 failed: No team model
INFO [2025-03-29 12:32:23] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 12:32:23] Leg 1 accuracy: 0.787179487179487
INFO [2025-03-29 12:32:23] Leg 2 accuracy: 0.8
INFO [2025-03-29 12:32:23] Leg 3 accuracy: 0.8
INFO [2025-03-29 12:32:23] Leg 4 accuracy: 0.813636363636364
INFO [2025-03-29 12:32:23] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 12:32:23] Leg importance weights: Leg 1: 0.25, Leg 2: 0.25, Leg 3: 0.25, Leg 4: 0.25
INFO [2025-03-29 12:32:23] Resetting men's probabilities at or below the mode to zero
INFO [2025-03-29 12:32:23] No values appear more than twice for Win_Prob
INFO [2025-03-29 12:32:23] No values appear more than twice for Podium_Prob
INFO [2025-03-29 12:32:23] No values appear more than twice for Top5_Prob
INFO [2025-03-29 12:32:23] No values appear more than twice for Top10_Prob
INFO [2025-03-29 12:32:23] Resetting ladies' probabilities at or below the mode to zero
INFO [2025-03-29 12:32:23] Reset 3 values to 0 for Win_Prob (repeated values or values <  0 )
INFO [2025-03-29 12:32:23] Repeated values: 0
INFO [2025-03-29 12:32:23] No values appear more than twice for Podium_Prob
INFO [2025-03-29 12:32:23] No values appear more than twice for Top5_Prob
INFO [2025-03-29 12:32:23] No values appear more than twice for Top10_Prob
INFO [2025-03-29 12:32:23] Normalizing men's team probabilities
INFO [2025-03-29 12:32:23] Normalized Win_Prob from sum of 0.71 to 1
INFO [2025-03-29 12:32:23] Normalized Podium_Prob from sum of 2.34 to 3
INFO [2025-03-29 12:32:23] Normalized Top5_Prob from sum of 4.2 to 5
INFO [2025-03-29 12:32:23] Normalized Top10_Prob from sum of 10.33 to 10
INFO [2025-03-29 12:32:23] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 12:32:23] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 12:32:23] Normalizing ladies' team probabilities
INFO [2025-03-29 12:32:23] Normalized Win_Prob from sum of 1.11 to 1
INFO [2025-03-29 12:32:23] Normalized Podium_Prob from sum of 3.26 to 3
INFO [2025-03-29 12:32:23] Normalized Top5_Prob from sum of 4.51 to 5
INFO [2025-03-29 12:32:23] Normalized Top10_Prob from sum of 9.35 to 10
INFO [2025-03-29 12:32:23] Capped 2 values at 1 for Top5_Prob
INFO [2025-03-29 12:32:23] Capped 5 values at 1 for Top10_Prob
INFO [2025-03-29 12:32:23] Final capping of probabilities to maximum of 1
INFO [2025-03-29 12:32:23] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 12:32:23] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 12:32:23] Capped 2 values at 1 for Top5_Prob
INFO [2025-03-29 12:32:23] Capped 5 values at 1 for Top10_Prob
INFO [2025-03-29 12:32:23] Optimizing fantasy relay team
INFO [2025-03-29 12:32:23] Fantasy team optimization complete. Selected 12 teams.
INFO [2025-03-29 12:32:23] Total price: 99826 of max 1e+05
INFO [2025-03-29 12:32:23] Expected total points: 812.6
INFO [2025-03-29 12:32:23] Men's teams: 6 ( 6 )
INFO [2025-03-29 12:32:23] Ladies' teams: 6 ( 6 )
INFO [2025-03-29 12:32:23] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_points.xlsx
INFO [2025-03-29 12:32:23] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_probabilities.xlsx
INFO [2025-03-29 12:32:23] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_points.xlsx
INFO [2025-03-29 12:32:23] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_probabilities.xlsx
INFO [2025-03-29 12:32:23] Saved fantasy team results to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/fantasy_relay_team.xlsx
INFO [2025-03-29 12:32:23] Relay predictions completed successfully
INFO [2025-03-29 12:34:43] Starting relay predictions process
INFO [2025-03-29 12:34:43] Loading weekend race data
INFO [2025-03-29 12:34:43] Tomorrow's date: 2025-03-29
INFO [2025-03-29 12:34:43] Found 1 men's relay races and 1 ladies' relay races
INFO [2025-03-29 12:34:43] Loading chrono data
INFO [2025-03-29 12:34:48] Loaded men's chrono with 105122 rows and 36 columns
INFO [2025-03-29 12:34:48] Loaded ladies' chrono with 78706 rows and 36 columns
INFO [2025-03-29 12:34:48] Created men's relay df with 9688 rows
INFO [2025-03-29 12:34:48] Created men's individual df with 92143 rows
INFO [2025-03-29 12:34:48] Created ladies' relay df with 8019 rows
INFO [2025-03-29 12:34:48] Created ladies' individual df with 68253 rows
INFO [2025-03-29 12:34:53] Training models for Leg 1
INFO [2025-03-29 12:34:53] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:34:53] Training podium model using glm
INFO [2025-03-29 12:34:53] Training win model using glm
INFO [2025-03-29 12:34:53] Training top5 model using glm
INFO [2025-03-29 12:34:53] Training top10 model using glm
INFO [2025-03-29 12:34:53] Top features for Leg 1 podium prediction:
INFO [2025-03-29 12:34:53] Training models for Leg 2
INFO [2025-03-29 12:34:54] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:34:54] Training podium model using glm
INFO [2025-03-29 12:34:54] Training win model using glm
INFO [2025-03-29 12:34:54] Training top5 model using glm
INFO [2025-03-29 12:34:54] Training top10 model using glm
INFO [2025-03-29 12:34:54] Top features for Leg 2 podium prediction:
INFO [2025-03-29 12:34:54] Training models for Leg 3
INFO [2025-03-29 12:34:54] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:34:54] Training podium model using glm
INFO [2025-03-29 12:34:54] Training win model using glm
INFO [2025-03-29 12:34:54] Training top5 model using glm
INFO [2025-03-29 12:34:54] Training top10 model using glm
INFO [2025-03-29 12:34:54] Top features for Leg 3 podium prediction:
INFO [2025-03-29 12:34:54] Training models for Leg 4
INFO [2025-03-29 12:34:54] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:34:54] Training podium model using glm
INFO [2025-03-29 12:34:54] Training win model using glm
INFO [2025-03-29 12:34:54] Training top5 model using glm
INFO [2025-03-29 12:34:54] Training top10 model using glm
INFO [2025-03-29 12:34:54] Top features for Leg 4 podium prediction:
INFO [2025-03-29 12:34:54] Training models for Leg 1
INFO [2025-03-29 12:34:54] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:34:54] Training podium model using glm
INFO [2025-03-29 12:34:55] Training win model using glm
INFO [2025-03-29 12:34:55] Training top5 model using glm
INFO [2025-03-29 12:34:55] Training top10 model using glm
INFO [2025-03-29 12:34:55] Top features for Leg 1 podium prediction:
INFO [2025-03-29 12:34:55] Training models for Leg 2
INFO [2025-03-29 12:34:55] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:34:55] Training podium model using glm
INFO [2025-03-29 12:34:55] Training win model using glm
INFO [2025-03-29 12:34:55] Training top5 model using glm
INFO [2025-03-29 12:34:55] Training top10 model using glm
INFO [2025-03-29 12:34:55] Top features for Leg 2 podium prediction:
INFO [2025-03-29 12:34:55] Training models for Leg 3
INFO [2025-03-29 12:34:55] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:34:55] Training podium model using glm
INFO [2025-03-29 12:34:55] Training win model using glm
INFO [2025-03-29 12:34:55] Training top5 model using glm
INFO [2025-03-29 12:34:55] Training top10 model using glm
INFO [2025-03-29 12:34:55] Top features for Leg 3 podium prediction:
INFO [2025-03-29 12:34:55] Training models for Leg 4
INFO [2025-03-29 12:34:55] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:34:55] Training podium model using glm
INFO [2025-03-29 12:34:55] Training win model using glm
INFO [2025-03-29 12:34:56] Training top5 model using glm
INFO [2025-03-29 12:34:56] Training top10 model using glm
INFO [2025-03-29 12:34:56] Top features for Leg 4 podium prediction:
INFO [2025-03-29 12:34:56] Processing men's relay predictions
INFO [2025-03-29 12:34:56] Loaded men relay teams startlist with 24 rows
INFO [2025-03-29 12:34:56] Loaded men relay individuals startlist with 96 rows
INFO [2025-03-29 12:34:56] Preparing current men skier data
INFO [2025-03-29 12:34:56] Found 9 Elo columns for current skiers
INFO [2025-03-29 12:34:56] Replaced NAs in Distance_Elo with first quartile: 1207.23243912712
INFO [2025-03-29 12:34:56] Replaced NAs in Distance_C_Elo with first quartile: 1233.40200699225
INFO [2025-03-29 12:34:56] Replaced NAs in Distance_F_Elo with first quartile: 1236.48554062178
INFO [2025-03-29 12:34:56] Replaced NAs in Sprint_Elo with first quartile: 1223.60107000698
INFO [2025-03-29 12:34:56] Replaced NAs in Sprint_C_Elo with first quartile: 1241.28715500947
INFO [2025-03-29 12:34:56] Replaced NAs in Sprint_F_Elo with first quartile: 1234.45151108772
INFO [2025-03-29 12:34:56] Replaced NAs in Classic_Elo with first quartile: 1241.52867310024
INFO [2025-03-29 12:34:56] Replaced NAs in Freestyle_Elo with first quartile: 1228.48649348109
INFO [2025-03-29 12:34:56] Replaced NAs in Distance_Pelo with first quartile: 1211.63035979047
INFO [2025-03-29 12:34:56] Replaced NAs in Distance_C_Pelo with first quartile: 1234.81091928129
INFO [2025-03-29 12:34:56] Replaced NAs in Distance_F_Pelo with first quartile: 1239.65331180248
INFO [2025-03-29 12:34:56] Replaced NAs in Sprint_Pelo with first quartile: 1240.94751821383
INFO [2025-03-29 12:34:56] Replaced NAs in Sprint_C_Pelo with first quartile: 1241.28715500947
INFO [2025-03-29 12:34:56] Replaced NAs in Sprint_F_Pelo with first quartile: 1252.45166310493
INFO [2025-03-29 12:34:56] Replaced NAs in Classic_Pelo with first quartile: 1243.63746068082
INFO [2025-03-29 12:34:56] Replaced NAs in Freestyle_Pelo with first quartile: 1249.30280713791
INFO [2025-03-29 12:34:56] Replaced NAs in Classic_Last_5 with first quartile: 0
INFO [2025-03-29 12:34:56] Replaced NAs in Freestyle_Last_5 with first quartile: 0
INFO [2025-03-29 12:34:56] Created Pelo_Pct from Elo with max value: 1946.6211651574
INFO [2025-03-29 12:34:56] Created Distance_Pelo_Pct from Distance_Elo with max value: 1869.1251911742
INFO [2025-03-29 12:34:56] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1777.16297253153
INFO [2025-03-29 12:34:56] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1695.2053212904
INFO [2025-03-29 12:34:56] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1886.80363942481
INFO [2025-03-29 12:34:56] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1711.08486899169
INFO [2025-03-29 12:34:56] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1792.65157560707
INFO [2025-03-29 12:34:56] Created Classic_Pelo_Pct from Classic_Elo with max value: 1807.56773496777
INFO [2025-03-29 12:34:56] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1814.60460629541
INFO [2025-03-29 12:34:56] Prepared data for 381 men skiers with 33 features
INFO [2025-03-29 12:34:56] Using FIS startlist for men's leg predictions
INFO [2025-03-29 12:34:56] Using FIS startlist for men
INFO [2025-03-29 12:34:56] Attempting Option 1: Team model coefficients
INFO [2025-03-29 12:34:56] Option 1 failed: No team_podium model found
INFO [2025-03-29 12:34:56] Option 1 failed: No team model
INFO [2025-03-29 12:34:56] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 12:34:56] Leg 1 accuracy: 0.854441846873174
INFO [2025-03-29 12:34:56] Leg 2 accuracy: 0.83774011299435
INFO [2025-03-29 12:34:56] Leg 3 accuracy: 0.864040522111825
INFO [2025-03-29 12:34:56] Leg 4 accuracy: 0.891340346775765
INFO [2025-03-29 12:34:56] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 12:34:56] Leg importance weights: Leg 1: 0.25, Leg 2: 0.24, Leg 3: 0.25, Leg 4: 0.26
INFO [2025-03-29 12:34:56] Processing ladies's relay predictions
INFO [2025-03-29 12:34:56] Loaded ladies relay teams startlist with 35 rows
INFO [2025-03-29 12:34:56] Loaded ladies relay individuals startlist with 231 rows
INFO [2025-03-29 12:34:56] Preparing current ladies skier data
INFO [2025-03-29 12:34:56] Found 9 Elo columns for current skiers
INFO [2025-03-29 12:34:56] Replaced NAs in Distance_Elo with first quartile: 1237.38564383256
INFO [2025-03-29 12:34:56] Replaced NAs in Distance_C_Elo with first quartile: 1243.87329106944
INFO [2025-03-29 12:34:56] Replaced NAs in Distance_F_Elo with first quartile: 1256.69628195708
INFO [2025-03-29 12:34:56] Replaced NAs in Sprint_Elo with first quartile: 1246.32574824425
INFO [2025-03-29 12:34:56] Replaced NAs in Sprint_C_Elo with first quartile: 1257.67866787334
INFO [2025-03-29 12:34:56] Replaced NAs in Sprint_F_Elo with first quartile: 1244.84742904868
INFO [2025-03-29 12:34:56] Replaced NAs in Classic_Elo with first quartile: 1252.44868703669
INFO [2025-03-29 12:34:56] Replaced NAs in Freestyle_Elo with first quartile: 1244.44508230281
INFO [2025-03-29 12:34:56] Replaced NAs in Distance_Pelo with first quartile: 1241.11854419952
INFO [2025-03-29 12:34:56] Replaced NAs in Distance_C_Pelo with first quartile: 1245.57367555166
INFO [2025-03-29 12:34:56] Replaced NAs in Distance_F_Pelo with first quartile: 1259.54282973153
INFO [2025-03-29 12:34:56] Replaced NAs in Sprint_Pelo with first quartile: 1254.58885254623
INFO [2025-03-29 12:34:56] Replaced NAs in Sprint_C_Pelo with first quartile: 1257.58302026178
INFO [2025-03-29 12:34:56] Replaced NAs in Sprint_F_Pelo with first quartile: 1257.67755691493
INFO [2025-03-29 12:34:56] Replaced NAs in Classic_Pelo with first quartile: 1256.79275004544
INFO [2025-03-29 12:34:56] Replaced NAs in Freestyle_Pelo with first quartile: 1256.79999900008
INFO [2025-03-29 12:34:56] Replaced NAs in Classic_Last_5 with first quartile: 3.5
INFO [2025-03-29 12:34:56] Replaced NAs in Freestyle_Last_5 with first quartile: 2.4
INFO [2025-03-29 12:34:56] Created Pelo_Pct from Elo with max value: 1841.00191142018
INFO [2025-03-29 12:34:56] Created Distance_Pelo_Pct from Distance_Elo with max value: 1889.46974050597
INFO [2025-03-29 12:34:56] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1763.33572074398
INFO [2025-03-29 12:34:56] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1693.85026290322
INFO [2025-03-29 12:34:56] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1742.74758850835
INFO [2025-03-29 12:34:56] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1601.5820663103
INFO [2025-03-29 12:34:56] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1681.09824552997
INFO [2025-03-29 12:34:56] Created Classic_Pelo_Pct from Classic_Elo with max value: 1698.69428891549
INFO [2025-03-29 12:34:56] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1707.58410982918
INFO [2025-03-29 12:34:56] Prepared data for 255 ladies skiers with 33 features
INFO [2025-03-29 12:34:57] No FIS startlist, predicting for all skiers in all legs
INFO [2025-03-29 12:34:57] No valid FIS startlist for ladies, building optimized teams
INFO [2025-03-29 12:34:57] Attempting Option 1: Team model coefficients
INFO [2025-03-29 12:34:57] Option 1 failed: argument "leg_models" is missing, with no default
INFO [2025-03-29 12:34:57] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 12:34:57] Option 2 failed: argument "leg_models" is missing, with no default
INFO [2025-03-29 12:34:57] Using Option 3: Default leg importance weights
INFO [2025-03-29 12:34:57] Using leg importance weights for team optimization: Leg 1: 0.20, Leg 2: 0.20, Leg 3: 0.25, Leg 4: 0.35
INFO [2025-03-29 12:34:57] Optimizing team for Sweden
INFO [2025-03-29 12:34:57] Optimizing team for Norway
INFO [2025-03-29 12:34:57] Optimizing team for Germany
INFO [2025-03-29 12:34:57] Optimizing team for USA
INFO [2025-03-29 12:34:57] Optimizing team for Austria
INFO [2025-03-29 12:34:57] Optimizing team for Finland
INFO [2025-03-29 12:34:57] Optimizing team for Czechia
INFO [2025-03-29 12:34:57] Optimizing team for Switzerland
INFO [2025-03-29 12:34:57] Optimizing team for Italy
INFO [2025-03-29 12:34:57] Optimizing team for France
INFO [2025-03-29 12:34:57] Optimizing team for Canada
INFO [2025-03-29 12:34:57] Optimizing team for Slovenia
INFO [2025-03-29 12:34:57] Optimizing team for Estonia
INFO [2025-03-29 12:34:57] Optimizing team for Australia
INFO [2025-03-29 12:34:57] Optimizing team for Ukraine
INFO [2025-03-29 12:34:57] Optimizing team for Kazakhstan
INFO [2025-03-29 12:34:57] Optimizing team for Armenia
INFO [2025-03-29 12:34:57] Optimizing team for Latvia
INFO [2025-03-29 12:34:57] Optimizing team for Japan
INFO [2025-03-29 12:34:57] Optimizing team for Poland
INFO [2025-03-29 12:34:57] Optimizing team for South Korea
INFO [2025-03-29 12:34:57] Optimizing team for Andorra
INFO [2025-03-29 12:34:57] Optimizing team for Taiwan
INFO [2025-03-29 12:34:57] Optimizing team for China
INFO [2025-03-29 12:34:57] Optimizing team for Croatia
INFO [2025-03-29 12:34:57] Optimizing team for Slovakia
INFO [2025-03-29 12:34:57] Optimizing team for Argentina
INFO [2025-03-29 12:34:58] Optimizing team for Mongolia
INFO [2025-03-29 12:34:58] Optimizing team for Brazil
INFO [2025-03-29 12:34:58] Optimizing team for Lithuania
INFO [2025-03-29 12:34:58] Optimizing team for Greece
INFO [2025-03-29 12:34:58] Optimizing team for Iceland
INFO [2025-03-29 12:34:58] Optimizing team for Bulgaria
INFO [2025-03-29 12:34:58] Optimizing team for Serbia
INFO [2025-03-29 12:34:58] Optimizing team for Hungary
INFO [2025-03-29 12:34:58] Optimizing team for Turkey
INFO [2025-03-29 12:34:58] Optimizing team for North Macedonia
INFO [2025-03-29 12:34:58] Optimizing team for Romania
INFO [2025-03-29 12:34:58] Optimizing team for Bosnia&Herzegovina
INFO [2025-03-29 12:34:58] Optimizing team for Mexico
INFO [2025-03-29 12:34:58] Optimizing team for Iran
INFO [2025-03-29 12:34:58] Optimizing team for Chile
INFO [2025-03-29 12:34:58] Optimizing team for India
INFO [2025-03-29 12:34:58] Optimizing team for Malaysia
INFO [2025-03-29 12:34:58] Optimizing team for Haiti
INFO [2025-03-29 12:34:58] Optimizing team for Lebanon
INFO [2025-03-29 12:34:58] Optimizing team for Liechtenstein
INFO [2025-03-29 12:34:58] Matching optimized teams with startlist team names and prices
INFO [2025-03-29 12:34:58] Resetting men's probabilities at or below the mode to zero
INFO [2025-03-29 12:34:58] No values appear more than twice for Win_Prob
INFO [2025-03-29 12:34:58] No values appear more than twice for Podium_Prob
INFO [2025-03-29 12:34:58] No values appear more than twice for Top5_Prob
INFO [2025-03-29 12:34:58] No values appear more than twice for Top10_Prob
INFO [2025-03-29 12:34:58] Resetting ladies' probabilities at or below the mode to zero
INFO [2025-03-29 12:34:58] Reset 20 values to 0 for Win_Prob (repeated values or values <  0 )
INFO [2025-03-29 12:34:58] Repeated values: 0, 0, 0, 0, 0
INFO [2025-03-29 12:34:58] No values appear more than twice for Podium_Prob
INFO [2025-03-29 12:34:58] No values appear more than twice for Top5_Prob
INFO [2025-03-29 12:34:58] No values appear more than twice for Top10_Prob
INFO [2025-03-29 12:34:58] Normalizing men's team probabilities
INFO [2025-03-29 12:34:58] Normalized Win_Prob from sum of 0.72 to 1
INFO [2025-03-29 12:34:58] Normalized Podium_Prob from sum of 2.34 to 3
INFO [2025-03-29 12:34:58] Normalized Top5_Prob from sum of 4.2 to 5
INFO [2025-03-29 12:34:58] Normalized Top10_Prob from sum of 10.33 to 10
INFO [2025-03-29 12:34:58] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 12:34:58] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 12:34:58] Normalizing ladies' team probabilities
INFO [2025-03-29 12:34:58] Normalized Win_Prob from sum of 2.19 to 1
INFO [2025-03-29 12:34:58] Normalized Podium_Prob from sum of 4.41 to 3
INFO [2025-03-29 12:34:58] Normalized Top5_Prob from sum of 4.73 to 5
INFO [2025-03-29 12:34:58] Normalized Top10_Prob from sum of 13.19 to 10
INFO [2025-03-29 12:34:58] Final capping of probabilities to maximum of 1
INFO [2025-03-29 12:34:58] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 12:34:58] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 12:34:58] Optimizing fantasy relay team
INFO [2025-03-29 12:34:58] Fantasy team optimization complete. Selected 6 teams.
INFO [2025-03-29 12:34:58] Total price: 92546 of max 1e+05
INFO [2025-03-29 12:34:58] Expected total points: 543
INFO [2025-03-29 12:34:58] Men's teams: 6 ( 6 )
INFO [2025-03-29 12:34:58] Ladies' teams: 0 ( 0 )
INFO [2025-03-29 12:34:58] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_points.xlsx
INFO [2025-03-29 12:34:58] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_probabilities.xlsx
INFO [2025-03-29 12:34:58] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_points.xlsx
INFO [2025-03-29 12:34:58] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_probabilities.xlsx
INFO [2025-03-29 12:34:58] Saved fantasy team results to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/fantasy_relay_team.xlsx
INFO [2025-03-29 12:34:58] Relay predictions completed successfully
INFO [2025-03-29 12:48:28] Starting relay predictions process
INFO [2025-03-29 12:48:28] Loading weekend race data
INFO [2025-03-29 12:48:28] Tomorrow's date: 2025-03-29
INFO [2025-03-29 12:48:28] Found 1 men's relay races and 1 ladies' relay races
INFO [2025-03-29 12:48:28] Loading chrono data
INFO [2025-03-29 12:48:34] Loaded men's chrono with 105122 rows and 36 columns
INFO [2025-03-29 12:48:34] Loaded ladies' chrono with 78706 rows and 36 columns
INFO [2025-03-29 12:48:34] Created men's relay df with 9688 rows
INFO [2025-03-29 12:48:34] Created men's individual df with 92143 rows
INFO [2025-03-29 12:48:34] Created ladies' relay df with 8019 rows
INFO [2025-03-29 12:48:34] Created ladies' individual df with 68253 rows
INFO [2025-03-29 12:48:39] Training models for Leg 1
INFO [2025-03-29 12:48:39] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:48:39] Training podium model using glm
INFO [2025-03-29 12:48:39] Training win model using glm
INFO [2025-03-29 12:48:39] Training top5 model using glm
INFO [2025-03-29 12:48:39] Training top10 model using glm
INFO [2025-03-29 12:48:39] Top features for Leg 1 podium prediction:
INFO [2025-03-29 12:48:39] Training models for Leg 2
INFO [2025-03-29 12:48:39] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:48:39] Training podium model using glm
INFO [2025-03-29 12:48:39] Training win model using glm
INFO [2025-03-29 12:48:39] Training top5 model using glm
INFO [2025-03-29 12:48:39] Training top10 model using glm
INFO [2025-03-29 12:48:39] Top features for Leg 2 podium prediction:
INFO [2025-03-29 12:48:39] Training models for Leg 3
INFO [2025-03-29 12:48:39] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:48:39] Training podium model using glm
INFO [2025-03-29 12:48:39] Training win model using glm
INFO [2025-03-29 12:48:39] Training top5 model using glm
INFO [2025-03-29 12:48:40] Training top10 model using glm
INFO [2025-03-29 12:48:40] Top features for Leg 3 podium prediction:
INFO [2025-03-29 12:48:40] Training models for Leg 4
INFO [2025-03-29 12:48:40] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:48:40] Training podium model using glm
INFO [2025-03-29 12:48:40] Training win model using glm
INFO [2025-03-29 12:48:40] Training top5 model using glm
INFO [2025-03-29 12:48:40] Training top10 model using glm
INFO [2025-03-29 12:48:40] Top features for Leg 4 podium prediction:
INFO [2025-03-29 12:48:40] Training models for Leg 1
INFO [2025-03-29 12:48:40] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:48:40] Training podium model using glm
INFO [2025-03-29 12:48:40] Training win model using glm
INFO [2025-03-29 12:48:40] Training top5 model using glm
INFO [2025-03-29 12:48:40] Training top10 model using glm
INFO [2025-03-29 12:48:40] Top features for Leg 1 podium prediction:
INFO [2025-03-29 12:48:40] Training models for Leg 2
INFO [2025-03-29 12:48:40] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:48:40] Training podium model using glm
INFO [2025-03-29 12:48:40] Training win model using glm
INFO [2025-03-29 12:48:40] Training top5 model using glm
INFO [2025-03-29 12:48:40] Training top10 model using glm
INFO [2025-03-29 12:48:41] Top features for Leg 2 podium prediction:
INFO [2025-03-29 12:48:41] Training models for Leg 3
INFO [2025-03-29 12:48:41] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:48:41] Training podium model using glm
INFO [2025-03-29 12:48:41] Training win model using glm
INFO [2025-03-29 12:48:41] Training top5 model using glm
INFO [2025-03-29 12:48:41] Training top10 model using glm
INFO [2025-03-29 12:48:41] Top features for Leg 3 podium prediction:
INFO [2025-03-29 12:48:41] Training models for Leg 4
INFO [2025-03-29 12:48:41] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:48:41] Training podium model using glm
INFO [2025-03-29 12:48:41] Training win model using glm
INFO [2025-03-29 12:48:41] Training top5 model using glm
INFO [2025-03-29 12:48:41] Training top10 model using glm
INFO [2025-03-29 12:48:41] Top features for Leg 4 podium prediction:
INFO [2025-03-29 12:48:41] Processing men's relay predictions
INFO [2025-03-29 12:48:41] Loaded men relay teams startlist with 24 rows
INFO [2025-03-29 12:48:41] Loaded men relay individuals startlist with 96 rows
INFO [2025-03-29 12:48:41] Preparing current men skier data
INFO [2025-03-29 12:48:41] Found 9 Elo columns for current skiers
INFO [2025-03-29 12:48:41] Replaced NAs in Distance_Elo with first quartile: 1207.23243912712
INFO [2025-03-29 12:48:41] Replaced NAs in Distance_C_Elo with first quartile: 1233.40200699225
INFO [2025-03-29 12:48:41] Replaced NAs in Distance_F_Elo with first quartile: 1236.48554062178
INFO [2025-03-29 12:48:41] Replaced NAs in Sprint_Elo with first quartile: 1223.60107000698
INFO [2025-03-29 12:48:41] Replaced NAs in Sprint_C_Elo with first quartile: 1241.28715500947
INFO [2025-03-29 12:48:41] Replaced NAs in Sprint_F_Elo with first quartile: 1234.45151108772
INFO [2025-03-29 12:48:41] Replaced NAs in Classic_Elo with first quartile: 1241.52867310024
INFO [2025-03-29 12:48:41] Replaced NAs in Freestyle_Elo with first quartile: 1228.48649348109
INFO [2025-03-29 12:48:41] Replaced NAs in Distance_Pelo with first quartile: 1211.63035979047
INFO [2025-03-29 12:48:41] Replaced NAs in Distance_C_Pelo with first quartile: 1234.81091928129
INFO [2025-03-29 12:48:41] Replaced NAs in Distance_F_Pelo with first quartile: 1239.65331180248
INFO [2025-03-29 12:48:41] Replaced NAs in Sprint_Pelo with first quartile: 1240.94751821383
INFO [2025-03-29 12:48:41] Replaced NAs in Sprint_C_Pelo with first quartile: 1241.28715500947
INFO [2025-03-29 12:48:41] Replaced NAs in Sprint_F_Pelo with first quartile: 1252.45166310493
INFO [2025-03-29 12:48:41] Replaced NAs in Classic_Pelo with first quartile: 1243.63746068082
INFO [2025-03-29 12:48:41] Replaced NAs in Freestyle_Pelo with first quartile: 1249.30280713791
INFO [2025-03-29 12:48:41] Replaced NAs in Classic_Last_5 with first quartile: 0
INFO [2025-03-29 12:48:41] Replaced NAs in Freestyle_Last_5 with first quartile: 0
INFO [2025-03-29 12:48:41] Created Pelo_Pct from Elo with max value: 1946.6211651574
INFO [2025-03-29 12:48:41] Created Distance_Pelo_Pct from Distance_Elo with max value: 1869.1251911742
INFO [2025-03-29 12:48:41] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1777.16297253153
INFO [2025-03-29 12:48:41] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1695.2053212904
INFO [2025-03-29 12:48:41] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1886.80363942481
INFO [2025-03-29 12:48:41] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1711.08486899169
INFO [2025-03-29 12:48:41] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1792.65157560707
INFO [2025-03-29 12:48:41] Created Classic_Pelo_Pct from Classic_Elo with max value: 1807.56773496777
INFO [2025-03-29 12:48:41] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1814.60460629541
INFO [2025-03-29 12:48:41] Prepared data for 381 men skiers with 33 features
INFO [2025-03-29 12:48:42] Using FIS startlist for men's leg predictions
INFO [2025-03-29 12:48:42] Using FIS startlist for men
INFO [2025-03-29 12:48:42] Attempting Option 1: Team model coefficients
INFO [2025-03-29 12:48:42] Option 1 failed: No team_podium model found
INFO [2025-03-29 12:48:42] Option 1 failed: No team model
INFO [2025-03-29 12:48:42] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 12:48:42] Leg 1 accuracy: 0.851449444769141
INFO [2025-03-29 12:48:42] Leg 2 accuracy: 0.844632768361582
INFO [2025-03-29 12:48:42] Leg 3 accuracy: 0.867543346970583
INFO [2025-03-29 12:48:42] Leg 4 accuracy: 0.891683226183518
INFO [2025-03-29 12:48:42] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 12:48:42] Leg importance weights: Leg 1: 0.25, Leg 2: 0.24, Leg 3: 0.25, Leg 4: 0.26
INFO [2025-03-29 12:48:42] Processing ladies's relay predictions
INFO [2025-03-29 12:48:42] Loaded ladies relay teams startlist with 35 rows
INFO [2025-03-29 12:48:42] Loaded ladies relay individuals startlist with 231 rows
INFO [2025-03-29 12:48:42] Preparing current ladies skier data
INFO [2025-03-29 12:48:42] Found 9 Elo columns for current skiers
INFO [2025-03-29 12:48:42] Replaced NAs in Distance_Elo with first quartile: 1237.38564383256
INFO [2025-03-29 12:48:42] Replaced NAs in Distance_C_Elo with first quartile: 1243.87329106944
INFO [2025-03-29 12:48:42] Replaced NAs in Distance_F_Elo with first quartile: 1256.69628195708
INFO [2025-03-29 12:48:42] Replaced NAs in Sprint_Elo with first quartile: 1246.32574824425
INFO [2025-03-29 12:48:42] Replaced NAs in Sprint_C_Elo with first quartile: 1257.67866787334
INFO [2025-03-29 12:48:42] Replaced NAs in Sprint_F_Elo with first quartile: 1244.84742904868
INFO [2025-03-29 12:48:42] Replaced NAs in Classic_Elo with first quartile: 1252.44868703669
INFO [2025-03-29 12:48:42] Replaced NAs in Freestyle_Elo with first quartile: 1244.44508230281
INFO [2025-03-29 12:48:42] Replaced NAs in Distance_Pelo with first quartile: 1241.11854419952
INFO [2025-03-29 12:48:42] Replaced NAs in Distance_C_Pelo with first quartile: 1245.57367555166
INFO [2025-03-29 12:48:42] Replaced NAs in Distance_F_Pelo with first quartile: 1259.54282973153
INFO [2025-03-29 12:48:42] Replaced NAs in Sprint_Pelo with first quartile: 1254.58885254623
INFO [2025-03-29 12:48:42] Replaced NAs in Sprint_C_Pelo with first quartile: 1257.58302026178
INFO [2025-03-29 12:48:42] Replaced NAs in Sprint_F_Pelo with first quartile: 1257.67755691493
INFO [2025-03-29 12:48:42] Replaced NAs in Classic_Pelo with first quartile: 1256.79275004544
INFO [2025-03-29 12:48:42] Replaced NAs in Freestyle_Pelo with first quartile: 1256.79999900008
INFO [2025-03-29 12:48:42] Replaced NAs in Classic_Last_5 with first quartile: 3.5
INFO [2025-03-29 12:48:42] Replaced NAs in Freestyle_Last_5 with first quartile: 2.4
INFO [2025-03-29 12:48:42] Created Pelo_Pct from Elo with max value: 1841.00191142018
INFO [2025-03-29 12:48:42] Created Distance_Pelo_Pct from Distance_Elo with max value: 1889.46974050597
INFO [2025-03-29 12:48:42] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1763.33572074398
INFO [2025-03-29 12:48:42] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1693.85026290322
INFO [2025-03-29 12:48:42] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1742.74758850835
INFO [2025-03-29 12:48:42] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1601.5820663103
INFO [2025-03-29 12:48:42] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1681.09824552997
INFO [2025-03-29 12:48:42] Created Classic_Pelo_Pct from Classic_Elo with max value: 1698.69428891549
INFO [2025-03-29 12:48:42] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1707.58410982918
INFO [2025-03-29 12:48:42] Prepared data for 255 ladies skiers with 33 features
INFO [2025-03-29 12:48:42] No FIS startlist, predicting for all skiers in all legs
INFO [2025-03-29 12:48:42] No valid FIS startlist for ladies, building optimized teams
INFO [2025-03-29 12:48:42] Attempting Option 1: Team model coefficients
INFO [2025-03-29 12:48:42] Option 1 failed: argument "leg_models" is missing, with no default
INFO [2025-03-29 12:48:42] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 12:48:42] Option 2 failed: argument "leg_models" is missing, with no default
INFO [2025-03-29 12:48:42] Using Option 3: Default leg importance weights
INFO [2025-03-29 12:48:42] Using leg importance weights for team optimization: Leg 1: 0.20, Leg 2: 0.20, Leg 3: 0.25, Leg 4: 0.35
INFO [2025-03-29 12:48:42] Optimizing team for Sweden
INFO [2025-03-29 12:48:42] Optimizing team for Norway
INFO [2025-03-29 12:48:42] Optimizing team for Germany
INFO [2025-03-29 12:48:43] Optimizing team for USA
INFO [2025-03-29 12:48:43] Optimizing team for Austria
INFO [2025-03-29 12:48:43] Optimizing team for Finland
INFO [2025-03-29 12:48:43] Optimizing team for Czechia
INFO [2025-03-29 12:48:43] Optimizing team for Switzerland
INFO [2025-03-29 12:48:43] Optimizing team for Italy
INFO [2025-03-29 12:48:43] Optimizing team for France
INFO [2025-03-29 12:48:43] Optimizing team for Canada
INFO [2025-03-29 12:48:43] Optimizing team for Slovenia
INFO [2025-03-29 12:48:43] Optimizing team for Estonia
INFO [2025-03-29 12:48:43] Optimizing team for Australia
INFO [2025-03-29 12:48:43] Optimizing team for Ukraine
INFO [2025-03-29 12:48:43] Optimizing team for Kazakhstan
INFO [2025-03-29 12:48:43] Optimizing team for Armenia
INFO [2025-03-29 12:48:43] Optimizing team for Latvia
INFO [2025-03-29 12:48:43] Optimizing team for Japan
INFO [2025-03-29 12:48:43] Optimizing team for Poland
INFO [2025-03-29 12:48:43] Optimizing team for South Korea
INFO [2025-03-29 12:48:43] Optimizing team for Andorra
INFO [2025-03-29 12:48:43] Optimizing team for Taiwan
INFO [2025-03-29 12:48:43] Optimizing team for China
INFO [2025-03-29 12:48:43] Optimizing team for Croatia
INFO [2025-03-29 12:48:43] Optimizing team for Slovakia
INFO [2025-03-29 12:48:43] Optimizing team for Argentina
INFO [2025-03-29 12:48:43] Optimizing team for Mongolia
INFO [2025-03-29 12:48:43] Optimizing team for Brazil
INFO [2025-03-29 12:48:43] Optimizing team for Lithuania
INFO [2025-03-29 12:48:43] Optimizing team for Greece
INFO [2025-03-29 12:48:43] Optimizing team for Iceland
INFO [2025-03-29 12:48:43] Optimizing team for Bulgaria
INFO [2025-03-29 12:48:43] Optimizing team for Serbia
INFO [2025-03-29 12:48:43] Optimizing team for Hungary
INFO [2025-03-29 12:48:43] Optimizing team for Turkey
INFO [2025-03-29 12:48:43] Optimizing team for North Macedonia
INFO [2025-03-29 12:48:43] Optimizing team for Romania
INFO [2025-03-29 12:48:43] Optimizing team for Bosnia&Herzegovina
INFO [2025-03-29 12:48:43] Optimizing team for Mexico
INFO [2025-03-29 12:48:43] Optimizing team for Iran
INFO [2025-03-29 12:48:43] Optimizing team for Chile
INFO [2025-03-29 12:48:43] Optimizing team for India
INFO [2025-03-29 12:48:43] Optimizing team for Malaysia
INFO [2025-03-29 12:48:43] Optimizing team for Haiti
INFO [2025-03-29 12:48:43] Optimizing team for Lebanon
INFO [2025-03-29 12:48:43] Optimizing team for Liechtenstein
INFO [2025-03-29 12:48:44] Matching optimized teams with startlist team names and prices
INFO [2025-03-29 12:48:44] Resetting men's probabilities at or below the mode to zero
INFO [2025-03-29 12:48:44] No values appear more than twice for Win_Prob
INFO [2025-03-29 12:48:44] No values appear more than twice for Podium_Prob
INFO [2025-03-29 12:48:44] No values appear more than twice for Top5_Prob
INFO [2025-03-29 12:48:44] No values appear more than twice for Top10_Prob
INFO [2025-03-29 12:48:44] Resetting ladies' probabilities at or below the mode to zero
INFO [2025-03-29 12:48:44] Reset 20 values to 0 for Win_Prob (repeated values or values <  0 )
INFO [2025-03-29 12:48:44] Repeated values: 0, 0, 0, 0, 0
INFO [2025-03-29 12:48:44] No values appear more than twice for Podium_Prob
INFO [2025-03-29 12:48:44] No values appear more than twice for Top5_Prob
INFO [2025-03-29 12:48:44] No values appear more than twice for Top10_Prob
INFO [2025-03-29 12:48:44] Normalizing men's team probabilities
INFO [2025-03-29 12:48:44] Normalized Win_Prob from sum of 0.72 to 1
INFO [2025-03-29 12:48:44] Normalized Podium_Prob from sum of 2.34 to 3
INFO [2025-03-29 12:48:44] Normalized Top5_Prob from sum of 4.2 to 5
INFO [2025-03-29 12:48:44] Normalized Top10_Prob from sum of 10.33 to 10
INFO [2025-03-29 12:48:44] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 12:48:44] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 12:48:44] Normalizing ladies' team probabilities
INFO [2025-03-29 12:48:44] Normalized Win_Prob from sum of 2.19 to 1
INFO [2025-03-29 12:48:44] Normalized Podium_Prob from sum of 4.41 to 3
INFO [2025-03-29 12:48:44] Normalized Top5_Prob from sum of 4.73 to 5
INFO [2025-03-29 12:48:44] Normalized Top10_Prob from sum of 13.19 to 10
INFO [2025-03-29 12:48:44] Final capping of probabilities to maximum of 1
INFO [2025-03-29 12:48:44] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 12:48:44] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 12:48:44] Optimizing fantasy relay team
INFO [2025-03-29 12:48:44] Fantasy team optimization complete. Selected 6 teams.
INFO [2025-03-29 12:48:44] Total price: 92546 of max 1e+05
INFO [2025-03-29 12:48:44] Expected total points: 543.3
INFO [2025-03-29 12:48:44] Men's teams: 6 ( 6 )
INFO [2025-03-29 12:48:44] Ladies' teams: 0 ( 0 )
INFO [2025-03-29 12:48:44] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_points.xlsx
INFO [2025-03-29 12:48:44] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_probabilities.xlsx
INFO [2025-03-29 12:48:44] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_points.xlsx
INFO [2025-03-29 12:48:44] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_probabilities.xlsx
INFO [2025-03-29 12:48:44] Saved fantasy team results to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/fantasy_relay_team.xlsx
INFO [2025-03-29 12:48:44] Relay predictions completed successfully
INFO [2025-03-29 12:49:26] Starting relay predictions process
INFO [2025-03-29 12:49:26] Loading weekend race data
INFO [2025-03-29 12:49:26] Tomorrow's date: 2025-03-29
INFO [2025-03-29 12:49:26] Found 1 men's relay races and 1 ladies' relay races
INFO [2025-03-29 12:49:26] Loading chrono data
INFO [2025-03-29 12:49:32] Loaded men's chrono with 105122 rows and 36 columns
INFO [2025-03-29 12:49:32] Loaded ladies' chrono with 78706 rows and 36 columns
INFO [2025-03-29 12:49:32] Created men's relay df with 9688 rows
INFO [2025-03-29 12:49:32] Created men's individual df with 92143 rows
INFO [2025-03-29 12:49:32] Created ladies' relay df with 8019 rows
INFO [2025-03-29 12:49:32] Created ladies' individual df with 68253 rows
INFO [2025-03-29 12:49:37] Training models for Leg 1
INFO [2025-03-29 12:49:37] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:49:37] Training podium model using glm
INFO [2025-03-29 12:49:37] Training win model using glm
INFO [2025-03-29 12:49:37] Training top5 model using glm
INFO [2025-03-29 12:49:37] Training top10 model using glm
INFO [2025-03-29 12:49:37] Top features for Leg 1 podium prediction:
INFO [2025-03-29 12:49:37] Training models for Leg 2
INFO [2025-03-29 12:49:37] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:49:37] Training podium model using glm
INFO [2025-03-29 12:49:37] Training win model using glm
INFO [2025-03-29 12:49:37] Training top5 model using glm
INFO [2025-03-29 12:49:37] Training top10 model using glm
INFO [2025-03-29 12:49:37] Top features for Leg 2 podium prediction:
INFO [2025-03-29 12:49:37] Training models for Leg 3
INFO [2025-03-29 12:49:37] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:49:37] Training podium model using glm
INFO [2025-03-29 12:49:38] Training win model using glm
INFO [2025-03-29 12:49:38] Training top5 model using glm
INFO [2025-03-29 12:49:38] Training top10 model using glm
INFO [2025-03-29 12:49:38] Top features for Leg 3 podium prediction:
INFO [2025-03-29 12:49:38] Training models for Leg 4
INFO [2025-03-29 12:49:38] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:49:38] Training podium model using glm
INFO [2025-03-29 12:49:38] Training win model using glm
INFO [2025-03-29 12:49:38] Training top5 model using glm
INFO [2025-03-29 12:49:38] Training top10 model using glm
INFO [2025-03-29 12:49:38] Top features for Leg 4 podium prediction:
INFO [2025-03-29 12:49:38] Training models for Leg 1
INFO [2025-03-29 12:49:38] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:49:38] Training podium model using glm
INFO [2025-03-29 12:49:38] Training win model using glm
INFO [2025-03-29 12:49:38] Training top5 model using glm
INFO [2025-03-29 12:49:38] Training top10 model using glm
INFO [2025-03-29 12:49:38] Top features for Leg 1 podium prediction:
INFO [2025-03-29 12:49:38] Training models for Leg 2
INFO [2025-03-29 12:49:38] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:49:38] Training podium model using glm
INFO [2025-03-29 12:49:39] Training win model using glm
INFO [2025-03-29 12:49:39] Training top5 model using glm
INFO [2025-03-29 12:49:39] Training top10 model using glm
INFO [2025-03-29 12:49:39] Top features for Leg 2 podium prediction:
INFO [2025-03-29 12:49:39] Training models for Leg 3
INFO [2025-03-29 12:49:39] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:49:39] Training podium model using glm
INFO [2025-03-29 12:49:39] Training win model using glm
INFO [2025-03-29 12:49:39] Training top5 model using glm
INFO [2025-03-29 12:49:39] Training top10 model using glm
INFO [2025-03-29 12:49:39] Top features for Leg 3 podium prediction:
INFO [2025-03-29 12:49:39] Training models for Leg 4
INFO [2025-03-29 12:49:39] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:49:39] Training podium model using glm
INFO [2025-03-29 12:49:39] Training win model using glm
INFO [2025-03-29 12:49:39] Training top5 model using glm
INFO [2025-03-29 12:49:39] Training top10 model using glm
INFO [2025-03-29 12:49:39] Top features for Leg 4 podium prediction:
INFO [2025-03-29 12:49:39] Processing men's relay predictions
INFO [2025-03-29 12:49:40] Loaded men relay teams startlist with 24 rows
INFO [2025-03-29 12:49:40] Loaded men relay individuals startlist with 96 rows
INFO [2025-03-29 12:49:40] Preparing current men skier data
INFO [2025-03-29 12:49:40] Found 9 Elo columns for current skiers
INFO [2025-03-29 12:49:40] Replaced NAs in Distance_Elo with first quartile: 1207.23243912712
INFO [2025-03-29 12:49:40] Replaced NAs in Distance_C_Elo with first quartile: 1233.40200699225
INFO [2025-03-29 12:49:40] Replaced NAs in Distance_F_Elo with first quartile: 1236.48554062178
INFO [2025-03-29 12:49:40] Replaced NAs in Sprint_Elo with first quartile: 1223.60107000698
INFO [2025-03-29 12:49:40] Replaced NAs in Sprint_C_Elo with first quartile: 1241.28715500947
INFO [2025-03-29 12:49:40] Replaced NAs in Sprint_F_Elo with first quartile: 1234.45151108772
INFO [2025-03-29 12:49:40] Replaced NAs in Classic_Elo with first quartile: 1241.52867310024
INFO [2025-03-29 12:49:40] Replaced NAs in Freestyle_Elo with first quartile: 1228.48649348109
INFO [2025-03-29 12:49:40] Replaced NAs in Distance_Pelo with first quartile: 1211.63035979047
INFO [2025-03-29 12:49:40] Replaced NAs in Distance_C_Pelo with first quartile: 1234.81091928129
INFO [2025-03-29 12:49:40] Replaced NAs in Distance_F_Pelo with first quartile: 1239.65331180248
INFO [2025-03-29 12:49:40] Replaced NAs in Sprint_Pelo with first quartile: 1240.94751821383
INFO [2025-03-29 12:49:40] Replaced NAs in Sprint_C_Pelo with first quartile: 1241.28715500947
INFO [2025-03-29 12:49:40] Replaced NAs in Sprint_F_Pelo with first quartile: 1252.45166310493
INFO [2025-03-29 12:49:40] Replaced NAs in Classic_Pelo with first quartile: 1243.63746068082
INFO [2025-03-29 12:49:40] Replaced NAs in Freestyle_Pelo with first quartile: 1249.30280713791
INFO [2025-03-29 12:49:40] Replaced NAs in Classic_Last_5 with first quartile: 0
INFO [2025-03-29 12:49:40] Replaced NAs in Freestyle_Last_5 with first quartile: 0
INFO [2025-03-29 12:49:40] Created Pelo_Pct from Elo with max value: 1946.6211651574
INFO [2025-03-29 12:49:40] Created Distance_Pelo_Pct from Distance_Elo with max value: 1869.1251911742
INFO [2025-03-29 12:49:40] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1777.16297253153
INFO [2025-03-29 12:49:40] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1695.2053212904
INFO [2025-03-29 12:49:40] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1886.80363942481
INFO [2025-03-29 12:49:40] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1711.08486899169
INFO [2025-03-29 12:49:40] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1792.65157560707
INFO [2025-03-29 12:49:40] Created Classic_Pelo_Pct from Classic_Elo with max value: 1807.56773496777
INFO [2025-03-29 12:49:40] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1814.60460629541
INFO [2025-03-29 12:49:40] Prepared data for 381 men skiers with 33 features
INFO [2025-03-29 12:49:40] Using FIS startlist for men's leg predictions
INFO [2025-03-29 12:49:40] Using FIS startlist for men
INFO [2025-03-29 12:49:40] Attempting Option 1: Team model coefficients
INFO [2025-03-29 12:49:40] Option 1 failed: No team_podium model found
INFO [2025-03-29 12:49:40] Option 1 failed: No team model
INFO [2025-03-29 12:49:40] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 12:49:40] Leg 1 accuracy: 0.868178453146308
INFO [2025-03-29 12:49:40] Leg 2 accuracy: 0.858022598870056
INFO [2025-03-29 12:49:40] Leg 3 accuracy: 0.857428404441847
INFO [2025-03-29 12:49:40] Leg 4 accuracy: 0.884560685758816
INFO [2025-03-29 12:49:40] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 12:49:40] Leg importance weights: Leg 1: 0.25, Leg 2: 0.25, Leg 3: 0.25, Leg 4: 0.26
INFO [2025-03-29 12:49:40] Processing ladies's relay predictions
INFO [2025-03-29 12:49:40] Loaded ladies relay teams startlist with 35 rows
INFO [2025-03-29 12:49:40] Loaded ladies relay individuals startlist with 231 rows
INFO [2025-03-29 12:49:40] Preparing current ladies skier data
INFO [2025-03-29 12:49:40] Found 9 Elo columns for current skiers
INFO [2025-03-29 12:49:40] Replaced NAs in Distance_Elo with first quartile: 1237.38564383256
INFO [2025-03-29 12:49:40] Replaced NAs in Distance_C_Elo with first quartile: 1243.87329106944
INFO [2025-03-29 12:49:40] Replaced NAs in Distance_F_Elo with first quartile: 1256.69628195708
INFO [2025-03-29 12:49:40] Replaced NAs in Sprint_Elo with first quartile: 1246.32574824425
INFO [2025-03-29 12:49:40] Replaced NAs in Sprint_C_Elo with first quartile: 1257.67866787334
INFO [2025-03-29 12:49:40] Replaced NAs in Sprint_F_Elo with first quartile: 1244.84742904868
INFO [2025-03-29 12:49:40] Replaced NAs in Classic_Elo with first quartile: 1252.44868703669
INFO [2025-03-29 12:49:40] Replaced NAs in Freestyle_Elo with first quartile: 1244.44508230281
INFO [2025-03-29 12:49:40] Replaced NAs in Distance_Pelo with first quartile: 1241.11854419952
INFO [2025-03-29 12:49:40] Replaced NAs in Distance_C_Pelo with first quartile: 1245.57367555166
INFO [2025-03-29 12:49:40] Replaced NAs in Distance_F_Pelo with first quartile: 1259.54282973153
INFO [2025-03-29 12:49:40] Replaced NAs in Sprint_Pelo with first quartile: 1254.58885254623
INFO [2025-03-29 12:49:40] Replaced NAs in Sprint_C_Pelo with first quartile: 1257.58302026178
INFO [2025-03-29 12:49:40] Replaced NAs in Sprint_F_Pelo with first quartile: 1257.67755691493
INFO [2025-03-29 12:49:40] Replaced NAs in Classic_Pelo with first quartile: 1256.79275004544
INFO [2025-03-29 12:49:40] Replaced NAs in Freestyle_Pelo with first quartile: 1256.79999900008
INFO [2025-03-29 12:49:40] Replaced NAs in Classic_Last_5 with first quartile: 3.5
INFO [2025-03-29 12:49:40] Replaced NAs in Freestyle_Last_5 with first quartile: 2.4
INFO [2025-03-29 12:49:40] Created Pelo_Pct from Elo with max value: 1841.00191142018
INFO [2025-03-29 12:49:40] Created Distance_Pelo_Pct from Distance_Elo with max value: 1889.46974050597
INFO [2025-03-29 12:49:40] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1763.33572074398
INFO [2025-03-29 12:49:40] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1693.85026290322
INFO [2025-03-29 12:49:40] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1742.74758850835
INFO [2025-03-29 12:49:40] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1601.5820663103
INFO [2025-03-29 12:49:40] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1681.09824552997
INFO [2025-03-29 12:49:40] Created Classic_Pelo_Pct from Classic_Elo with max value: 1698.69428891549
INFO [2025-03-29 12:49:40] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1707.58410982918
INFO [2025-03-29 12:49:40] Prepared data for 255 ladies skiers with 33 features
INFO [2025-03-29 12:49:40] No FIS startlist, predicting for all skiers in all legs
INFO [2025-03-29 12:49:41] No valid FIS startlist for ladies, building optimized teams
INFO [2025-03-29 12:49:41] Attempting Option 1: Team model coefficients
INFO [2025-03-29 12:49:41] Option 1 failed: argument "leg_models" is missing, with no default
INFO [2025-03-29 12:49:41] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 12:49:41] Option 2 failed: argument "leg_models" is missing, with no default
INFO [2025-03-29 12:49:41] Using Option 3: Default leg importance weights
INFO [2025-03-29 12:49:41] Using leg importance weights for team optimization: Leg 1: 0.20, Leg 2: 0.20, Leg 3: 0.25, Leg 4: 0.35
INFO [2025-03-29 12:49:41] Optimizing team for Sweden
INFO [2025-03-29 12:49:41] Optimizing team for Norway
INFO [2025-03-29 12:49:41] Optimizing team for Germany
INFO [2025-03-29 12:49:41] Optimizing team for USA
INFO [2025-03-29 12:49:41] Optimizing team for Austria
INFO [2025-03-29 12:49:41] Optimizing team for Finland
INFO [2025-03-29 12:49:41] Optimizing team for Czechia
INFO [2025-03-29 12:49:41] Optimizing team for Switzerland
INFO [2025-03-29 12:49:41] Optimizing team for Italy
INFO [2025-03-29 12:49:41] Optimizing team for France
INFO [2025-03-29 12:49:41] Optimizing team for Canada
INFO [2025-03-29 12:49:41] Optimizing team for Slovenia
INFO [2025-03-29 12:49:41] Optimizing team for Estonia
INFO [2025-03-29 12:49:41] Optimizing team for Australia
INFO [2025-03-29 12:49:41] Optimizing team for Ukraine
INFO [2025-03-29 12:49:41] Optimizing team for Kazakhstan
INFO [2025-03-29 12:49:41] Optimizing team for Armenia
INFO [2025-03-29 12:49:41] Optimizing team for Latvia
INFO [2025-03-29 12:49:41] Optimizing team for Japan
INFO [2025-03-29 12:49:41] Optimizing team for Poland
INFO [2025-03-29 12:49:41] Optimizing team for South Korea
INFO [2025-03-29 12:49:41] Optimizing team for Andorra
INFO [2025-03-29 12:49:41] Optimizing team for Taiwan
INFO [2025-03-29 12:49:41] Optimizing team for China
INFO [2025-03-29 12:49:41] Optimizing team for Croatia
INFO [2025-03-29 12:49:41] Optimizing team for Slovakia
INFO [2025-03-29 12:49:41] Optimizing team for Argentina
INFO [2025-03-29 12:49:41] Optimizing team for Mongolia
INFO [2025-03-29 12:49:41] Optimizing team for Brazil
INFO [2025-03-29 12:49:42] Optimizing team for Lithuania
INFO [2025-03-29 12:49:42] Optimizing team for Greece
INFO [2025-03-29 12:49:42] Optimizing team for Iceland
INFO [2025-03-29 12:49:42] Optimizing team for Bulgaria
INFO [2025-03-29 12:49:42] Optimizing team for Serbia
INFO [2025-03-29 12:49:42] Optimizing team for Hungary
INFO [2025-03-29 12:49:42] Optimizing team for Turkey
INFO [2025-03-29 12:49:42] Optimizing team for North Macedonia
INFO [2025-03-29 12:49:42] Optimizing team for Romania
INFO [2025-03-29 12:49:42] Optimizing team for Bosnia&Herzegovina
INFO [2025-03-29 12:49:42] Optimizing team for Mexico
INFO [2025-03-29 12:49:42] Optimizing team for Iran
INFO [2025-03-29 12:49:42] Optimizing team for Chile
INFO [2025-03-29 12:49:42] Optimizing team for India
INFO [2025-03-29 12:49:42] Optimizing team for Malaysia
INFO [2025-03-29 12:49:42] Optimizing team for Haiti
INFO [2025-03-29 12:49:42] Optimizing team for Lebanon
INFO [2025-03-29 12:49:42] Optimizing team for Liechtenstein
INFO [2025-03-29 12:49:42] Matching optimized teams with startlist team names and prices
INFO [2025-03-29 12:49:42] Resetting men's probabilities at or below the mode to zero
INFO [2025-03-29 12:49:42] No values appear more than twice for Win_Prob
INFO [2025-03-29 12:49:42] No values appear more than twice for Podium_Prob
INFO [2025-03-29 12:49:42] No values appear more than twice for Top5_Prob
INFO [2025-03-29 12:49:42] No values appear more than twice for Top10_Prob
INFO [2025-03-29 12:49:42] Resetting ladies' probabilities at or below the mode to zero
INFO [2025-03-29 12:49:42] Reset 20 values to 0 for Win_Prob (repeated values or values <  0 )
INFO [2025-03-29 12:49:42] Repeated values: 0, 0, 0, 0, 0
INFO [2025-03-29 12:49:42] No values appear more than twice for Podium_Prob
INFO [2025-03-29 12:49:42] No values appear more than twice for Top5_Prob
INFO [2025-03-29 12:49:42] No values appear more than twice for Top10_Prob
INFO [2025-03-29 12:49:42] Normalizing men's team probabilities
INFO [2025-03-29 12:49:42] Normalized Win_Prob from sum of 0.71 to 1
INFO [2025-03-29 12:49:42] Normalized Podium_Prob from sum of 2.35 to 3
INFO [2025-03-29 12:49:42] Normalized Top5_Prob from sum of 4.21 to 5
INFO [2025-03-29 12:49:42] Normalized Top10_Prob from sum of 10.33 to 10
INFO [2025-03-29 12:49:42] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 12:49:42] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 12:49:42] Normalizing ladies' team probabilities
INFO [2025-03-29 12:49:42] Normalized Win_Prob from sum of 2.19 to 1
INFO [2025-03-29 12:49:42] Normalized Podium_Prob from sum of 4.41 to 3
INFO [2025-03-29 12:49:42] Normalized Top5_Prob from sum of 4.73 to 5
INFO [2025-03-29 12:49:42] Normalized Top10_Prob from sum of 13.19 to 10
INFO [2025-03-29 12:49:42] Final capping of probabilities to maximum of 1
INFO [2025-03-29 12:49:42] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 12:49:42] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 12:49:42] Optimizing fantasy relay team
INFO [2025-03-29 12:49:42] Fantasy team optimization complete. Selected 6 teams.
INFO [2025-03-29 12:49:42] Total price: 92546 of max 1e+05
INFO [2025-03-29 12:49:42] Expected total points: 542.9
INFO [2025-03-29 12:49:42] Men's teams: 6 ( 6 )
INFO [2025-03-29 12:49:42] Ladies' teams: 0 ( 0 )
INFO [2025-03-29 12:49:42] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_points.xlsx
INFO [2025-03-29 12:49:42] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_probabilities.xlsx
INFO [2025-03-29 12:49:42] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_points.xlsx
INFO [2025-03-29 12:49:42] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_probabilities.xlsx
INFO [2025-03-29 12:49:42] Saved fantasy team results to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/fantasy_relay_team.xlsx
INFO [2025-03-29 12:49:42] Relay predictions completed successfully
INFO [2025-03-29 12:51:03] Starting relay predictions process
INFO [2025-03-29 12:51:03] Loading weekend race data
INFO [2025-03-29 12:51:03] Tomorrow's date: 2025-03-29
INFO [2025-03-29 12:51:03] Found 1 men's relay races and 1 ladies' relay races
INFO [2025-03-29 12:51:03] Loading chrono data
INFO [2025-03-29 12:51:08] Loaded men's chrono with 105122 rows and 36 columns
INFO [2025-03-29 12:51:08] Loaded ladies' chrono with 78706 rows and 36 columns
INFO [2025-03-29 12:51:08] Created men's relay df with 9688 rows
INFO [2025-03-29 12:51:08] Created men's individual df with 92143 rows
INFO [2025-03-29 12:51:08] Created ladies' relay df with 8019 rows
INFO [2025-03-29 12:51:08] Created ladies' individual df with 68253 rows
INFO [2025-03-29 12:51:13] Training models for Leg 1
INFO [2025-03-29 12:51:13] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:51:13] Training podium model using glm
INFO [2025-03-29 12:51:13] Training win model using glm
INFO [2025-03-29 12:51:13] Training top5 model using glm
INFO [2025-03-29 12:51:13] Training top10 model using glm
INFO [2025-03-29 12:51:13] Top features for Leg 1 podium prediction:
INFO [2025-03-29 12:51:13] Training models for Leg 2
INFO [2025-03-29 12:51:13] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:51:13] Training podium model using glm
INFO [2025-03-29 12:51:13] Training win model using glm
INFO [2025-03-29 12:51:13] Training top5 model using glm
INFO [2025-03-29 12:51:14] Training top10 model using glm
INFO [2025-03-29 12:51:14] Top features for Leg 2 podium prediction:
INFO [2025-03-29 12:51:14] Training models for Leg 3
INFO [2025-03-29 12:51:14] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:51:14] Training podium model using glm
INFO [2025-03-29 12:51:14] Training win model using glm
INFO [2025-03-29 12:51:14] Training top5 model using glm
INFO [2025-03-29 12:51:14] Training top10 model using glm
INFO [2025-03-29 12:51:14] Top features for Leg 3 podium prediction:
INFO [2025-03-29 12:51:14] Training models for Leg 4
INFO [2025-03-29 12:51:14] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:51:14] Training podium model using glm
INFO [2025-03-29 12:51:14] Training win model using glm
INFO [2025-03-29 12:51:14] Training top5 model using glm
INFO [2025-03-29 12:51:14] Training top10 model using glm
INFO [2025-03-29 12:51:14] Top features for Leg 4 podium prediction:
INFO [2025-03-29 12:51:14] Training models for Leg 1
INFO [2025-03-29 12:51:14] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:51:15] Training podium model using glm
INFO [2025-03-29 12:51:15] Training win model using glm
INFO [2025-03-29 12:51:15] Training top5 model using glm
INFO [2025-03-29 12:51:15] Training top10 model using glm
INFO [2025-03-29 12:51:15] Top features for Leg 1 podium prediction:
INFO [2025-03-29 12:51:15] Training models for Leg 2
INFO [2025-03-29 12:51:15] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:51:15] Training podium model using glm
INFO [2025-03-29 12:51:15] Training win model using glm
INFO [2025-03-29 12:51:15] Training top5 model using glm
INFO [2025-03-29 12:51:15] Training top10 model using glm
INFO [2025-03-29 12:51:15] Top features for Leg 2 podium prediction:
INFO [2025-03-29 12:51:15] Training models for Leg 3
INFO [2025-03-29 12:51:15] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:51:15] Training podium model using glm
INFO [2025-03-29 12:51:15] Training win model using glm
INFO [2025-03-29 12:51:15] Training top5 model using glm
INFO [2025-03-29 12:51:15] Training top10 model using glm
INFO [2025-03-29 12:51:15] Top features for Leg 3 podium prediction:
INFO [2025-03-29 12:51:15] Training models for Leg 4
INFO [2025-03-29 12:51:15] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:51:15] Training podium model using glm
INFO [2025-03-29 12:51:16] Training win model using glm
INFO [2025-03-29 12:51:16] Training top5 model using glm
INFO [2025-03-29 12:51:16] Training top10 model using glm
INFO [2025-03-29 12:51:16] Top features for Leg 4 podium prediction:
INFO [2025-03-29 12:51:16] Processing men's relay predictions
INFO [2025-03-29 12:51:16] Loaded men relay teams startlist with 24 rows
INFO [2025-03-29 12:51:16] Loaded men relay individuals startlist with 96 rows
INFO [2025-03-29 12:51:16] Preparing current men skier data
INFO [2025-03-29 12:51:16] Found 9 Elo columns for current skiers
INFO [2025-03-29 12:51:16] Replaced NAs in Distance_Elo with first quartile: 1207.23243912712
INFO [2025-03-29 12:51:16] Replaced NAs in Distance_C_Elo with first quartile: 1233.40200699225
INFO [2025-03-29 12:51:16] Replaced NAs in Distance_F_Elo with first quartile: 1236.48554062178
INFO [2025-03-29 12:51:16] Replaced NAs in Sprint_Elo with first quartile: 1223.60107000698
INFO [2025-03-29 12:51:16] Replaced NAs in Sprint_C_Elo with first quartile: 1241.28715500947
INFO [2025-03-29 12:51:16] Replaced NAs in Sprint_F_Elo with first quartile: 1234.45151108772
INFO [2025-03-29 12:51:16] Replaced NAs in Classic_Elo with first quartile: 1241.52867310024
INFO [2025-03-29 12:51:16] Replaced NAs in Freestyle_Elo with first quartile: 1228.48649348109
INFO [2025-03-29 12:51:16] Replaced NAs in Distance_Pelo with first quartile: 1211.63035979047
INFO [2025-03-29 12:51:16] Replaced NAs in Distance_C_Pelo with first quartile: 1234.81091928129
INFO [2025-03-29 12:51:16] Replaced NAs in Distance_F_Pelo with first quartile: 1239.65331180248
INFO [2025-03-29 12:51:16] Replaced NAs in Sprint_Pelo with first quartile: 1240.94751821383
INFO [2025-03-29 12:51:16] Replaced NAs in Sprint_C_Pelo with first quartile: 1241.28715500947
INFO [2025-03-29 12:51:16] Replaced NAs in Sprint_F_Pelo with first quartile: 1252.45166310493
INFO [2025-03-29 12:51:16] Replaced NAs in Classic_Pelo with first quartile: 1243.63746068082
INFO [2025-03-29 12:51:16] Replaced NAs in Freestyle_Pelo with first quartile: 1249.30280713791
INFO [2025-03-29 12:51:16] Replaced NAs in Classic_Last_5 with first quartile: 0
INFO [2025-03-29 12:51:16] Replaced NAs in Freestyle_Last_5 with first quartile: 0
INFO [2025-03-29 12:51:16] Created Pelo_Pct from Elo with max value: 1946.6211651574
INFO [2025-03-29 12:51:16] Created Distance_Pelo_Pct from Distance_Elo with max value: 1869.1251911742
INFO [2025-03-29 12:51:16] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1777.16297253153
INFO [2025-03-29 12:51:16] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1695.2053212904
INFO [2025-03-29 12:51:16] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1886.80363942481
INFO [2025-03-29 12:51:16] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1711.08486899169
INFO [2025-03-29 12:51:16] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1792.65157560707
INFO [2025-03-29 12:51:16] Created Classic_Pelo_Pct from Classic_Elo with max value: 1807.56773496777
INFO [2025-03-29 12:51:16] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1814.60460629541
INFO [2025-03-29 12:51:16] Prepared data for 381 men skiers with 33 features
INFO [2025-03-29 12:51:16] Using FIS startlist for men's leg predictions
INFO [2025-03-29 12:51:16] Using FIS startlist for men
INFO [2025-03-29 12:51:16] Attempting Option 1: Team model coefficients
INFO [2025-03-29 12:51:16] Option 1 failed: No team_podium model found
INFO [2025-03-29 12:51:16] Option 1 failed: No team model
INFO [2025-03-29 12:51:16] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 12:51:16] Leg 1 accuracy: 0.858694720436392
INFO [2025-03-29 12:51:16] Leg 2 accuracy: 0.851299435028249
INFO [2025-03-29 12:51:16] Leg 3 accuracy: 0.870777323202805
INFO [2025-03-29 12:51:16] Leg 4 accuracy: 0.891505941944282
INFO [2025-03-29 12:51:16] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 12:51:16] Leg importance weights: Leg 1: 0.25, Leg 2: 0.25, Leg 3: 0.25, Leg 4: 0.26
INFO [2025-03-29 12:51:16] Processing ladies's relay predictions
INFO [2025-03-29 12:51:16] Loaded ladies relay teams startlist with 35 rows
INFO [2025-03-29 12:51:16] Loaded ladies relay individuals startlist with 231 rows
INFO [2025-03-29 12:51:16] Preparing current ladies skier data
INFO [2025-03-29 12:51:16] Found 9 Elo columns for current skiers
INFO [2025-03-29 12:51:16] Replaced NAs in Distance_Elo with first quartile: 1237.38564383256
INFO [2025-03-29 12:51:16] Replaced NAs in Distance_C_Elo with first quartile: 1243.87329106944
INFO [2025-03-29 12:51:16] Replaced NAs in Distance_F_Elo with first quartile: 1256.69628195708
INFO [2025-03-29 12:51:16] Replaced NAs in Sprint_Elo with first quartile: 1246.32574824425
INFO [2025-03-29 12:51:16] Replaced NAs in Sprint_C_Elo with first quartile: 1257.67866787334
INFO [2025-03-29 12:51:16] Replaced NAs in Sprint_F_Elo with first quartile: 1244.84742904868
INFO [2025-03-29 12:51:16] Replaced NAs in Classic_Elo with first quartile: 1252.44868703669
INFO [2025-03-29 12:51:16] Replaced NAs in Freestyle_Elo with first quartile: 1244.44508230281
INFO [2025-03-29 12:51:16] Replaced NAs in Distance_Pelo with first quartile: 1241.11854419952
INFO [2025-03-29 12:51:16] Replaced NAs in Distance_C_Pelo with first quartile: 1245.57367555166
INFO [2025-03-29 12:51:16] Replaced NAs in Distance_F_Pelo with first quartile: 1259.54282973153
INFO [2025-03-29 12:51:16] Replaced NAs in Sprint_Pelo with first quartile: 1254.58885254623
INFO [2025-03-29 12:51:16] Replaced NAs in Sprint_C_Pelo with first quartile: 1257.58302026178
INFO [2025-03-29 12:51:16] Replaced NAs in Sprint_F_Pelo with first quartile: 1257.67755691493
INFO [2025-03-29 12:51:16] Replaced NAs in Classic_Pelo with first quartile: 1256.79275004544
INFO [2025-03-29 12:51:16] Replaced NAs in Freestyle_Pelo with first quartile: 1256.79999900008
INFO [2025-03-29 12:51:16] Replaced NAs in Classic_Last_5 with first quartile: 3.5
INFO [2025-03-29 12:51:16] Replaced NAs in Freestyle_Last_5 with first quartile: 2.4
INFO [2025-03-29 12:51:16] Created Pelo_Pct from Elo with max value: 1841.00191142018
INFO [2025-03-29 12:51:16] Created Distance_Pelo_Pct from Distance_Elo with max value: 1889.46974050597
INFO [2025-03-29 12:51:16] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1763.33572074398
INFO [2025-03-29 12:51:16] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1693.85026290322
INFO [2025-03-29 12:51:16] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1742.74758850835
INFO [2025-03-29 12:51:16] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1601.5820663103
INFO [2025-03-29 12:51:16] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1681.09824552997
INFO [2025-03-29 12:51:16] Created Classic_Pelo_Pct from Classic_Elo with max value: 1698.69428891549
INFO [2025-03-29 12:51:16] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1707.58410982918
INFO [2025-03-29 12:51:16] Prepared data for 255 ladies skiers with 33 features
INFO [2025-03-29 12:51:17] No FIS startlist, predicting for all skiers in all legs
INFO [2025-03-29 12:51:17] No valid FIS startlist for ladies, building optimized teams
INFO [2025-03-29 12:51:17] Attempting Option 1: Team model coefficients
INFO [2025-03-29 12:51:17] Option 1 failed: argument "leg_models" is missing, with no default
INFO [2025-03-29 12:51:17] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 12:51:17] Option 2 failed: argument "leg_models" is missing, with no default
INFO [2025-03-29 12:51:17] Using Option 3: Default leg importance weights
INFO [2025-03-29 12:51:17] Using leg importance weights for team optimization: Leg 1: 0.20, Leg 2: 0.20, Leg 3: 0.25, Leg 4: 0.35
INFO [2025-03-29 12:51:17] Optimizing team for Sweden
INFO [2025-03-29 12:51:17] Optimizing team for Norway
INFO [2025-03-29 12:51:17] Optimizing team for Germany
INFO [2025-03-29 12:51:17] Optimizing team for USA
INFO [2025-03-29 12:51:17] Optimizing team for Austria
INFO [2025-03-29 12:51:17] Optimizing team for Finland
INFO [2025-03-29 12:51:17] Optimizing team for Czechia
INFO [2025-03-29 12:51:17] Optimizing team for Switzerland
INFO [2025-03-29 12:51:17] Optimizing team for Italy
INFO [2025-03-29 12:51:17] Optimizing team for France
INFO [2025-03-29 12:51:17] Optimizing team for Canada
INFO [2025-03-29 12:51:17] Optimizing team for Slovenia
INFO [2025-03-29 12:51:17] Optimizing team for Estonia
INFO [2025-03-29 12:51:17] Optimizing team for Australia
INFO [2025-03-29 12:51:17] Optimizing team for Ukraine
INFO [2025-03-29 12:51:17] Optimizing team for Kazakhstan
INFO [2025-03-29 12:51:17] Optimizing team for Armenia
INFO [2025-03-29 12:51:17] Optimizing team for Latvia
INFO [2025-03-29 12:51:17] Optimizing team for Japan
INFO [2025-03-29 12:51:17] Optimizing team for Poland
INFO [2025-03-29 12:51:17] Optimizing team for South Korea
INFO [2025-03-29 12:51:17] Optimizing team for Andorra
INFO [2025-03-29 12:51:17] Optimizing team for Taiwan
INFO [2025-03-29 12:51:18] Optimizing team for China
INFO [2025-03-29 12:51:18] Optimizing team for Croatia
INFO [2025-03-29 12:51:18] Optimizing team for Slovakia
INFO [2025-03-29 12:51:18] Optimizing team for Argentina
INFO [2025-03-29 12:51:18] Optimizing team for Mongolia
INFO [2025-03-29 12:51:18] Optimizing team for Brazil
INFO [2025-03-29 12:51:18] Optimizing team for Lithuania
INFO [2025-03-29 12:51:18] Optimizing team for Greece
INFO [2025-03-29 12:51:18] Optimizing team for Iceland
INFO [2025-03-29 12:51:18] Optimizing team for Bulgaria
INFO [2025-03-29 12:51:18] Optimizing team for Serbia
INFO [2025-03-29 12:51:18] Optimizing team for Hungary
INFO [2025-03-29 12:51:18] Optimizing team for Turkey
INFO [2025-03-29 12:51:18] Optimizing team for North Macedonia
INFO [2025-03-29 12:51:18] Optimizing team for Romania
INFO [2025-03-29 12:51:18] Optimizing team for Bosnia&Herzegovina
INFO [2025-03-29 12:51:18] Optimizing team for Mexico
INFO [2025-03-29 12:51:18] Optimizing team for Iran
INFO [2025-03-29 12:51:18] Optimizing team for Chile
INFO [2025-03-29 12:51:18] Optimizing team for India
INFO [2025-03-29 12:51:18] Optimizing team for Malaysia
INFO [2025-03-29 12:51:18] Optimizing team for Haiti
INFO [2025-03-29 12:51:18] Optimizing team for Lebanon
INFO [2025-03-29 12:51:18] Optimizing team for Liechtenstein
INFO [2025-03-29 12:53:27] Starting relay predictions process
INFO [2025-03-29 12:53:28] Loading weekend race data
INFO [2025-03-29 12:53:28] Tomorrow's date: 2025-03-29
INFO [2025-03-29 12:53:28] Found 1 men's relay races and 1 ladies' relay races
INFO [2025-03-29 12:53:28] Loading chrono data
INFO [2025-03-29 12:53:33] Loaded men's chrono with 105122 rows and 36 columns
INFO [2025-03-29 12:53:33] Loaded ladies' chrono with 78706 rows and 36 columns
INFO [2025-03-29 12:53:33] Created men's relay df with 9688 rows
INFO [2025-03-29 12:53:33] Created men's individual df with 92143 rows
INFO [2025-03-29 12:53:33] Created ladies' relay df with 8019 rows
INFO [2025-03-29 12:53:33] Created ladies' individual df with 68253 rows
INFO [2025-03-29 12:53:38] Training models for Leg 1
INFO [2025-03-29 12:53:38] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:53:38] Training podium model using glm
INFO [2025-03-29 12:53:38] Training win model using glm
INFO [2025-03-29 12:53:38] Training top5 model using glm
INFO [2025-03-29 12:53:38] Training top10 model using glm
INFO [2025-03-29 12:53:38] Top features for Leg 1 podium prediction:
INFO [2025-03-29 12:53:38] Training models for Leg 2
INFO [2025-03-29 12:53:38] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:53:38] Training podium model using glm
INFO [2025-03-29 12:53:38] Training win model using glm
INFO [2025-03-29 12:53:38] Training top5 model using glm
INFO [2025-03-29 12:53:38] Training top10 model using glm
INFO [2025-03-29 12:53:38] Top features for Leg 2 podium prediction:
INFO [2025-03-29 12:53:38] Training models for Leg 3
INFO [2025-03-29 12:53:38] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:53:38] Training podium model using glm
INFO [2025-03-29 12:53:38] Training win model using glm
INFO [2025-03-29 12:53:39] Training top5 model using glm
INFO [2025-03-29 12:53:39] Training top10 model using glm
INFO [2025-03-29 12:53:39] Top features for Leg 3 podium prediction:
INFO [2025-03-29 12:53:39] Training models for Leg 4
INFO [2025-03-29 12:53:39] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:53:39] Training podium model using glm
INFO [2025-03-29 12:53:39] Training win model using glm
INFO [2025-03-29 12:53:39] Training top5 model using glm
INFO [2025-03-29 12:53:39] Training top10 model using glm
INFO [2025-03-29 12:53:39] Top features for Leg 4 podium prediction:
INFO [2025-03-29 12:53:39] Training models for Leg 1
INFO [2025-03-29 12:53:39] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:53:39] Training podium model using glm
INFO [2025-03-29 12:53:39] Training win model using glm
INFO [2025-03-29 12:53:39] Training top5 model using glm
INFO [2025-03-29 12:53:39] Training top10 model using glm
INFO [2025-03-29 12:53:39] Top features for Leg 1 podium prediction:
INFO [2025-03-29 12:53:39] Training models for Leg 2
INFO [2025-03-29 12:53:39] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:53:39] Training podium model using glm
INFO [2025-03-29 12:53:39] Training win model using glm
INFO [2025-03-29 12:53:40] Training top5 model using glm
INFO [2025-03-29 12:53:40] Training top10 model using glm
INFO [2025-03-29 12:53:40] Top features for Leg 2 podium prediction:
INFO [2025-03-29 12:53:40] Training models for Leg 3
INFO [2025-03-29 12:53:40] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:53:40] Training podium model using glm
INFO [2025-03-29 12:53:40] Training win model using glm
INFO [2025-03-29 12:53:40] Training top5 model using glm
INFO [2025-03-29 12:53:40] Training top10 model using glm
INFO [2025-03-29 12:53:40] Top features for Leg 3 podium prediction:
INFO [2025-03-29 12:53:40] Training models for Leg 4
INFO [2025-03-29 12:53:40] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:53:40] Training podium model using glm
INFO [2025-03-29 12:53:40] Training win model using glm
INFO [2025-03-29 12:53:40] Training top5 model using glm
INFO [2025-03-29 12:53:40] Training top10 model using glm
INFO [2025-03-29 12:53:40] Top features for Leg 4 podium prediction:
INFO [2025-03-29 12:53:40] Processing men's relay predictions
INFO [2025-03-29 12:53:40] Loaded men relay teams startlist with 24 rows
INFO [2025-03-29 12:53:40] Loaded men relay individuals startlist with 96 rows
INFO [2025-03-29 12:53:40] Preparing current men skier data
INFO [2025-03-29 12:53:40] Found 9 Elo columns for current skiers
INFO [2025-03-29 12:53:40] Replaced NAs in Distance_Elo with first quartile: 1207.23243912712
INFO [2025-03-29 12:53:40] Replaced NAs in Distance_C_Elo with first quartile: 1233.40200699225
INFO [2025-03-29 12:53:40] Replaced NAs in Distance_F_Elo with first quartile: 1236.48554062178
INFO [2025-03-29 12:53:40] Replaced NAs in Sprint_Elo with first quartile: 1223.60107000698
INFO [2025-03-29 12:53:41] Replaced NAs in Sprint_C_Elo with first quartile: 1241.28715500947
INFO [2025-03-29 12:53:41] Replaced NAs in Sprint_F_Elo with first quartile: 1234.45151108772
INFO [2025-03-29 12:53:41] Replaced NAs in Classic_Elo with first quartile: 1241.52867310024
INFO [2025-03-29 12:53:41] Replaced NAs in Freestyle_Elo with first quartile: 1228.48649348109
INFO [2025-03-29 12:53:41] Replaced NAs in Distance_Pelo with first quartile: 1211.63035979047
INFO [2025-03-29 12:53:41] Replaced NAs in Distance_C_Pelo with first quartile: 1234.81091928129
INFO [2025-03-29 12:53:41] Replaced NAs in Distance_F_Pelo with first quartile: 1239.65331180248
INFO [2025-03-29 12:53:41] Replaced NAs in Sprint_Pelo with first quartile: 1240.94751821383
INFO [2025-03-29 12:53:41] Replaced NAs in Sprint_C_Pelo with first quartile: 1241.28715500947
INFO [2025-03-29 12:53:41] Replaced NAs in Sprint_F_Pelo with first quartile: 1252.45166310493
INFO [2025-03-29 12:53:41] Replaced NAs in Classic_Pelo with first quartile: 1243.63746068082
INFO [2025-03-29 12:53:41] Replaced NAs in Freestyle_Pelo with first quartile: 1249.30280713791
INFO [2025-03-29 12:53:41] Replaced NAs in Classic_Last_5 with first quartile: 0
INFO [2025-03-29 12:53:41] Replaced NAs in Freestyle_Last_5 with first quartile: 0
INFO [2025-03-29 12:53:41] Created Pelo_Pct from Elo with max value: 1946.6211651574
INFO [2025-03-29 12:53:41] Created Distance_Pelo_Pct from Distance_Elo with max value: 1869.1251911742
INFO [2025-03-29 12:53:41] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1777.16297253153
INFO [2025-03-29 12:53:41] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1695.2053212904
INFO [2025-03-29 12:53:41] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1886.80363942481
INFO [2025-03-29 12:53:41] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1711.08486899169
INFO [2025-03-29 12:53:41] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1792.65157560707
INFO [2025-03-29 12:53:41] Created Classic_Pelo_Pct from Classic_Elo with max value: 1807.56773496777
INFO [2025-03-29 12:53:41] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1814.60460629541
INFO [2025-03-29 12:53:41] Prepared data for 381 men skiers with 33 features
INFO [2025-03-29 12:53:41] Using FIS startlist for men's leg predictions
INFO [2025-03-29 12:53:41] Using FIS startlist for men
INFO [2025-03-29 12:53:41] Attempting Option 1: Team model coefficients
INFO [2025-03-29 12:53:41] Option 1 failed: No team_podium model found
INFO [2025-03-29 12:53:41] Option 1 failed: No team model
INFO [2025-03-29 12:53:41] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 12:53:41] Leg 1 accuracy: 0.864841223456069
INFO [2025-03-29 12:53:41] Leg 2 accuracy: 0.851299435028249
INFO [2025-03-29 12:53:41] Leg 3 accuracy: 0.864040522111825
INFO [2025-03-29 12:53:41] Leg 4 accuracy: 0.881344243132671
INFO [2025-03-29 12:53:41] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 12:53:41] Leg importance weights: Leg 1: 0.25, Leg 2: 0.25, Leg 3: 0.25, Leg 4: 0.25
INFO [2025-03-29 12:53:41] Processing ladies's relay predictions
INFO [2025-03-29 12:53:41] Loaded ladies relay teams startlist with 35 rows
INFO [2025-03-29 12:53:41] Loaded ladies relay individuals startlist with 231 rows
INFO [2025-03-29 12:53:41] Preparing current ladies skier data
INFO [2025-03-29 12:53:41] Found 9 Elo columns for current skiers
INFO [2025-03-29 12:53:41] Replaced NAs in Distance_Elo with first quartile: 1237.38564383256
INFO [2025-03-29 12:53:41] Replaced NAs in Distance_C_Elo with first quartile: 1243.87329106944
INFO [2025-03-29 12:53:41] Replaced NAs in Distance_F_Elo with first quartile: 1256.69628195708
INFO [2025-03-29 12:53:41] Replaced NAs in Sprint_Elo with first quartile: 1246.32574824425
INFO [2025-03-29 12:53:41] Replaced NAs in Sprint_C_Elo with first quartile: 1257.67866787334
INFO [2025-03-29 12:53:41] Replaced NAs in Sprint_F_Elo with first quartile: 1244.84742904868
INFO [2025-03-29 12:53:41] Replaced NAs in Classic_Elo with first quartile: 1252.44868703669
INFO [2025-03-29 12:53:41] Replaced NAs in Freestyle_Elo with first quartile: 1244.44508230281
INFO [2025-03-29 12:53:41] Replaced NAs in Distance_Pelo with first quartile: 1241.11854419952
INFO [2025-03-29 12:53:41] Replaced NAs in Distance_C_Pelo with first quartile: 1245.57367555166
INFO [2025-03-29 12:53:41] Replaced NAs in Distance_F_Pelo with first quartile: 1259.54282973153
INFO [2025-03-29 12:53:41] Replaced NAs in Sprint_Pelo with first quartile: 1254.58885254623
INFO [2025-03-29 12:53:41] Replaced NAs in Sprint_C_Pelo with first quartile: 1257.58302026178
INFO [2025-03-29 12:53:41] Replaced NAs in Sprint_F_Pelo with first quartile: 1257.67755691493
INFO [2025-03-29 12:53:41] Replaced NAs in Classic_Pelo with first quartile: 1256.79275004544
INFO [2025-03-29 12:53:41] Replaced NAs in Freestyle_Pelo with first quartile: 1256.79999900008
INFO [2025-03-29 12:53:41] Replaced NAs in Classic_Last_5 with first quartile: 3.5
INFO [2025-03-29 12:53:41] Replaced NAs in Freestyle_Last_5 with first quartile: 2.4
INFO [2025-03-29 12:53:41] Created Pelo_Pct from Elo with max value: 1841.00191142018
INFO [2025-03-29 12:53:41] Created Distance_Pelo_Pct from Distance_Elo with max value: 1889.46974050597
INFO [2025-03-29 12:53:41] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1763.33572074398
INFO [2025-03-29 12:53:41] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1693.85026290322
INFO [2025-03-29 12:53:41] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1742.74758850835
INFO [2025-03-29 12:53:41] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1601.5820663103
INFO [2025-03-29 12:53:41] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1681.09824552997
INFO [2025-03-29 12:53:41] Created Classic_Pelo_Pct from Classic_Elo with max value: 1698.69428891549
INFO [2025-03-29 12:53:41] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1707.58410982918
INFO [2025-03-29 12:53:41] Prepared data for 255 ladies skiers with 33 features
INFO [2025-03-29 12:53:41] No FIS startlist, predicting for all skiers in all legs
INFO [2025-03-29 12:53:41] No valid FIS startlist for ladies, building optimized teams
INFO [2025-03-29 12:53:41] Attempting Option 1: Team model coefficients
INFO [2025-03-29 12:53:41] Option 1 failed: argument "leg_models" is missing, with no default
INFO [2025-03-29 12:53:41] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 12:53:41] Option 2 failed: argument "leg_models" is missing, with no default
INFO [2025-03-29 12:53:41] Using Option 3: Default leg importance weights
INFO [2025-03-29 12:53:41] Using leg importance weights for team optimization: Leg 1: 0.20, Leg 2: 0.20, Leg 3: 0.25, Leg 4: 0.35
INFO [2025-03-29 12:53:41] Optimizing team for Sweden
INFO [2025-03-29 12:53:41] Optimizing team for Norway
INFO [2025-03-29 12:53:41] Optimizing team for Germany
INFO [2025-03-29 12:53:41] Optimizing team for USA
INFO [2025-03-29 12:53:41] Optimizing team for Austria
INFO [2025-03-29 12:53:42] Optimizing team for Finland
INFO [2025-03-29 12:53:42] Optimizing team for Czechia
INFO [2025-03-29 12:53:42] Optimizing team for Switzerland
INFO [2025-03-29 12:53:42] Optimizing team for Italy
INFO [2025-03-29 12:53:42] Optimizing team for France
INFO [2025-03-29 12:53:42] Optimizing team for Canada
INFO [2025-03-29 12:53:42] Optimizing team for Slovenia
INFO [2025-03-29 12:53:42] Optimizing team for Estonia
INFO [2025-03-29 12:53:42] Optimizing team for Australia
INFO [2025-03-29 12:53:42] Optimizing team for Ukraine
INFO [2025-03-29 12:53:42] Optimizing team for Kazakhstan
INFO [2025-03-29 12:53:42] Optimizing team for Armenia
INFO [2025-03-29 12:53:42] Optimizing team for Latvia
INFO [2025-03-29 12:53:42] Optimizing team for Japan
INFO [2025-03-29 12:53:42] Optimizing team for Poland
INFO [2025-03-29 12:53:42] Optimizing team for South Korea
INFO [2025-03-29 12:53:42] Optimizing team for Andorra
INFO [2025-03-29 12:53:42] Optimizing team for Taiwan
INFO [2025-03-29 12:53:42] Optimizing team for China
INFO [2025-03-29 12:53:42] Optimizing team for Croatia
INFO [2025-03-29 12:53:42] Optimizing team for Slovakia
INFO [2025-03-29 12:53:42] Optimizing team for Argentina
INFO [2025-03-29 12:53:42] Optimizing team for Mongolia
INFO [2025-03-29 12:53:42] Optimizing team for Brazil
INFO [2025-03-29 12:53:42] Optimizing team for Lithuania
INFO [2025-03-29 12:53:42] Optimizing team for Greece
INFO [2025-03-29 12:53:42] Optimizing team for Iceland
INFO [2025-03-29 12:53:42] Optimizing team for Bulgaria
INFO [2025-03-29 12:53:42] Optimizing team for Serbia
INFO [2025-03-29 12:53:42] Optimizing team for Hungary
INFO [2025-03-29 12:53:42] Optimizing team for Turkey
INFO [2025-03-29 12:53:42] Optimizing team for North Macedonia
INFO [2025-03-29 12:53:42] Optimizing team for Romania
INFO [2025-03-29 12:53:42] Optimizing team for Bosnia&Herzegovina
INFO [2025-03-29 12:53:42] Optimizing team for Mexico
INFO [2025-03-29 12:53:42] Optimizing team for Iran
INFO [2025-03-29 12:53:42] Optimizing team for Chile
INFO [2025-03-29 12:53:42] Optimizing team for India
INFO [2025-03-29 12:53:42] Optimizing team for Malaysia
INFO [2025-03-29 12:53:42] Optimizing team for Haiti
INFO [2025-03-29 12:53:42] Optimizing team for Lebanon
INFO [2025-03-29 12:53:42] Optimizing team for Liechtenstein
INFO [2025-03-29 12:53:43] Matching optimized teams with startlist team names and prices
INFO [2025-03-29 12:53:43] Resetting men's probabilities at or below the mode to zero
INFO [2025-03-29 12:53:43] No values appear more than twice for Win_Prob
INFO [2025-03-29 12:53:43] No values appear more than twice for Podium_Prob
INFO [2025-03-29 12:53:43] No values appear more than twice for Top5_Prob
INFO [2025-03-29 12:53:43] No values appear more than twice for Top10_Prob
INFO [2025-03-29 12:53:43] Resetting ladies' probabilities at or below the mode to zero
INFO [2025-03-29 12:53:43] Reset 20 values to 0 for Win_Prob (repeated values or values <  0 )
INFO [2025-03-29 12:53:43] Repeated values: 0, 0, 0, 0, 0
INFO [2025-03-29 12:53:43] No values appear more than twice for Podium_Prob
INFO [2025-03-29 12:53:43] No values appear more than twice for Top5_Prob
INFO [2025-03-29 12:53:43] No values appear more than twice for Top10_Prob
INFO [2025-03-29 12:53:43] Normalizing men's team probabilities
INFO [2025-03-29 12:53:43] Normalized Win_Prob from sum of 0.71 to 1
INFO [2025-03-29 12:53:43] Normalized Podium_Prob from sum of 2.34 to 3
INFO [2025-03-29 12:53:43] Normalized Top5_Prob from sum of 4.2 to 5
INFO [2025-03-29 12:53:43] Normalized Top10_Prob from sum of 10.33 to 10
INFO [2025-03-29 12:53:43] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 12:53:43] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 12:53:43] Normalizing ladies' team probabilities
INFO [2025-03-29 12:53:43] Normalized Win_Prob from sum of 2.19 to 1
INFO [2025-03-29 12:53:43] Normalized Podium_Prob from sum of 4.41 to 3
INFO [2025-03-29 12:53:43] Normalized Top5_Prob from sum of 4.73 to 5
INFO [2025-03-29 12:53:43] Normalized Top10_Prob from sum of 13.19 to 10
INFO [2025-03-29 12:53:43] Final capping of probabilities to maximum of 1
INFO [2025-03-29 12:53:43] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 12:53:43] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 12:53:43] Optimizing fantasy relay team
INFO [2025-03-29 12:53:43] Fantasy team optimization complete. Selected 6 teams.
INFO [2025-03-29 12:53:43] Total price: 92546 of max 1e+05
INFO [2025-03-29 12:53:43] Expected total points: 542.9
INFO [2025-03-29 12:53:43] Men's teams: 6 ( 6 )
INFO [2025-03-29 12:53:43] Ladies' teams: 0 ( 0 )
INFO [2025-03-29 12:53:43] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_points.xlsx
INFO [2025-03-29 12:53:43] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_probabilities.xlsx
INFO [2025-03-29 12:53:43] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_points.xlsx
INFO [2025-03-29 12:53:43] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_probabilities.xlsx
INFO [2025-03-29 12:53:43] Saved fantasy team results to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/fantasy_relay_team.xlsx
INFO [2025-03-29 12:53:43] Relay predictions completed successfully
INFO [2025-03-29 12:58:48] Starting relay predictions process
INFO [2025-03-29 12:58:49] Loading weekend race data
INFO [2025-03-29 12:58:49] Tomorrow's date: 2025-03-29
INFO [2025-03-29 12:58:49] Found 1 men's relay races and 1 ladies' relay races
INFO [2025-03-29 12:58:49] Loading chrono data
INFO [2025-03-29 12:58:54] Loaded men's chrono with 105122 rows and 36 columns
INFO [2025-03-29 12:58:54] Loaded ladies' chrono with 78706 rows and 36 columns
INFO [2025-03-29 12:58:54] Created men's relay df with 9688 rows
INFO [2025-03-29 12:58:54] Created men's individual df with 92143 rows
INFO [2025-03-29 12:58:54] Created ladies' relay df with 8019 rows
INFO [2025-03-29 12:58:54] Created ladies' individual df with 68253 rows
INFO [2025-03-29 12:58:59] Training models for Leg 1
INFO [2025-03-29 12:58:59] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:58:59] Training podium model using glm
INFO [2025-03-29 12:58:59] Training win model using glm
INFO [2025-03-29 12:58:59] Training top5 model using glm
INFO [2025-03-29 12:58:59] Training top10 model using glm
INFO [2025-03-29 12:58:59] Top features for Leg 1 podium prediction:
INFO [2025-03-29 12:58:59] Training models for Leg 2
INFO [2025-03-29 12:58:59] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:58:59] Training podium model using glm
INFO [2025-03-29 12:58:59] Training win model using glm
INFO [2025-03-29 12:58:59] Training top5 model using glm
INFO [2025-03-29 12:59:00] Training top10 model using glm
INFO [2025-03-29 12:59:00] Top features for Leg 2 podium prediction:
INFO [2025-03-29 12:59:00] Training models for Leg 3
INFO [2025-03-29 12:59:00] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:59:00] Training podium model using glm
INFO [2025-03-29 12:59:00] Training win model using glm
INFO [2025-03-29 12:59:00] Training top5 model using glm
INFO [2025-03-29 12:59:00] Training top10 model using glm
INFO [2025-03-29 12:59:00] Top features for Leg 3 podium prediction:
INFO [2025-03-29 12:59:00] Training models for Leg 4
INFO [2025-03-29 12:59:00] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:59:00] Training podium model using glm
INFO [2025-03-29 12:59:00] Training win model using glm
INFO [2025-03-29 12:59:00] Training top5 model using glm
INFO [2025-03-29 12:59:00] Training top10 model using glm
INFO [2025-03-29 12:59:00] Top features for Leg 4 podium prediction:
INFO [2025-03-29 12:59:00] Training models for Leg 1
INFO [2025-03-29 12:59:00] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:59:00] Training podium model using glm
INFO [2025-03-29 12:59:00] Training win model using glm
INFO [2025-03-29 12:59:01] Training top5 model using glm
INFO [2025-03-29 12:59:01] Training top10 model using glm
INFO [2025-03-29 12:59:01] Top features for Leg 1 podium prediction:
INFO [2025-03-29 12:59:01] Training models for Leg 2
INFO [2025-03-29 12:59:01] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:59:01] Training podium model using glm
INFO [2025-03-29 12:59:01] Training win model using glm
INFO [2025-03-29 12:59:01] Training top5 model using glm
INFO [2025-03-29 12:59:01] Training top10 model using glm
INFO [2025-03-29 12:59:01] Top features for Leg 2 podium prediction:
INFO [2025-03-29 12:59:01] Training models for Leg 3
INFO [2025-03-29 12:59:01] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:59:01] Training podium model using glm
INFO [2025-03-29 12:59:01] Training win model using glm
INFO [2025-03-29 12:59:01] Training top5 model using glm
INFO [2025-03-29 12:59:01] Training top10 model using glm
INFO [2025-03-29 12:59:01] Top features for Leg 3 podium prediction:
INFO [2025-03-29 12:59:01] Training models for Leg 4
INFO [2025-03-29 12:59:01] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:59:01] Training podium model using glm
INFO [2025-03-29 12:59:01] Training win model using glm
INFO [2025-03-29 12:59:02] Training top5 model using glm
INFO [2025-03-29 12:59:02] Training top10 model using glm
INFO [2025-03-29 12:59:02] Top features for Leg 4 podium prediction:
INFO [2025-03-29 12:59:02] Processing men's relay predictions
INFO [2025-03-29 12:59:02] Loaded men relay teams startlist with 24 rows
INFO [2025-03-29 12:59:02] Loaded men relay individuals startlist with 96 rows
INFO [2025-03-29 12:59:02] Preparing current men skier data
INFO [2025-03-29 12:59:02] Found 9 Elo columns for current skiers
INFO [2025-03-29 12:59:02] Replaced NAs in Distance_Elo with first quartile: 1207.23243912712
INFO [2025-03-29 12:59:02] Replaced NAs in Distance_C_Elo with first quartile: 1233.40200699225
INFO [2025-03-29 12:59:02] Replaced NAs in Distance_F_Elo with first quartile: 1236.48554062178
INFO [2025-03-29 12:59:02] Replaced NAs in Sprint_Elo with first quartile: 1223.60107000698
INFO [2025-03-29 12:59:02] Replaced NAs in Sprint_C_Elo with first quartile: 1241.28715500947
INFO [2025-03-29 12:59:02] Replaced NAs in Sprint_F_Elo with first quartile: 1234.45151108772
INFO [2025-03-29 12:59:02] Replaced NAs in Classic_Elo with first quartile: 1241.52867310024
INFO [2025-03-29 12:59:02] Replaced NAs in Freestyle_Elo with first quartile: 1228.48649348109
INFO [2025-03-29 12:59:02] Replaced NAs in Distance_Pelo with first quartile: 1211.63035979047
INFO [2025-03-29 12:59:02] Replaced NAs in Distance_C_Pelo with first quartile: 1234.81091928129
INFO [2025-03-29 12:59:02] Replaced NAs in Distance_F_Pelo with first quartile: 1239.65331180248
INFO [2025-03-29 12:59:02] Replaced NAs in Sprint_Pelo with first quartile: 1240.94751821383
INFO [2025-03-29 12:59:02] Replaced NAs in Sprint_C_Pelo with first quartile: 1241.28715500947
INFO [2025-03-29 12:59:02] Replaced NAs in Sprint_F_Pelo with first quartile: 1252.45166310493
INFO [2025-03-29 12:59:02] Replaced NAs in Classic_Pelo with first quartile: 1243.63746068082
INFO [2025-03-29 12:59:02] Replaced NAs in Freestyle_Pelo with first quartile: 1249.30280713791
INFO [2025-03-29 12:59:02] Replaced NAs in Classic_Last_5 with first quartile: 0
INFO [2025-03-29 12:59:02] Replaced NAs in Freestyle_Last_5 with first quartile: 0
INFO [2025-03-29 12:59:02] Created Pelo_Pct from Elo with max value: 1946.6211651574
INFO [2025-03-29 12:59:02] Created Distance_Pelo_Pct from Distance_Elo with max value: 1869.1251911742
INFO [2025-03-29 12:59:02] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1777.16297253153
INFO [2025-03-29 12:59:02] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1695.2053212904
INFO [2025-03-29 12:59:02] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1886.80363942481
INFO [2025-03-29 12:59:02] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1711.08486899169
INFO [2025-03-29 12:59:02] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1792.65157560707
INFO [2025-03-29 12:59:02] Created Classic_Pelo_Pct from Classic_Elo with max value: 1807.56773496777
INFO [2025-03-29 12:59:02] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1814.60460629541
INFO [2025-03-29 12:59:02] Prepared data for 381 men skiers with 33 features
INFO [2025-03-29 12:59:02] Using FIS startlist for men's leg predictions
INFO [2025-03-29 12:59:02] Using FIS startlist for men
INFO [2025-03-29 12:59:02] Attempting Option 1: Team model coefficients
INFO [2025-03-29 12:59:02] Option 1 failed: No team_podium model found
INFO [2025-03-29 12:59:02] Option 1 failed: No team model
INFO [2025-03-29 12:59:02] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 12:59:02] Leg 1 accuracy: 0.861850769530489
INFO [2025-03-29 12:59:02] Leg 2 accuracy: 0.823528151178648
INFO [2025-03-29 12:59:02] Leg 3 accuracy: 0.860432495616599
INFO [2025-03-29 12:59:02] Leg 4 accuracy: 0.881515682836548
INFO [2025-03-29 12:59:02] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 12:59:02] Leg importance weights: Leg 1: 0.25, Leg 2: 0.24, Leg 3: 0.25, Leg 4: 0.26
INFO [2025-03-29 12:59:02] Processing ladies's relay predictions
INFO [2025-03-29 12:59:02] Loaded ladies relay teams startlist with 35 rows
INFO [2025-03-29 12:59:02] Loaded ladies relay individuals startlist with 231 rows
INFO [2025-03-29 12:59:02] Preparing current ladies skier data
INFO [2025-03-29 12:59:02] Found 9 Elo columns for current skiers
INFO [2025-03-29 12:59:03] Replaced NAs in Distance_Elo with first quartile: 1237.38564383256
INFO [2025-03-29 12:59:03] Replaced NAs in Distance_C_Elo with first quartile: 1243.87329106944
INFO [2025-03-29 12:59:03] Replaced NAs in Distance_F_Elo with first quartile: 1256.69628195708
INFO [2025-03-29 12:59:03] Replaced NAs in Sprint_Elo with first quartile: 1246.32574824425
INFO [2025-03-29 12:59:03] Replaced NAs in Sprint_C_Elo with first quartile: 1257.67866787334
INFO [2025-03-29 12:59:03] Replaced NAs in Sprint_F_Elo with first quartile: 1244.84742904868
INFO [2025-03-29 12:59:03] Replaced NAs in Classic_Elo with first quartile: 1252.44868703669
INFO [2025-03-29 12:59:03] Replaced NAs in Freestyle_Elo with first quartile: 1244.44508230281
INFO [2025-03-29 12:59:03] Replaced NAs in Distance_Pelo with first quartile: 1241.11854419952
INFO [2025-03-29 12:59:03] Replaced NAs in Distance_C_Pelo with first quartile: 1245.57367555166
INFO [2025-03-29 12:59:03] Replaced NAs in Distance_F_Pelo with first quartile: 1259.54282973153
INFO [2025-03-29 12:59:03] Replaced NAs in Sprint_Pelo with first quartile: 1254.58885254623
INFO [2025-03-29 12:59:03] Replaced NAs in Sprint_C_Pelo with first quartile: 1257.58302026178
INFO [2025-03-29 12:59:03] Replaced NAs in Sprint_F_Pelo with first quartile: 1257.67755691493
INFO [2025-03-29 12:59:03] Replaced NAs in Classic_Pelo with first quartile: 1256.79275004544
INFO [2025-03-29 12:59:03] Replaced NAs in Freestyle_Pelo with first quartile: 1256.79999900008
INFO [2025-03-29 12:59:03] Replaced NAs in Classic_Last_5 with first quartile: 3.5
INFO [2025-03-29 12:59:03] Replaced NAs in Freestyle_Last_5 with first quartile: 2.4
INFO [2025-03-29 12:59:03] Created Pelo_Pct from Elo with max value: 1841.00191142018
INFO [2025-03-29 12:59:03] Created Distance_Pelo_Pct from Distance_Elo with max value: 1889.46974050597
INFO [2025-03-29 12:59:03] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1763.33572074398
INFO [2025-03-29 12:59:03] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1693.85026290322
INFO [2025-03-29 12:59:03] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1742.74758850835
INFO [2025-03-29 12:59:03] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1601.5820663103
INFO [2025-03-29 12:59:03] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1681.09824552997
INFO [2025-03-29 12:59:03] Created Classic_Pelo_Pct from Classic_Elo with max value: 1698.69428891549
INFO [2025-03-29 12:59:03] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1707.58410982918
INFO [2025-03-29 12:59:03] Prepared data for 255 ladies skiers with 33 features
INFO [2025-03-29 12:59:03] No FIS startlist, predicting for all skiers in all legs
INFO [2025-03-29 12:59:03] No valid FIS startlist for ladies, building optimized teams
INFO [2025-03-29 12:59:03] Attempting Option 1: Team model coefficients
INFO [2025-03-29 12:59:03] Option 1 failed: argument "leg_models" is missing, with no default
INFO [2025-03-29 12:59:03] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 12:59:03] Option 2 failed: argument "leg_models" is missing, with no default
INFO [2025-03-29 12:59:03] Using Option 3: Default leg importance weights
INFO [2025-03-29 12:59:03] Using leg importance weights for team optimization: Leg 1: 0.20, Leg 2: 0.20, Leg 3: 0.25, Leg 4: 0.35
INFO [2025-03-29 12:59:03] Optimizing team for Sweden
INFO [2025-03-29 12:59:03] Optimizing team for Norway
INFO [2025-03-29 12:59:03] Optimizing team for Germany
INFO [2025-03-29 12:59:03] Optimizing team for USA
INFO [2025-03-29 12:59:03] Optimizing team for Austria
INFO [2025-03-29 12:59:03] Optimizing team for Finland
INFO [2025-03-29 12:59:03] Optimizing team for Czechia
INFO [2025-03-29 12:59:03] Optimizing team for Switzerland
INFO [2025-03-29 12:59:03] Optimizing team for Italy
INFO [2025-03-29 12:59:03] Optimizing team for France
INFO [2025-03-29 12:59:03] Optimizing team for Canada
INFO [2025-03-29 12:59:03] Optimizing team for Slovenia
INFO [2025-03-29 12:59:03] Optimizing team for Estonia
INFO [2025-03-29 12:59:03] Optimizing team for Australia
INFO [2025-03-29 12:59:03] Optimizing team for Ukraine
INFO [2025-03-29 12:59:03] Optimizing team for Kazakhstan
INFO [2025-03-29 12:59:03] Optimizing team for Armenia
INFO [2025-03-29 12:59:03] Optimizing team for Latvia
INFO [2025-03-29 12:59:03] Optimizing team for Japan
INFO [2025-03-29 12:59:03] Optimizing team for Poland
INFO [2025-03-29 12:59:04] Optimizing team for South Korea
INFO [2025-03-29 12:59:04] Optimizing team for Andorra
INFO [2025-03-29 12:59:04] Optimizing team for Taiwan
INFO [2025-03-29 12:59:04] Optimizing team for China
INFO [2025-03-29 12:59:04] Optimizing team for Croatia
INFO [2025-03-29 12:59:04] Optimizing team for Slovakia
INFO [2025-03-29 12:59:04] Optimizing team for Argentina
INFO [2025-03-29 12:59:04] Optimizing team for Mongolia
INFO [2025-03-29 12:59:04] Optimizing team for Brazil
INFO [2025-03-29 12:59:04] Optimizing team for Lithuania
INFO [2025-03-29 12:59:04] Optimizing team for Greece
INFO [2025-03-29 12:59:04] Optimizing team for Iceland
INFO [2025-03-29 12:59:04] Optimizing team for Bulgaria
INFO [2025-03-29 12:59:04] Optimizing team for Serbia
INFO [2025-03-29 12:59:04] Optimizing team for Hungary
INFO [2025-03-29 12:59:04] Optimizing team for Turkey
INFO [2025-03-29 12:59:04] Optimizing team for North Macedonia
INFO [2025-03-29 12:59:04] Optimizing team for Romania
INFO [2025-03-29 12:59:04] Optimizing team for Bosnia&Herzegovina
INFO [2025-03-29 12:59:04] Optimizing team for Mexico
INFO [2025-03-29 12:59:04] Optimizing team for Iran
INFO [2025-03-29 12:59:04] Optimizing team for Chile
INFO [2025-03-29 12:59:04] Optimizing team for India
INFO [2025-03-29 12:59:04] Optimizing team for Malaysia
INFO [2025-03-29 12:59:04] Optimizing team for Haiti
INFO [2025-03-29 12:59:04] Optimizing team for Lebanon
INFO [2025-03-29 12:59:04] Optimizing team for Liechtenstein
INFO [2025-03-29 12:59:04] Matching optimized teams with startlist team names and prices
INFO [2025-03-29 12:59:04] Resetting men's probabilities at or below the mode to zero
INFO [2025-03-29 12:59:04] No values appear more than twice for Win_Prob
INFO [2025-03-29 12:59:04] No values appear more than twice for Podium_Prob
INFO [2025-03-29 12:59:04] No values appear more than twice for Top5_Prob
INFO [2025-03-29 12:59:04] No values appear more than twice for Top10_Prob
INFO [2025-03-29 12:59:04] Resetting ladies' probabilities at or below the mode to zero
INFO [2025-03-29 12:59:04] Reset 20 values to 0 for Win_Prob (repeated values or values <  0 )
INFO [2025-03-29 12:59:04] Repeated values: 0, 0, 0, 0, 0
INFO [2025-03-29 12:59:04] No values appear more than twice for Podium_Prob
INFO [2025-03-29 12:59:04] No values appear more than twice for Top5_Prob
INFO [2025-03-29 12:59:04] No values appear more than twice for Top10_Prob
INFO [2025-03-29 12:59:04] Normalizing men's team probabilities
INFO [2025-03-29 12:59:04] Normalized Win_Prob from sum of 0.71 to 1
INFO [2025-03-29 12:59:04] Normalized Podium_Prob from sum of 2.34 to 3
INFO [2025-03-29 12:59:04] Normalized Top5_Prob from sum of 4.2 to 5
INFO [2025-03-29 12:59:04] Normalized Top10_Prob from sum of 10.32 to 10
INFO [2025-03-29 12:59:04] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 12:59:04] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 12:59:04] Normalizing ladies' team probabilities
INFO [2025-03-29 12:59:04] Normalized Win_Prob from sum of 2.19 to 1
INFO [2025-03-29 12:59:04] Normalized Podium_Prob from sum of 4.41 to 3
INFO [2025-03-29 12:59:04] Normalized Top5_Prob from sum of 4.73 to 5
INFO [2025-03-29 12:59:04] Normalized Top10_Prob from sum of 13.19 to 10
INFO [2025-03-29 12:59:04] Final capping of probabilities to maximum of 1
INFO [2025-03-29 12:59:04] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 12:59:04] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 12:59:04] Optimizing fantasy relay team
INFO [2025-03-29 12:59:04] Fantasy team optimization complete. Selected 6 teams.
INFO [2025-03-29 12:59:04] Total price: 92546 of max 1e+05
INFO [2025-03-29 12:59:04] Expected total points: 542.4
INFO [2025-03-29 12:59:04] Men's teams: 6 ( 6 )
INFO [2025-03-29 12:59:04] Ladies' teams: 0 ( 0 )
INFO [2025-03-29 12:59:04] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_points.xlsx
INFO [2025-03-29 12:59:04] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_probabilities.xlsx
INFO [2025-03-29 12:59:04] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_points.xlsx
INFO [2025-03-29 12:59:05] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_probabilities.xlsx
INFO [2025-03-29 12:59:05] Saved fantasy team results to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/fantasy_relay_team.xlsx
INFO [2025-03-29 12:59:05] Relay predictions completed successfully
INFO [2025-03-29 12:59:43] Starting relay predictions process
INFO [2025-03-29 12:59:43] Loading weekend race data
INFO [2025-03-29 12:59:43] Tomorrow's date: 2025-03-29
INFO [2025-03-29 12:59:43] Found 1 men's relay races and 1 ladies' relay races
INFO [2025-03-29 12:59:43] Loading chrono data
INFO [2025-03-29 12:59:48] Loaded men's chrono with 105122 rows and 36 columns
INFO [2025-03-29 12:59:48] Loaded ladies' chrono with 78706 rows and 36 columns
INFO [2025-03-29 12:59:49] Created men's relay df with 9688 rows
INFO [2025-03-29 12:59:49] Created men's individual df with 92143 rows
INFO [2025-03-29 12:59:49] Created ladies' relay df with 8019 rows
INFO [2025-03-29 12:59:49] Created ladies' individual df with 68253 rows
INFO [2025-03-29 12:59:53] Training models for Leg 1
INFO [2025-03-29 12:59:53] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:59:53] Training podium model using glm
INFO [2025-03-29 12:59:53] Training win model using glm
INFO [2025-03-29 12:59:53] Training top5 model using glm
INFO [2025-03-29 12:59:53] Training top10 model using glm
INFO [2025-03-29 12:59:53] Top features for Leg 1 podium prediction:
INFO [2025-03-29 12:59:53] Training models for Leg 2
INFO [2025-03-29 12:59:54] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:59:54] Training podium model using glm
INFO [2025-03-29 12:59:54] Training win model using glm
INFO [2025-03-29 12:59:54] Training top5 model using glm
INFO [2025-03-29 12:59:54] Training top10 model using glm
INFO [2025-03-29 12:59:54] Top features for Leg 2 podium prediction:
INFO [2025-03-29 12:59:54] Training models for Leg 3
INFO [2025-03-29 12:59:54] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:59:54] Training podium model using glm
INFO [2025-03-29 12:59:54] Training win model using glm
INFO [2025-03-29 12:59:54] Training top5 model using glm
INFO [2025-03-29 12:59:54] Training top10 model using glm
INFO [2025-03-29 12:59:54] Top features for Leg 3 podium prediction:
INFO [2025-03-29 12:59:54] Training models for Leg 4
INFO [2025-03-29 12:59:54] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:59:54] Training podium model using glm
INFO [2025-03-29 12:59:54] Training win model using glm
INFO [2025-03-29 12:59:54] Training top5 model using glm
INFO [2025-03-29 12:59:55] Training top10 model using glm
INFO [2025-03-29 12:59:55] Top features for Leg 4 podium prediction:
INFO [2025-03-29 12:59:55] Training models for Leg 1
INFO [2025-03-29 12:59:55] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:59:55] Training podium model using glm
INFO [2025-03-29 12:59:55] Training win model using glm
INFO [2025-03-29 12:59:55] Training top5 model using glm
INFO [2025-03-29 12:59:55] Training top10 model using glm
INFO [2025-03-29 12:59:55] Top features for Leg 1 podium prediction:
INFO [2025-03-29 12:59:55] Training models for Leg 2
INFO [2025-03-29 12:59:55] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:59:55] Training podium model using glm
INFO [2025-03-29 12:59:55] Training win model using glm
INFO [2025-03-29 12:59:55] Training top5 model using glm
INFO [2025-03-29 12:59:55] Training top10 model using glm
INFO [2025-03-29 12:59:55] Top features for Leg 2 podium prediction:
INFO [2025-03-29 12:59:55] Training models for Leg 3
INFO [2025-03-29 12:59:55] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:59:55] Training podium model using glm
INFO [2025-03-29 12:59:55] Training win model using glm
INFO [2025-03-29 12:59:55] Training top5 model using glm
INFO [2025-03-29 12:59:56] Training top10 model using glm
INFO [2025-03-29 12:59:56] Top features for Leg 3 podium prediction:
INFO [2025-03-29 12:59:56] Training models for Leg 4
INFO [2025-03-29 12:59:56] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 12:59:56] Training podium model using glm
INFO [2025-03-29 12:59:56] Training win model using glm
INFO [2025-03-29 12:59:56] Training top5 model using glm
INFO [2025-03-29 12:59:56] Training top10 model using glm
INFO [2025-03-29 12:59:56] Top features for Leg 4 podium prediction:
INFO [2025-03-29 12:59:56] Processing men's relay predictions
INFO [2025-03-29 12:59:56] Loaded men relay teams startlist with 24 rows
INFO [2025-03-29 12:59:56] Loaded men relay individuals startlist with 96 rows
INFO [2025-03-29 12:59:56] Preparing current men skier data
INFO [2025-03-29 12:59:56] Found 9 Elo columns for current skiers
INFO [2025-03-29 12:59:56] Replaced NAs in Distance_Elo with first quartile: 1207.23243912712
INFO [2025-03-29 12:59:56] Replaced NAs in Distance_C_Elo with first quartile: 1233.40200699225
INFO [2025-03-29 12:59:56] Replaced NAs in Distance_F_Elo with first quartile: 1236.48554062178
INFO [2025-03-29 12:59:56] Replaced NAs in Sprint_Elo with first quartile: 1223.60107000698
INFO [2025-03-29 12:59:56] Replaced NAs in Sprint_C_Elo with first quartile: 1241.28715500947
INFO [2025-03-29 12:59:56] Replaced NAs in Sprint_F_Elo with first quartile: 1234.45151108772
INFO [2025-03-29 12:59:56] Replaced NAs in Classic_Elo with first quartile: 1241.52867310024
INFO [2025-03-29 12:59:56] Replaced NAs in Freestyle_Elo with first quartile: 1228.48649348109
INFO [2025-03-29 12:59:56] Replaced NAs in Distance_Pelo with first quartile: 1211.63035979047
INFO [2025-03-29 12:59:56] Replaced NAs in Distance_C_Pelo with first quartile: 1234.81091928129
INFO [2025-03-29 12:59:56] Replaced NAs in Distance_F_Pelo with first quartile: 1239.65331180248
INFO [2025-03-29 12:59:56] Replaced NAs in Sprint_Pelo with first quartile: 1240.94751821383
INFO [2025-03-29 12:59:56] Replaced NAs in Sprint_C_Pelo with first quartile: 1241.28715500947
INFO [2025-03-29 12:59:56] Replaced NAs in Sprint_F_Pelo with first quartile: 1252.45166310493
INFO [2025-03-29 12:59:56] Replaced NAs in Classic_Pelo with first quartile: 1243.63746068082
INFO [2025-03-29 12:59:56] Replaced NAs in Freestyle_Pelo with first quartile: 1249.30280713791
INFO [2025-03-29 12:59:56] Replaced NAs in Classic_Last_5 with first quartile: 0
INFO [2025-03-29 12:59:56] Replaced NAs in Freestyle_Last_5 with first quartile: 0
INFO [2025-03-29 12:59:56] Created Pelo_Pct from Elo with max value: 1946.6211651574
INFO [2025-03-29 12:59:56] Created Distance_Pelo_Pct from Distance_Elo with max value: 1869.1251911742
INFO [2025-03-29 12:59:56] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1777.16297253153
INFO [2025-03-29 12:59:56] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1695.2053212904
INFO [2025-03-29 12:59:56] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1886.80363942481
INFO [2025-03-29 12:59:56] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1711.08486899169
INFO [2025-03-29 12:59:56] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1792.65157560707
INFO [2025-03-29 12:59:56] Created Classic_Pelo_Pct from Classic_Elo with max value: 1807.56773496777
INFO [2025-03-29 12:59:56] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1814.60460629541
INFO [2025-03-29 12:59:56] Prepared data for 381 men skiers with 33 features
INFO [2025-03-29 12:59:56] Using FIS startlist for men's leg predictions
INFO [2025-03-29 12:59:56] Using FIS startlist for men
INFO [2025-03-29 12:59:56] Attempting Option 1: Team model coefficients
INFO [2025-03-29 12:59:56] Option 1 failed: No team_podium model found
INFO [2025-03-29 12:59:56] Option 1 failed: No team model
INFO [2025-03-29 12:59:56] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 12:59:56] Leg 1 accuracy: 0.854632768361582
INFO [2025-03-29 12:59:56] Leg 2 accuracy: 0.841225404247029
INFO [2025-03-29 12:59:56] Leg 3 accuracy: 0.86750438340152
INFO [2025-03-29 12:59:56] Leg 4 accuracy: 0.891525423728814
INFO [2025-03-29 12:59:56] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 12:59:56] Leg importance weights: Leg 1: 0.25, Leg 2: 0.24, Leg 3: 0.25, Leg 4: 0.26
INFO [2025-03-29 12:59:56] Processing ladies's relay predictions
INFO [2025-03-29 12:59:56] Loaded ladies relay teams startlist with 35 rows
INFO [2025-03-29 12:59:56] Loaded ladies relay individuals startlist with 231 rows
INFO [2025-03-29 12:59:56] Preparing current ladies skier data
INFO [2025-03-29 12:59:57] Found 9 Elo columns for current skiers
INFO [2025-03-29 12:59:57] Replaced NAs in Distance_Elo with first quartile: 1237.38564383256
INFO [2025-03-29 12:59:57] Replaced NAs in Distance_C_Elo with first quartile: 1243.87329106944
INFO [2025-03-29 12:59:57] Replaced NAs in Distance_F_Elo with first quartile: 1256.69628195708
INFO [2025-03-29 12:59:57] Replaced NAs in Sprint_Elo with first quartile: 1246.32574824425
INFO [2025-03-29 12:59:57] Replaced NAs in Sprint_C_Elo with first quartile: 1257.67866787334
INFO [2025-03-29 12:59:57] Replaced NAs in Sprint_F_Elo with first quartile: 1244.84742904868
INFO [2025-03-29 12:59:57] Replaced NAs in Classic_Elo with first quartile: 1252.44868703669
INFO [2025-03-29 12:59:57] Replaced NAs in Freestyle_Elo with first quartile: 1244.44508230281
INFO [2025-03-29 12:59:57] Replaced NAs in Distance_Pelo with first quartile: 1241.11854419952
INFO [2025-03-29 12:59:57] Replaced NAs in Distance_C_Pelo with first quartile: 1245.57367555166
INFO [2025-03-29 12:59:57] Replaced NAs in Distance_F_Pelo with first quartile: 1259.54282973153
INFO [2025-03-29 12:59:57] Replaced NAs in Sprint_Pelo with first quartile: 1254.58885254623
INFO [2025-03-29 12:59:57] Replaced NAs in Sprint_C_Pelo with first quartile: 1257.58302026178
INFO [2025-03-29 12:59:57] Replaced NAs in Sprint_F_Pelo with first quartile: 1257.67755691493
INFO [2025-03-29 12:59:57] Replaced NAs in Classic_Pelo with first quartile: 1256.79275004544
INFO [2025-03-29 12:59:57] Replaced NAs in Freestyle_Pelo with first quartile: 1256.79999900008
INFO [2025-03-29 12:59:57] Replaced NAs in Classic_Last_5 with first quartile: 3.5
INFO [2025-03-29 12:59:57] Replaced NAs in Freestyle_Last_5 with first quartile: 2.4
INFO [2025-03-29 12:59:57] Created Pelo_Pct from Elo with max value: 1841.00191142018
INFO [2025-03-29 12:59:57] Created Distance_Pelo_Pct from Distance_Elo with max value: 1889.46974050597
INFO [2025-03-29 12:59:57] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1763.33572074398
INFO [2025-03-29 12:59:57] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1693.85026290322
INFO [2025-03-29 12:59:57] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1742.74758850835
INFO [2025-03-29 12:59:57] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1601.5820663103
INFO [2025-03-29 12:59:57] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1681.09824552997
INFO [2025-03-29 12:59:57] Created Classic_Pelo_Pct from Classic_Elo with max value: 1698.69428891549
INFO [2025-03-29 12:59:57] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1707.58410982918
INFO [2025-03-29 12:59:57] Prepared data for 255 ladies skiers with 33 features
INFO [2025-03-29 12:59:57] No FIS startlist, predicting for all skiers in all legs
INFO [2025-03-29 12:59:57] No valid FIS startlist for ladies, building optimized teams
INFO [2025-03-29 12:59:57] Attempting Option 1: Team model coefficients
INFO [2025-03-29 12:59:57] Option 1 failed: argument "leg_models" is missing, with no default
INFO [2025-03-29 12:59:57] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 12:59:57] Option 2 failed: argument "leg_models" is missing, with no default
INFO [2025-03-29 12:59:57] Using Option 3: Default leg importance weights
INFO [2025-03-29 12:59:57] Using leg importance weights for team optimization: Leg 1: 0.20, Leg 2: 0.20, Leg 3: 0.25, Leg 4: 0.35
INFO [2025-03-29 12:59:57] Optimizing team for Sweden
INFO [2025-03-29 12:59:57] Optimizing team for Norway
INFO [2025-03-29 12:59:57] Optimizing team for Germany
INFO [2025-03-29 12:59:57] Optimizing team for USA
INFO [2025-03-29 12:59:57] Optimizing team for Austria
INFO [2025-03-29 12:59:57] Optimizing team for Finland
INFO [2025-03-29 12:59:57] Optimizing team for Czechia
INFO [2025-03-29 12:59:57] Optimizing team for Switzerland
INFO [2025-03-29 12:59:57] Optimizing team for Italy
INFO [2025-03-29 12:59:57] Optimizing team for France
INFO [2025-03-29 12:59:57] Optimizing team for Canada
INFO [2025-03-29 12:59:57] Optimizing team for Slovenia
INFO [2025-03-29 12:59:57] Optimizing team for Estonia
INFO [2025-03-29 12:59:57] Optimizing team for Australia
INFO [2025-03-29 12:59:57] Optimizing team for Ukraine
INFO [2025-03-29 12:59:57] Optimizing team for Kazakhstan
INFO [2025-03-29 12:59:58] Optimizing team for Armenia
INFO [2025-03-29 12:59:58] Optimizing team for Latvia
INFO [2025-03-29 12:59:58] Optimizing team for Japan
INFO [2025-03-29 12:59:58] Optimizing team for Poland
INFO [2025-03-29 12:59:58] Optimizing team for South Korea
INFO [2025-03-29 12:59:58] Optimizing team for Andorra
INFO [2025-03-29 12:59:58] Optimizing team for Taiwan
INFO [2025-03-29 12:59:58] Optimizing team for China
INFO [2025-03-29 12:59:58] Optimizing team for Croatia
INFO [2025-03-29 12:59:58] Optimizing team for Slovakia
INFO [2025-03-29 12:59:58] Optimizing team for Argentina
INFO [2025-03-29 12:59:58] Optimizing team for Mongolia
INFO [2025-03-29 12:59:58] Optimizing team for Brazil
INFO [2025-03-29 12:59:58] Optimizing team for Lithuania
INFO [2025-03-29 12:59:58] Optimizing team for Greece
INFO [2025-03-29 12:59:58] Optimizing team for Iceland
INFO [2025-03-29 12:59:58] Optimizing team for Bulgaria
INFO [2025-03-29 12:59:58] Optimizing team for Serbia
INFO [2025-03-29 12:59:58] Optimizing team for Hungary
INFO [2025-03-29 12:59:58] Optimizing team for Turkey
INFO [2025-03-29 12:59:58] Optimizing team for North Macedonia
INFO [2025-03-29 12:59:58] Optimizing team for Romania
INFO [2025-03-29 12:59:58] Optimizing team for Bosnia&Herzegovina
INFO [2025-03-29 12:59:58] Optimizing team for Mexico
INFO [2025-03-29 12:59:58] Optimizing team for Iran
INFO [2025-03-29 12:59:58] Optimizing team for Chile
INFO [2025-03-29 12:59:58] Optimizing team for India
INFO [2025-03-29 12:59:58] Optimizing team for Malaysia
INFO [2025-03-29 12:59:58] Optimizing team for Haiti
INFO [2025-03-29 12:59:58] Optimizing team for Lebanon
INFO [2025-03-29 12:59:58] Optimizing team for Liechtenstein
WARN [2025-03-29 12:59:58] Could not read individuals file: invalid 'description' argument
WARN [2025-03-29 12:59:58] Could not read teams file: invalid 'description' argument
INFO [2025-03-29 12:59:58] Resetting men's probabilities at or below the mode to zero
INFO [2025-03-29 12:59:58] No values appear more than twice for Win_Prob
INFO [2025-03-29 12:59:58] No values appear more than twice for Podium_Prob
INFO [2025-03-29 12:59:58] No values appear more than twice for Top5_Prob
INFO [2025-03-29 12:59:58] No values appear more than twice for Top10_Prob
INFO [2025-03-29 12:59:58] Resetting ladies' probabilities at or below the mode to zero
INFO [2025-03-29 12:59:58] Reset 20 values to 0 for Win_Prob (repeated values or values <  0 )
INFO [2025-03-29 12:59:58] Repeated values: 0, 0, 0, 0, 0
INFO [2025-03-29 12:59:58] No values appear more than twice for Podium_Prob
INFO [2025-03-29 12:59:58] No values appear more than twice for Top5_Prob
INFO [2025-03-29 12:59:58] No values appear more than twice for Top10_Prob
INFO [2025-03-29 12:59:58] Normalizing men's team probabilities
INFO [2025-03-29 12:59:58] Normalized Win_Prob from sum of 0.72 to 1
INFO [2025-03-29 12:59:58] Normalized Podium_Prob from sum of 2.34 to 3
INFO [2025-03-29 12:59:58] Normalized Top5_Prob from sum of 4.2 to 5
INFO [2025-03-29 12:59:58] Normalized Top10_Prob from sum of 10.33 to 10
INFO [2025-03-29 12:59:58] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 12:59:58] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 12:59:58] Normalizing ladies' team probabilities
INFO [2025-03-29 12:59:58] Normalized Win_Prob from sum of 2.19 to 1
INFO [2025-03-29 12:59:58] Normalized Podium_Prob from sum of 4.41 to 3
INFO [2025-03-29 12:59:58] Normalized Top5_Prob from sum of 4.73 to 5
INFO [2025-03-29 12:59:58] Normalized Top10_Prob from sum of 13.19 to 10
INFO [2025-03-29 12:59:58] Final capping of probabilities to maximum of 1
INFO [2025-03-29 12:59:58] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 12:59:58] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 12:59:58] Optimizing fantasy relay team
INFO [2025-03-29 12:59:58] Fantasy team optimization complete. Selected 6 teams.
INFO [2025-03-29 12:59:58] Total price: 92546 of max 1e+05
INFO [2025-03-29 12:59:58] Expected total points: 543.1
INFO [2025-03-29 12:59:58] Men's teams: 6 ( 6 )
INFO [2025-03-29 12:59:58] Ladies' teams: 0 ( 0 )
INFO [2025-03-29 12:59:59] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_points.xlsx
INFO [2025-03-29 12:59:59] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_probabilities.xlsx
INFO [2025-03-29 12:59:59] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_points.xlsx
INFO [2025-03-29 12:59:59] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_probabilities.xlsx
INFO [2025-03-29 12:59:59] Saved fantasy team results to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/fantasy_relay_team.xlsx
INFO [2025-03-29 12:59:59] Relay predictions completed successfully
INFO [2025-03-29 13:01:34] Starting relay predictions process
INFO [2025-03-29 13:01:34] Loading weekend race data
INFO [2025-03-29 13:01:34] Tomorrow's date: 2025-03-29
INFO [2025-03-29 13:01:34] Found 1 men's relay races and 1 ladies' relay races
INFO [2025-03-29 13:01:34] Loading chrono data
INFO [2025-03-29 13:01:39] Loaded men's chrono with 105122 rows and 36 columns
INFO [2025-03-29 13:01:39] Loaded ladies' chrono with 78706 rows and 36 columns
INFO [2025-03-29 13:01:39] Created men's relay df with 9688 rows
INFO [2025-03-29 13:01:39] Created men's individual df with 92143 rows
INFO [2025-03-29 13:01:39] Created ladies' relay df with 8019 rows
INFO [2025-03-29 13:01:39] Created ladies' individual df with 68253 rows
INFO [2025-03-29 13:01:44] Training models for Leg 1
INFO [2025-03-29 13:01:44] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:01:44] Training podium model using glm
INFO [2025-03-29 13:01:44] Training win model using glm
INFO [2025-03-29 13:01:44] Training top5 model using glm
INFO [2025-03-29 13:01:44] Training top10 model using glm
INFO [2025-03-29 13:01:44] Top features for Leg 1 podium prediction:
INFO [2025-03-29 13:01:44] Training models for Leg 2
INFO [2025-03-29 13:01:44] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:01:44] Training podium model using glm
INFO [2025-03-29 13:01:45] Training win model using glm
INFO [2025-03-29 13:01:45] Training top5 model using glm
INFO [2025-03-29 13:01:45] Training top10 model using glm
INFO [2025-03-29 13:01:45] Top features for Leg 2 podium prediction:
INFO [2025-03-29 13:01:45] Training models for Leg 3
INFO [2025-03-29 13:01:45] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:01:45] Training podium model using glm
INFO [2025-03-29 13:01:45] Training win model using glm
INFO [2025-03-29 13:01:45] Training top5 model using glm
INFO [2025-03-29 13:01:45] Training top10 model using glm
INFO [2025-03-29 13:01:45] Top features for Leg 3 podium prediction:
INFO [2025-03-29 13:01:45] Training models for Leg 4
INFO [2025-03-29 13:01:45] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:01:45] Training podium model using glm
INFO [2025-03-29 13:01:45] Training win model using glm
INFO [2025-03-29 13:01:45] Training top5 model using glm
INFO [2025-03-29 13:01:45] Training top10 model using glm
INFO [2025-03-29 13:01:46] Top features for Leg 4 podium prediction:
INFO [2025-03-29 13:01:46] Training models for Leg 1
INFO [2025-03-29 13:01:46] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:01:46] Training podium model using glm
INFO [2025-03-29 13:01:46] Training win model using glm
INFO [2025-03-29 13:01:46] Training top5 model using glm
INFO [2025-03-29 13:01:46] Training top10 model using glm
INFO [2025-03-29 13:01:46] Top features for Leg 1 podium prediction:
INFO [2025-03-29 13:01:46] Training models for Leg 2
INFO [2025-03-29 13:01:46] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:01:46] Training podium model using glm
INFO [2025-03-29 13:01:46] Training win model using glm
INFO [2025-03-29 13:01:46] Training top5 model using glm
INFO [2025-03-29 13:01:46] Training top10 model using glm
INFO [2025-03-29 13:01:46] Top features for Leg 2 podium prediction:
INFO [2025-03-29 13:01:46] Training models for Leg 3
INFO [2025-03-29 13:01:46] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:01:46] Training podium model using glm
INFO [2025-03-29 13:01:46] Training win model using glm
INFO [2025-03-29 13:01:46] Training top5 model using glm
INFO [2025-03-29 13:01:46] Training top10 model using glm
INFO [2025-03-29 13:01:46] Top features for Leg 3 podium prediction:
INFO [2025-03-29 13:01:46] Training models for Leg 4
INFO [2025-03-29 13:01:46] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:01:46] Training podium model using glm
INFO [2025-03-29 13:01:47] Training win model using glm
INFO [2025-03-29 13:01:47] Training top5 model using glm
INFO [2025-03-29 13:01:47] Training top10 model using glm
INFO [2025-03-29 13:01:47] Top features for Leg 4 podium prediction:
INFO [2025-03-29 13:01:47] Processing men's relay predictions
INFO [2025-03-29 13:01:47] Loaded men relay teams startlist with 24 rows
INFO [2025-03-29 13:01:47] Loaded men relay individuals startlist with 96 rows
INFO [2025-03-29 13:01:47] Preparing current men skier data
INFO [2025-03-29 13:01:47] Found 9 Elo columns for current skiers
INFO [2025-03-29 13:01:47] Replaced NAs in Distance_Elo with first quartile: 1207.23243912712
INFO [2025-03-29 13:01:47] Replaced NAs in Distance_C_Elo with first quartile: 1233.40200699225
INFO [2025-03-29 13:01:47] Replaced NAs in Distance_F_Elo with first quartile: 1236.48554062178
INFO [2025-03-29 13:01:47] Replaced NAs in Sprint_Elo with first quartile: 1223.60107000698
INFO [2025-03-29 13:01:47] Replaced NAs in Sprint_C_Elo with first quartile: 1241.28715500947
INFO [2025-03-29 13:01:47] Replaced NAs in Sprint_F_Elo with first quartile: 1234.45151108772
INFO [2025-03-29 13:01:47] Replaced NAs in Classic_Elo with first quartile: 1241.52867310024
INFO [2025-03-29 13:01:47] Replaced NAs in Freestyle_Elo with first quartile: 1228.48649348109
INFO [2025-03-29 13:01:47] Replaced NAs in Distance_Pelo with first quartile: 1211.63035979047
INFO [2025-03-29 13:01:47] Replaced NAs in Distance_C_Pelo with first quartile: 1234.81091928129
INFO [2025-03-29 13:01:47] Replaced NAs in Distance_F_Pelo with first quartile: 1239.65331180248
INFO [2025-03-29 13:01:47] Replaced NAs in Sprint_Pelo with first quartile: 1240.94751821383
INFO [2025-03-29 13:01:47] Replaced NAs in Sprint_C_Pelo with first quartile: 1241.28715500947
INFO [2025-03-29 13:01:47] Replaced NAs in Sprint_F_Pelo with first quartile: 1252.45166310493
INFO [2025-03-29 13:01:47] Replaced NAs in Classic_Pelo with first quartile: 1243.63746068082
INFO [2025-03-29 13:01:47] Replaced NAs in Freestyle_Pelo with first quartile: 1249.30280713791
INFO [2025-03-29 13:01:47] Replaced NAs in Classic_Last_5 with first quartile: 0
INFO [2025-03-29 13:01:47] Replaced NAs in Freestyle_Last_5 with first quartile: 0
INFO [2025-03-29 13:01:47] Created Pelo_Pct from Elo with max value: 1946.6211651574
INFO [2025-03-29 13:01:47] Created Distance_Pelo_Pct from Distance_Elo with max value: 1869.1251911742
INFO [2025-03-29 13:01:47] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1777.16297253153
INFO [2025-03-29 13:01:47] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1695.2053212904
INFO [2025-03-29 13:01:47] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1886.80363942481
INFO [2025-03-29 13:01:47] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1711.08486899169
INFO [2025-03-29 13:01:47] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1792.65157560707
INFO [2025-03-29 13:01:47] Created Classic_Pelo_Pct from Classic_Elo with max value: 1807.56773496777
INFO [2025-03-29 13:01:47] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1814.60460629541
INFO [2025-03-29 13:01:47] Prepared data for 381 men skiers with 33 features
INFO [2025-03-29 13:01:47] Using FIS startlist for men's leg predictions
INFO [2025-03-29 13:01:47] Using FIS startlist for men
INFO [2025-03-29 13:01:47] Attempting Option 1: Team model coefficients
INFO [2025-03-29 13:01:47] Option 1 failed: No team_podium model found
INFO [2025-03-29 13:01:47] Option 1 failed: No team model
INFO [2025-03-29 13:01:47] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 13:01:47] Leg 1 accuracy: 0.861412429378531
INFO [2025-03-29 13:01:47] Leg 2 accuracy: 0.827627118644068
INFO [2025-03-29 13:01:47] Leg 3 accuracy: 0.864056107539451
INFO [2025-03-29 13:01:47] Leg 4 accuracy: 0.878236898499903
INFO [2025-03-29 13:01:47] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 13:01:47] Leg importance weights: Leg 1: 0.25, Leg 2: 0.24, Leg 3: 0.25, Leg 4: 0.26
INFO [2025-03-29 13:01:47] Processing ladies's relay predictions
INFO [2025-03-29 13:01:47] Loaded ladies relay teams startlist with 35 rows
INFO [2025-03-29 13:01:47] Loaded ladies relay individuals startlist with 231 rows
INFO [2025-03-29 13:01:47] Preparing current ladies skier data
INFO [2025-03-29 13:01:47] Found 9 Elo columns for current skiers
INFO [2025-03-29 13:01:48] Replaced NAs in Distance_Elo with first quartile: 1237.38564383256
INFO [2025-03-29 13:01:48] Replaced NAs in Distance_C_Elo with first quartile: 1243.87329106944
INFO [2025-03-29 13:01:48] Replaced NAs in Distance_F_Elo with first quartile: 1256.69628195708
INFO [2025-03-29 13:01:48] Replaced NAs in Sprint_Elo with first quartile: 1246.32574824425
INFO [2025-03-29 13:01:48] Replaced NAs in Sprint_C_Elo with first quartile: 1257.67866787334
INFO [2025-03-29 13:01:48] Replaced NAs in Sprint_F_Elo with first quartile: 1244.84742904868
INFO [2025-03-29 13:01:48] Replaced NAs in Classic_Elo with first quartile: 1252.44868703669
INFO [2025-03-29 13:01:48] Replaced NAs in Freestyle_Elo with first quartile: 1244.44508230281
INFO [2025-03-29 13:01:48] Replaced NAs in Distance_Pelo with first quartile: 1241.11854419952
INFO [2025-03-29 13:01:48] Replaced NAs in Distance_C_Pelo with first quartile: 1245.57367555166
INFO [2025-03-29 13:01:48] Replaced NAs in Distance_F_Pelo with first quartile: 1259.54282973153
INFO [2025-03-29 13:01:48] Replaced NAs in Sprint_Pelo with first quartile: 1254.58885254623
INFO [2025-03-29 13:01:48] Replaced NAs in Sprint_C_Pelo with first quartile: 1257.58302026178
INFO [2025-03-29 13:01:48] Replaced NAs in Sprint_F_Pelo with first quartile: 1257.67755691493
INFO [2025-03-29 13:01:48] Replaced NAs in Classic_Pelo with first quartile: 1256.79275004544
INFO [2025-03-29 13:01:48] Replaced NAs in Freestyle_Pelo with first quartile: 1256.79999900008
INFO [2025-03-29 13:01:48] Replaced NAs in Classic_Last_5 with first quartile: 3.5
INFO [2025-03-29 13:01:48] Replaced NAs in Freestyle_Last_5 with first quartile: 2.4
INFO [2025-03-29 13:01:48] Created Pelo_Pct from Elo with max value: 1841.00191142018
INFO [2025-03-29 13:01:48] Created Distance_Pelo_Pct from Distance_Elo with max value: 1889.46974050597
INFO [2025-03-29 13:01:48] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1763.33572074398
INFO [2025-03-29 13:01:48] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1693.85026290322
INFO [2025-03-29 13:01:48] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1742.74758850835
INFO [2025-03-29 13:01:48] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1601.5820663103
INFO [2025-03-29 13:01:48] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1681.09824552997
INFO [2025-03-29 13:01:48] Created Classic_Pelo_Pct from Classic_Elo with max value: 1698.69428891549
INFO [2025-03-29 13:01:48] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1707.58410982918
INFO [2025-03-29 13:01:48] Prepared data for 255 ladies skiers with 33 features
INFO [2025-03-29 13:01:48] No FIS startlist, predicting for all skiers in all legs
INFO [2025-03-29 13:01:48] No valid FIS startlist for ladies, building optimized teams
INFO [2025-03-29 13:01:48] Attempting Option 1: Team model coefficients
INFO [2025-03-29 13:01:48] Option 1 failed: argument "leg_models" is missing, with no default
INFO [2025-03-29 13:01:48] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 13:01:48] Option 2 failed: argument "leg_models" is missing, with no default
INFO [2025-03-29 13:01:48] Using Option 3: Default leg importance weights
INFO [2025-03-29 13:01:48] Using leg importance weights for team optimization: Leg 1: 0.20, Leg 2: 0.20, Leg 3: 0.25, Leg 4: 0.35
INFO [2025-03-29 13:01:48] Optimizing team for Sweden
INFO [2025-03-29 13:01:48] Optimizing team for Norway
INFO [2025-03-29 13:01:48] Optimizing team for Germany
INFO [2025-03-29 13:01:48] Optimizing team for USA
INFO [2025-03-29 13:01:48] Optimizing team for Austria
INFO [2025-03-29 13:01:48] Optimizing team for Finland
INFO [2025-03-29 13:01:48] Optimizing team for Czechia
INFO [2025-03-29 13:01:48] Optimizing team for Switzerland
INFO [2025-03-29 13:01:48] Optimizing team for Italy
INFO [2025-03-29 13:01:48] Optimizing team for France
INFO [2025-03-29 13:01:48] Optimizing team for Canada
INFO [2025-03-29 13:01:48] Optimizing team for Slovenia
INFO [2025-03-29 13:01:48] Optimizing team for Estonia
INFO [2025-03-29 13:01:49] Optimizing team for Australia
INFO [2025-03-29 13:01:49] Optimizing team for Ukraine
INFO [2025-03-29 13:01:49] Optimizing team for Kazakhstan
INFO [2025-03-29 13:01:49] Optimizing team for Armenia
INFO [2025-03-29 13:01:49] Optimizing team for Latvia
INFO [2025-03-29 13:01:49] Optimizing team for Japan
INFO [2025-03-29 13:01:49] Optimizing team for Poland
INFO [2025-03-29 13:01:49] Optimizing team for South Korea
INFO [2025-03-29 13:01:49] Optimizing team for Andorra
INFO [2025-03-29 13:01:49] Optimizing team for Taiwan
INFO [2025-03-29 13:01:49] Optimizing team for China
INFO [2025-03-29 13:01:49] Optimizing team for Croatia
INFO [2025-03-29 13:01:49] Optimizing team for Slovakia
INFO [2025-03-29 13:01:49] Optimizing team for Argentina
INFO [2025-03-29 13:01:49] Optimizing team for Mongolia
INFO [2025-03-29 13:01:49] Optimizing team for Brazil
INFO [2025-03-29 13:01:49] Optimizing team for Lithuania
INFO [2025-03-29 13:01:49] Optimizing team for Greece
INFO [2025-03-29 13:01:49] Optimizing team for Iceland
INFO [2025-03-29 13:01:49] Optimizing team for Bulgaria
INFO [2025-03-29 13:01:49] Optimizing team for Serbia
INFO [2025-03-29 13:01:49] Optimizing team for Hungary
INFO [2025-03-29 13:01:49] Optimizing team for Turkey
INFO [2025-03-29 13:01:49] Optimizing team for North Macedonia
INFO [2025-03-29 13:01:49] Optimizing team for Romania
INFO [2025-03-29 13:01:49] Optimizing team for Bosnia&Herzegovina
INFO [2025-03-29 13:01:49] Optimizing team for Mexico
INFO [2025-03-29 13:01:49] Optimizing team for Iran
INFO [2025-03-29 13:01:49] Optimizing team for Chile
INFO [2025-03-29 13:01:49] Optimizing team for India
INFO [2025-03-29 13:01:49] Optimizing team for Malaysia
INFO [2025-03-29 13:01:49] Optimizing team for Haiti
INFO [2025-03-29 13:01:49] Optimizing team for Lebanon
INFO [2025-03-29 13:01:49] Optimizing team for Liechtenstein
WARN [2025-03-29 13:01:49] Could not read individuals file: invalid 'description' argument
WARN [2025-03-29 13:01:49] Could not read teams file: invalid 'description' argument
INFO [2025-03-29 13:01:49] Resetting men's probabilities at or below the mode to zero
INFO [2025-03-29 13:01:49] No values appear more than twice for Win_Prob
INFO [2025-03-29 13:01:49] No values appear more than twice for Podium_Prob
INFO [2025-03-29 13:01:49] No values appear more than twice for Top5_Prob
INFO [2025-03-29 13:01:49] No values appear more than twice for Top10_Prob
INFO [2025-03-29 13:01:49] Resetting ladies' probabilities at or below the mode to zero
INFO [2025-03-29 13:01:49] Reset 20 values to 0 for Win_Prob (repeated values or values <  0 )
INFO [2025-03-29 13:01:49] Repeated values: 0, 0, 0, 0, 0
INFO [2025-03-29 13:01:49] No values appear more than twice for Podium_Prob
INFO [2025-03-29 13:01:49] No values appear more than twice for Top5_Prob
INFO [2025-03-29 13:01:49] No values appear more than twice for Top10_Prob
INFO [2025-03-29 13:01:49] Normalizing men's team probabilities
INFO [2025-03-29 13:01:49] Normalized Win_Prob from sum of 0.71 to 1
INFO [2025-03-29 13:01:49] Normalized Podium_Prob from sum of 2.34 to 3
INFO [2025-03-29 13:01:49] Normalized Top5_Prob from sum of 4.2 to 5
INFO [2025-03-29 13:01:49] Normalized Top10_Prob from sum of 10.32 to 10
INFO [2025-03-29 13:01:49] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 13:01:49] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 13:01:49] Normalizing ladies' team probabilities
INFO [2025-03-29 13:01:49] Normalized Win_Prob from sum of 2.19 to 1
INFO [2025-03-29 13:01:49] Normalized Podium_Prob from sum of 4.41 to 3
INFO [2025-03-29 13:01:49] Normalized Top5_Prob from sum of 4.73 to 5
INFO [2025-03-29 13:01:49] Normalized Top10_Prob from sum of 13.19 to 10
INFO [2025-03-29 13:01:49] Final capping of probabilities to maximum of 1
INFO [2025-03-29 13:01:49] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 13:01:49] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 13:01:49] Optimizing fantasy relay team
INFO [2025-03-29 13:01:49] Fantasy team optimization complete. Selected 6 teams.
INFO [2025-03-29 13:01:49] Total price: 92546 of max 1e+05
INFO [2025-03-29 13:01:49] Expected total points: 542.5
INFO [2025-03-29 13:01:49] Men's teams: 6 ( 6 )
INFO [2025-03-29 13:01:49] Ladies' teams: 0 ( 0 )
INFO [2025-03-29 13:01:49] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_points.xlsx
INFO [2025-03-29 13:01:49] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_probabilities.xlsx
INFO [2025-03-29 13:01:49] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_points.xlsx
INFO [2025-03-29 13:01:49] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_probabilities.xlsx
INFO [2025-03-29 13:01:49] Saved fantasy team results to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/fantasy_relay_team.xlsx
INFO [2025-03-29 13:01:49] Relay predictions completed successfully
INFO [2025-03-29 13:03:23] Starting relay predictions process
INFO [2025-03-29 13:03:23] Loading weekend race data
INFO [2025-03-29 13:03:23] Tomorrow's date: 2025-03-29
INFO [2025-03-29 13:03:23] Found 1 men's relay races and 1 ladies' relay races
INFO [2025-03-29 13:03:23] Loading chrono data
INFO [2025-03-29 13:03:29] Loaded men's chrono with 105122 rows and 36 columns
INFO [2025-03-29 13:03:29] Loaded ladies' chrono with 78706 rows and 36 columns
INFO [2025-03-29 13:03:29] Created men's relay df with 9688 rows
INFO [2025-03-29 13:03:29] Created men's individual df with 92143 rows
INFO [2025-03-29 13:03:29] Created ladies' relay df with 8019 rows
INFO [2025-03-29 13:03:29] Created ladies' individual df with 68253 rows
INFO [2025-03-29 13:03:34] Training models for Leg 1
INFO [2025-03-29 13:03:34] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:03:34] Training podium model using glm
INFO [2025-03-29 13:03:34] Training win model using glm
INFO [2025-03-29 13:03:34] Training top5 model using glm
INFO [2025-03-29 13:03:34] Training top10 model using glm
INFO [2025-03-29 13:03:34] Top features for Leg 1 podium prediction:
INFO [2025-03-29 13:03:34] Training models for Leg 2
INFO [2025-03-29 13:03:34] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:03:34] Training podium model using glm
INFO [2025-03-29 13:03:34] Training win model using glm
INFO [2025-03-29 13:03:34] Training top5 model using glm
INFO [2025-03-29 13:03:34] Training top10 model using glm
INFO [2025-03-29 13:03:34] Top features for Leg 2 podium prediction:
INFO [2025-03-29 13:03:34] Training models for Leg 3
INFO [2025-03-29 13:03:34] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:03:34] Training podium model using glm
INFO [2025-03-29 13:03:34] Training win model using glm
INFO [2025-03-29 13:03:34] Training top5 model using glm
INFO [2025-03-29 13:03:34] Training top10 model using glm
INFO [2025-03-29 13:03:34] Top features for Leg 3 podium prediction:
INFO [2025-03-29 13:03:34] Training models for Leg 4
INFO [2025-03-29 13:03:34] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:03:34] Training podium model using glm
INFO [2025-03-29 13:03:35] Training win model using glm
INFO [2025-03-29 13:03:35] Training top5 model using glm
INFO [2025-03-29 13:03:35] Training top10 model using glm
INFO [2025-03-29 13:03:35] Top features for Leg 4 podium prediction:
INFO [2025-03-29 13:03:35] Training models for Leg 1
INFO [2025-03-29 13:03:35] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:03:35] Training podium model using glm
INFO [2025-03-29 13:03:35] Training win model using glm
INFO [2025-03-29 13:03:35] Training top5 model using glm
INFO [2025-03-29 13:03:35] Training top10 model using glm
INFO [2025-03-29 13:03:35] Top features for Leg 1 podium prediction:
INFO [2025-03-29 13:03:35] Training models for Leg 2
INFO [2025-03-29 13:03:35] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:03:35] Training podium model using glm
INFO [2025-03-29 13:03:35] Training win model using glm
INFO [2025-03-29 13:03:35] Training top5 model using glm
INFO [2025-03-29 13:03:35] Training top10 model using glm
INFO [2025-03-29 13:03:35] Top features for Leg 2 podium prediction:
INFO [2025-03-29 13:03:35] Training models for Leg 3
INFO [2025-03-29 13:03:35] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:03:35] Training podium model using glm
INFO [2025-03-29 13:03:36] Training win model using glm
INFO [2025-03-29 13:03:36] Training top5 model using glm
INFO [2025-03-29 13:03:36] Training top10 model using glm
INFO [2025-03-29 13:03:36] Top features for Leg 3 podium prediction:
INFO [2025-03-29 13:03:36] Training models for Leg 4
INFO [2025-03-29 13:03:36] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:03:36] Training podium model using glm
INFO [2025-03-29 13:03:36] Training win model using glm
INFO [2025-03-29 13:03:36] Training top5 model using glm
INFO [2025-03-29 13:03:36] Training top10 model using glm
INFO [2025-03-29 13:03:36] Top features for Leg 4 podium prediction:
INFO [2025-03-29 13:03:36] Processing men's relay predictions
INFO [2025-03-29 13:03:36] Loaded men relay teams startlist with 24 rows
INFO [2025-03-29 13:03:36] Loaded men relay individuals startlist with 96 rows
INFO [2025-03-29 13:03:36] Preparing current men skier data
INFO [2025-03-29 13:03:36] Found 9 Elo columns for current skiers
INFO [2025-03-29 13:03:36] Replaced NAs in Distance_Elo with first quartile: 1207.23243912712
INFO [2025-03-29 13:03:36] Replaced NAs in Distance_C_Elo with first quartile: 1233.40200699225
INFO [2025-03-29 13:03:36] Replaced NAs in Distance_F_Elo with first quartile: 1236.48554062178
INFO [2025-03-29 13:03:36] Replaced NAs in Sprint_Elo with first quartile: 1223.60107000698
INFO [2025-03-29 13:03:36] Replaced NAs in Sprint_C_Elo with first quartile: 1241.28715500947
INFO [2025-03-29 13:03:36] Replaced NAs in Sprint_F_Elo with first quartile: 1234.45151108772
INFO [2025-03-29 13:03:36] Replaced NAs in Classic_Elo with first quartile: 1241.52867310024
INFO [2025-03-29 13:03:36] Replaced NAs in Freestyle_Elo with first quartile: 1228.48649348109
INFO [2025-03-29 13:03:36] Replaced NAs in Distance_Pelo with first quartile: 1211.63035979047
INFO [2025-03-29 13:03:36] Replaced NAs in Distance_C_Pelo with first quartile: 1234.81091928129
INFO [2025-03-29 13:03:36] Replaced NAs in Distance_F_Pelo with first quartile: 1239.65331180248
INFO [2025-03-29 13:03:36] Replaced NAs in Sprint_Pelo with first quartile: 1240.94751821383
INFO [2025-03-29 13:03:36] Replaced NAs in Sprint_C_Pelo with first quartile: 1241.28715500947
INFO [2025-03-29 13:03:36] Replaced NAs in Sprint_F_Pelo with first quartile: 1252.45166310493
INFO [2025-03-29 13:03:36] Replaced NAs in Classic_Pelo with first quartile: 1243.63746068082
INFO [2025-03-29 13:03:36] Replaced NAs in Freestyle_Pelo with first quartile: 1249.30280713791
INFO [2025-03-29 13:03:36] Replaced NAs in Classic_Last_5 with first quartile: 0
INFO [2025-03-29 13:03:36] Replaced NAs in Freestyle_Last_5 with first quartile: 0
INFO [2025-03-29 13:03:36] Created Pelo_Pct from Elo with max value: 1946.6211651574
INFO [2025-03-29 13:03:36] Created Distance_Pelo_Pct from Distance_Elo with max value: 1869.1251911742
INFO [2025-03-29 13:03:36] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1777.16297253153
INFO [2025-03-29 13:03:36] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1695.2053212904
INFO [2025-03-29 13:03:36] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1886.80363942481
INFO [2025-03-29 13:03:36] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1711.08486899169
INFO [2025-03-29 13:03:36] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1792.65157560707
INFO [2025-03-29 13:03:36] Created Classic_Pelo_Pct from Classic_Elo with max value: 1807.56773496777
INFO [2025-03-29 13:03:36] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1814.60460629541
INFO [2025-03-29 13:03:36] Prepared data for 381 men skiers with 33 features
INFO [2025-03-29 13:03:36] Using FIS startlist for men's leg predictions
INFO [2025-03-29 13:03:37] Using FIS startlist for men
INFO [2025-03-29 13:03:37] Attempting Option 1: Team model coefficients
INFO [2025-03-29 13:03:37] Option 1 failed: No team_podium model found
INFO [2025-03-29 13:03:37] Option 1 failed: No team model
INFO [2025-03-29 13:03:37] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 13:03:37] Leg 1 accuracy: 0.854556789401909
INFO [2025-03-29 13:03:37] Leg 2 accuracy: 0.841168907071888
INFO [2025-03-29 13:03:37] Leg 3 accuracy: 0.860344827586207
INFO [2025-03-29 13:03:37] Leg 4 accuracy: 0.891385154880187
INFO [2025-03-29 13:03:37] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 13:03:37] Leg importance weights: Leg 1: 0.25, Leg 2: 0.24, Leg 3: 0.25, Leg 4: 0.26
INFO [2025-03-29 13:03:37] Processing ladies's relay predictions
INFO [2025-03-29 13:03:37] Loaded ladies relay teams startlist with 35 rows
INFO [2025-03-29 13:03:37] Loaded ladies relay individuals startlist with 231 rows
INFO [2025-03-29 13:03:37] Preparing current ladies skier data
INFO [2025-03-29 13:03:37] Found 9 Elo columns for current skiers
INFO [2025-03-29 13:03:37] Replaced NAs in Distance_Elo with first quartile: 1237.38564383256
INFO [2025-03-29 13:03:37] Replaced NAs in Distance_C_Elo with first quartile: 1243.87329106944
INFO [2025-03-29 13:03:37] Replaced NAs in Distance_F_Elo with first quartile: 1256.69628195708
INFO [2025-03-29 13:03:37] Replaced NAs in Sprint_Elo with first quartile: 1246.32574824425
INFO [2025-03-29 13:03:37] Replaced NAs in Sprint_C_Elo with first quartile: 1257.67866787334
INFO [2025-03-29 13:03:37] Replaced NAs in Sprint_F_Elo with first quartile: 1244.84742904868
INFO [2025-03-29 13:03:37] Replaced NAs in Classic_Elo with first quartile: 1252.44868703669
INFO [2025-03-29 13:03:37] Replaced NAs in Freestyle_Elo with first quartile: 1244.44508230281
INFO [2025-03-29 13:03:37] Replaced NAs in Distance_Pelo with first quartile: 1241.11854419952
INFO [2025-03-29 13:03:37] Replaced NAs in Distance_C_Pelo with first quartile: 1245.57367555166
INFO [2025-03-29 13:03:37] Replaced NAs in Distance_F_Pelo with first quartile: 1259.54282973153
INFO [2025-03-29 13:03:37] Replaced NAs in Sprint_Pelo with first quartile: 1254.58885254623
INFO [2025-03-29 13:03:37] Replaced NAs in Sprint_C_Pelo with first quartile: 1257.58302026178
INFO [2025-03-29 13:03:37] Replaced NAs in Sprint_F_Pelo with first quartile: 1257.67755691493
INFO [2025-03-29 13:03:37] Replaced NAs in Classic_Pelo with first quartile: 1256.79275004544
INFO [2025-03-29 13:03:37] Replaced NAs in Freestyle_Pelo with first quartile: 1256.79999900008
INFO [2025-03-29 13:03:37] Replaced NAs in Classic_Last_5 with first quartile: 3.5
INFO [2025-03-29 13:03:37] Replaced NAs in Freestyle_Last_5 with first quartile: 2.4
INFO [2025-03-29 13:03:37] Created Pelo_Pct from Elo with max value: 1841.00191142018
INFO [2025-03-29 13:03:37] Created Distance_Pelo_Pct from Distance_Elo with max value: 1889.46974050597
INFO [2025-03-29 13:03:37] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1763.33572074398
INFO [2025-03-29 13:03:37] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1693.85026290322
INFO [2025-03-29 13:03:37] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1742.74758850835
INFO [2025-03-29 13:03:37] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1601.5820663103
INFO [2025-03-29 13:03:37] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1681.09824552997
INFO [2025-03-29 13:03:37] Created Classic_Pelo_Pct from Classic_Elo with max value: 1698.69428891549
INFO [2025-03-29 13:03:37] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1707.58410982918
INFO [2025-03-29 13:03:37] Prepared data for 255 ladies skiers with 33 features
INFO [2025-03-29 13:03:37] No FIS startlist, predicting for all skiers in all legs
INFO [2025-03-29 13:03:37] No valid FIS startlist for ladies, building optimized teams
INFO [2025-03-29 13:03:37] Attempting Option 1: Team model coefficients
INFO [2025-03-29 13:03:37] Option 1 failed: argument "leg_models" is missing, with no default
INFO [2025-03-29 13:03:37] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 13:03:37] Option 2 failed: argument "leg_models" is missing, with no default
INFO [2025-03-29 13:03:37] Using Option 3: Default leg importance weights
INFO [2025-03-29 13:03:37] Using leg importance weights for team optimization: Leg 1: 0.20, Leg 2: 0.20, Leg 3: 0.25, Leg 4: 0.35
INFO [2025-03-29 13:03:37] Optimizing team for Sweden
INFO [2025-03-29 13:03:37] Optimizing team for Norway
INFO [2025-03-29 13:03:37] Optimizing team for Germany
INFO [2025-03-29 13:03:37] Optimizing team for USA
INFO [2025-03-29 13:03:37] Optimizing team for Austria
INFO [2025-03-29 13:03:37] Optimizing team for Finland
INFO [2025-03-29 13:03:37] Optimizing team for Czechia
INFO [2025-03-29 13:03:37] Optimizing team for Switzerland
INFO [2025-03-29 13:03:37] Optimizing team for Italy
INFO [2025-03-29 13:03:37] Optimizing team for France
INFO [2025-03-29 13:03:37] Optimizing team for Canada
INFO [2025-03-29 13:03:38] Optimizing team for Slovenia
INFO [2025-03-29 13:03:38] Optimizing team for Estonia
INFO [2025-03-29 13:03:38] Optimizing team for Australia
INFO [2025-03-29 13:03:38] Optimizing team for Ukraine
INFO [2025-03-29 13:03:38] Optimizing team for Kazakhstan
INFO [2025-03-29 13:03:38] Optimizing team for Armenia
INFO [2025-03-29 13:03:38] Optimizing team for Latvia
INFO [2025-03-29 13:03:38] Optimizing team for Japan
INFO [2025-03-29 13:03:38] Optimizing team for Poland
INFO [2025-03-29 13:03:38] Optimizing team for South Korea
INFO [2025-03-29 13:03:38] Optimizing team for Andorra
INFO [2025-03-29 13:03:38] Optimizing team for Taiwan
INFO [2025-03-29 13:03:38] Optimizing team for China
INFO [2025-03-29 13:03:38] Optimizing team for Croatia
INFO [2025-03-29 13:03:38] Optimizing team for Slovakia
INFO [2025-03-29 13:03:38] Optimizing team for Argentina
INFO [2025-03-29 13:03:38] Optimizing team for Mongolia
INFO [2025-03-29 13:03:38] Optimizing team for Brazil
INFO [2025-03-29 13:03:38] Optimizing team for Lithuania
INFO [2025-03-29 13:03:38] Optimizing team for Greece
INFO [2025-03-29 13:03:38] Optimizing team for Iceland
INFO [2025-03-29 13:03:38] Optimizing team for Bulgaria
INFO [2025-03-29 13:03:38] Optimizing team for Serbia
INFO [2025-03-29 13:03:38] Optimizing team for Hungary
INFO [2025-03-29 13:03:38] Optimizing team for Turkey
INFO [2025-03-29 13:03:38] Optimizing team for North Macedonia
INFO [2025-03-29 13:03:38] Optimizing team for Romania
INFO [2025-03-29 13:03:38] Optimizing team for Bosnia&Herzegovina
INFO [2025-03-29 13:03:38] Optimizing team for Mexico
INFO [2025-03-29 13:03:38] Optimizing team for Iran
INFO [2025-03-29 13:03:38] Optimizing team for Chile
INFO [2025-03-29 13:03:38] Optimizing team for India
INFO [2025-03-29 13:03:38] Optimizing team for Malaysia
INFO [2025-03-29 13:03:38] Optimizing team for Haiti
INFO [2025-03-29 13:03:38] Optimizing team for Lebanon
INFO [2025-03-29 13:03:38] Optimizing team for Liechtenstein
WARN [2025-03-29 13:03:38] Could not read individuals file: invalid 'description' argument
WARN [2025-03-29 13:03:38] Could not read teams file: invalid 'description' argument
INFO [2025-03-29 13:03:38] Resetting men's probabilities at or below the mode to zero
INFO [2025-03-29 13:03:38] No values appear more than twice for Win_Prob
INFO [2025-03-29 13:03:38] No values appear more than twice for Podium_Prob
INFO [2025-03-29 13:03:38] No values appear more than twice for Top5_Prob
INFO [2025-03-29 13:03:38] No values appear more than twice for Top10_Prob
INFO [2025-03-29 13:03:38] Resetting ladies' probabilities at or below the mode to zero
INFO [2025-03-29 13:03:38] Reset 20 values to 0 for Win_Prob (repeated values or values <  0 )
INFO [2025-03-29 13:03:38] Repeated values: 0, 0, 0, 0, 0
INFO [2025-03-29 13:03:38] No values appear more than twice for Podium_Prob
INFO [2025-03-29 13:03:38] No values appear more than twice for Top5_Prob
INFO [2025-03-29 13:03:38] No values appear more than twice for Top10_Prob
INFO [2025-03-29 13:03:38] Normalizing men's team probabilities
INFO [2025-03-29 13:03:38] Normalized Win_Prob from sum of 0.72 to 1
INFO [2025-03-29 13:03:38] Normalized Podium_Prob from sum of 2.34 to 3
INFO [2025-03-29 13:03:38] Normalized Top5_Prob from sum of 4.2 to 5
INFO [2025-03-29 13:03:38] Normalized Top10_Prob from sum of 10.33 to 10
INFO [2025-03-29 13:03:38] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 13:03:38] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 13:03:38] Normalizing ladies' team probabilities
INFO [2025-03-29 13:03:38] Normalized Win_Prob from sum of 2.19 to 1
INFO [2025-03-29 13:03:38] Normalized Podium_Prob from sum of 4.41 to 3
INFO [2025-03-29 13:03:38] Normalized Top5_Prob from sum of 4.73 to 5
INFO [2025-03-29 13:03:38] Normalized Top10_Prob from sum of 13.19 to 10
INFO [2025-03-29 13:03:38] Final capping of probabilities to maximum of 1
INFO [2025-03-29 13:03:38] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 13:03:38] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 13:03:38] Optimizing fantasy relay team
INFO [2025-03-29 13:03:39] Fantasy team optimization complete. Selected 6 teams.
INFO [2025-03-29 13:03:39] Total price: 92546 of max 1e+05
INFO [2025-03-29 13:03:39] Expected total points: 543.1
INFO [2025-03-29 13:03:39] Men's teams: 6 ( 6 )
INFO [2025-03-29 13:03:39] Ladies' teams: 0 ( 0 )
INFO [2025-03-29 13:03:39] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_points.xlsx
INFO [2025-03-29 13:03:39] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_probabilities.xlsx
INFO [2025-03-29 13:03:39] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_points.xlsx
INFO [2025-03-29 13:03:39] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_probabilities.xlsx
INFO [2025-03-29 13:03:39] Saved fantasy team results to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/fantasy_relay_team.xlsx
INFO [2025-03-29 13:03:39] Relay predictions completed successfully
INFO [2025-03-29 13:04:00] Starting relay predictions process
INFO [2025-03-29 13:04:00] Loading weekend race data
INFO [2025-03-29 13:04:00] Tomorrow's date: 2025-03-29
INFO [2025-03-29 13:04:00] Found 1 men's relay races and 1 ladies' relay races
INFO [2025-03-29 13:04:00] Loading chrono data
INFO [2025-03-29 13:04:05] Loaded men's chrono with 105122 rows and 36 columns
INFO [2025-03-29 13:04:05] Loaded ladies' chrono with 78706 rows and 36 columns
INFO [2025-03-29 13:04:05] Created men's relay df with 9688 rows
INFO [2025-03-29 13:04:05] Created men's individual df with 92143 rows
INFO [2025-03-29 13:04:05] Created ladies' relay df with 8019 rows
INFO [2025-03-29 13:04:05] Created ladies' individual df with 68253 rows
INFO [2025-03-29 13:04:10] Training models for Leg 1
INFO [2025-03-29 13:04:10] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:04:10] Training podium model using glm
INFO [2025-03-29 13:04:10] Training win model using glm
INFO [2025-03-29 13:04:10] Training top5 model using glm
INFO [2025-03-29 13:04:10] Training top10 model using glm
INFO [2025-03-29 13:04:10] Top features for Leg 1 podium prediction:
INFO [2025-03-29 13:04:10] Training models for Leg 2
INFO [2025-03-29 13:04:10] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:04:10] Training podium model using glm
INFO [2025-03-29 13:04:10] Training win model using glm
INFO [2025-03-29 13:04:11] Training top5 model using glm
INFO [2025-03-29 13:04:11] Training top10 model using glm
INFO [2025-03-29 13:04:11] Top features for Leg 2 podium prediction:
INFO [2025-03-29 13:04:11] Training models for Leg 3
INFO [2025-03-29 13:04:11] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:04:11] Training podium model using glm
INFO [2025-03-29 13:04:11] Training win model using glm
INFO [2025-03-29 13:04:11] Training top5 model using glm
INFO [2025-03-29 13:04:11] Training top10 model using glm
INFO [2025-03-29 13:04:11] Top features for Leg 3 podium prediction:
INFO [2025-03-29 13:04:11] Training models for Leg 4
INFO [2025-03-29 13:04:11] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:04:11] Training podium model using glm
INFO [2025-03-29 13:04:11] Training win model using glm
INFO [2025-03-29 13:04:11] Training top5 model using glm
INFO [2025-03-29 13:04:11] Training top10 model using glm
INFO [2025-03-29 13:04:11] Top features for Leg 4 podium prediction:
INFO [2025-03-29 13:04:11] Training models for Leg 1
INFO [2025-03-29 13:04:11] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:04:11] Training podium model using glm
INFO [2025-03-29 13:04:11] Training win model using glm
INFO [2025-03-29 13:04:12] Training top5 model using glm
INFO [2025-03-29 13:04:12] Training top10 model using glm
INFO [2025-03-29 13:04:12] Top features for Leg 1 podium prediction:
INFO [2025-03-29 13:04:12] Training models for Leg 2
INFO [2025-03-29 13:04:12] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:04:12] Training podium model using glm
INFO [2025-03-29 13:04:12] Training win model using glm
INFO [2025-03-29 13:04:12] Training top5 model using glm
INFO [2025-03-29 13:04:12] Training top10 model using glm
INFO [2025-03-29 13:04:12] Top features for Leg 2 podium prediction:
INFO [2025-03-29 13:04:12] Training models for Leg 3
INFO [2025-03-29 13:04:12] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:04:12] Training podium model using glm
INFO [2025-03-29 13:04:12] Training win model using glm
INFO [2025-03-29 13:04:12] Training top5 model using glm
INFO [2025-03-29 13:04:12] Training top10 model using glm
INFO [2025-03-29 13:04:12] Top features for Leg 3 podium prediction:
INFO [2025-03-29 13:04:12] Training models for Leg 4
INFO [2025-03-29 13:04:12] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:04:12] Training podium model using glm
INFO [2025-03-29 13:04:12] Training win model using glm
INFO [2025-03-29 13:04:12] Training top5 model using glm
INFO [2025-03-29 13:04:13] Training top10 model using glm
INFO [2025-03-29 13:04:13] Top features for Leg 4 podium prediction:
INFO [2025-03-29 13:04:13] Processing men's relay predictions
INFO [2025-03-29 13:04:13] Loaded men relay teams startlist with 24 rows
INFO [2025-03-29 13:04:13] Loaded men relay individuals startlist with 96 rows
INFO [2025-03-29 13:04:13] Preparing current men skier data
INFO [2025-03-29 13:04:13] Found 9 Elo columns for current skiers
INFO [2025-03-29 13:04:13] Replaced NAs in Distance_Elo with first quartile: 1207.23243912712
INFO [2025-03-29 13:04:13] Replaced NAs in Distance_C_Elo with first quartile: 1233.40200699225
INFO [2025-03-29 13:04:13] Replaced NAs in Distance_F_Elo with first quartile: 1236.48554062178
INFO [2025-03-29 13:04:13] Replaced NAs in Sprint_Elo with first quartile: 1223.60107000698
INFO [2025-03-29 13:04:13] Replaced NAs in Sprint_C_Elo with first quartile: 1241.28715500947
INFO [2025-03-29 13:04:13] Replaced NAs in Sprint_F_Elo with first quartile: 1234.45151108772
INFO [2025-03-29 13:04:13] Replaced NAs in Classic_Elo with first quartile: 1241.52867310024
INFO [2025-03-29 13:04:13] Replaced NAs in Freestyle_Elo with first quartile: 1228.48649348109
INFO [2025-03-29 13:04:13] Replaced NAs in Distance_Pelo with first quartile: 1211.63035979047
INFO [2025-03-29 13:04:13] Replaced NAs in Distance_C_Pelo with first quartile: 1234.81091928129
INFO [2025-03-29 13:04:13] Replaced NAs in Distance_F_Pelo with first quartile: 1239.65331180248
INFO [2025-03-29 13:04:13] Replaced NAs in Sprint_Pelo with first quartile: 1240.94751821383
INFO [2025-03-29 13:04:13] Replaced NAs in Sprint_C_Pelo with first quartile: 1241.28715500947
INFO [2025-03-29 13:04:13] Replaced NAs in Sprint_F_Pelo with first quartile: 1252.45166310493
INFO [2025-03-29 13:04:13] Replaced NAs in Classic_Pelo with first quartile: 1243.63746068082
INFO [2025-03-29 13:04:13] Replaced NAs in Freestyle_Pelo with first quartile: 1249.30280713791
INFO [2025-03-29 13:04:13] Replaced NAs in Classic_Last_5 with first quartile: 0
INFO [2025-03-29 13:04:13] Replaced NAs in Freestyle_Last_5 with first quartile: 0
INFO [2025-03-29 13:04:13] Created Pelo_Pct from Elo with max value: 1946.6211651574
INFO [2025-03-29 13:04:13] Created Distance_Pelo_Pct from Distance_Elo with max value: 1869.1251911742
INFO [2025-03-29 13:04:13] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1777.16297253153
INFO [2025-03-29 13:04:13] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1695.2053212904
INFO [2025-03-29 13:04:13] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1886.80363942481
INFO [2025-03-29 13:04:13] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1711.08486899169
INFO [2025-03-29 13:04:13] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1792.65157560707
INFO [2025-03-29 13:04:13] Created Classic_Pelo_Pct from Classic_Elo with max value: 1807.56773496777
INFO [2025-03-29 13:04:13] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1814.60460629541
INFO [2025-03-29 13:04:13] Prepared data for 381 men skiers with 33 features
INFO [2025-03-29 13:04:13] Using FIS startlist for men's leg predictions
INFO [2025-03-29 13:04:13] Using FIS startlist for men
INFO [2025-03-29 13:04:13] Attempting Option 1: Team model coefficients
INFO [2025-03-29 13:04:13] Option 1 failed: No team_podium model found
INFO [2025-03-29 13:04:13] Option 1 failed: No team model
INFO [2025-03-29 13:04:13] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 13:04:13] Leg 1 accuracy: 0.865133450224041
INFO [2025-03-29 13:04:13] Leg 2 accuracy: 0.854500292226768
INFO [2025-03-29 13:04:13] Leg 3 accuracy: 0.864114552893045
INFO [2025-03-29 13:04:13] Leg 4 accuracy: 0.894899668809663
INFO [2025-03-29 13:04:13] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 13:04:13] Leg importance weights: Leg 1: 0.25, Leg 2: 0.25, Leg 3: 0.25, Leg 4: 0.26
INFO [2025-03-29 13:04:13] Processing ladies's relay predictions
INFO [2025-03-29 13:04:13] Loaded ladies relay teams startlist with 35 rows
INFO [2025-03-29 13:04:13] Loaded ladies relay individuals startlist with 231 rows
INFO [2025-03-29 13:04:13] Preparing current ladies skier data
INFO [2025-03-29 13:04:13] Found 9 Elo columns for current skiers
INFO [2025-03-29 13:04:13] Replaced NAs in Distance_Elo with first quartile: 1237.38564383256
INFO [2025-03-29 13:04:13] Replaced NAs in Distance_C_Elo with first quartile: 1243.87329106944
INFO [2025-03-29 13:04:13] Replaced NAs in Distance_F_Elo with first quartile: 1256.69628195708
INFO [2025-03-29 13:04:13] Replaced NAs in Sprint_Elo with first quartile: 1246.32574824425
INFO [2025-03-29 13:04:13] Replaced NAs in Sprint_C_Elo with first quartile: 1257.67866787334
INFO [2025-03-29 13:04:13] Replaced NAs in Sprint_F_Elo with first quartile: 1244.84742904868
INFO [2025-03-29 13:04:13] Replaced NAs in Classic_Elo with first quartile: 1252.44868703669
INFO [2025-03-29 13:04:13] Replaced NAs in Freestyle_Elo with first quartile: 1244.44508230281
INFO [2025-03-29 13:04:13] Replaced NAs in Distance_Pelo with first quartile: 1241.11854419952
INFO [2025-03-29 13:04:13] Replaced NAs in Distance_C_Pelo with first quartile: 1245.57367555166
INFO [2025-03-29 13:04:13] Replaced NAs in Distance_F_Pelo with first quartile: 1259.54282973153
INFO [2025-03-29 13:04:13] Replaced NAs in Sprint_Pelo with first quartile: 1254.58885254623
INFO [2025-03-29 13:04:13] Replaced NAs in Sprint_C_Pelo with first quartile: 1257.58302026178
INFO [2025-03-29 13:04:13] Replaced NAs in Sprint_F_Pelo with first quartile: 1257.67755691493
INFO [2025-03-29 13:04:13] Replaced NAs in Classic_Pelo with first quartile: 1256.79275004544
INFO [2025-03-29 13:04:13] Replaced NAs in Freestyle_Pelo with first quartile: 1256.79999900008
INFO [2025-03-29 13:04:13] Replaced NAs in Classic_Last_5 with first quartile: 3.5
INFO [2025-03-29 13:04:13] Replaced NAs in Freestyle_Last_5 with first quartile: 2.4
INFO [2025-03-29 13:04:13] Created Pelo_Pct from Elo with max value: 1841.00191142018
INFO [2025-03-29 13:04:13] Created Distance_Pelo_Pct from Distance_Elo with max value: 1889.46974050597
INFO [2025-03-29 13:04:13] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1763.33572074398
INFO [2025-03-29 13:04:13] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1693.85026290322
INFO [2025-03-29 13:04:13] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1742.74758850835
INFO [2025-03-29 13:04:13] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1601.5820663103
INFO [2025-03-29 13:04:13] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1681.09824552997
INFO [2025-03-29 13:04:13] Created Classic_Pelo_Pct from Classic_Elo with max value: 1698.69428891549
INFO [2025-03-29 13:04:13] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1707.58410982918
INFO [2025-03-29 13:04:13] Prepared data for 255 ladies skiers with 33 features
INFO [2025-03-29 13:04:14] No FIS startlist, predicting for all skiers in all legs
INFO [2025-03-29 13:04:14] No valid FIS startlist for ladies, building optimized teams
INFO [2025-03-29 13:04:14] Attempting Option 1: Team model coefficients
INFO [2025-03-29 13:04:14] Option 1 failed: argument "leg_models" is missing, with no default
INFO [2025-03-29 13:04:14] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 13:04:14] Option 2 failed: argument "leg_models" is missing, with no default
INFO [2025-03-29 13:04:14] Using Option 3: Default leg importance weights
INFO [2025-03-29 13:04:14] Using leg importance weights for team optimization: Leg 1: 0.20, Leg 2: 0.20, Leg 3: 0.25, Leg 4: 0.35
INFO [2025-03-29 13:04:14] Optimizing team for Sweden
INFO [2025-03-29 13:04:14] Optimizing team for Norway
INFO [2025-03-29 13:04:14] Optimizing team for Germany
INFO [2025-03-29 13:04:14] Optimizing team for USA
INFO [2025-03-29 13:04:14] Optimizing team for Austria
INFO [2025-03-29 13:04:14] Optimizing team for Finland
INFO [2025-03-29 13:04:14] Optimizing team for Czechia
INFO [2025-03-29 13:04:14] Optimizing team for Switzerland
INFO [2025-03-29 13:04:14] Optimizing team for Italy
INFO [2025-03-29 13:04:14] Optimizing team for France
INFO [2025-03-29 13:04:14] Optimizing team for Canada
INFO [2025-03-29 13:04:14] Optimizing team for Slovenia
INFO [2025-03-29 13:04:14] Optimizing team for Estonia
INFO [2025-03-29 13:04:14] Optimizing team for Australia
INFO [2025-03-29 13:04:14] Optimizing team for Ukraine
INFO [2025-03-29 13:04:14] Optimizing team for Kazakhstan
INFO [2025-03-29 13:04:14] Optimizing team for Armenia
INFO [2025-03-29 13:04:14] Optimizing team for Latvia
INFO [2025-03-29 13:04:14] Optimizing team for Japan
INFO [2025-03-29 13:04:14] Optimizing team for Poland
INFO [2025-03-29 13:04:14] Optimizing team for South Korea
INFO [2025-03-29 13:04:14] Optimizing team for Andorra
INFO [2025-03-29 13:04:14] Optimizing team for Taiwan
INFO [2025-03-29 13:04:14] Optimizing team for China
INFO [2025-03-29 13:04:14] Optimizing team for Croatia
INFO [2025-03-29 13:04:14] Optimizing team for Slovakia
INFO [2025-03-29 13:04:14] Optimizing team for Argentina
INFO [2025-03-29 13:04:14] Optimizing team for Mongolia
INFO [2025-03-29 13:04:15] Optimizing team for Brazil
INFO [2025-03-29 13:04:15] Optimizing team for Lithuania
INFO [2025-03-29 13:04:15] Optimizing team for Greece
INFO [2025-03-29 13:04:15] Optimizing team for Iceland
INFO [2025-03-29 13:04:15] Optimizing team for Bulgaria
INFO [2025-03-29 13:04:15] Optimizing team for Serbia
INFO [2025-03-29 13:04:15] Optimizing team for Hungary
INFO [2025-03-29 13:04:15] Optimizing team for Turkey
INFO [2025-03-29 13:04:15] Optimizing team for North Macedonia
INFO [2025-03-29 13:04:15] Optimizing team for Romania
INFO [2025-03-29 13:04:15] Optimizing team for Bosnia&Herzegovina
INFO [2025-03-29 13:04:15] Optimizing team for Mexico
INFO [2025-03-29 13:04:15] Optimizing team for Iran
INFO [2025-03-29 13:04:15] Optimizing team for Chile
INFO [2025-03-29 13:04:15] Optimizing team for India
INFO [2025-03-29 13:04:15] Optimizing team for Malaysia
INFO [2025-03-29 13:04:15] Optimizing team for Haiti
INFO [2025-03-29 13:04:15] Optimizing team for Lebanon
INFO [2025-03-29 13:04:15] Optimizing team for Liechtenstein
WARN [2025-03-29 13:04:15] Could not read individuals file: invalid 'description' argument
WARN [2025-03-29 13:04:15] Could not read teams file: invalid 'description' argument
INFO [2025-03-29 13:04:15] Resetting men's probabilities at or below the mode to zero
INFO [2025-03-29 13:04:15] No values appear more than twice for Win_Prob
INFO [2025-03-29 13:04:15] No values appear more than twice for Podium_Prob
INFO [2025-03-29 13:04:15] No values appear more than twice for Top5_Prob
INFO [2025-03-29 13:04:15] No values appear more than twice for Top10_Prob
INFO [2025-03-29 13:04:15] Resetting ladies' probabilities at or below the mode to zero
INFO [2025-03-29 13:04:15] Reset 20 values to 0 for Win_Prob (repeated values or values <  0 )
INFO [2025-03-29 13:04:15] Repeated values: 0, 0, 0, 0, 0
INFO [2025-03-29 13:04:15] No values appear more than twice for Podium_Prob
INFO [2025-03-29 13:04:15] No values appear more than twice for Top5_Prob
INFO [2025-03-29 13:04:15] No values appear more than twice for Top10_Prob
INFO [2025-03-29 13:04:15] Normalizing men's team probabilities
INFO [2025-03-29 13:04:15] Normalized Win_Prob from sum of 0.72 to 1
INFO [2025-03-29 13:04:15] Normalized Podium_Prob from sum of 2.34 to 3
INFO [2025-03-29 13:04:15] Normalized Top5_Prob from sum of 4.2 to 5
INFO [2025-03-29 13:04:15] Normalized Top10_Prob from sum of 10.33 to 10
INFO [2025-03-29 13:04:15] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 13:04:15] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 13:04:15] Normalizing ladies' team probabilities
INFO [2025-03-29 13:04:15] Normalized Win_Prob from sum of 2.19 to 1
INFO [2025-03-29 13:04:15] Normalized Podium_Prob from sum of 4.41 to 3
INFO [2025-03-29 13:04:15] Normalized Top5_Prob from sum of 4.73 to 5
INFO [2025-03-29 13:04:15] Normalized Top10_Prob from sum of 13.19 to 10
INFO [2025-03-29 13:04:15] Final capping of probabilities to maximum of 1
INFO [2025-03-29 13:04:15] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 13:04:15] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 13:04:15] Optimizing fantasy relay team
INFO [2025-03-29 13:04:15] Fantasy team optimization complete. Selected 6 teams.
INFO [2025-03-29 13:04:15] Total price: 92546 of max 1e+05
INFO [2025-03-29 13:04:15] Expected total points: 543.1
INFO [2025-03-29 13:04:15] Men's teams: 6 ( 6 )
INFO [2025-03-29 13:04:15] Ladies' teams: 0 ( 0 )
INFO [2025-03-29 13:04:15] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_points.xlsx
INFO [2025-03-29 13:04:15] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_probabilities.xlsx
INFO [2025-03-29 13:04:15] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_points.xlsx
INFO [2025-03-29 13:04:15] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_probabilities.xlsx
INFO [2025-03-29 13:04:15] Saved fantasy team results to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/fantasy_relay_team.xlsx
INFO [2025-03-29 13:04:15] Relay predictions completed successfully
INFO [2025-03-29 13:05:28] Starting relay predictions process
INFO [2025-03-29 13:05:28] Loading weekend race data
INFO [2025-03-29 13:05:28] Tomorrow's date: 2025-03-29
INFO [2025-03-29 13:05:28] Found 1 men's relay races and 1 ladies' relay races
INFO [2025-03-29 13:05:28] Loading chrono data
INFO [2025-03-29 13:05:34] Loaded men's chrono with 105122 rows and 36 columns
INFO [2025-03-29 13:05:34] Loaded ladies' chrono with 78706 rows and 36 columns
INFO [2025-03-29 13:05:34] Created men's relay df with 9688 rows
INFO [2025-03-29 13:05:34] Created men's individual df with 92143 rows
INFO [2025-03-29 13:05:34] Created ladies' relay df with 8019 rows
INFO [2025-03-29 13:05:34] Created ladies' individual df with 68253 rows
INFO [2025-03-29 13:05:38] Training models for Leg 1
INFO [2025-03-29 13:05:38] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:05:38] Training podium model using glm
INFO [2025-03-29 13:05:38] Training win model using glm
INFO [2025-03-29 13:05:39] Training top5 model using glm
INFO [2025-03-29 13:05:39] Training top10 model using glm
INFO [2025-03-29 13:05:39] Top features for Leg 1 podium prediction:
INFO [2025-03-29 13:05:39] Training models for Leg 2
INFO [2025-03-29 13:05:39] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:05:39] Training podium model using glm
INFO [2025-03-29 13:05:39] Training win model using glm
INFO [2025-03-29 13:05:39] Training top5 model using glm
INFO [2025-03-29 13:05:39] Training top10 model using glm
INFO [2025-03-29 13:05:39] Top features for Leg 2 podium prediction:
INFO [2025-03-29 13:05:39] Training models for Leg 3
INFO [2025-03-29 13:05:39] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:05:39] Training podium model using glm
INFO [2025-03-29 13:05:39] Training win model using glm
INFO [2025-03-29 13:05:39] Training top5 model using glm
INFO [2025-03-29 13:05:39] Training top10 model using glm
INFO [2025-03-29 13:05:39] Top features for Leg 3 podium prediction:
INFO [2025-03-29 13:05:39] Training models for Leg 4
INFO [2025-03-29 13:05:39] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:05:39] Training podium model using glm
INFO [2025-03-29 13:05:39] Training win model using glm
INFO [2025-03-29 13:05:40] Training top5 model using glm
INFO [2025-03-29 13:05:40] Training top10 model using glm
INFO [2025-03-29 13:05:40] Top features for Leg 4 podium prediction:
INFO [2025-03-29 13:05:40] Training models for Leg 1
INFO [2025-03-29 13:05:40] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:05:40] Training podium model using glm
INFO [2025-03-29 13:05:40] Training win model using glm
INFO [2025-03-29 13:05:40] Training top5 model using glm
INFO [2025-03-29 13:05:40] Training top10 model using glm
INFO [2025-03-29 13:05:40] Top features for Leg 1 podium prediction:
INFO [2025-03-29 13:05:40] Training models for Leg 2
INFO [2025-03-29 13:05:40] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:05:40] Training podium model using glm
INFO [2025-03-29 13:05:40] Training win model using glm
INFO [2025-03-29 13:05:40] Training top5 model using glm
INFO [2025-03-29 13:05:40] Training top10 model using glm
INFO [2025-03-29 13:05:40] Top features for Leg 2 podium prediction:
INFO [2025-03-29 13:05:40] Training models for Leg 3
INFO [2025-03-29 13:05:40] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:05:40] Training podium model using glm
INFO [2025-03-29 13:05:40] Training win model using glm
INFO [2025-03-29 13:05:40] Training top5 model using glm
INFO [2025-03-29 13:05:41] Training top10 model using glm
INFO [2025-03-29 13:05:41] Top features for Leg 3 podium prediction:
INFO [2025-03-29 13:05:41] Training models for Leg 4
INFO [2025-03-29 13:05:41] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:05:41] Training podium model using glm
INFO [2025-03-29 13:05:41] Training win model using glm
INFO [2025-03-29 13:05:41] Training top5 model using glm
INFO [2025-03-29 13:05:41] Training top10 model using glm
INFO [2025-03-29 13:05:41] Top features for Leg 4 podium prediction:
INFO [2025-03-29 13:05:41] Processing men's relay predictions
INFO [2025-03-29 13:05:41] Loaded men relay teams startlist with 24 rows
INFO [2025-03-29 13:05:41] Loaded men relay individuals startlist with 96 rows
INFO [2025-03-29 13:05:41] Preparing current men skier data
INFO [2025-03-29 13:05:41] Found 9 Elo columns for current skiers
INFO [2025-03-29 13:05:41] Replaced NAs in Distance_Elo with first quartile: 1207.23243912712
INFO [2025-03-29 13:05:41] Replaced NAs in Distance_C_Elo with first quartile: 1233.40200699225
INFO [2025-03-29 13:05:41] Replaced NAs in Distance_F_Elo with first quartile: 1236.48554062178
INFO [2025-03-29 13:05:41] Replaced NAs in Sprint_Elo with first quartile: 1223.60107000698
INFO [2025-03-29 13:05:41] Replaced NAs in Sprint_C_Elo with first quartile: 1241.28715500947
INFO [2025-03-29 13:05:41] Replaced NAs in Sprint_F_Elo with first quartile: 1234.45151108772
INFO [2025-03-29 13:05:41] Replaced NAs in Classic_Elo with first quartile: 1241.52867310024
INFO [2025-03-29 13:05:41] Replaced NAs in Freestyle_Elo with first quartile: 1228.48649348109
INFO [2025-03-29 13:05:41] Replaced NAs in Distance_Pelo with first quartile: 1211.63035979047
INFO [2025-03-29 13:05:41] Replaced NAs in Distance_C_Pelo with first quartile: 1234.81091928129
INFO [2025-03-29 13:05:41] Replaced NAs in Distance_F_Pelo with first quartile: 1239.65331180248
INFO [2025-03-29 13:05:41] Replaced NAs in Sprint_Pelo with first quartile: 1240.94751821383
INFO [2025-03-29 13:05:41] Replaced NAs in Sprint_C_Pelo with first quartile: 1241.28715500947
INFO [2025-03-29 13:05:41] Replaced NAs in Sprint_F_Pelo with first quartile: 1252.45166310493
INFO [2025-03-29 13:05:41] Replaced NAs in Classic_Pelo with first quartile: 1243.63746068082
INFO [2025-03-29 13:05:41] Replaced NAs in Freestyle_Pelo with first quartile: 1249.30280713791
INFO [2025-03-29 13:05:41] Replaced NAs in Classic_Last_5 with first quartile: 0
INFO [2025-03-29 13:05:41] Replaced NAs in Freestyle_Last_5 with first quartile: 0
INFO [2025-03-29 13:05:41] Created Pelo_Pct from Elo with max value: 1946.6211651574
INFO [2025-03-29 13:05:41] Created Distance_Pelo_Pct from Distance_Elo with max value: 1869.1251911742
INFO [2025-03-29 13:05:41] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1777.16297253153
INFO [2025-03-29 13:05:41] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1695.2053212904
INFO [2025-03-29 13:05:41] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1886.80363942481
INFO [2025-03-29 13:05:41] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1711.08486899169
INFO [2025-03-29 13:05:41] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1792.65157560707
INFO [2025-03-29 13:05:41] Created Classic_Pelo_Pct from Classic_Elo with max value: 1807.56773496777
INFO [2025-03-29 13:05:41] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1814.60460629541
INFO [2025-03-29 13:05:41] Prepared data for 381 men skiers with 33 features
INFO [2025-03-29 13:05:41] Using FIS startlist for men's leg predictions
INFO [2025-03-29 13:05:41] Using FIS startlist for men
INFO [2025-03-29 13:05:41] Attempting Option 1: Team model coefficients
INFO [2025-03-29 13:05:41] Option 1 failed: No team_podium model found
INFO [2025-03-29 13:05:41] Option 1 failed: No team model
INFO [2025-03-29 13:05:41] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 13:05:41] Leg 1 accuracy: 0.858008961620884
INFO [2025-03-29 13:05:41] Leg 2 accuracy: 0.83461913111241
INFO [2025-03-29 13:05:41] Leg 3 accuracy: 0.871052016364699
INFO [2025-03-29 13:05:41] Leg 4 accuracy: 0.891525423728814
INFO [2025-03-29 13:05:41] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 13:05:41] Leg importance weights: Leg 1: 0.25, Leg 2: 0.24, Leg 3: 0.25, Leg 4: 0.26
INFO [2025-03-29 13:05:42] Processing ladies's relay predictions
INFO [2025-03-29 13:05:42] Loaded ladies relay teams startlist with 35 rows
INFO [2025-03-29 13:05:42] Loaded ladies relay individuals startlist with 231 rows
INFO [2025-03-29 13:05:42] Preparing current ladies skier data
INFO [2025-03-29 13:05:42] Found 9 Elo columns for current skiers
INFO [2025-03-29 13:05:42] Replaced NAs in Distance_Elo with first quartile: 1237.38564383256
INFO [2025-03-29 13:05:42] Replaced NAs in Distance_C_Elo with first quartile: 1243.87329106944
INFO [2025-03-29 13:05:42] Replaced NAs in Distance_F_Elo with first quartile: 1256.69628195708
INFO [2025-03-29 13:05:42] Replaced NAs in Sprint_Elo with first quartile: 1246.32574824425
INFO [2025-03-29 13:05:42] Replaced NAs in Sprint_C_Elo with first quartile: 1257.67866787334
INFO [2025-03-29 13:05:42] Replaced NAs in Sprint_F_Elo with first quartile: 1244.84742904868
INFO [2025-03-29 13:05:42] Replaced NAs in Classic_Elo with first quartile: 1252.44868703669
INFO [2025-03-29 13:05:42] Replaced NAs in Freestyle_Elo with first quartile: 1244.44508230281
INFO [2025-03-29 13:05:42] Replaced NAs in Distance_Pelo with first quartile: 1241.11854419952
INFO [2025-03-29 13:05:42] Replaced NAs in Distance_C_Pelo with first quartile: 1245.57367555166
INFO [2025-03-29 13:05:42] Replaced NAs in Distance_F_Pelo with first quartile: 1259.54282973153
INFO [2025-03-29 13:05:42] Replaced NAs in Sprint_Pelo with first quartile: 1254.58885254623
INFO [2025-03-29 13:05:42] Replaced NAs in Sprint_C_Pelo with first quartile: 1257.58302026178
INFO [2025-03-29 13:05:42] Replaced NAs in Sprint_F_Pelo with first quartile: 1257.67755691493
INFO [2025-03-29 13:05:42] Replaced NAs in Classic_Pelo with first quartile: 1256.79275004544
INFO [2025-03-29 13:05:42] Replaced NAs in Freestyle_Pelo with first quartile: 1256.79999900008
INFO [2025-03-29 13:05:42] Replaced NAs in Classic_Last_5 with first quartile: 3.5
INFO [2025-03-29 13:05:42] Replaced NAs in Freestyle_Last_5 with first quartile: 2.4
INFO [2025-03-29 13:05:42] Created Pelo_Pct from Elo with max value: 1841.00191142018
INFO [2025-03-29 13:05:42] Created Distance_Pelo_Pct from Distance_Elo with max value: 1889.46974050597
INFO [2025-03-29 13:05:42] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1763.33572074398
INFO [2025-03-29 13:05:42] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1693.85026290322
INFO [2025-03-29 13:05:42] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1742.74758850835
INFO [2025-03-29 13:05:42] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1601.5820663103
INFO [2025-03-29 13:05:42] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1681.09824552997
INFO [2025-03-29 13:05:42] Created Classic_Pelo_Pct from Classic_Elo with max value: 1698.69428891549
INFO [2025-03-29 13:05:42] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1707.58410982918
INFO [2025-03-29 13:05:42] Prepared data for 255 ladies skiers with 33 features
INFO [2025-03-29 13:05:42] No FIS startlist, predicting for all skiers in all legs
INFO [2025-03-29 13:05:42] No valid FIS startlist for ladies, building optimized teams
INFO [2025-03-29 13:05:42] Attempting Option 1: Team model coefficients
INFO [2025-03-29 13:05:42] Option 1 failed: argument "leg_models" is missing, with no default
INFO [2025-03-29 13:05:42] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 13:05:42] Option 2 failed: argument "leg_models" is missing, with no default
INFO [2025-03-29 13:05:42] Using Option 3: Default leg importance weights
INFO [2025-03-29 13:05:42] Using leg importance weights for team optimization: Leg 1: 0.20, Leg 2: 0.20, Leg 3: 0.25, Leg 4: 0.35
INFO [2025-03-29 13:05:42] Optimizing team for Sweden
INFO [2025-03-29 13:05:42] Optimizing team for Norway
INFO [2025-03-29 13:05:42] Optimizing team for Germany
INFO [2025-03-29 13:05:42] Optimizing team for USA
INFO [2025-03-29 13:05:42] Optimizing team for Austria
INFO [2025-03-29 13:05:42] Optimizing team for Finland
INFO [2025-03-29 13:05:42] Optimizing team for Czechia
INFO [2025-03-29 13:05:42] Optimizing team for Switzerland
INFO [2025-03-29 13:05:42] Optimizing team for Italy
INFO [2025-03-29 13:05:42] Optimizing team for France
INFO [2025-03-29 13:05:42] Optimizing team for Canada
INFO [2025-03-29 13:05:42] Optimizing team for Slovenia
INFO [2025-03-29 13:05:42] Optimizing team for Estonia
INFO [2025-03-29 13:05:42] Optimizing team for Australia
INFO [2025-03-29 13:05:42] Optimizing team for Ukraine
INFO [2025-03-29 13:05:42] Optimizing team for Kazakhstan
INFO [2025-03-29 13:05:42] Optimizing team for Armenia
INFO [2025-03-29 13:05:43] Optimizing team for Latvia
INFO [2025-03-29 13:05:43] Optimizing team for Japan
INFO [2025-03-29 13:05:43] Optimizing team for Poland
INFO [2025-03-29 13:05:43] Optimizing team for South Korea
INFO [2025-03-29 13:05:43] Optimizing team for Andorra
INFO [2025-03-29 13:05:43] Optimizing team for Taiwan
INFO [2025-03-29 13:05:43] Optimizing team for China
INFO [2025-03-29 13:05:43] Optimizing team for Croatia
INFO [2025-03-29 13:05:43] Optimizing team for Slovakia
INFO [2025-03-29 13:05:43] Optimizing team for Argentina
INFO [2025-03-29 13:05:43] Optimizing team for Mongolia
INFO [2025-03-29 13:05:43] Optimizing team for Brazil
INFO [2025-03-29 13:05:43] Optimizing team for Lithuania
INFO [2025-03-29 13:05:43] Optimizing team for Greece
INFO [2025-03-29 13:05:43] Optimizing team for Iceland
INFO [2025-03-29 13:05:43] Optimizing team for Bulgaria
INFO [2025-03-29 13:05:43] Optimizing team for Serbia
INFO [2025-03-29 13:05:43] Optimizing team for Hungary
INFO [2025-03-29 13:05:43] Optimizing team for Turkey
INFO [2025-03-29 13:05:43] Optimizing team for North Macedonia
INFO [2025-03-29 13:05:43] Optimizing team for Romania
INFO [2025-03-29 13:05:43] Optimizing team for Bosnia&Herzegovina
INFO [2025-03-29 13:05:43] Optimizing team for Mexico
INFO [2025-03-29 13:05:43] Optimizing team for Iran
INFO [2025-03-29 13:05:43] Optimizing team for Chile
INFO [2025-03-29 13:05:43] Optimizing team for India
INFO [2025-03-29 13:05:43] Optimizing team for Malaysia
INFO [2025-03-29 13:05:43] Optimizing team for Haiti
INFO [2025-03-29 13:05:43] Optimizing team for Lebanon
INFO [2025-03-29 13:05:43] Optimizing team for Liechtenstein
WARN [2025-03-29 13:05:43] Could not read individuals file: invalid 'description' argument
WARN [2025-03-29 13:05:43] Could not read teams file: invalid 'description' argument
INFO [2025-03-29 13:05:43] Resetting men's probabilities at or below the mode to zero
INFO [2025-03-29 13:05:43] No values appear more than twice for Win_Prob
INFO [2025-03-29 13:05:43] No values appear more than twice for Podium_Prob
INFO [2025-03-29 13:05:43] No values appear more than twice for Top5_Prob
INFO [2025-03-29 13:05:43] No values appear more than twice for Top10_Prob
INFO [2025-03-29 13:05:43] Resetting ladies' probabilities at or below the mode to zero
INFO [2025-03-29 13:05:43] Reset 20 values to 0 for Win_Prob (repeated values or values <  0 )
INFO [2025-03-29 13:05:43] Repeated values: 0, 0, 0, 0, 0
INFO [2025-03-29 13:05:43] No values appear more than twice for Podium_Prob
INFO [2025-03-29 13:05:43] No values appear more than twice for Top5_Prob
INFO [2025-03-29 13:05:43] No values appear more than twice for Top10_Prob
INFO [2025-03-29 13:05:43] Normalizing men's team probabilities
INFO [2025-03-29 13:05:43] Normalized Win_Prob from sum of 0.71 to 1
INFO [2025-03-29 13:05:43] Normalized Podium_Prob from sum of 2.34 to 3
INFO [2025-03-29 13:05:43] Normalized Top5_Prob from sum of 4.2 to 5
INFO [2025-03-29 13:05:43] Normalized Top10_Prob from sum of 10.33 to 10
INFO [2025-03-29 13:05:43] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 13:05:43] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 13:05:43] Normalizing ladies' team probabilities
INFO [2025-03-29 13:05:43] Normalized Win_Prob from sum of 2.19 to 1
INFO [2025-03-29 13:05:43] Normalized Podium_Prob from sum of 4.41 to 3
INFO [2025-03-29 13:05:43] Normalized Top5_Prob from sum of 4.73 to 5
INFO [2025-03-29 13:05:43] Normalized Top10_Prob from sum of 13.19 to 10
INFO [2025-03-29 13:05:43] Final capping of probabilities to maximum of 1
INFO [2025-03-29 13:05:43] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 13:05:43] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 13:05:43] Optimizing fantasy relay team
INFO [2025-03-29 13:06:02] Starting relay predictions process
INFO [2025-03-29 13:06:02] Loading weekend race data
INFO [2025-03-29 13:06:02] Tomorrow's date: 2025-03-29
INFO [2025-03-29 13:06:02] Found 1 men's relay races and 1 ladies' relay races
INFO [2025-03-29 13:06:02] Loading chrono data
INFO [2025-03-29 13:06:07] Loaded men's chrono with 105122 rows and 36 columns
INFO [2025-03-29 13:06:07] Loaded ladies' chrono with 78706 rows and 36 columns
INFO [2025-03-29 13:06:07] Created men's relay df with 9688 rows
INFO [2025-03-29 13:06:07] Created men's individual df with 92143 rows
INFO [2025-03-29 13:06:07] Created ladies' relay df with 8019 rows
INFO [2025-03-29 13:06:07] Created ladies' individual df with 68253 rows
INFO [2025-03-29 13:06:09] Starting relay predictions process
INFO [2025-03-29 13:06:09] Loading weekend race data
INFO [2025-03-29 13:06:09] Tomorrow's date: 2025-03-29
INFO [2025-03-29 13:06:09] Found 1 men's relay races and 1 ladies' relay races
INFO [2025-03-29 13:06:09] Loading chrono data
INFO [2025-03-29 13:06:14] Loaded men's chrono with 105122 rows and 36 columns
INFO [2025-03-29 13:06:14] Loaded ladies' chrono with 78706 rows and 36 columns
INFO [2025-03-29 13:06:14] Created men's relay df with 9688 rows
INFO [2025-03-29 13:06:14] Created men's individual df with 92143 rows
INFO [2025-03-29 13:06:14] Created ladies' relay df with 8019 rows
INFO [2025-03-29 13:06:14] Created ladies' individual df with 68253 rows
INFO [2025-03-29 13:06:19] Training models for Leg 1
INFO [2025-03-29 13:06:19] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:06:19] Training podium model using glm
INFO [2025-03-29 13:06:20] Training win model using glm
INFO [2025-03-29 13:06:20] Training top5 model using glm
INFO [2025-03-29 13:06:20] Training top10 model using glm
INFO [2025-03-29 13:06:20] Top features for Leg 1 podium prediction:
INFO [2025-03-29 13:06:20] Training models for Leg 2
INFO [2025-03-29 13:06:20] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:06:20] Training podium model using glm
INFO [2025-03-29 13:06:20] Training win model using glm
INFO [2025-03-29 13:06:20] Training top5 model using glm
INFO [2025-03-29 13:06:20] Training top10 model using glm
INFO [2025-03-29 13:06:20] Top features for Leg 2 podium prediction:
INFO [2025-03-29 13:06:20] Training models for Leg 3
INFO [2025-03-29 13:06:20] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:06:20] Training podium model using glm
INFO [2025-03-29 13:06:20] Training win model using glm
INFO [2025-03-29 13:06:20] Training top5 model using glm
INFO [2025-03-29 13:06:20] Training top10 model using glm
INFO [2025-03-29 13:06:21] Top features for Leg 3 podium prediction:
INFO [2025-03-29 13:06:21] Training models for Leg 4
INFO [2025-03-29 13:06:21] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:06:21] Training podium model using glm
INFO [2025-03-29 13:06:21] Training win model using glm
INFO [2025-03-29 13:06:21] Training top5 model using glm
INFO [2025-03-29 13:06:21] Training top10 model using glm
INFO [2025-03-29 13:06:21] Top features for Leg 4 podium prediction:
INFO [2025-03-29 13:06:21] Training models for Leg 1
INFO [2025-03-29 13:06:21] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:06:21] Training podium model using glm
INFO [2025-03-29 13:06:21] Training win model using glm
INFO [2025-03-29 13:06:21] Training top5 model using glm
INFO [2025-03-29 13:06:21] Training top10 model using glm
INFO [2025-03-29 13:06:21] Top features for Leg 1 podium prediction:
INFO [2025-03-29 13:06:21] Training models for Leg 2
INFO [2025-03-29 13:06:21] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:06:21] Training podium model using glm
INFO [2025-03-29 13:06:21] Training win model using glm
INFO [2025-03-29 13:06:21] Training top5 model using glm
INFO [2025-03-29 13:06:22] Training top10 model using glm
INFO [2025-03-29 13:06:22] Top features for Leg 2 podium prediction:
INFO [2025-03-29 13:06:22] Training models for Leg 3
INFO [2025-03-29 13:06:22] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:06:22] Training podium model using glm
INFO [2025-03-29 13:06:22] Training win model using glm
INFO [2025-03-29 13:06:22] Training top5 model using glm
INFO [2025-03-29 13:06:22] Training top10 model using glm
INFO [2025-03-29 13:06:22] Top features for Leg 3 podium prediction:
INFO [2025-03-29 13:06:22] Training models for Leg 4
INFO [2025-03-29 13:06:22] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:06:22] Training podium model using glm
INFO [2025-03-29 13:06:22] Training win model using glm
INFO [2025-03-29 13:06:22] Training top5 model using glm
INFO [2025-03-29 13:06:22] Training top10 model using glm
INFO [2025-03-29 13:06:22] Top features for Leg 4 podium prediction:
INFO [2025-03-29 13:06:22] Processing men's relay predictions
INFO [2025-03-29 13:06:22] Loaded men relay teams startlist with 24 rows
INFO [2025-03-29 13:06:22] Loaded men relay individuals startlist with 96 rows
INFO [2025-03-29 13:06:22] Preparing current men skier data
INFO [2025-03-29 13:06:22] Found 9 Elo columns for current skiers
INFO [2025-03-29 13:06:22] Replaced NAs in Distance_Elo with first quartile: 1207.23243912712
INFO [2025-03-29 13:06:22] Replaced NAs in Distance_C_Elo with first quartile: 1233.40200699225
INFO [2025-03-29 13:06:22] Replaced NAs in Distance_F_Elo with first quartile: 1236.48554062178
INFO [2025-03-29 13:06:22] Replaced NAs in Sprint_Elo with first quartile: 1223.60107000698
INFO [2025-03-29 13:06:22] Replaced NAs in Sprint_C_Elo with first quartile: 1241.28715500947
INFO [2025-03-29 13:06:22] Replaced NAs in Sprint_F_Elo with first quartile: 1234.45151108772
INFO [2025-03-29 13:06:22] Replaced NAs in Classic_Elo with first quartile: 1241.52867310024
INFO [2025-03-29 13:06:22] Replaced NAs in Freestyle_Elo with first quartile: 1228.48649348109
INFO [2025-03-29 13:06:22] Replaced NAs in Distance_Pelo with first quartile: 1211.63035979047
INFO [2025-03-29 13:06:22] Replaced NAs in Distance_C_Pelo with first quartile: 1234.81091928129
INFO [2025-03-29 13:06:22] Replaced NAs in Distance_F_Pelo with first quartile: 1239.65331180248
INFO [2025-03-29 13:06:22] Replaced NAs in Sprint_Pelo with first quartile: 1240.94751821383
INFO [2025-03-29 13:06:22] Replaced NAs in Sprint_C_Pelo with first quartile: 1241.28715500947
INFO [2025-03-29 13:06:22] Replaced NAs in Sprint_F_Pelo with first quartile: 1252.45166310493
INFO [2025-03-29 13:06:22] Replaced NAs in Classic_Pelo with first quartile: 1243.63746068082
INFO [2025-03-29 13:06:22] Replaced NAs in Freestyle_Pelo with first quartile: 1249.30280713791
INFO [2025-03-29 13:06:22] Replaced NAs in Classic_Last_5 with first quartile: 0
INFO [2025-03-29 13:06:22] Replaced NAs in Freestyle_Last_5 with first quartile: 0
INFO [2025-03-29 13:06:22] Created Pelo_Pct from Elo with max value: 1946.6211651574
INFO [2025-03-29 13:06:22] Created Distance_Pelo_Pct from Distance_Elo with max value: 1869.1251911742
INFO [2025-03-29 13:06:22] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1777.16297253153
INFO [2025-03-29 13:06:22] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1695.2053212904
INFO [2025-03-29 13:06:22] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1886.80363942481
INFO [2025-03-29 13:06:22] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1711.08486899169
INFO [2025-03-29 13:06:22] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1792.65157560707
INFO [2025-03-29 13:06:22] Created Classic_Pelo_Pct from Classic_Elo with max value: 1807.56773496777
INFO [2025-03-29 13:06:22] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1814.60460629541
INFO [2025-03-29 13:06:22] Prepared data for 381 men skiers with 33 features
INFO [2025-03-29 13:06:23] Using FIS startlist for men's leg predictions
INFO [2025-03-29 13:06:23] Using FIS startlist for men
INFO [2025-03-29 13:06:23] Attempting Option 1: Team model coefficients
INFO [2025-03-29 13:06:23] Option 1 failed: No team_podium model found
INFO [2025-03-29 13:06:23] Option 1 failed: No team model
INFO [2025-03-29 13:06:23] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 13:06:23] Leg 1 accuracy: 0.86461328657705
INFO [2025-03-29 13:06:23] Leg 2 accuracy: 0.844504188583674
INFO [2025-03-29 13:06:23] Leg 3 accuracy: 0.860490940970193
INFO [2025-03-29 13:06:23] Leg 4 accuracy: 0.888065458796026
INFO [2025-03-29 13:06:23] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 13:06:23] Leg importance weights: Leg 1: 0.25, Leg 2: 0.24, Leg 3: 0.25, Leg 4: 0.26
INFO [2025-03-29 13:06:23] Processing ladies's relay predictions
INFO [2025-03-29 13:06:23] Loaded ladies relay teams startlist with 35 rows
INFO [2025-03-29 13:06:23] Loaded ladies relay individuals startlist with 231 rows
INFO [2025-03-29 13:06:23] Preparing current ladies skier data
INFO [2025-03-29 13:06:23] Found 9 Elo columns for current skiers
INFO [2025-03-29 13:06:23] Replaced NAs in Distance_Elo with first quartile: 1237.38564383256
INFO [2025-03-29 13:06:23] Replaced NAs in Distance_C_Elo with first quartile: 1243.87329106944
INFO [2025-03-29 13:06:23] Replaced NAs in Distance_F_Elo with first quartile: 1256.69628195708
INFO [2025-03-29 13:06:23] Replaced NAs in Sprint_Elo with first quartile: 1246.32574824425
INFO [2025-03-29 13:06:23] Replaced NAs in Sprint_C_Elo with first quartile: 1257.67866787334
INFO [2025-03-29 13:06:23] Replaced NAs in Sprint_F_Elo with first quartile: 1244.84742904868
INFO [2025-03-29 13:06:23] Replaced NAs in Classic_Elo with first quartile: 1252.44868703669
INFO [2025-03-29 13:06:23] Replaced NAs in Freestyle_Elo with first quartile: 1244.44508230281
INFO [2025-03-29 13:06:23] Replaced NAs in Distance_Pelo with first quartile: 1241.11854419952
INFO [2025-03-29 13:06:23] Replaced NAs in Distance_C_Pelo with first quartile: 1245.57367555166
INFO [2025-03-29 13:06:23] Replaced NAs in Distance_F_Pelo with first quartile: 1259.54282973153
INFO [2025-03-29 13:06:23] Replaced NAs in Sprint_Pelo with first quartile: 1254.58885254623
INFO [2025-03-29 13:06:23] Replaced NAs in Sprint_C_Pelo with first quartile: 1257.58302026178
INFO [2025-03-29 13:06:23] Replaced NAs in Sprint_F_Pelo with first quartile: 1257.67755691493
INFO [2025-03-29 13:06:23] Replaced NAs in Classic_Pelo with first quartile: 1256.79275004544
INFO [2025-03-29 13:06:23] Replaced NAs in Freestyle_Pelo with first quartile: 1256.79999900008
INFO [2025-03-29 13:06:23] Replaced NAs in Classic_Last_5 with first quartile: 3.5
INFO [2025-03-29 13:06:23] Replaced NAs in Freestyle_Last_5 with first quartile: 2.4
INFO [2025-03-29 13:06:23] Created Pelo_Pct from Elo with max value: 1841.00191142018
INFO [2025-03-29 13:06:23] Created Distance_Pelo_Pct from Distance_Elo with max value: 1889.46974050597
INFO [2025-03-29 13:06:23] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1763.33572074398
INFO [2025-03-29 13:06:23] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1693.85026290322
INFO [2025-03-29 13:06:23] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1742.74758850835
INFO [2025-03-29 13:06:23] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1601.5820663103
INFO [2025-03-29 13:06:23] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1681.09824552997
INFO [2025-03-29 13:06:23] Created Classic_Pelo_Pct from Classic_Elo with max value: 1698.69428891549
INFO [2025-03-29 13:06:23] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1707.58410982918
INFO [2025-03-29 13:06:23] Prepared data for 255 ladies skiers with 33 features
INFO [2025-03-29 13:06:23] No FIS startlist, predicting for all skiers in all legs
INFO [2025-03-29 13:06:23] No valid FIS startlist for ladies, building optimized teams
INFO [2025-03-29 13:06:23] Attempting Option 1: Team model coefficients
INFO [2025-03-29 13:06:23] Option 1 failed: argument "leg_models" is missing, with no default
INFO [2025-03-29 13:06:23] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 13:06:23] Option 2 failed: argument "leg_models" is missing, with no default
INFO [2025-03-29 13:06:23] Using Option 3: Default leg importance weights
INFO [2025-03-29 13:06:23] Using leg importance weights for team optimization: Leg 1: 0.20, Leg 2: 0.20, Leg 3: 0.25, Leg 4: 0.35
INFO [2025-03-29 13:06:23] Optimizing team for Sweden
INFO [2025-03-29 13:06:23] Optimizing team for Norway
INFO [2025-03-29 13:06:23] Optimizing team for Germany
INFO [2025-03-29 13:06:23] Optimizing team for USA
INFO [2025-03-29 13:06:24] Optimizing team for Austria
INFO [2025-03-29 13:06:24] Optimizing team for Finland
INFO [2025-03-29 13:06:24] Optimizing team for Czechia
INFO [2025-03-29 13:06:24] Optimizing team for Switzerland
INFO [2025-03-29 13:06:24] Optimizing team for Italy
INFO [2025-03-29 13:06:24] Optimizing team for France
INFO [2025-03-29 13:06:24] Optimizing team for Canada
INFO [2025-03-29 13:06:24] Optimizing team for Slovenia
INFO [2025-03-29 13:06:24] Optimizing team for Estonia
INFO [2025-03-29 13:06:24] Optimizing team for Australia
INFO [2025-03-29 13:06:24] Optimizing team for Ukraine
INFO [2025-03-29 13:06:24] Optimizing team for Kazakhstan
INFO [2025-03-29 13:06:24] Optimizing team for Armenia
INFO [2025-03-29 13:06:24] Optimizing team for Latvia
INFO [2025-03-29 13:06:24] Optimizing team for Japan
INFO [2025-03-29 13:06:24] Optimizing team for Poland
INFO [2025-03-29 13:06:24] Optimizing team for South Korea
INFO [2025-03-29 13:06:24] Optimizing team for Andorra
INFO [2025-03-29 13:06:24] Optimizing team for Taiwan
INFO [2025-03-29 13:06:24] Optimizing team for China
INFO [2025-03-29 13:06:24] Optimizing team for Croatia
INFO [2025-03-29 13:06:24] Optimizing team for Slovakia
INFO [2025-03-29 13:06:24] Optimizing team for Argentina
INFO [2025-03-29 13:06:24] Optimizing team for Mongolia
INFO [2025-03-29 13:06:24] Optimizing team for Brazil
INFO [2025-03-29 13:06:24] Optimizing team for Lithuania
INFO [2025-03-29 13:06:24] Optimizing team for Greece
INFO [2025-03-29 13:06:24] Optimizing team for Iceland
INFO [2025-03-29 13:06:24] Optimizing team for Bulgaria
INFO [2025-03-29 13:06:24] Optimizing team for Serbia
INFO [2025-03-29 13:06:24] Optimizing team for Hungary
INFO [2025-03-29 13:06:24] Optimizing team for Turkey
INFO [2025-03-29 13:06:24] Optimizing team for North Macedonia
INFO [2025-03-29 13:06:24] Optimizing team for Romania
INFO [2025-03-29 13:06:24] Optimizing team for Bosnia&Herzegovina
INFO [2025-03-29 13:06:24] Optimizing team for Mexico
INFO [2025-03-29 13:06:24] Optimizing team for Iran
INFO [2025-03-29 13:06:24] Optimizing team for Chile
INFO [2025-03-29 13:06:24] Optimizing team for India
INFO [2025-03-29 13:06:24] Optimizing team for Malaysia
INFO [2025-03-29 13:06:24] Optimizing team for Haiti
INFO [2025-03-29 13:06:24] Optimizing team for Lebanon
INFO [2025-03-29 13:06:24] Optimizing team for Liechtenstein
WARN [2025-03-29 13:06:25] Could not read individuals file: invalid 'description' argument
WARN [2025-03-29 13:06:25] Could not read teams file: invalid 'description' argument
INFO [2025-03-29 13:06:25] Resetting men's probabilities at or below the mode to zero
INFO [2025-03-29 13:06:25] No values appear more than twice for Win_Prob
INFO [2025-03-29 13:06:25] No values appear more than twice for Podium_Prob
INFO [2025-03-29 13:06:25] No values appear more than twice for Top5_Prob
INFO [2025-03-29 13:06:25] No values appear more than twice for Top10_Prob
INFO [2025-03-29 13:06:25] Resetting ladies' probabilities at or below the mode to zero
INFO [2025-03-29 13:06:25] Reset 20 values to 0 for Win_Prob (repeated values or values <  0 )
INFO [2025-03-29 13:06:25] Repeated values: 0, 0, 0, 0, 0
INFO [2025-03-29 13:06:25] No values appear more than twice for Podium_Prob
INFO [2025-03-29 13:06:25] No values appear more than twice for Top5_Prob
INFO [2025-03-29 13:06:25] No values appear more than twice for Top10_Prob
INFO [2025-03-29 13:06:25] Normalizing men's team probabilities
INFO [2025-03-29 13:06:25] Normalized Win_Prob from sum of 0.71 to 1
INFO [2025-03-29 13:06:25] Normalized Podium_Prob from sum of 2.34 to 3
INFO [2025-03-29 13:06:25] Normalized Top5_Prob from sum of 4.2 to 5
INFO [2025-03-29 13:06:25] Normalized Top10_Prob from sum of 10.33 to 10
INFO [2025-03-29 13:06:25] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 13:06:25] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 13:06:25] Normalizing ladies' team probabilities
INFO [2025-03-29 13:06:25] Normalized Win_Prob from sum of 2.19 to 1
INFO [2025-03-29 13:06:25] Normalized Podium_Prob from sum of 4.41 to 3
INFO [2025-03-29 13:06:25] Normalized Top5_Prob from sum of 4.73 to 5
INFO [2025-03-29 13:06:25] Normalized Top10_Prob from sum of 13.19 to 10
INFO [2025-03-29 13:06:25] Final capping of probabilities to maximum of 1
INFO [2025-03-29 13:06:25] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 13:06:25] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 13:06:25] Optimizing fantasy relay team
INFO [2025-03-29 13:06:25] Fantasy team optimization complete. Selected 6 teams.
INFO [2025-03-29 13:06:25] Total price: 92546 of max 1e+05
INFO [2025-03-29 13:06:25] Expected total points: 542.8
INFO [2025-03-29 13:06:25] Men's teams: 6 ( 6 )
INFO [2025-03-29 13:06:25] Ladies' teams: 0 ( 0 )
INFO [2025-03-29 13:06:25] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_points.xlsx
INFO [2025-03-29 13:06:25] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_probabilities.xlsx
INFO [2025-03-29 13:06:25] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_points.xlsx
INFO [2025-03-29 13:06:25] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_probabilities.xlsx
INFO [2025-03-29 13:06:25] Saved fantasy team results to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/fantasy_relay_team.xlsx
INFO [2025-03-29 13:06:25] Relay predictions completed successfully
INFO [2025-03-29 13:06:44] Starting relay predictions process
INFO [2025-03-29 13:06:44] Loading weekend race data
INFO [2025-03-29 13:06:44] Tomorrow's date: 2025-03-29
INFO [2025-03-29 13:06:44] Found 1 men's relay races and 1 ladies' relay races
INFO [2025-03-29 13:06:44] Loading chrono data
INFO [2025-03-29 13:06:50] Loaded men's chrono with 105122 rows and 36 columns
INFO [2025-03-29 13:06:50] Loaded ladies' chrono with 78706 rows and 36 columns
INFO [2025-03-29 13:06:50] Created men's relay df with 9688 rows
INFO [2025-03-29 13:06:50] Created men's individual df with 92143 rows
INFO [2025-03-29 13:06:50] Created ladies' relay df with 8019 rows
INFO [2025-03-29 13:06:50] Created ladies' individual df with 68253 rows
INFO [2025-03-29 13:06:54] Training models for Leg 1
INFO [2025-03-29 13:06:54] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:06:54] Training podium model using glm
INFO [2025-03-29 13:06:55] Training win model using glm
INFO [2025-03-29 13:06:55] Training top5 model using glm
INFO [2025-03-29 13:06:55] Training top10 model using glm
INFO [2025-03-29 13:06:55] Top features for Leg 1 podium prediction:
INFO [2025-03-29 13:06:55] Training models for Leg 2
INFO [2025-03-29 13:06:55] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:06:55] Training podium model using glm
INFO [2025-03-29 13:06:55] Training win model using glm
INFO [2025-03-29 13:06:55] Training top5 model using glm
INFO [2025-03-29 13:06:55] Training top10 model using glm
INFO [2025-03-29 13:06:55] Top features for Leg 2 podium prediction:
INFO [2025-03-29 13:06:55] Training models for Leg 3
INFO [2025-03-29 13:06:55] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:06:55] Training podium model using glm
INFO [2025-03-29 13:06:55] Training win model using glm
INFO [2025-03-29 13:06:55] Training top5 model using glm
INFO [2025-03-29 13:06:55] Training top10 model using glm
INFO [2025-03-29 13:06:55] Top features for Leg 3 podium prediction:
INFO [2025-03-29 13:06:55] Training models for Leg 4
INFO [2025-03-29 13:06:55] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:06:55] Training podium model using glm
INFO [2025-03-29 13:06:56] Training win model using glm
INFO [2025-03-29 13:06:56] Training top5 model using glm
INFO [2025-03-29 13:06:56] Training top10 model using glm
INFO [2025-03-29 13:06:56] Top features for Leg 4 podium prediction:
INFO [2025-03-29 13:06:56] Training models for Leg 1
INFO [2025-03-29 13:06:56] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:06:56] Training podium model using glm
INFO [2025-03-29 13:06:56] Training win model using glm
INFO [2025-03-29 13:06:56] Training top5 model using glm
INFO [2025-03-29 13:06:56] Training top10 model using glm
INFO [2025-03-29 13:06:56] Top features for Leg 1 podium prediction:
INFO [2025-03-29 13:06:56] Training models for Leg 2
INFO [2025-03-29 13:06:56] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:06:56] Training podium model using glm
INFO [2025-03-29 13:06:56] Training win model using glm
INFO [2025-03-29 13:06:56] Training top5 model using glm
INFO [2025-03-29 13:06:56] Training top10 model using glm
INFO [2025-03-29 13:06:56] Top features for Leg 2 podium prediction:
INFO [2025-03-29 13:06:56] Training models for Leg 3
INFO [2025-03-29 13:06:56] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:06:56] Training podium model using glm
INFO [2025-03-29 13:06:57] Training win model using glm
INFO [2025-03-29 13:06:57] Training top5 model using glm
INFO [2025-03-29 13:06:57] Training top10 model using glm
INFO [2025-03-29 13:06:57] Top features for Leg 3 podium prediction:
INFO [2025-03-29 13:06:57] Training models for Leg 4
INFO [2025-03-29 13:06:57] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:06:57] Training podium model using glm
INFO [2025-03-29 13:06:57] Training win model using glm
INFO [2025-03-29 13:06:57] Training top5 model using glm
INFO [2025-03-29 13:06:57] Training top10 model using glm
INFO [2025-03-29 13:06:57] Top features for Leg 4 podium prediction:
INFO [2025-03-29 13:06:57] Processing men's relay predictions
INFO [2025-03-29 13:06:57] Loaded men relay teams startlist with 24 rows
INFO [2025-03-29 13:06:57] Loaded men relay individuals startlist with 96 rows
INFO [2025-03-29 13:06:57] Preparing current men skier data
INFO [2025-03-29 13:06:57] Found 9 Elo columns for current skiers
INFO [2025-03-29 13:06:58] Replaced NAs in Distance_Elo with first quartile: 1207.23243912712
INFO [2025-03-29 13:06:58] Replaced NAs in Distance_C_Elo with first quartile: 1233.40200699225
INFO [2025-03-29 13:06:58] Replaced NAs in Distance_F_Elo with first quartile: 1236.48554062178
INFO [2025-03-29 13:06:58] Replaced NAs in Sprint_Elo with first quartile: 1223.60107000698
INFO [2025-03-29 13:06:58] Replaced NAs in Sprint_C_Elo with first quartile: 1241.28715500947
INFO [2025-03-29 13:06:58] Replaced NAs in Sprint_F_Elo with first quartile: 1234.45151108772
INFO [2025-03-29 13:06:58] Replaced NAs in Classic_Elo with first quartile: 1241.52867310024
INFO [2025-03-29 13:06:58] Replaced NAs in Freestyle_Elo with first quartile: 1228.48649348109
INFO [2025-03-29 13:06:58] Replaced NAs in Distance_Pelo with first quartile: 1211.63035979047
INFO [2025-03-29 13:06:58] Replaced NAs in Distance_C_Pelo with first quartile: 1234.81091928129
INFO [2025-03-29 13:06:58] Replaced NAs in Distance_F_Pelo with first quartile: 1239.65331180248
INFO [2025-03-29 13:06:58] Replaced NAs in Sprint_Pelo with first quartile: 1240.94751821383
INFO [2025-03-29 13:06:58] Replaced NAs in Sprint_C_Pelo with first quartile: 1241.28715500947
INFO [2025-03-29 13:06:58] Replaced NAs in Sprint_F_Pelo with first quartile: 1252.45166310493
INFO [2025-03-29 13:06:58] Replaced NAs in Classic_Pelo with first quartile: 1243.63746068082
INFO [2025-03-29 13:06:58] Replaced NAs in Freestyle_Pelo with first quartile: 1249.30280713791
INFO [2025-03-29 13:06:58] Replaced NAs in Classic_Last_5 with first quartile: 0
INFO [2025-03-29 13:06:58] Replaced NAs in Freestyle_Last_5 with first quartile: 0
INFO [2025-03-29 13:06:58] Created Pelo_Pct from Elo with max value: 1946.6211651574
INFO [2025-03-29 13:06:58] Created Distance_Pelo_Pct from Distance_Elo with max value: 1869.1251911742
INFO [2025-03-29 13:06:58] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1777.16297253153
INFO [2025-03-29 13:06:58] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1695.2053212904
INFO [2025-03-29 13:06:58] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1886.80363942481
INFO [2025-03-29 13:06:58] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1711.08486899169
INFO [2025-03-29 13:06:58] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1792.65157560707
INFO [2025-03-29 13:06:58] Created Classic_Pelo_Pct from Classic_Elo with max value: 1807.56773496777
INFO [2025-03-29 13:06:58] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1814.60460629541
INFO [2025-03-29 13:06:58] Prepared data for 381 men skiers with 33 features
INFO [2025-03-29 13:06:58] Using FIS startlist for men's leg predictions
INFO [2025-03-29 13:06:58] Using FIS startlist for men
INFO [2025-03-29 13:06:58] Attempting Option 1: Team model coefficients
INFO [2025-03-29 13:06:58] Option 1 failed: No team_podium model found
INFO [2025-03-29 13:06:58] Option 1 failed: No team model
INFO [2025-03-29 13:06:58] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 13:06:58] Leg 1 accuracy: 0.864858757062147
INFO [2025-03-29 13:06:58] Leg 2 accuracy: 0.844671731930645
INFO [2025-03-29 13:06:58] Leg 3 accuracy: 0.867212156633548
INFO [2025-03-29 13:06:58] Leg 4 accuracy: 0.881398792129359
INFO [2025-03-29 13:06:58] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 13:06:58] Leg importance weights: Leg 1: 0.25, Leg 2: 0.24, Leg 3: 0.25, Leg 4: 0.25
INFO [2025-03-29 13:06:58] Processing ladies's relay predictions
INFO [2025-03-29 13:06:58] Loaded ladies relay teams startlist with 35 rows
INFO [2025-03-29 13:06:58] Loaded ladies relay individuals startlist with 231 rows
INFO [2025-03-29 13:06:58] Preparing current ladies skier data
INFO [2025-03-29 13:06:58] Found 9 Elo columns for current skiers
INFO [2025-03-29 13:06:58] Replaced NAs in Distance_Elo with first quartile: 1237.38564383256
INFO [2025-03-29 13:06:58] Replaced NAs in Distance_C_Elo with first quartile: 1243.87329106944
INFO [2025-03-29 13:06:58] Replaced NAs in Distance_F_Elo with first quartile: 1256.69628195708
INFO [2025-03-29 13:06:58] Replaced NAs in Sprint_Elo with first quartile: 1246.32574824425
INFO [2025-03-29 13:06:58] Replaced NAs in Sprint_C_Elo with first quartile: 1257.67866787334
INFO [2025-03-29 13:06:58] Replaced NAs in Sprint_F_Elo with first quartile: 1244.84742904868
INFO [2025-03-29 13:06:58] Replaced NAs in Classic_Elo with first quartile: 1252.44868703669
INFO [2025-03-29 13:06:58] Replaced NAs in Freestyle_Elo with first quartile: 1244.44508230281
INFO [2025-03-29 13:06:58] Replaced NAs in Distance_Pelo with first quartile: 1241.11854419952
INFO [2025-03-29 13:06:58] Replaced NAs in Distance_C_Pelo with first quartile: 1245.57367555166
INFO [2025-03-29 13:06:58] Replaced NAs in Distance_F_Pelo with first quartile: 1259.54282973153
INFO [2025-03-29 13:06:58] Replaced NAs in Sprint_Pelo with first quartile: 1254.58885254623
INFO [2025-03-29 13:06:58] Replaced NAs in Sprint_C_Pelo with first quartile: 1257.58302026178
INFO [2025-03-29 13:06:58] Replaced NAs in Sprint_F_Pelo with first quartile: 1257.67755691493
INFO [2025-03-29 13:06:58] Replaced NAs in Classic_Pelo with first quartile: 1256.79275004544
INFO [2025-03-29 13:06:58] Replaced NAs in Freestyle_Pelo with first quartile: 1256.79999900008
INFO [2025-03-29 13:06:58] Replaced NAs in Classic_Last_5 with first quartile: 3.5
INFO [2025-03-29 13:06:58] Replaced NAs in Freestyle_Last_5 with first quartile: 2.4
INFO [2025-03-29 13:06:58] Created Pelo_Pct from Elo with max value: 1841.00191142018
INFO [2025-03-29 13:06:58] Created Distance_Pelo_Pct from Distance_Elo with max value: 1889.46974050597
INFO [2025-03-29 13:06:58] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1763.33572074398
INFO [2025-03-29 13:06:58] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1693.85026290322
INFO [2025-03-29 13:06:58] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1742.74758850835
INFO [2025-03-29 13:06:58] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1601.5820663103
INFO [2025-03-29 13:06:58] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1681.09824552997
INFO [2025-03-29 13:06:58] Created Classic_Pelo_Pct from Classic_Elo with max value: 1698.69428891549
INFO [2025-03-29 13:06:58] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1707.58410982918
INFO [2025-03-29 13:06:58] Prepared data for 255 ladies skiers with 33 features
INFO [2025-03-29 13:06:58] No FIS startlist, predicting for all skiers in all legs
INFO [2025-03-29 13:06:58] No valid FIS startlist for ladies, building optimized teams
INFO [2025-03-29 13:06:58] Attempting Option 1: Team model coefficients
INFO [2025-03-29 13:06:58] Option 1 failed: argument "leg_models" is missing, with no default
INFO [2025-03-29 13:06:58] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 13:06:58] Option 2 failed: argument "leg_models" is missing, with no default
INFO [2025-03-29 13:06:58] Using Option 3: Default leg importance weights
INFO [2025-03-29 13:06:58] Using leg importance weights for team optimization: Leg 1: 0.20, Leg 2: 0.20, Leg 3: 0.25, Leg 4: 0.35
INFO [2025-03-29 13:06:58] Optimizing team for Sweden
INFO [2025-03-29 13:06:58] Optimizing team for Norway
INFO [2025-03-29 13:06:58] Optimizing team for Germany
INFO [2025-03-29 13:06:58] Optimizing team for USA
INFO [2025-03-29 13:06:58] Optimizing team for Austria
INFO [2025-03-29 13:06:58] Optimizing team for Finland
INFO [2025-03-29 13:06:59] Optimizing team for Czechia
INFO [2025-03-29 13:06:59] Optimizing team for Switzerland
INFO [2025-03-29 13:06:59] Optimizing team for Italy
INFO [2025-03-29 13:06:59] Optimizing team for France
INFO [2025-03-29 13:06:59] Optimizing team for Canada
INFO [2025-03-29 13:06:59] Optimizing team for Slovenia
INFO [2025-03-29 13:06:59] Optimizing team for Estonia
INFO [2025-03-29 13:06:59] Optimizing team for Australia
INFO [2025-03-29 13:06:59] Optimizing team for Ukraine
INFO [2025-03-29 13:06:59] Optimizing team for Kazakhstan
INFO [2025-03-29 13:06:59] Optimizing team for Armenia
INFO [2025-03-29 13:06:59] Optimizing team for Latvia
INFO [2025-03-29 13:06:59] Optimizing team for Japan
INFO [2025-03-29 13:06:59] Optimizing team for Poland
INFO [2025-03-29 13:06:59] Optimizing team for South Korea
INFO [2025-03-29 13:06:59] Optimizing team for Andorra
INFO [2025-03-29 13:06:59] Optimizing team for Taiwan
INFO [2025-03-29 13:06:59] Optimizing team for China
INFO [2025-03-29 13:06:59] Optimizing team for Croatia
INFO [2025-03-29 13:06:59] Optimizing team for Slovakia
INFO [2025-03-29 13:06:59] Optimizing team for Argentina
INFO [2025-03-29 13:06:59] Optimizing team for Mongolia
INFO [2025-03-29 13:06:59] Optimizing team for Brazil
INFO [2025-03-29 13:06:59] Optimizing team for Lithuania
INFO [2025-03-29 13:06:59] Optimizing team for Greece
INFO [2025-03-29 13:06:59] Optimizing team for Iceland
INFO [2025-03-29 13:06:59] Optimizing team for Bulgaria
INFO [2025-03-29 13:06:59] Optimizing team for Serbia
INFO [2025-03-29 13:06:59] Optimizing team for Hungary
INFO [2025-03-29 13:06:59] Optimizing team for Turkey
INFO [2025-03-29 13:06:59] Optimizing team for North Macedonia
INFO [2025-03-29 13:06:59] Optimizing team for Romania
INFO [2025-03-29 13:06:59] Optimizing team for Bosnia&Herzegovina
INFO [2025-03-29 13:06:59] Optimizing team for Mexico
INFO [2025-03-29 13:06:59] Optimizing team for Iran
INFO [2025-03-29 13:06:59] Optimizing team for Chile
INFO [2025-03-29 13:06:59] Optimizing team for India
INFO [2025-03-29 13:06:59] Optimizing team for Malaysia
INFO [2025-03-29 13:06:59] Optimizing team for Haiti
INFO [2025-03-29 13:06:59] Optimizing team for Lebanon
INFO [2025-03-29 13:06:59] Optimizing team for Liechtenstein
WARN [2025-03-29 13:06:59] Could not read individuals file: invalid 'description' argument
WARN [2025-03-29 13:06:59] Could not read teams file: invalid 'description' argument
INFO [2025-03-29 13:06:59] Resetting men's probabilities at or below the mode to zero
INFO [2025-03-29 13:06:59] No values appear more than twice for Win_Prob
INFO [2025-03-29 13:06:59] No values appear more than twice for Podium_Prob
INFO [2025-03-29 13:06:59] No values appear more than twice for Top5_Prob
INFO [2025-03-29 13:06:59] No values appear more than twice for Top10_Prob
INFO [2025-03-29 13:06:59] Resetting ladies' probabilities at or below the mode to zero
INFO [2025-03-29 13:06:59] Reset 20 values to 0 for Win_Prob (repeated values or values <  0 )
INFO [2025-03-29 13:06:59] Repeated values: 0, 0, 0, 0, 0
INFO [2025-03-29 13:06:59] No values appear more than twice for Podium_Prob
INFO [2025-03-29 13:06:59] No values appear more than twice for Top5_Prob
INFO [2025-03-29 13:06:59] No values appear more than twice for Top10_Prob
INFO [2025-03-29 13:06:59] Normalizing men's team probabilities
INFO [2025-03-29 13:06:59] Normalized Win_Prob from sum of 0.71 to 1
INFO [2025-03-29 13:06:59] Normalized Podium_Prob from sum of 2.34 to 3
INFO [2025-03-29 13:06:59] Normalized Top5_Prob from sum of 4.2 to 5
INFO [2025-03-29 13:06:59] Normalized Top10_Prob from sum of 10.33 to 10
INFO [2025-03-29 13:06:59] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 13:06:59] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 13:06:59] Normalizing ladies' team probabilities
INFO [2025-03-29 13:06:59] Normalized Win_Prob from sum of 2.19 to 1
INFO [2025-03-29 13:06:59] Normalized Podium_Prob from sum of 4.41 to 3
INFO [2025-03-29 13:06:59] Normalized Top5_Prob from sum of 4.73 to 5
INFO [2025-03-29 13:06:59] Normalized Top10_Prob from sum of 13.19 to 10
INFO [2025-03-29 13:06:59] Final capping of probabilities to maximum of 1
INFO [2025-03-29 13:06:59] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 13:06:59] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 13:06:59] Optimizing fantasy relay team
INFO [2025-03-29 13:07:00] Fantasy team optimization complete. Selected 6 teams.
INFO [2025-03-29 13:07:00] Total price: 92546 of max 1e+05
INFO [2025-03-29 13:07:00] Expected total points: 542.8
INFO [2025-03-29 13:07:00] Men's teams: 6 ( 6 )
INFO [2025-03-29 13:07:00] Ladies' teams: 0 ( 0 )
INFO [2025-03-29 13:07:00] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_points.xlsx
INFO [2025-03-29 13:07:00] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_probabilities.xlsx
INFO [2025-03-29 13:07:00] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_points.xlsx
INFO [2025-03-29 13:07:00] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_probabilities.xlsx
INFO [2025-03-29 13:07:00] Saved fantasy team results to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/fantasy_relay_team.xlsx
INFO [2025-03-29 13:07:00] Relay predictions completed successfully
INFO [2025-03-29 13:07:37] Starting relay predictions process
INFO [2025-03-29 13:07:37] Loading weekend race data
INFO [2025-03-29 13:07:37] Tomorrow's date: 2025-03-29
INFO [2025-03-29 13:07:37] Found 1 men's relay races and 1 ladies' relay races
INFO [2025-03-29 13:07:37] Loading chrono data
INFO [2025-03-29 13:07:43] Loaded men's chrono with 105122 rows and 36 columns
INFO [2025-03-29 13:07:43] Loaded ladies' chrono with 78706 rows and 36 columns
INFO [2025-03-29 13:07:43] Created men's relay df with 9688 rows
INFO [2025-03-29 13:07:43] Created men's individual df with 92143 rows
INFO [2025-03-29 13:07:43] Created ladies' relay df with 8019 rows
INFO [2025-03-29 13:07:43] Created ladies' individual df with 68253 rows
INFO [2025-03-29 13:07:48] Training models for Leg 1
INFO [2025-03-29 13:07:48] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:07:48] Training podium model using glm
INFO [2025-03-29 13:07:48] Training win model using glm
INFO [2025-03-29 13:07:48] Training top5 model using glm
INFO [2025-03-29 13:07:48] Training top10 model using glm
INFO [2025-03-29 13:07:49] Top features for Leg 1 podium prediction:
INFO [2025-03-29 13:07:49] Training models for Leg 2
INFO [2025-03-29 13:07:49] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:07:49] Training podium model using glm
INFO [2025-03-29 13:07:49] Training win model using glm
INFO [2025-03-29 13:07:49] Training top5 model using glm
INFO [2025-03-29 13:07:49] Training top10 model using glm
INFO [2025-03-29 13:07:49] Top features for Leg 2 podium prediction:
INFO [2025-03-29 13:07:49] Training models for Leg 3
INFO [2025-03-29 13:07:49] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:07:49] Training podium model using glm
INFO [2025-03-29 13:07:49] Training win model using glm
INFO [2025-03-29 13:07:49] Training top5 model using glm
INFO [2025-03-29 13:07:49] Training top10 model using glm
INFO [2025-03-29 13:07:49] Top features for Leg 3 podium prediction:
INFO [2025-03-29 13:07:49] Training models for Leg 4
INFO [2025-03-29 13:07:49] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:07:49] Training podium model using glm
INFO [2025-03-29 13:07:49] Training win model using glm
INFO [2025-03-29 13:07:49] Training top5 model using glm
INFO [2025-03-29 13:07:50] Training top10 model using glm
INFO [2025-03-29 13:07:50] Top features for Leg 4 podium prediction:
INFO [2025-03-29 13:07:50] Training models for Leg 1
INFO [2025-03-29 13:07:50] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:07:50] Training podium model using glm
INFO [2025-03-29 13:07:50] Training win model using glm
INFO [2025-03-29 13:07:50] Training top5 model using glm
INFO [2025-03-29 13:07:50] Training top10 model using glm
INFO [2025-03-29 13:07:50] Top features for Leg 1 podium prediction:
INFO [2025-03-29 13:07:50] Training models for Leg 2
INFO [2025-03-29 13:07:50] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:07:50] Training podium model using glm
INFO [2025-03-29 13:07:50] Training win model using glm
INFO [2025-03-29 13:07:50] Training top5 model using glm
INFO [2025-03-29 13:07:50] Training top10 model using glm
INFO [2025-03-29 13:07:51] Top features for Leg 2 podium prediction:
INFO [2025-03-29 13:07:51] Training models for Leg 3
INFO [2025-03-29 13:07:51] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:07:51] Training podium model using glm
INFO [2025-03-29 13:07:51] Training win model using glm
INFO [2025-03-29 13:07:51] Training top5 model using glm
INFO [2025-03-29 13:07:51] Training top10 model using glm
INFO [2025-03-29 13:07:51] Top features for Leg 3 podium prediction:
INFO [2025-03-29 13:07:51] Training models for Leg 4
INFO [2025-03-29 13:07:51] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:07:51] Training podium model using glm
INFO [2025-03-29 13:07:51] Training win model using glm
INFO [2025-03-29 13:07:51] Training top5 model using glm
INFO [2025-03-29 13:07:51] Training top10 model using glm
INFO [2025-03-29 13:07:51] Top features for Leg 4 podium prediction:
INFO [2025-03-29 13:07:51] Processing men's relay predictions
INFO [2025-03-29 13:07:51] Loaded men relay teams startlist with 24 rows
INFO [2025-03-29 13:07:51] Loaded men relay individuals startlist with 96 rows
INFO [2025-03-29 13:07:51] Preparing current men skier data
INFO [2025-03-29 13:07:51] Found 9 Elo columns for current skiers
INFO [2025-03-29 13:07:51] Replaced NAs in Distance_Elo with first quartile: 1207.23243912712
INFO [2025-03-29 13:07:51] Replaced NAs in Distance_C_Elo with first quartile: 1233.40200699225
INFO [2025-03-29 13:07:51] Replaced NAs in Distance_F_Elo with first quartile: 1236.48554062178
INFO [2025-03-29 13:07:51] Replaced NAs in Sprint_Elo with first quartile: 1223.60107000698
INFO [2025-03-29 13:07:51] Replaced NAs in Sprint_C_Elo with first quartile: 1241.28715500947
INFO [2025-03-29 13:07:51] Replaced NAs in Sprint_F_Elo with first quartile: 1234.45151108772
INFO [2025-03-29 13:07:51] Replaced NAs in Classic_Elo with first quartile: 1241.52867310024
INFO [2025-03-29 13:07:51] Replaced NAs in Freestyle_Elo with first quartile: 1228.48649348109
INFO [2025-03-29 13:07:51] Replaced NAs in Distance_Pelo with first quartile: 1211.63035979047
INFO [2025-03-29 13:07:51] Replaced NAs in Distance_C_Pelo with first quartile: 1234.81091928129
INFO [2025-03-29 13:07:51] Replaced NAs in Distance_F_Pelo with first quartile: 1239.65331180248
INFO [2025-03-29 13:07:51] Replaced NAs in Sprint_Pelo with first quartile: 1240.94751821383
INFO [2025-03-29 13:07:51] Replaced NAs in Sprint_C_Pelo with first quartile: 1241.28715500947
INFO [2025-03-29 13:07:51] Replaced NAs in Sprint_F_Pelo with first quartile: 1252.45166310493
INFO [2025-03-29 13:07:51] Replaced NAs in Classic_Pelo with first quartile: 1243.63746068082
INFO [2025-03-29 13:07:51] Replaced NAs in Freestyle_Pelo with first quartile: 1249.30280713791
INFO [2025-03-29 13:07:51] Replaced NAs in Classic_Last_5 with first quartile: 0
INFO [2025-03-29 13:07:51] Replaced NAs in Freestyle_Last_5 with first quartile: 0
INFO [2025-03-29 13:07:51] Created Pelo_Pct from Elo with max value: 1946.6211651574
INFO [2025-03-29 13:07:51] Created Distance_Pelo_Pct from Distance_Elo with max value: 1869.1251911742
INFO [2025-03-29 13:07:51] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1777.16297253153
INFO [2025-03-29 13:07:51] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1695.2053212904
INFO [2025-03-29 13:07:51] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1886.80363942481
INFO [2025-03-29 13:07:51] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1711.08486899169
INFO [2025-03-29 13:07:51] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1792.65157560707
INFO [2025-03-29 13:07:51] Created Classic_Pelo_Pct from Classic_Elo with max value: 1807.56773496777
INFO [2025-03-29 13:07:51] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1814.60460629541
INFO [2025-03-29 13:07:51] Prepared data for 381 men skiers with 33 features
INFO [2025-03-29 13:07:52] Using FIS startlist for men's leg predictions
INFO [2025-03-29 13:07:52] Using FIS startlist for men
INFO [2025-03-29 13:07:52] Attempting Option 1: Team model coefficients
INFO [2025-03-29 13:07:52] Option 1 failed: No team_podium model found
INFO [2025-03-29 13:07:52] Option 1 failed: No team model
INFO [2025-03-29 13:07:52] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 13:07:52] Leg 1 accuracy: 0.858291447496591
INFO [2025-03-29 13:07:52] Leg 2 accuracy: 0.834387297876485
INFO [2025-03-29 13:07:52] Leg 3 accuracy: 0.860596142606663
INFO [2025-03-29 13:07:52] Leg 4 accuracy: 0.88162867718683
INFO [2025-03-29 13:07:52] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 13:07:52] Leg importance weights: Leg 1: 0.25, Leg 2: 0.24, Leg 3: 0.25, Leg 4: 0.26
INFO [2025-03-29 13:07:52] Processing ladies's relay predictions
INFO [2025-03-29 13:07:52] Loaded ladies relay teams startlist with 35 rows
INFO [2025-03-29 13:07:52] Loaded ladies relay individuals startlist with 231 rows
INFO [2025-03-29 13:07:52] Preparing current ladies skier data
INFO [2025-03-29 13:07:52] Found 9 Elo columns for current skiers
INFO [2025-03-29 13:07:52] Replaced NAs in Distance_Elo with first quartile: 1237.38564383256
INFO [2025-03-29 13:07:52] Replaced NAs in Distance_C_Elo with first quartile: 1243.87329106944
INFO [2025-03-29 13:07:52] Replaced NAs in Distance_F_Elo with first quartile: 1256.69628195708
INFO [2025-03-29 13:07:52] Replaced NAs in Sprint_Elo with first quartile: 1246.32574824425
INFO [2025-03-29 13:07:52] Replaced NAs in Sprint_C_Elo with first quartile: 1257.67866787334
INFO [2025-03-29 13:07:52] Replaced NAs in Sprint_F_Elo with first quartile: 1244.84742904868
INFO [2025-03-29 13:07:52] Replaced NAs in Classic_Elo with first quartile: 1252.44868703669
INFO [2025-03-29 13:07:52] Replaced NAs in Freestyle_Elo with first quartile: 1244.44508230281
INFO [2025-03-29 13:07:52] Replaced NAs in Distance_Pelo with first quartile: 1241.11854419952
INFO [2025-03-29 13:07:52] Replaced NAs in Distance_C_Pelo with first quartile: 1245.57367555166
INFO [2025-03-29 13:07:52] Replaced NAs in Distance_F_Pelo with first quartile: 1259.54282973153
INFO [2025-03-29 13:07:52] Replaced NAs in Sprint_Pelo with first quartile: 1254.58885254623
INFO [2025-03-29 13:07:52] Replaced NAs in Sprint_C_Pelo with first quartile: 1257.58302026178
INFO [2025-03-29 13:07:52] Replaced NAs in Sprint_F_Pelo with first quartile: 1257.67755691493
INFO [2025-03-29 13:07:52] Replaced NAs in Classic_Pelo with first quartile: 1256.79275004544
INFO [2025-03-29 13:07:52] Replaced NAs in Freestyle_Pelo with first quartile: 1256.79999900008
INFO [2025-03-29 13:07:52] Replaced NAs in Classic_Last_5 with first quartile: 3.5
INFO [2025-03-29 13:07:52] Replaced NAs in Freestyle_Last_5 with first quartile: 2.4
INFO [2025-03-29 13:07:52] Created Pelo_Pct from Elo with max value: 1841.00191142018
INFO [2025-03-29 13:07:52] Created Distance_Pelo_Pct from Distance_Elo with max value: 1889.46974050597
INFO [2025-03-29 13:07:52] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1763.33572074398
INFO [2025-03-29 13:07:52] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1693.85026290322
INFO [2025-03-29 13:07:52] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1742.74758850835
INFO [2025-03-29 13:07:52] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1601.5820663103
INFO [2025-03-29 13:07:52] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1681.09824552997
INFO [2025-03-29 13:07:52] Created Classic_Pelo_Pct from Classic_Elo with max value: 1698.69428891549
INFO [2025-03-29 13:07:52] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1707.58410982918
INFO [2025-03-29 13:07:52] Prepared data for 255 ladies skiers with 33 features
INFO [2025-03-29 13:07:52] No FIS startlist, predicting for all skiers in all legs
INFO [2025-03-29 13:07:52] No valid FIS startlist for ladies, building optimized teams
INFO [2025-03-29 13:07:52] Attempting Option 1: Team model coefficients
INFO [2025-03-29 13:07:52] Option 1 failed: argument "leg_models" is missing, with no default
INFO [2025-03-29 13:07:52] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 13:07:52] Option 2 failed: argument "leg_models" is missing, with no default
INFO [2025-03-29 13:07:52] Using Option 3: Default leg importance weights
INFO [2025-03-29 13:07:52] Using leg importance weights for team optimization: Leg 1: 0.20, Leg 2: 0.20, Leg 3: 0.25, Leg 4: 0.35
INFO [2025-03-29 13:07:52] Optimizing team for Sweden
INFO [2025-03-29 13:07:52] Optimizing team for Norway
INFO [2025-03-29 13:07:52] Optimizing team for Germany
INFO [2025-03-29 13:07:52] Optimizing team for USA
INFO [2025-03-29 13:07:52] Optimizing team for Austria
INFO [2025-03-29 13:07:52] Optimizing team for Finland
INFO [2025-03-29 13:07:52] Optimizing team for Czechia
INFO [2025-03-29 13:07:52] Optimizing team for Switzerland
INFO [2025-03-29 13:07:53] Optimizing team for Italy
INFO [2025-03-29 13:07:53] Optimizing team for France
INFO [2025-03-29 13:07:53] Optimizing team for Canada
INFO [2025-03-29 13:07:53] Optimizing team for Slovenia
INFO [2025-03-29 13:07:53] Optimizing team for Estonia
INFO [2025-03-29 13:07:53] Optimizing team for Australia
INFO [2025-03-29 13:07:53] Optimizing team for Ukraine
INFO [2025-03-29 13:07:53] Optimizing team for Kazakhstan
INFO [2025-03-29 13:07:53] Optimizing team for Armenia
INFO [2025-03-29 13:07:53] Optimizing team for Latvia
INFO [2025-03-29 13:07:53] Optimizing team for Japan
INFO [2025-03-29 13:07:53] Optimizing team for Poland
INFO [2025-03-29 13:07:53] Optimizing team for South Korea
INFO [2025-03-29 13:07:53] Optimizing team for Andorra
INFO [2025-03-29 13:07:53] Optimizing team for Taiwan
INFO [2025-03-29 13:07:53] Optimizing team for China
INFO [2025-03-29 13:07:53] Optimizing team for Croatia
INFO [2025-03-29 13:07:53] Optimizing team for Slovakia
INFO [2025-03-29 13:07:53] Optimizing team for Argentina
INFO [2025-03-29 13:07:53] Optimizing team for Mongolia
INFO [2025-03-29 13:07:53] Optimizing team for Brazil
INFO [2025-03-29 13:07:53] Optimizing team for Lithuania
INFO [2025-03-29 13:07:53] Optimizing team for Greece
INFO [2025-03-29 13:07:53] Optimizing team for Iceland
INFO [2025-03-29 13:07:53] Optimizing team for Bulgaria
INFO [2025-03-29 13:07:53] Optimizing team for Serbia
INFO [2025-03-29 13:07:53] Optimizing team for Hungary
INFO [2025-03-29 13:07:53] Optimizing team for Turkey
INFO [2025-03-29 13:07:53] Optimizing team for North Macedonia
INFO [2025-03-29 13:07:53] Optimizing team for Romania
INFO [2025-03-29 13:07:53] Optimizing team for Bosnia&Herzegovina
INFO [2025-03-29 13:07:53] Optimizing team for Mexico
INFO [2025-03-29 13:07:53] Optimizing team for Iran
INFO [2025-03-29 13:07:53] Optimizing team for Chile
INFO [2025-03-29 13:07:53] Optimizing team for India
INFO [2025-03-29 13:07:53] Optimizing team for Malaysia
INFO [2025-03-29 13:07:53] Optimizing team for Haiti
INFO [2025-03-29 13:07:53] Optimizing team for Lebanon
INFO [2025-03-29 13:07:53] Optimizing team for Liechtenstein
WARN [2025-03-29 13:07:53] Could not read individuals file: invalid 'description' argument
WARN [2025-03-29 13:07:53] Could not read teams file: invalid 'description' argument
INFO [2025-03-29 13:07:53] Resetting men's probabilities at or below the mode to zero
INFO [2025-03-29 13:07:53] No values appear more than twice for Win_Prob
INFO [2025-03-29 13:07:53] No values appear more than twice for Podium_Prob
INFO [2025-03-29 13:07:53] No values appear more than twice for Top5_Prob
INFO [2025-03-29 13:07:53] No values appear more than twice for Top10_Prob
INFO [2025-03-29 13:07:53] Resetting ladies' probabilities at or below the mode to zero
INFO [2025-03-29 13:07:53] Reset 20 values to 0 for Win_Prob (repeated values or values <  0 )
INFO [2025-03-29 13:07:53] Repeated values: 0, 0, 0, 0, 0
INFO [2025-03-29 13:07:53] No values appear more than twice for Podium_Prob
INFO [2025-03-29 13:07:53] No values appear more than twice for Top5_Prob
INFO [2025-03-29 13:07:53] No values appear more than twice for Top10_Prob
INFO [2025-03-29 13:07:53] Normalizing men's team probabilities
INFO [2025-03-29 13:07:53] Normalized Win_Prob from sum of 0.71 to 1
INFO [2025-03-29 13:07:53] Normalized Podium_Prob from sum of 2.34 to 3
INFO [2025-03-29 13:07:53] Normalized Top5_Prob from sum of 4.2 to 5
INFO [2025-03-29 13:07:53] Normalized Top10_Prob from sum of 10.33 to 10
INFO [2025-03-29 13:07:53] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 13:07:53] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 13:07:53] Normalizing ladies' team probabilities
INFO [2025-03-29 13:07:53] Normalized Win_Prob from sum of 2.19 to 1
INFO [2025-03-29 13:07:53] Normalized Podium_Prob from sum of 4.41 to 3
INFO [2025-03-29 13:07:53] Normalized Top5_Prob from sum of 4.73 to 5
INFO [2025-03-29 13:07:53] Normalized Top10_Prob from sum of 13.19 to 10
INFO [2025-03-29 13:07:53] Final capping of probabilities to maximum of 1
INFO [2025-03-29 13:07:53] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 13:07:53] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 13:07:53] Optimizing fantasy relay team
INFO [2025-03-29 13:07:54] Fantasy team optimization complete. Selected 6 teams.
INFO [2025-03-29 13:07:54] Total price: 92546 of max 1e+05
INFO [2025-03-29 13:07:54] Expected total points: 542.8
INFO [2025-03-29 13:07:54] Men's teams: 6 ( 6 )
INFO [2025-03-29 13:07:54] Ladies' teams: 0 ( 0 )
INFO [2025-03-29 13:07:54] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_points.xlsx
INFO [2025-03-29 13:07:54] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_probabilities.xlsx
INFO [2025-03-29 13:07:54] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_points.xlsx
INFO [2025-03-29 13:07:54] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_probabilities.xlsx
INFO [2025-03-29 13:07:54] Saved fantasy team results to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/fantasy_relay_team.xlsx
INFO [2025-03-29 13:07:54] Relay predictions completed successfully
INFO [2025-03-29 13:08:57] Starting relay predictions process
INFO [2025-03-29 13:08:57] Loading weekend race data
INFO [2025-03-29 13:08:57] Tomorrow's date: 2025-03-29
INFO [2025-03-29 13:08:57] Found 1 men's relay races and 1 ladies' relay races
INFO [2025-03-29 13:08:57] Loading chrono data
INFO [2025-03-29 13:09:02] Loaded men's chrono with 105122 rows and 36 columns
INFO [2025-03-29 13:09:02] Loaded ladies' chrono with 78706 rows and 36 columns
INFO [2025-03-29 13:09:02] Created men's relay df with 9688 rows
INFO [2025-03-29 13:09:02] Created men's individual df with 92143 rows
INFO [2025-03-29 13:09:02] Created ladies' relay df with 8019 rows
INFO [2025-03-29 13:09:02] Created ladies' individual df with 68253 rows
INFO [2025-03-29 13:09:07] Training models for Leg 1
INFO [2025-03-29 13:09:07] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:09:07] Training podium model using glm
INFO [2025-03-29 13:09:07] Training win model using glm
INFO [2025-03-29 13:09:07] Training top5 model using glm
INFO [2025-03-29 13:09:08] Training top10 model using glm
INFO [2025-03-29 13:09:08] Top features for Leg 1 podium prediction:
INFO [2025-03-29 13:09:08] Training models for Leg 2
INFO [2025-03-29 13:09:08] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:09:08] Training podium model using glm
INFO [2025-03-29 13:09:08] Training win model using glm
INFO [2025-03-29 13:09:08] Training top5 model using glm
INFO [2025-03-29 13:09:08] Training top10 model using glm
INFO [2025-03-29 13:09:08] Top features for Leg 2 podium prediction:
INFO [2025-03-29 13:09:08] Training models for Leg 3
INFO [2025-03-29 13:09:08] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:09:08] Training podium model using glm
INFO [2025-03-29 13:09:08] Training win model using glm
INFO [2025-03-29 13:09:08] Training top5 model using glm
INFO [2025-03-29 13:09:08] Training top10 model using glm
INFO [2025-03-29 13:09:08] Top features for Leg 3 podium prediction:
INFO [2025-03-29 13:09:08] Training models for Leg 4
INFO [2025-03-29 13:09:08] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:09:08] Training podium model using glm
INFO [2025-03-29 13:09:08] Training win model using glm
INFO [2025-03-29 13:09:09] Training top5 model using glm
INFO [2025-03-29 13:09:09] Training top10 model using glm
INFO [2025-03-29 13:09:09] Top features for Leg 4 podium prediction:
INFO [2025-03-29 13:09:09] Training models for Leg 1
INFO [2025-03-29 13:09:09] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:09:09] Training podium model using glm
INFO [2025-03-29 13:09:09] Training win model using glm
INFO [2025-03-29 13:09:09] Training top5 model using glm
INFO [2025-03-29 13:09:09] Training top10 model using glm
INFO [2025-03-29 13:09:09] Top features for Leg 1 podium prediction:
INFO [2025-03-29 13:09:09] Training models for Leg 2
INFO [2025-03-29 13:09:09] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:09:09] Training podium model using glm
INFO [2025-03-29 13:09:09] Training win model using glm
INFO [2025-03-29 13:09:09] Training top5 model using glm
INFO [2025-03-29 13:09:09] Training top10 model using glm
INFO [2025-03-29 13:09:09] Top features for Leg 2 podium prediction:
INFO [2025-03-29 13:09:09] Training models for Leg 3
INFO [2025-03-29 13:09:09] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:09:09] Training podium model using glm
INFO [2025-03-29 13:09:09] Training win model using glm
INFO [2025-03-29 13:09:10] Training top5 model using glm
INFO [2025-03-29 13:09:10] Training top10 model using glm
INFO [2025-03-29 13:09:10] Top features for Leg 3 podium prediction:
INFO [2025-03-29 13:09:10] Training models for Leg 4
INFO [2025-03-29 13:09:10] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:09:10] Training podium model using glm
INFO [2025-03-29 13:09:10] Training win model using glm
INFO [2025-03-29 13:09:10] Training top5 model using glm
INFO [2025-03-29 13:09:10] Training top10 model using glm
INFO [2025-03-29 13:09:10] Top features for Leg 4 podium prediction:
INFO [2025-03-29 13:09:10] Processing men's relay predictions
INFO [2025-03-29 13:09:10] Loaded men relay teams startlist with 24 rows
INFO [2025-03-29 13:09:10] Loaded men relay individuals startlist with 96 rows
INFO [2025-03-29 13:09:10] Preparing current men skier data
INFO [2025-03-29 13:09:10] Found 9 Elo columns for current skiers
INFO [2025-03-29 13:09:10] Replaced NAs in Distance_Elo with first quartile: 1207.23243912712
INFO [2025-03-29 13:09:10] Replaced NAs in Distance_C_Elo with first quartile: 1233.40200699225
INFO [2025-03-29 13:09:10] Replaced NAs in Distance_F_Elo with first quartile: 1236.48554062178
INFO [2025-03-29 13:09:10] Replaced NAs in Sprint_Elo with first quartile: 1223.60107000698
INFO [2025-03-29 13:09:10] Replaced NAs in Sprint_C_Elo with first quartile: 1241.28715500947
INFO [2025-03-29 13:09:10] Replaced NAs in Sprint_F_Elo with first quartile: 1234.45151108772
INFO [2025-03-29 13:09:10] Replaced NAs in Classic_Elo with first quartile: 1241.52867310024
INFO [2025-03-29 13:09:10] Replaced NAs in Freestyle_Elo with first quartile: 1228.48649348109
INFO [2025-03-29 13:09:10] Replaced NAs in Distance_Pelo with first quartile: 1211.63035979047
INFO [2025-03-29 13:09:10] Replaced NAs in Distance_C_Pelo with first quartile: 1234.81091928129
INFO [2025-03-29 13:09:10] Replaced NAs in Distance_F_Pelo with first quartile: 1239.65331180248
INFO [2025-03-29 13:09:10] Replaced NAs in Sprint_Pelo with first quartile: 1240.94751821383
INFO [2025-03-29 13:09:10] Replaced NAs in Sprint_C_Pelo with first quartile: 1241.28715500947
INFO [2025-03-29 13:09:10] Replaced NAs in Sprint_F_Pelo with first quartile: 1252.45166310493
INFO [2025-03-29 13:09:10] Replaced NAs in Classic_Pelo with first quartile: 1243.63746068082
INFO [2025-03-29 13:09:10] Replaced NAs in Freestyle_Pelo with first quartile: 1249.30280713791
INFO [2025-03-29 13:09:10] Replaced NAs in Classic_Last_5 with first quartile: 0
INFO [2025-03-29 13:09:10] Replaced NAs in Freestyle_Last_5 with first quartile: 0
INFO [2025-03-29 13:09:10] Created Pelo_Pct from Elo with max value: 1946.6211651574
INFO [2025-03-29 13:09:10] Created Distance_Pelo_Pct from Distance_Elo with max value: 1869.1251911742
INFO [2025-03-29 13:09:10] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1777.16297253153
INFO [2025-03-29 13:09:10] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1695.2053212904
INFO [2025-03-29 13:09:10] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1886.80363942481
INFO [2025-03-29 13:09:10] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1711.08486899169
INFO [2025-03-29 13:09:10] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1792.65157560707
INFO [2025-03-29 13:09:10] Created Classic_Pelo_Pct from Classic_Elo with max value: 1807.56773496777
INFO [2025-03-29 13:09:10] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1814.60460629541
INFO [2025-03-29 13:09:10] Prepared data for 381 men skiers with 33 features
INFO [2025-03-29 13:09:10] Using FIS startlist for men's leg predictions
INFO [2025-03-29 13:09:10] Using FIS startlist for men
INFO [2025-03-29 13:09:10] Attempting Option 1: Team model coefficients
INFO [2025-03-29 13:09:10] Option 1 failed: No team_podium model found
INFO [2025-03-29 13:09:10] Option 1 failed: No team model
INFO [2025-03-29 13:09:10] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 13:09:10] Leg 1 accuracy: 0.861412429378531
INFO [2025-03-29 13:09:10] Leg 2 accuracy: 0.844441846873174
INFO [2025-03-29 13:09:10] Leg 3 accuracy: 0.860070134424313
INFO [2025-03-29 13:09:10] Leg 4 accuracy: 0.887821936489382
INFO [2025-03-29 13:09:10] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 13:09:10] Leg importance weights: Leg 1: 0.25, Leg 2: 0.24, Leg 3: 0.25, Leg 4: 0.26
INFO [2025-03-29 13:09:11] Processing ladies's relay predictions
INFO [2025-03-29 13:09:11] Loaded ladies relay teams startlist with 35 rows
INFO [2025-03-29 13:09:11] Loaded ladies relay individuals startlist with 231 rows
INFO [2025-03-29 13:09:11] Preparing current ladies skier data
INFO [2025-03-29 13:09:11] Found 9 Elo columns for current skiers
INFO [2025-03-29 13:09:11] Replaced NAs in Distance_Elo with first quartile: 1237.38564383256
INFO [2025-03-29 13:09:11] Replaced NAs in Distance_C_Elo with first quartile: 1243.87329106944
INFO [2025-03-29 13:09:11] Replaced NAs in Distance_F_Elo with first quartile: 1256.69628195708
INFO [2025-03-29 13:09:11] Replaced NAs in Sprint_Elo with first quartile: 1246.32574824425
INFO [2025-03-29 13:09:11] Replaced NAs in Sprint_C_Elo with first quartile: 1257.67866787334
INFO [2025-03-29 13:09:11] Replaced NAs in Sprint_F_Elo with first quartile: 1244.84742904868
INFO [2025-03-29 13:09:11] Replaced NAs in Classic_Elo with first quartile: 1252.44868703669
INFO [2025-03-29 13:09:11] Replaced NAs in Freestyle_Elo with first quartile: 1244.44508230281
INFO [2025-03-29 13:09:11] Replaced NAs in Distance_Pelo with first quartile: 1241.11854419952
INFO [2025-03-29 13:09:11] Replaced NAs in Distance_C_Pelo with first quartile: 1245.57367555166
INFO [2025-03-29 13:09:11] Replaced NAs in Distance_F_Pelo with first quartile: 1259.54282973153
INFO [2025-03-29 13:09:11] Replaced NAs in Sprint_Pelo with first quartile: 1254.58885254623
INFO [2025-03-29 13:09:11] Replaced NAs in Sprint_C_Pelo with first quartile: 1257.58302026178
INFO [2025-03-29 13:09:11] Replaced NAs in Sprint_F_Pelo with first quartile: 1257.67755691493
INFO [2025-03-29 13:09:11] Replaced NAs in Classic_Pelo with first quartile: 1256.79275004544
INFO [2025-03-29 13:09:11] Replaced NAs in Freestyle_Pelo with first quartile: 1256.79999900008
INFO [2025-03-29 13:09:11] Replaced NAs in Classic_Last_5 with first quartile: 3.5
INFO [2025-03-29 13:09:11] Replaced NAs in Freestyle_Last_5 with first quartile: 2.4
INFO [2025-03-29 13:09:11] Created Pelo_Pct from Elo with max value: 1841.00191142018
INFO [2025-03-29 13:09:11] Created Distance_Pelo_Pct from Distance_Elo with max value: 1889.46974050597
INFO [2025-03-29 13:09:11] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1763.33572074398
INFO [2025-03-29 13:09:11] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1693.85026290322
INFO [2025-03-29 13:09:11] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1742.74758850835
INFO [2025-03-29 13:09:11] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1601.5820663103
INFO [2025-03-29 13:09:11] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1681.09824552997
INFO [2025-03-29 13:09:11] Created Classic_Pelo_Pct from Classic_Elo with max value: 1698.69428891549
INFO [2025-03-29 13:09:11] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1707.58410982918
INFO [2025-03-29 13:09:11] Prepared data for 255 ladies skiers with 33 features
INFO [2025-03-29 13:09:11] No FIS startlist, predicting for all skiers in all legs
INFO [2025-03-29 13:09:11] No valid FIS startlist for ladies, building optimized teams
INFO [2025-03-29 13:09:11] Attempting Option 1: Team model coefficients
INFO [2025-03-29 13:09:11] Option 1 failed: argument "leg_models" is missing, with no default
INFO [2025-03-29 13:09:11] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 13:09:11] Option 2 failed: argument "leg_models" is missing, with no default
INFO [2025-03-29 13:09:11] Using Option 3: Default leg importance weights
INFO [2025-03-29 13:09:11] Using leg importance weights for team optimization: Leg 1: 0.20, Leg 2: 0.20, Leg 3: 0.25, Leg 4: 0.35
INFO [2025-03-29 13:09:11] Optimizing team for Sweden
INFO [2025-03-29 13:09:11] Optimizing team for Norway
INFO [2025-03-29 13:09:11] Optimizing team for Germany
INFO [2025-03-29 13:09:11] Optimizing team for USA
INFO [2025-03-29 13:09:11] Optimizing team for Austria
INFO [2025-03-29 13:09:11] Optimizing team for Finland
INFO [2025-03-29 13:09:11] Optimizing team for Czechia
INFO [2025-03-29 13:09:11] Optimizing team for Switzerland
INFO [2025-03-29 13:09:11] Optimizing team for Italy
INFO [2025-03-29 13:09:11] Optimizing team for France
INFO [2025-03-29 13:09:11] Optimizing team for Canada
INFO [2025-03-29 13:09:11] Optimizing team for Slovenia
INFO [2025-03-29 13:09:11] Optimizing team for Estonia
INFO [2025-03-29 13:09:11] Optimizing team for Australia
INFO [2025-03-29 13:09:11] Optimizing team for Ukraine
INFO [2025-03-29 13:09:11] Optimizing team for Kazakhstan
INFO [2025-03-29 13:09:12] Optimizing team for Armenia
INFO [2025-03-29 13:09:12] Optimizing team for Latvia
INFO [2025-03-29 13:09:12] Optimizing team for Japan
INFO [2025-03-29 13:09:12] Optimizing team for Poland
INFO [2025-03-29 13:09:12] Optimizing team for South Korea
INFO [2025-03-29 13:09:12] Optimizing team for Andorra
INFO [2025-03-29 13:09:12] Optimizing team for Taiwan
INFO [2025-03-29 13:09:12] Optimizing team for China
INFO [2025-03-29 13:09:12] Optimizing team for Croatia
INFO [2025-03-29 13:09:12] Optimizing team for Slovakia
INFO [2025-03-29 13:09:12] Optimizing team for Argentina
INFO [2025-03-29 13:09:12] Optimizing team for Mongolia
INFO [2025-03-29 13:09:12] Optimizing team for Brazil
INFO [2025-03-29 13:09:12] Optimizing team for Lithuania
INFO [2025-03-29 13:09:12] Optimizing team for Greece
INFO [2025-03-29 13:09:12] Optimizing team for Iceland
INFO [2025-03-29 13:09:12] Optimizing team for Bulgaria
INFO [2025-03-29 13:09:12] Optimizing team for Serbia
INFO [2025-03-29 13:09:12] Optimizing team for Hungary
INFO [2025-03-29 13:09:12] Optimizing team for Turkey
INFO [2025-03-29 13:09:12] Optimizing team for North Macedonia
INFO [2025-03-29 13:09:12] Optimizing team for Romania
INFO [2025-03-29 13:09:12] Optimizing team for Bosnia&Herzegovina
INFO [2025-03-29 13:09:12] Optimizing team for Mexico
INFO [2025-03-29 13:09:12] Optimizing team for Iran
INFO [2025-03-29 13:09:12] Optimizing team for Chile
INFO [2025-03-29 13:09:12] Optimizing team for India
INFO [2025-03-29 13:09:12] Optimizing team for Malaysia
INFO [2025-03-29 13:09:12] Optimizing team for Haiti
INFO [2025-03-29 13:09:12] Optimizing team for Lebanon
INFO [2025-03-29 13:09:12] Optimizing team for Liechtenstein
WARN [2025-03-29 13:09:12] Could not read individuals file: invalid 'description' argument
WARN [2025-03-29 13:09:12] Could not read teams file: invalid 'description' argument
INFO [2025-03-29 13:09:12] Resetting men's probabilities at or below the mode to zero
INFO [2025-03-29 13:09:12] No values appear more than twice for Win_Prob
INFO [2025-03-29 13:09:12] No values appear more than twice for Podium_Prob
INFO [2025-03-29 13:09:12] No values appear more than twice for Top5_Prob
INFO [2025-03-29 13:09:12] No values appear more than twice for Top10_Prob
INFO [2025-03-29 13:09:12] Resetting ladies' probabilities at or below the mode to zero
INFO [2025-03-29 13:09:12] Reset 20 values to 0 for Win_Prob (repeated values or values <  0 )
INFO [2025-03-29 13:09:12] Repeated values: 0, 0, 0, 0, 0
INFO [2025-03-29 13:09:12] No values appear more than twice for Podium_Prob
INFO [2025-03-29 13:09:12] No values appear more than twice for Top5_Prob
INFO [2025-03-29 13:09:12] No values appear more than twice for Top10_Prob
INFO [2025-03-29 13:09:12] Normalizing men's team probabilities
INFO [2025-03-29 13:09:12] Normalized Win_Prob from sum of 0.71 to 1
INFO [2025-03-29 13:09:12] Normalized Podium_Prob from sum of 2.34 to 3
INFO [2025-03-29 13:09:12] Normalized Top5_Prob from sum of 4.2 to 5
INFO [2025-03-29 13:09:12] Normalized Top10_Prob from sum of 10.33 to 10
INFO [2025-03-29 13:09:12] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 13:09:12] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 13:09:12] Normalizing ladies' team probabilities
INFO [2025-03-29 13:09:12] Normalized Win_Prob from sum of 2.19 to 1
INFO [2025-03-29 13:09:12] Normalized Podium_Prob from sum of 4.41 to 3
INFO [2025-03-29 13:09:12] Normalized Top5_Prob from sum of 4.73 to 5
INFO [2025-03-29 13:09:12] Normalized Top10_Prob from sum of 13.19 to 10
INFO [2025-03-29 13:09:12] Final capping of probabilities to maximum of 1
INFO [2025-03-29 13:09:12] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 13:09:12] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 13:09:12] Optimizing fantasy relay team
INFO [2025-03-29 13:09:12] Fantasy team optimization complete. Selected 6 teams.
INFO [2025-03-29 13:09:12] Total price: 92546 of max 1e+05
INFO [2025-03-29 13:09:12] Expected total points: 542.9
INFO [2025-03-29 13:09:12] Men's teams: 6 ( 6 )
INFO [2025-03-29 13:09:12] Ladies' teams: 0 ( 0 )
INFO [2025-03-29 13:09:17] Starting relay predictions process
INFO [2025-03-29 13:09:17] Loading weekend race data
INFO [2025-03-29 13:09:17] Tomorrow's date: 2025-03-29
INFO [2025-03-29 13:09:17] Found 1 men's relay races and 1 ladies' relay races
INFO [2025-03-29 13:09:17] Loading chrono data
INFO [2025-03-29 13:09:23] Loaded men's chrono with 105122 rows and 36 columns
INFO [2025-03-29 13:09:23] Loaded ladies' chrono with 78706 rows and 36 columns
INFO [2025-03-29 13:09:23] Created men's relay df with 9688 rows
INFO [2025-03-29 13:09:23] Created men's individual df with 92143 rows
INFO [2025-03-29 13:09:23] Created ladies' relay df with 8019 rows
INFO [2025-03-29 13:09:23] Created ladies' individual df with 68253 rows
INFO [2025-03-29 13:09:27] Training models for Leg 1
INFO [2025-03-29 13:09:27] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:09:27] Training podium model using glm
INFO [2025-03-29 13:09:28] Training win model using glm
INFO [2025-03-29 13:09:28] Training top5 model using glm
INFO [2025-03-29 13:09:28] Training top10 model using glm
INFO [2025-03-29 13:09:28] Top features for Leg 1 podium prediction:
INFO [2025-03-29 13:09:28] Training models for Leg 2
INFO [2025-03-29 13:09:28] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:09:28] Training podium model using glm
INFO [2025-03-29 13:09:28] Training win model using glm
INFO [2025-03-29 13:09:28] Training top5 model using glm
INFO [2025-03-29 13:09:28] Training top10 model using glm
INFO [2025-03-29 13:09:28] Top features for Leg 2 podium prediction:
INFO [2025-03-29 13:09:28] Training models for Leg 3
INFO [2025-03-29 13:09:28] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:09:28] Training podium model using glm
INFO [2025-03-29 13:09:28] Training win model using glm
INFO [2025-03-29 13:09:28] Training top5 model using glm
INFO [2025-03-29 13:09:28] Training top10 model using glm
INFO [2025-03-29 13:09:28] Top features for Leg 3 podium prediction:
INFO [2025-03-29 13:09:28] Training models for Leg 4
INFO [2025-03-29 13:09:28] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:09:28] Training podium model using glm
INFO [2025-03-29 13:09:29] Training win model using glm
INFO [2025-03-29 13:09:29] Training top5 model using glm
INFO [2025-03-29 13:09:29] Training top10 model using glm
INFO [2025-03-29 13:09:29] Top features for Leg 4 podium prediction:
INFO [2025-03-29 13:09:29] Training models for Leg 1
INFO [2025-03-29 13:09:29] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:09:29] Training podium model using glm
INFO [2025-03-29 13:09:29] Training win model using glm
INFO [2025-03-29 13:09:29] Training top5 model using glm
INFO [2025-03-29 13:09:29] Training top10 model using glm
INFO [2025-03-29 13:09:29] Top features for Leg 1 podium prediction:
INFO [2025-03-29 13:09:29] Training models for Leg 2
INFO [2025-03-29 13:09:29] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:09:29] Training podium model using glm
INFO [2025-03-29 13:09:29] Training win model using glm
INFO [2025-03-29 13:09:29] Training top5 model using glm
INFO [2025-03-29 13:09:29] Training top10 model using glm
INFO [2025-03-29 13:09:29] Top features for Leg 2 podium prediction:
INFO [2025-03-29 13:09:29] Training models for Leg 3
INFO [2025-03-29 13:09:29] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:09:29] Training podium model using glm
INFO [2025-03-29 13:09:30] Training win model using glm
INFO [2025-03-29 13:09:30] Training top5 model using glm
INFO [2025-03-29 13:09:30] Training top10 model using glm
INFO [2025-03-29 13:09:30] Top features for Leg 3 podium prediction:
INFO [2025-03-29 13:09:30] Training models for Leg 4
INFO [2025-03-29 13:09:30] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:09:30] Training podium model using glm
INFO [2025-03-29 13:09:30] Training win model using glm
INFO [2025-03-29 13:09:30] Training top5 model using glm
INFO [2025-03-29 13:09:30] Training top10 model using glm
INFO [2025-03-29 13:09:30] Top features for Leg 4 podium prediction:
INFO [2025-03-29 13:09:30] Processing men's relay predictions
INFO [2025-03-29 13:09:30] Loaded men relay teams startlist with 24 rows
INFO [2025-03-29 13:09:30] Loaded men relay individuals startlist with 96 rows
INFO [2025-03-29 13:09:30] Preparing current men skier data
INFO [2025-03-29 13:09:30] Found 9 Elo columns for current skiers
INFO [2025-03-29 13:09:30] Replaced NAs in Distance_Elo with first quartile: 1207.23243912712
INFO [2025-03-29 13:09:30] Replaced NAs in Distance_C_Elo with first quartile: 1233.40200699225
INFO [2025-03-29 13:09:30] Replaced NAs in Distance_F_Elo with first quartile: 1236.48554062178
INFO [2025-03-29 13:09:30] Replaced NAs in Sprint_Elo with first quartile: 1223.60107000698
INFO [2025-03-29 13:09:30] Replaced NAs in Sprint_C_Elo with first quartile: 1241.28715500947
INFO [2025-03-29 13:09:30] Replaced NAs in Sprint_F_Elo with first quartile: 1234.45151108772
INFO [2025-03-29 13:09:30] Replaced NAs in Classic_Elo with first quartile: 1241.52867310024
INFO [2025-03-29 13:09:30] Replaced NAs in Freestyle_Elo with first quartile: 1228.48649348109
INFO [2025-03-29 13:09:30] Replaced NAs in Distance_Pelo with first quartile: 1211.63035979047
INFO [2025-03-29 13:09:30] Replaced NAs in Distance_C_Pelo with first quartile: 1234.81091928129
INFO [2025-03-29 13:09:30] Replaced NAs in Distance_F_Pelo with first quartile: 1239.65331180248
INFO [2025-03-29 13:09:30] Replaced NAs in Sprint_Pelo with first quartile: 1240.94751821383
INFO [2025-03-29 13:09:30] Replaced NAs in Sprint_C_Pelo with first quartile: 1241.28715500947
INFO [2025-03-29 13:09:30] Replaced NAs in Sprint_F_Pelo with first quartile: 1252.45166310493
INFO [2025-03-29 13:09:30] Replaced NAs in Classic_Pelo with first quartile: 1243.63746068082
INFO [2025-03-29 13:09:30] Replaced NAs in Freestyle_Pelo with first quartile: 1249.30280713791
INFO [2025-03-29 13:09:30] Replaced NAs in Classic_Last_5 with first quartile: 0
INFO [2025-03-29 13:09:30] Replaced NAs in Freestyle_Last_5 with first quartile: 0
INFO [2025-03-29 13:09:30] Created Pelo_Pct from Elo with max value: 1946.6211651574
INFO [2025-03-29 13:09:30] Created Distance_Pelo_Pct from Distance_Elo with max value: 1869.1251911742
INFO [2025-03-29 13:09:30] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1777.16297253153
INFO [2025-03-29 13:09:30] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1695.2053212904
INFO [2025-03-29 13:09:30] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1886.80363942481
INFO [2025-03-29 13:09:30] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1711.08486899169
INFO [2025-03-29 13:09:30] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1792.65157560707
INFO [2025-03-29 13:09:30] Created Classic_Pelo_Pct from Classic_Elo with max value: 1807.56773496777
INFO [2025-03-29 13:09:30] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1814.60460629541
INFO [2025-03-29 13:09:30] Prepared data for 381 men skiers with 33 features
INFO [2025-03-29 13:09:30] Using FIS startlist for men's leg predictions
INFO [2025-03-29 13:09:31] Using FIS startlist for men
INFO [2025-03-29 13:09:31] Attempting Option 1: Team model coefficients
INFO [2025-03-29 13:09:31] Option 1 failed: No team_podium model found
INFO [2025-03-29 13:09:31] Option 1 failed: No team model
INFO [2025-03-29 13:09:31] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 13:09:31] Leg 1 accuracy: 0.858079096045198
INFO [2025-03-29 13:09:31] Leg 2 accuracy: 0.844576271186441
INFO [2025-03-29 13:09:31] Leg 3 accuracy: 0.877255016559517
INFO [2025-03-29 13:09:31] Leg 4 accuracy: 0.89507110851354
INFO [2025-03-29 13:09:31] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 13:09:31] Leg importance weights: Leg 1: 0.25, Leg 2: 0.24, Leg 3: 0.25, Leg 4: 0.26
INFO [2025-03-29 13:09:31] Processing ladies's relay predictions
INFO [2025-03-29 13:09:31] Loaded ladies relay teams startlist with 35 rows
INFO [2025-03-29 13:09:31] Loaded ladies relay individuals startlist with 231 rows
INFO [2025-03-29 13:09:31] Preparing current ladies skier data
INFO [2025-03-29 13:09:31] Found 9 Elo columns for current skiers
INFO [2025-03-29 13:09:31] Replaced NAs in Distance_Elo with first quartile: 1237.38564383256
INFO [2025-03-29 13:09:31] Replaced NAs in Distance_C_Elo with first quartile: 1243.87329106944
INFO [2025-03-29 13:09:31] Replaced NAs in Distance_F_Elo with first quartile: 1256.69628195708
INFO [2025-03-29 13:09:31] Replaced NAs in Sprint_Elo with first quartile: 1246.32574824425
INFO [2025-03-29 13:09:31] Replaced NAs in Sprint_C_Elo with first quartile: 1257.67866787334
INFO [2025-03-29 13:09:31] Replaced NAs in Sprint_F_Elo with first quartile: 1244.84742904868
INFO [2025-03-29 13:09:31] Replaced NAs in Classic_Elo with first quartile: 1252.44868703669
INFO [2025-03-29 13:09:31] Replaced NAs in Freestyle_Elo with first quartile: 1244.44508230281
INFO [2025-03-29 13:09:31] Replaced NAs in Distance_Pelo with first quartile: 1241.11854419952
INFO [2025-03-29 13:09:31] Replaced NAs in Distance_C_Pelo with first quartile: 1245.57367555166
INFO [2025-03-29 13:09:31] Replaced NAs in Distance_F_Pelo with first quartile: 1259.54282973153
INFO [2025-03-29 13:09:31] Replaced NAs in Sprint_Pelo with first quartile: 1254.58885254623
INFO [2025-03-29 13:09:31] Replaced NAs in Sprint_C_Pelo with first quartile: 1257.58302026178
INFO [2025-03-29 13:09:31] Replaced NAs in Sprint_F_Pelo with first quartile: 1257.67755691493
INFO [2025-03-29 13:09:31] Replaced NAs in Classic_Pelo with first quartile: 1256.79275004544
INFO [2025-03-29 13:09:31] Replaced NAs in Freestyle_Pelo with first quartile: 1256.79999900008
INFO [2025-03-29 13:09:31] Replaced NAs in Classic_Last_5 with first quartile: 3.5
INFO [2025-03-29 13:09:31] Replaced NAs in Freestyle_Last_5 with first quartile: 2.4
INFO [2025-03-29 13:09:31] Created Pelo_Pct from Elo with max value: 1841.00191142018
INFO [2025-03-29 13:09:31] Created Distance_Pelo_Pct from Distance_Elo with max value: 1889.46974050597
INFO [2025-03-29 13:09:31] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1763.33572074398
INFO [2025-03-29 13:09:31] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1693.85026290322
INFO [2025-03-29 13:09:31] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1742.74758850835
INFO [2025-03-29 13:09:31] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1601.5820663103
INFO [2025-03-29 13:09:31] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1681.09824552997
INFO [2025-03-29 13:09:31] Created Classic_Pelo_Pct from Classic_Elo with max value: 1698.69428891549
INFO [2025-03-29 13:09:31] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1707.58410982918
INFO [2025-03-29 13:09:31] Prepared data for 255 ladies skiers with 33 features
INFO [2025-03-29 13:09:31] No FIS startlist, predicting for all skiers in all legs
INFO [2025-03-29 13:09:31] No valid FIS startlist for ladies, building optimized teams
INFO [2025-03-29 13:09:31] Attempting Option 1: Team model coefficients
INFO [2025-03-29 13:09:31] Option 1 failed: argument "leg_models" is missing, with no default
INFO [2025-03-29 13:09:31] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 13:09:31] Option 2 failed: argument "leg_models" is missing, with no default
INFO [2025-03-29 13:09:31] Using Option 3: Default leg importance weights
INFO [2025-03-29 13:09:31] Using leg importance weights for team optimization: Leg 1: 0.20, Leg 2: 0.20, Leg 3: 0.25, Leg 4: 0.35
INFO [2025-03-29 13:09:31] Optimizing team for Sweden
INFO [2025-03-29 13:09:31] Optimizing team for Norway
INFO [2025-03-29 13:09:31] Optimizing team for Germany
INFO [2025-03-29 13:09:31] Optimizing team for USA
INFO [2025-03-29 13:09:31] Optimizing team for Austria
INFO [2025-03-29 13:09:31] Optimizing team for Finland
INFO [2025-03-29 13:09:31] Optimizing team for Czechia
INFO [2025-03-29 13:09:31] Optimizing team for Switzerland
INFO [2025-03-29 13:09:31] Optimizing team for Italy
INFO [2025-03-29 13:09:31] Optimizing team for France
INFO [2025-03-29 13:09:31] Optimizing team for Canada
INFO [2025-03-29 13:09:32] Optimizing team for Slovenia
INFO [2025-03-29 13:09:32] Optimizing team for Estonia
INFO [2025-03-29 13:09:32] Optimizing team for Australia
INFO [2025-03-29 13:09:32] Optimizing team for Ukraine
INFO [2025-03-29 13:09:32] Optimizing team for Kazakhstan
INFO [2025-03-29 13:09:32] Optimizing team for Armenia
INFO [2025-03-29 13:09:32] Optimizing team for Latvia
INFO [2025-03-29 13:09:32] Optimizing team for Japan
INFO [2025-03-29 13:09:32] Optimizing team for Poland
INFO [2025-03-29 13:09:32] Optimizing team for South Korea
INFO [2025-03-29 13:09:32] Optimizing team for Andorra
INFO [2025-03-29 13:09:32] Optimizing team for Taiwan
INFO [2025-03-29 13:09:32] Optimizing team for China
INFO [2025-03-29 13:09:32] Optimizing team for Croatia
INFO [2025-03-29 13:09:32] Optimizing team for Slovakia
INFO [2025-03-29 13:09:32] Optimizing team for Argentina
INFO [2025-03-29 13:09:32] Optimizing team for Mongolia
INFO [2025-03-29 13:09:32] Optimizing team for Brazil
INFO [2025-03-29 13:09:32] Optimizing team for Lithuania
INFO [2025-03-29 13:09:32] Optimizing team for Greece
INFO [2025-03-29 13:09:32] Optimizing team for Iceland
INFO [2025-03-29 13:09:32] Optimizing team for Bulgaria
INFO [2025-03-29 13:09:32] Optimizing team for Serbia
INFO [2025-03-29 13:09:32] Optimizing team for Hungary
INFO [2025-03-29 13:09:32] Optimizing team for Turkey
INFO [2025-03-29 13:09:32] Optimizing team for North Macedonia
INFO [2025-03-29 13:09:32] Optimizing team for Romania
INFO [2025-03-29 13:09:32] Optimizing team for Bosnia&Herzegovina
INFO [2025-03-29 13:09:32] Optimizing team for Mexico
INFO [2025-03-29 13:09:32] Optimizing team for Iran
INFO [2025-03-29 13:09:32] Optimizing team for Chile
INFO [2025-03-29 13:09:32] Optimizing team for India
INFO [2025-03-29 13:09:32] Optimizing team for Malaysia
INFO [2025-03-29 13:09:32] Optimizing team for Haiti
INFO [2025-03-29 13:09:32] Optimizing team for Lebanon
INFO [2025-03-29 13:09:32] Optimizing team for Liechtenstein
WARN [2025-03-29 13:09:32] Could not read individuals file: invalid 'description' argument
WARN [2025-03-29 13:09:32] Could not read teams file: invalid 'description' argument
INFO [2025-03-29 13:09:32] Resetting men's probabilities at or below the mode to zero
INFO [2025-03-29 13:09:32] No values appear more than twice for Win_Prob
INFO [2025-03-29 13:09:32] No values appear more than twice for Podium_Prob
INFO [2025-03-29 13:09:32] No values appear more than twice for Top5_Prob
INFO [2025-03-29 13:09:32] No values appear more than twice for Top10_Prob
INFO [2025-03-29 13:09:32] Resetting ladies' probabilities at or below the mode to zero
INFO [2025-03-29 13:09:32] Reset 20 values to 0 for Win_Prob (repeated values or values <  0 )
INFO [2025-03-29 13:09:32] Repeated values: 0, 0, 0, 0, 0
INFO [2025-03-29 13:09:32] No values appear more than twice for Podium_Prob
INFO [2025-03-29 13:09:32] No values appear more than twice for Top5_Prob
INFO [2025-03-29 13:09:32] No values appear more than twice for Top10_Prob
INFO [2025-03-29 13:09:32] Normalizing men's team probabilities
INFO [2025-03-29 13:09:32] Normalized Win_Prob from sum of 0.72 to 1
INFO [2025-03-29 13:09:32] Normalized Podium_Prob from sum of 2.34 to 3
INFO [2025-03-29 13:09:32] Normalized Top5_Prob from sum of 4.2 to 5
INFO [2025-03-29 13:09:32] Normalized Top10_Prob from sum of 10.33 to 10
INFO [2025-03-29 13:09:32] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 13:09:32] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 13:09:32] Normalizing ladies' team probabilities
INFO [2025-03-29 13:09:32] Normalized Win_Prob from sum of 2.19 to 1
INFO [2025-03-29 13:09:32] Normalized Podium_Prob from sum of 4.41 to 3
INFO [2025-03-29 13:09:32] Normalized Top5_Prob from sum of 4.73 to 5
INFO [2025-03-29 13:09:32] Normalized Top10_Prob from sum of 13.19 to 10
INFO [2025-03-29 13:09:32] Final capping of probabilities to maximum of 1
INFO [2025-03-29 13:09:32] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 13:09:32] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 13:09:32] Optimizing fantasy relay team
INFO [2025-03-29 13:09:33] Fantasy team optimization complete. Selected 6 teams.
INFO [2025-03-29 13:09:33] Total price: 92546 of max 1e+05
INFO [2025-03-29 13:09:33] Expected total points: 543.1
INFO [2025-03-29 13:09:33] Men's teams: 6 ( 6 )
INFO [2025-03-29 13:09:33] Ladies' teams: 0 ( 0 )
INFO [2025-03-29 13:09:33] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_points.xlsx
INFO [2025-03-29 13:09:33] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_probabilities.xlsx
INFO [2025-03-29 13:09:33] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_points.xlsx
INFO [2025-03-29 13:09:33] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_probabilities.xlsx
INFO [2025-03-29 13:09:33] Saved fantasy team results to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/fantasy_relay_team.xlsx
INFO [2025-03-29 13:09:33] Relay predictions completed successfully
INFO [2025-03-29 13:13:24] Starting relay predictions process
INFO [2025-03-29 13:13:24] Loading weekend race data
INFO [2025-03-29 13:13:24] Tomorrow's date: 2025-03-29
INFO [2025-03-29 13:13:24] Found 1 men's relay races and 1 ladies' relay races
INFO [2025-03-29 13:13:24] Loading chrono data
INFO [2025-03-29 13:13:29] Loaded men's chrono with 105122 rows and 36 columns
INFO [2025-03-29 13:13:29] Loaded ladies' chrono with 78706 rows and 36 columns
INFO [2025-03-29 13:13:29] Created men's relay df with 9688 rows
INFO [2025-03-29 13:13:29] Created men's individual df with 92143 rows
INFO [2025-03-29 13:13:29] Created ladies' relay df with 8019 rows
INFO [2025-03-29 13:13:29] Created ladies' individual df with 68253 rows
INFO [2025-03-29 13:13:34] Training models for Leg 1
INFO [2025-03-29 13:13:34] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:13:34] Training podium model using glm
INFO [2025-03-29 13:13:35] Training win model using glm
INFO [2025-03-29 13:13:35] Training top5 model using glm
INFO [2025-03-29 13:13:35] Training top10 model using glm
INFO [2025-03-29 13:13:35] Top features for Leg 1 podium prediction:
INFO [2025-03-29 13:13:35] Training models for Leg 2
INFO [2025-03-29 13:13:35] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:13:35] Training podium model using glm
INFO [2025-03-29 13:13:35] Training win model using glm
INFO [2025-03-29 13:13:35] Training top5 model using glm
INFO [2025-03-29 13:13:35] Training top10 model using glm
INFO [2025-03-29 13:13:35] Top features for Leg 2 podium prediction:
INFO [2025-03-29 13:13:35] Training models for Leg 3
INFO [2025-03-29 13:13:35] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:13:35] Training podium model using glm
INFO [2025-03-29 13:13:35] Training win model using glm
INFO [2025-03-29 13:13:35] Training top5 model using glm
INFO [2025-03-29 13:13:35] Training top10 model using glm
INFO [2025-03-29 13:13:35] Top features for Leg 3 podium prediction:
INFO [2025-03-29 13:13:35] Training models for Leg 4
INFO [2025-03-29 13:13:35] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:13:35] Training podium model using glm
INFO [2025-03-29 13:13:36] Training win model using glm
INFO [2025-03-29 13:13:36] Training top5 model using glm
INFO [2025-03-29 13:13:36] Training top10 model using glm
INFO [2025-03-29 13:13:36] Top features for Leg 4 podium prediction:
INFO [2025-03-29 13:13:36] Training models for Leg 1
INFO [2025-03-29 13:13:36] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:13:36] Training podium model using glm
INFO [2025-03-29 13:13:36] Training win model using glm
INFO [2025-03-29 13:13:36] Training top5 model using glm
INFO [2025-03-29 13:13:36] Training top10 model using glm
INFO [2025-03-29 13:13:36] Top features for Leg 1 podium prediction:
INFO [2025-03-29 13:13:36] Training models for Leg 2
INFO [2025-03-29 13:13:36] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:13:36] Training podium model using glm
INFO [2025-03-29 13:13:36] Training win model using glm
INFO [2025-03-29 13:13:36] Training top5 model using glm
INFO [2025-03-29 13:13:36] Training top10 model using glm
INFO [2025-03-29 13:13:36] Top features for Leg 2 podium prediction:
INFO [2025-03-29 13:13:36] Training models for Leg 3
INFO [2025-03-29 13:13:36] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:13:36] Training podium model using glm
INFO [2025-03-29 13:13:36] Training win model using glm
INFO [2025-03-29 13:13:37] Training top5 model using glm
INFO [2025-03-29 13:13:37] Training top10 model using glm
INFO [2025-03-29 13:13:37] Top features for Leg 3 podium prediction:
INFO [2025-03-29 13:13:37] Training models for Leg 4
INFO [2025-03-29 13:13:37] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:13:37] Training podium model using glm
INFO [2025-03-29 13:13:37] Training win model using glm
INFO [2025-03-29 13:13:37] Training top5 model using glm
INFO [2025-03-29 13:13:37] Training top10 model using glm
INFO [2025-03-29 13:13:37] Top features for Leg 4 podium prediction:
INFO [2025-03-29 13:13:37] Processing men's relay predictions
INFO [2025-03-29 13:13:37] Loaded men relay teams startlist with 24 rows
INFO [2025-03-29 13:13:37] Loaded men relay individuals startlist with 96 rows
INFO [2025-03-29 13:13:37] Preparing current men skier data
INFO [2025-03-29 13:13:37] Found 9 Elo columns for current skiers
INFO [2025-03-29 13:13:37] Replaced NAs in Distance_Elo with first quartile: 1207.23243912712
INFO [2025-03-29 13:13:37] Replaced NAs in Distance_C_Elo with first quartile: 1233.40200699225
INFO [2025-03-29 13:13:37] Replaced NAs in Distance_F_Elo with first quartile: 1236.48554062178
INFO [2025-03-29 13:13:37] Replaced NAs in Sprint_Elo with first quartile: 1223.60107000698
INFO [2025-03-29 13:13:37] Replaced NAs in Sprint_C_Elo with first quartile: 1241.28715500947
INFO [2025-03-29 13:13:37] Replaced NAs in Sprint_F_Elo with first quartile: 1234.45151108772
INFO [2025-03-29 13:13:37] Replaced NAs in Classic_Elo with first quartile: 1241.52867310024
INFO [2025-03-29 13:13:37] Replaced NAs in Freestyle_Elo with first quartile: 1228.48649348109
INFO [2025-03-29 13:13:37] Replaced NAs in Distance_Pelo with first quartile: 1211.63035979047
INFO [2025-03-29 13:13:37] Replaced NAs in Distance_C_Pelo with first quartile: 1234.81091928129
INFO [2025-03-29 13:13:37] Replaced NAs in Distance_F_Pelo with first quartile: 1239.65331180248
INFO [2025-03-29 13:13:37] Replaced NAs in Sprint_Pelo with first quartile: 1240.94751821383
INFO [2025-03-29 13:13:37] Replaced NAs in Sprint_C_Pelo with first quartile: 1241.28715500947
INFO [2025-03-29 13:13:37] Replaced NAs in Sprint_F_Pelo with first quartile: 1252.45166310493
INFO [2025-03-29 13:13:37] Replaced NAs in Classic_Pelo with first quartile: 1243.63746068082
INFO [2025-03-29 13:13:37] Replaced NAs in Freestyle_Pelo with first quartile: 1249.30280713791
INFO [2025-03-29 13:13:37] Replaced NAs in Classic_Last_5 with first quartile: 0
INFO [2025-03-29 13:13:37] Replaced NAs in Freestyle_Last_5 with first quartile: 0
INFO [2025-03-29 13:13:37] Created Pelo_Pct from Elo with max value: 1946.6211651574
INFO [2025-03-29 13:13:37] Created Distance_Pelo_Pct from Distance_Elo with max value: 1869.1251911742
INFO [2025-03-29 13:13:37] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1777.16297253153
INFO [2025-03-29 13:13:37] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1695.2053212904
INFO [2025-03-29 13:13:37] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1886.80363942481
INFO [2025-03-29 13:13:37] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1711.08486899169
INFO [2025-03-29 13:13:37] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1792.65157560707
INFO [2025-03-29 13:13:37] Created Classic_Pelo_Pct from Classic_Elo with max value: 1807.56773496777
INFO [2025-03-29 13:13:37] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1814.60460629541
INFO [2025-03-29 13:13:37] Prepared data for 381 men skiers with 33 features
INFO [2025-03-29 13:13:37] Using FIS startlist for men's leg predictions
INFO [2025-03-29 13:13:37] Using FIS startlist for men
INFO [2025-03-29 13:13:38] Attempting Option 1: Team model coefficients
INFO [2025-03-29 13:13:38] Option 1 failed: No team_podium model found
INFO [2025-03-29 13:13:38] Option 1 failed: No team model
INFO [2025-03-29 13:13:38] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 13:13:38] Leg 1 accuracy: 0.861299435028249
INFO [2025-03-29 13:13:38] Leg 2 accuracy: 0.858079096045198
INFO [2025-03-29 13:13:38] Leg 3 accuracy: 0.867484901616988
INFO [2025-03-29 13:13:38] Leg 4 accuracy: 0.884788622637834
INFO [2025-03-29 13:13:38] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 13:13:38] Leg importance weights: Leg 1: 0.25, Leg 2: 0.25, Leg 3: 0.25, Leg 4: 0.25
INFO [2025-03-29 13:13:38] Processing ladies's relay predictions
INFO [2025-03-29 13:13:38] Loaded ladies relay teams startlist with 35 rows
INFO [2025-03-29 13:13:38] Loaded ladies relay individuals startlist with 231 rows
INFO [2025-03-29 13:13:38] Preparing current ladies skier data
INFO [2025-03-29 13:13:38] Found 9 Elo columns for current skiers
INFO [2025-03-29 13:13:38] Replaced NAs in Distance_Elo with first quartile: 1237.38564383256
INFO [2025-03-29 13:13:38] Replaced NAs in Distance_C_Elo with first quartile: 1243.87329106944
INFO [2025-03-29 13:13:38] Replaced NAs in Distance_F_Elo with first quartile: 1256.69628195708
INFO [2025-03-29 13:13:38] Replaced NAs in Sprint_Elo with first quartile: 1246.32574824425
INFO [2025-03-29 13:13:38] Replaced NAs in Sprint_C_Elo with first quartile: 1257.67866787334
INFO [2025-03-29 13:13:38] Replaced NAs in Sprint_F_Elo with first quartile: 1244.84742904868
INFO [2025-03-29 13:13:38] Replaced NAs in Classic_Elo with first quartile: 1252.44868703669
INFO [2025-03-29 13:13:38] Replaced NAs in Freestyle_Elo with first quartile: 1244.44508230281
INFO [2025-03-29 13:13:38] Replaced NAs in Distance_Pelo with first quartile: 1241.11854419952
INFO [2025-03-29 13:13:38] Replaced NAs in Distance_C_Pelo with first quartile: 1245.57367555166
INFO [2025-03-29 13:13:38] Replaced NAs in Distance_F_Pelo with first quartile: 1259.54282973153
INFO [2025-03-29 13:13:38] Replaced NAs in Sprint_Pelo with first quartile: 1254.58885254623
INFO [2025-03-29 13:13:38] Replaced NAs in Sprint_C_Pelo with first quartile: 1257.58302026178
INFO [2025-03-29 13:13:38] Replaced NAs in Sprint_F_Pelo with first quartile: 1257.67755691493
INFO [2025-03-29 13:13:38] Replaced NAs in Classic_Pelo with first quartile: 1256.79275004544
INFO [2025-03-29 13:13:38] Replaced NAs in Freestyle_Pelo with first quartile: 1256.79999900008
INFO [2025-03-29 13:13:38] Replaced NAs in Classic_Last_5 with first quartile: 3.5
INFO [2025-03-29 13:13:38] Replaced NAs in Freestyle_Last_5 with first quartile: 2.4
INFO [2025-03-29 13:13:38] Created Pelo_Pct from Elo with max value: 1841.00191142018
INFO [2025-03-29 13:13:38] Created Distance_Pelo_Pct from Distance_Elo with max value: 1889.46974050597
INFO [2025-03-29 13:13:38] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1763.33572074398
INFO [2025-03-29 13:13:38] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1693.85026290322
INFO [2025-03-29 13:13:38] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1742.74758850835
INFO [2025-03-29 13:13:38] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1601.5820663103
INFO [2025-03-29 13:13:38] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1681.09824552997
INFO [2025-03-29 13:13:38] Created Classic_Pelo_Pct from Classic_Elo with max value: 1698.69428891549
INFO [2025-03-29 13:13:38] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1707.58410982918
INFO [2025-03-29 13:13:38] Prepared data for 255 ladies skiers with 33 features
INFO [2025-03-29 13:13:38] No FIS startlist, predicting for all skiers in all legs
INFO [2025-03-29 13:13:38] No valid FIS startlist for ladies, building optimized teams
INFO [2025-03-29 13:13:38] Attempting Option 1: Team model coefficients
INFO [2025-03-29 13:13:38] Option 1 failed: argument "leg_models" is missing, with no default
INFO [2025-03-29 13:13:38] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 13:13:38] Option 2 failed: argument "leg_models" is missing, with no default
INFO [2025-03-29 13:13:38] Using Option 3: Default leg importance weights
INFO [2025-03-29 13:13:38] Using leg importance weights for team optimization: Leg 1: 0.20, Leg 2: 0.20, Leg 3: 0.25, Leg 4: 0.35
INFO [2025-03-29 13:13:38] Optimizing team for Sweden
INFO [2025-03-29 13:13:38] Optimizing team for Norway
INFO [2025-03-29 13:13:38] Optimizing team for Germany
INFO [2025-03-29 13:13:38] Optimizing team for USA
INFO [2025-03-29 13:13:38] Optimizing team for Austria
INFO [2025-03-29 13:13:38] Optimizing team for Finland
INFO [2025-03-29 13:13:38] Optimizing team for Czechia
INFO [2025-03-29 13:13:38] Optimizing team for Switzerland
INFO [2025-03-29 13:13:38] Optimizing team for Italy
INFO [2025-03-29 13:13:38] Optimizing team for France
INFO [2025-03-29 13:13:38] Optimizing team for Canada
INFO [2025-03-29 13:13:38] Optimizing team for Slovenia
INFO [2025-03-29 13:13:39] Optimizing team for Estonia
INFO [2025-03-29 13:13:39] Optimizing team for Australia
INFO [2025-03-29 13:13:39] Optimizing team for Ukraine
INFO [2025-03-29 13:13:39] Optimizing team for Kazakhstan
INFO [2025-03-29 13:13:39] Optimizing team for Armenia
INFO [2025-03-29 13:13:39] Optimizing team for Latvia
INFO [2025-03-29 13:13:39] Optimizing team for Japan
INFO [2025-03-29 13:13:39] Optimizing team for Poland
INFO [2025-03-29 13:13:39] Optimizing team for South Korea
INFO [2025-03-29 13:13:39] Optimizing team for Andorra
INFO [2025-03-29 13:13:39] Optimizing team for Taiwan
INFO [2025-03-29 13:13:39] Optimizing team for China
INFO [2025-03-29 13:13:39] Optimizing team for Croatia
INFO [2025-03-29 13:13:39] Optimizing team for Slovakia
INFO [2025-03-29 13:13:39] Optimizing team for Argentina
INFO [2025-03-29 13:13:39] Optimizing team for Mongolia
INFO [2025-03-29 13:13:39] Optimizing team for Brazil
INFO [2025-03-29 13:13:39] Optimizing team for Lithuania
INFO [2025-03-29 13:13:39] Optimizing team for Greece
INFO [2025-03-29 13:13:39] Optimizing team for Iceland
INFO [2025-03-29 13:13:39] Optimizing team for Bulgaria
INFO [2025-03-29 13:13:39] Optimizing team for Serbia
INFO [2025-03-29 13:13:39] Optimizing team for Hungary
INFO [2025-03-29 13:13:39] Optimizing team for Turkey
INFO [2025-03-29 13:13:39] Optimizing team for North Macedonia
INFO [2025-03-29 13:13:39] Optimizing team for Romania
INFO [2025-03-29 13:13:39] Optimizing team for Bosnia&Herzegovina
INFO [2025-03-29 13:13:39] Optimizing team for Mexico
INFO [2025-03-29 13:13:39] Optimizing team for Iran
INFO [2025-03-29 13:13:39] Optimizing team for Chile
INFO [2025-03-29 13:13:39] Optimizing team for India
INFO [2025-03-29 13:13:39] Optimizing team for Malaysia
INFO [2025-03-29 13:13:39] Optimizing team for Haiti
INFO [2025-03-29 13:13:39] Optimizing team for Lebanon
INFO [2025-03-29 13:13:39] Optimizing team for Liechtenstein
WARN [2025-03-29 13:13:39] Could not read individuals file: invalid 'description' argument
WARN [2025-03-29 13:13:39] Could not read teams file: invalid 'description' argument
INFO [2025-03-29 13:13:39] Resetting men's probabilities at or below the mode to zero
INFO [2025-03-29 13:13:39] No values appear more than twice for Win_Prob
INFO [2025-03-29 13:13:39] No values appear more than twice for Podium_Prob
INFO [2025-03-29 13:13:39] No values appear more than twice for Top5_Prob
INFO [2025-03-29 13:13:39] No values appear more than twice for Top10_Prob
INFO [2025-03-29 13:13:39] Resetting ladies' probabilities at or below the mode to zero
INFO [2025-03-29 13:13:39] Reset 20 values to 0 for Win_Prob (repeated values or values <  0 )
INFO [2025-03-29 13:13:39] Repeated values: 0, 0, 0, 0, 0
INFO [2025-03-29 13:13:39] No values appear more than twice for Podium_Prob
INFO [2025-03-29 13:13:39] No values appear more than twice for Top5_Prob
INFO [2025-03-29 13:13:39] No values appear more than twice for Top10_Prob
INFO [2025-03-29 13:13:39] Normalizing men's team probabilities
INFO [2025-03-29 13:13:39] Normalized Win_Prob from sum of 0.72 to 1
INFO [2025-03-29 13:13:39] Normalized Podium_Prob from sum of 2.34 to 3
INFO [2025-03-29 13:13:39] Normalized Top5_Prob from sum of 4.21 to 5
INFO [2025-03-29 13:13:39] Normalized Top10_Prob from sum of 10.33 to 10
INFO [2025-03-29 13:13:39] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 13:13:39] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 13:13:39] Normalizing ladies' team probabilities
INFO [2025-03-29 13:13:39] Normalized Win_Prob from sum of 2.19 to 1
INFO [2025-03-29 13:13:39] Normalized Podium_Prob from sum of 4.41 to 3
INFO [2025-03-29 13:13:39] Normalized Top5_Prob from sum of 4.73 to 5
INFO [2025-03-29 13:13:39] Normalized Top10_Prob from sum of 13.19 to 10
INFO [2025-03-29 13:13:39] Final capping of probabilities to maximum of 1
INFO [2025-03-29 13:13:39] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 13:13:39] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 13:13:39] Optimizing fantasy relay team
INFO [2025-03-29 13:13:40] Fantasy team optimization complete. Selected 6 teams.
INFO [2025-03-29 13:13:40] Total price: 92546 of max 1e+05
INFO [2025-03-29 13:13:40] Expected total points: 543.2
INFO [2025-03-29 13:13:40] Men's teams: 6 ( 6 )
INFO [2025-03-29 13:13:40] Ladies' teams: 0 ( 0 )
INFO [2025-03-29 13:13:40] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_points.xlsx
INFO [2025-03-29 13:13:40] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_probabilities.xlsx
INFO [2025-03-29 13:13:40] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_points.xlsx
INFO [2025-03-29 13:13:40] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_probabilities.xlsx
INFO [2025-03-29 13:13:40] Saved fantasy team results to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/fantasy_relay_team.xlsx
INFO [2025-03-29 13:13:40] Relay predictions completed successfully
INFO [2025-03-29 13:21:27] Starting relay predictions process
INFO [2025-03-29 13:21:27] Loading weekend race data
INFO [2025-03-29 13:21:27] Tomorrow's date: 2025-03-29
INFO [2025-03-29 13:21:27] Found 1 men's relay races and 1 ladies' relay races
INFO [2025-03-29 13:21:27] Loading chrono data
INFO [2025-03-29 13:21:33] Loaded men's chrono with 105122 rows and 36 columns
INFO [2025-03-29 13:21:33] Loaded ladies' chrono with 78706 rows and 36 columns
INFO [2025-03-29 13:21:33] Created men's relay df with 9688 rows
INFO [2025-03-29 13:21:33] Created men's individual df with 92143 rows
INFO [2025-03-29 13:21:33] Created ladies' relay df with 8019 rows
INFO [2025-03-29 13:21:33] Created ladies' individual df with 68253 rows
INFO [2025-03-29 13:21:38] Training models for Leg 1
INFO [2025-03-29 13:21:38] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:21:38] Training podium model using glm
INFO [2025-03-29 13:21:38] Training win model using glm
INFO [2025-03-29 13:21:38] Training top5 model using glm
INFO [2025-03-29 13:21:39] Training top10 model using glm
INFO [2025-03-29 13:21:39] Top features for Leg 1 podium prediction:
INFO [2025-03-29 13:21:39] Training models for Leg 2
INFO [2025-03-29 13:21:39] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:21:39] Training podium model using glm
INFO [2025-03-29 13:21:39] Training win model using glm
INFO [2025-03-29 13:21:39] Training top5 model using glm
INFO [2025-03-29 13:21:39] Training top10 model using glm
INFO [2025-03-29 13:21:39] Top features for Leg 2 podium prediction:
INFO [2025-03-29 13:21:39] Training models for Leg 3
INFO [2025-03-29 13:21:39] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:21:39] Training podium model using glm
INFO [2025-03-29 13:21:39] Training win model using glm
INFO [2025-03-29 13:21:39] Training top5 model using glm
INFO [2025-03-29 13:21:39] Training top10 model using glm
INFO [2025-03-29 13:21:39] Top features for Leg 3 podium prediction:
INFO [2025-03-29 13:21:39] Training models for Leg 4
INFO [2025-03-29 13:21:39] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:21:39] Training podium model using glm
INFO [2025-03-29 13:21:39] Training win model using glm
INFO [2025-03-29 13:21:40] Training top5 model using glm
INFO [2025-03-29 13:21:40] Training top10 model using glm
INFO [2025-03-29 13:21:40] Top features for Leg 4 podium prediction:
INFO [2025-03-29 13:21:40] Training models for Leg 1
INFO [2025-03-29 13:21:40] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:21:40] Training podium model using glm
INFO [2025-03-29 13:21:40] Training win model using glm
INFO [2025-03-29 13:21:40] Training top5 model using glm
INFO [2025-03-29 13:21:40] Training top10 model using glm
INFO [2025-03-29 13:21:40] Top features for Leg 1 podium prediction:
INFO [2025-03-29 13:21:40] Training models for Leg 2
INFO [2025-03-29 13:21:40] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:21:40] Training podium model using glm
INFO [2025-03-29 13:21:40] Training win model using glm
INFO [2025-03-29 13:21:40] Training top5 model using glm
INFO [2025-03-29 13:21:40] Training top10 model using glm
INFO [2025-03-29 13:21:40] Top features for Leg 2 podium prediction:
INFO [2025-03-29 13:21:40] Training models for Leg 3
INFO [2025-03-29 13:21:40] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:21:40] Training podium model using glm
INFO [2025-03-29 13:21:41] Training win model using glm
INFO [2025-03-29 13:21:41] Training top5 model using glm
INFO [2025-03-29 13:21:41] Training top10 model using glm
INFO [2025-03-29 13:21:41] Top features for Leg 3 podium prediction:
INFO [2025-03-29 13:21:41] Training models for Leg 4
INFO [2025-03-29 13:21:41] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:21:41] Training podium model using glm
INFO [2025-03-29 13:21:41] Training win model using glm
INFO [2025-03-29 13:21:41] Training top5 model using glm
INFO [2025-03-29 13:21:41] Training top10 model using glm
INFO [2025-03-29 13:21:41] Top features for Leg 4 podium prediction:
INFO [2025-03-29 13:21:41] Processing men's relay predictions
INFO [2025-03-29 13:21:41] Loaded men relay teams startlist with 24 rows
INFO [2025-03-29 13:21:41] Loaded men relay individuals startlist with 96 rows
INFO [2025-03-29 13:21:41] Preparing current men skier data
INFO [2025-03-29 13:21:41] Found 9 Elo columns for current skiers
INFO [2025-03-29 13:21:41] Replaced NAs in Distance_Elo with first quartile: 1207.23243912712
INFO [2025-03-29 13:21:41] Replaced NAs in Distance_C_Elo with first quartile: 1233.40200699225
INFO [2025-03-29 13:21:41] Replaced NAs in Distance_F_Elo with first quartile: 1236.48554062178
INFO [2025-03-29 13:21:41] Replaced NAs in Sprint_Elo with first quartile: 1223.60107000698
INFO [2025-03-29 13:21:41] Replaced NAs in Sprint_C_Elo with first quartile: 1241.28715500947
INFO [2025-03-29 13:21:41] Replaced NAs in Sprint_F_Elo with first quartile: 1234.45151108772
INFO [2025-03-29 13:21:41] Replaced NAs in Classic_Elo with first quartile: 1241.52867310024
INFO [2025-03-29 13:21:41] Replaced NAs in Freestyle_Elo with first quartile: 1228.48649348109
INFO [2025-03-29 13:21:41] Replaced NAs in Distance_Pelo with first quartile: 1211.63035979047
INFO [2025-03-29 13:21:41] Replaced NAs in Distance_C_Pelo with first quartile: 1234.81091928129
INFO [2025-03-29 13:21:41] Replaced NAs in Distance_F_Pelo with first quartile: 1239.65331180248
INFO [2025-03-29 13:21:41] Replaced NAs in Sprint_Pelo with first quartile: 1240.94751821383
INFO [2025-03-29 13:21:41] Replaced NAs in Sprint_C_Pelo with first quartile: 1241.28715500947
INFO [2025-03-29 13:21:41] Replaced NAs in Sprint_F_Pelo with first quartile: 1252.45166310493
INFO [2025-03-29 13:21:41] Replaced NAs in Classic_Pelo with first quartile: 1243.63746068082
INFO [2025-03-29 13:21:41] Replaced NAs in Freestyle_Pelo with first quartile: 1249.30280713791
INFO [2025-03-29 13:21:41] Replaced NAs in Classic_Last_5 with first quartile: 0
INFO [2025-03-29 13:21:41] Replaced NAs in Freestyle_Last_5 with first quartile: 0
INFO [2025-03-29 13:21:41] Created Pelo_Pct from Elo with max value: 1946.6211651574
INFO [2025-03-29 13:21:41] Created Distance_Pelo_Pct from Distance_Elo with max value: 1869.1251911742
INFO [2025-03-29 13:21:41] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1777.16297253153
INFO [2025-03-29 13:21:41] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1695.2053212904
INFO [2025-03-29 13:21:41] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1886.80363942481
INFO [2025-03-29 13:21:41] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1711.08486899169
INFO [2025-03-29 13:21:41] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1792.65157560707
INFO [2025-03-29 13:21:41] Created Classic_Pelo_Pct from Classic_Elo with max value: 1807.56773496777
INFO [2025-03-29 13:21:41] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1814.60460629541
INFO [2025-03-29 13:21:41] Prepared data for 381 men skiers with 33 features
INFO [2025-03-29 13:21:41] Using FIS startlist for men's leg predictions
INFO [2025-03-29 13:21:42] Using FIS startlist for men
INFO [2025-03-29 13:21:42] Attempting Option 1: Team model coefficients
INFO [2025-03-29 13:21:42] Option 1 failed: No team_podium model found
INFO [2025-03-29 13:21:42] Option 1 failed: No team model
INFO [2025-03-29 13:21:42] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 13:21:42] Leg 1 accuracy: 0.854903565166569
INFO [2025-03-29 13:21:42] Leg 2 accuracy: 0.847796610169491
INFO [2025-03-29 13:21:42] Leg 3 accuracy: 0.867545295149036
INFO [2025-03-29 13:21:42] Leg 4 accuracy: 0.88135593220339
INFO [2025-03-29 13:21:42] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 13:21:42] Leg importance weights: Leg 1: 0.25, Leg 2: 0.25, Leg 3: 0.25, Leg 4: 0.26
INFO [2025-03-29 13:21:42] Processing ladies's relay predictions
INFO [2025-03-29 13:21:42] Loaded ladies relay teams startlist with 35 rows
INFO [2025-03-29 13:21:42] Loaded ladies relay individuals startlist with 231 rows
INFO [2025-03-29 13:21:42] Preparing current ladies skier data
INFO [2025-03-29 13:21:42] Found 9 Elo columns for current skiers
INFO [2025-03-29 13:21:42] Replaced NAs in Distance_Elo with first quartile: 1237.38564383256
INFO [2025-03-29 13:21:42] Replaced NAs in Distance_C_Elo with first quartile: 1243.87329106944
INFO [2025-03-29 13:21:42] Replaced NAs in Distance_F_Elo with first quartile: 1256.69628195708
INFO [2025-03-29 13:21:42] Replaced NAs in Sprint_Elo with first quartile: 1246.32574824425
INFO [2025-03-29 13:21:42] Replaced NAs in Sprint_C_Elo with first quartile: 1257.67866787334
INFO [2025-03-29 13:21:42] Replaced NAs in Sprint_F_Elo with first quartile: 1244.84742904868
INFO [2025-03-29 13:21:42] Replaced NAs in Classic_Elo with first quartile: 1252.44868703669
INFO [2025-03-29 13:21:42] Replaced NAs in Freestyle_Elo with first quartile: 1244.44508230281
INFO [2025-03-29 13:21:42] Replaced NAs in Distance_Pelo with first quartile: 1241.11854419952
INFO [2025-03-29 13:21:42] Replaced NAs in Distance_C_Pelo with first quartile: 1245.57367555166
INFO [2025-03-29 13:21:42] Replaced NAs in Distance_F_Pelo with first quartile: 1259.54282973153
INFO [2025-03-29 13:21:42] Replaced NAs in Sprint_Pelo with first quartile: 1254.58885254623
INFO [2025-03-29 13:21:42] Replaced NAs in Sprint_C_Pelo with first quartile: 1257.58302026178
INFO [2025-03-29 13:21:42] Replaced NAs in Sprint_F_Pelo with first quartile: 1257.67755691493
INFO [2025-03-29 13:21:42] Replaced NAs in Classic_Pelo with first quartile: 1256.79275004544
INFO [2025-03-29 13:21:42] Replaced NAs in Freestyle_Pelo with first quartile: 1256.79999900008
INFO [2025-03-29 13:21:42] Replaced NAs in Classic_Last_5 with first quartile: 3.5
INFO [2025-03-29 13:21:42] Replaced NAs in Freestyle_Last_5 with first quartile: 2.4
INFO [2025-03-29 13:21:42] Created Pelo_Pct from Elo with max value: 1841.00191142018
INFO [2025-03-29 13:21:42] Created Distance_Pelo_Pct from Distance_Elo with max value: 1889.46974050597
INFO [2025-03-29 13:21:42] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1763.33572074398
INFO [2025-03-29 13:21:42] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1693.85026290322
INFO [2025-03-29 13:21:42] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1742.74758850835
INFO [2025-03-29 13:21:42] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1601.5820663103
INFO [2025-03-29 13:21:42] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1681.09824552997
INFO [2025-03-29 13:21:42] Created Classic_Pelo_Pct from Classic_Elo with max value: 1698.69428891549
INFO [2025-03-29 13:21:42] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1707.58410982918
INFO [2025-03-29 13:21:42] Prepared data for 255 ladies skiers with 33 features
INFO [2025-03-29 13:21:42] No FIS startlist, predicting for all skiers in all legs
INFO [2025-03-29 13:21:42] No valid FIS startlist for ladies, building optimized teams
INFO [2025-03-29 13:21:42] Attempting Option 1: Team model coefficients
INFO [2025-03-29 13:21:42] Option 1 failed: No team_podium model found
INFO [2025-03-29 13:21:42] Option 1 failed: No team model
INFO [2025-03-29 13:21:42] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 13:21:42] Leg 1 accuracy: 0.787179487179487
INFO [2025-03-29 13:21:42] Leg 2 accuracy: 0.833333333333333
INFO [2025-03-29 13:21:42] Leg 3 accuracy: 0.803846153846154
INFO [2025-03-29 13:21:42] Leg 4 accuracy: 0.796969696969697
INFO [2025-03-29 13:21:42] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 13:21:42] Using leg importance weights for team optimization: Leg 1: 0.24, Leg 2: 0.26, Leg 3: 0.25, Leg 4: 0.25
INFO [2025-03-29 13:21:42] Optimizing team for Sweden
INFO [2025-03-29 13:21:42] Optimizing team for Norway
INFO [2025-03-29 13:21:42] Optimizing team for Germany
INFO [2025-03-29 13:21:42] Optimizing team for USA
INFO [2025-03-29 13:21:42] Optimizing team for Austria
INFO [2025-03-29 13:21:42] Optimizing team for Finland
INFO [2025-03-29 13:21:42] Optimizing team for Czechia
INFO [2025-03-29 13:21:42] Optimizing team for Switzerland
INFO [2025-03-29 13:21:42] Optimizing team for Italy
INFO [2025-03-29 13:21:43] Optimizing team for France
INFO [2025-03-29 13:21:43] Optimizing team for Canada
INFO [2025-03-29 13:21:43] Optimizing team for Slovenia
INFO [2025-03-29 13:21:43] Optimizing team for Estonia
INFO [2025-03-29 13:21:43] Optimizing team for Australia
INFO [2025-03-29 13:21:43] Optimizing team for Ukraine
INFO [2025-03-29 13:21:43] Optimizing team for Kazakhstan
INFO [2025-03-29 13:21:43] Optimizing team for Armenia
INFO [2025-03-29 13:21:43] Optimizing team for Latvia
INFO [2025-03-29 13:21:43] Optimizing team for Japan
INFO [2025-03-29 13:21:43] Optimizing team for Poland
INFO [2025-03-29 13:21:43] Optimizing team for South Korea
INFO [2025-03-29 13:21:43] Optimizing team for Andorra
INFO [2025-03-29 13:21:43] Optimizing team for Taiwan
INFO [2025-03-29 13:21:43] Optimizing team for China
INFO [2025-03-29 13:21:43] Optimizing team for Croatia
INFO [2025-03-29 13:21:43] Optimizing team for Slovakia
INFO [2025-03-29 13:21:43] Optimizing team for Argentina
INFO [2025-03-29 13:21:43] Optimizing team for Mongolia
INFO [2025-03-29 13:21:43] Optimizing team for Brazil
INFO [2025-03-29 13:21:43] Optimizing team for Lithuania
INFO [2025-03-29 13:21:43] Optimizing team for Greece
INFO [2025-03-29 13:21:43] Optimizing team for Iceland
INFO [2025-03-29 13:21:43] Optimizing team for Bulgaria
INFO [2025-03-29 13:21:43] Optimizing team for Serbia
INFO [2025-03-29 13:21:43] Optimizing team for Hungary
INFO [2025-03-29 13:21:43] Optimizing team for Turkey
INFO [2025-03-29 13:21:43] Optimizing team for North Macedonia
INFO [2025-03-29 13:21:43] Optimizing team for Romania
INFO [2025-03-29 13:21:43] Optimizing team for Bosnia&Herzegovina
INFO [2025-03-29 13:21:43] Optimizing team for Mexico
INFO [2025-03-29 13:21:43] Optimizing team for Iran
INFO [2025-03-29 13:21:43] Optimizing team for Chile
INFO [2025-03-29 13:21:43] Optimizing team for India
INFO [2025-03-29 13:21:43] Optimizing team for Malaysia
INFO [2025-03-29 13:21:43] Optimizing team for Haiti
INFO [2025-03-29 13:21:43] Optimizing team for Lebanon
INFO [2025-03-29 13:21:43] Optimizing team for Liechtenstein
WARN [2025-03-29 13:21:43] Could not read individuals file: invalid 'description' argument
WARN [2025-03-29 13:21:43] Could not read teams file: invalid 'description' argument
INFO [2025-03-29 13:21:43] Resetting men's probabilities at or below the mode to zero
INFO [2025-03-29 13:21:43] No values appear more than twice for Win_Prob
INFO [2025-03-29 13:21:43] No values appear more than twice for Podium_Prob
INFO [2025-03-29 13:21:43] No values appear more than twice for Top5_Prob
INFO [2025-03-29 13:21:43] No values appear more than twice for Top10_Prob
INFO [2025-03-29 13:21:43] Resetting ladies' probabilities at or below the mode to zero
INFO [2025-03-29 13:21:43] Reset 20 values to 0 for Win_Prob (repeated values or values <  0 )
INFO [2025-03-29 13:21:43] Repeated values: 0, 0, 0, 0
INFO [2025-03-29 13:21:43] No values appear more than twice for Podium_Prob
INFO [2025-03-29 13:21:43] No values appear more than twice for Top5_Prob
INFO [2025-03-29 13:21:43] No values appear more than twice for Top10_Prob
INFO [2025-03-29 13:21:43] Normalizing men's team probabilities
INFO [2025-03-29 13:21:43] Normalized Win_Prob from sum of 0.72 to 1
INFO [2025-03-29 13:21:43] Normalized Podium_Prob from sum of 2.34 to 3
INFO [2025-03-29 13:21:43] Normalized Top5_Prob from sum of 4.2 to 5
INFO [2025-03-29 13:21:43] Normalized Top10_Prob from sum of 10.33 to 10
INFO [2025-03-29 13:21:43] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 13:21:43] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 13:21:43] Normalizing ladies' team probabilities
INFO [2025-03-29 13:21:43] Normalized Win_Prob from sum of 1.77 to 1
INFO [2025-03-29 13:21:43] Normalized Podium_Prob from sum of 4.28 to 3
INFO [2025-03-29 13:21:43] Normalized Top5_Prob from sum of 5.13 to 5
INFO [2025-03-29 13:21:43] Normalized Top10_Prob from sum of 13.58 to 10
INFO [2025-03-29 13:21:43] Final capping of probabilities to maximum of 1
INFO [2025-03-29 13:21:43] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 13:21:43] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 13:21:43] Optimizing fantasy relay team
INFO [2025-03-29 13:21:44] Fantasy team optimization complete. Selected 6 teams.
INFO [2025-03-29 13:21:44] Total price: 92546 of max 1e+05
INFO [2025-03-29 13:21:44] Expected total points: 543.1
INFO [2025-03-29 13:21:44] Men's teams: 6 ( 6 )
INFO [2025-03-29 13:21:44] Ladies' teams: 0 ( 0 )
INFO [2025-03-29 13:21:44] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_points.xlsx
INFO [2025-03-29 13:21:44] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_probabilities.xlsx
INFO [2025-03-29 13:21:44] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_points.xlsx
INFO [2025-03-29 13:21:44] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_probabilities.xlsx
INFO [2025-03-29 13:21:44] Saved fantasy team results to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/fantasy_relay_team.xlsx
INFO [2025-03-29 13:21:44] Relay predictions completed successfully
INFO [2025-03-29 13:25:03] Starting relay predictions process
INFO [2025-03-29 13:25:03] Loading weekend race data
INFO [2025-03-29 13:25:03] Tomorrow's date: 2025-03-29
INFO [2025-03-29 13:25:03] Found 1 men's relay races and 1 ladies' relay races
INFO [2025-03-29 13:25:03] Loading chrono data
INFO [2025-03-29 13:25:09] Loaded men's chrono with 105122 rows and 36 columns
INFO [2025-03-29 13:25:09] Loaded ladies' chrono with 78706 rows and 36 columns
INFO [2025-03-29 13:25:09] Created men's relay df with 9688 rows
INFO [2025-03-29 13:25:09] Created men's individual df with 92143 rows
INFO [2025-03-29 13:25:09] Created ladies' relay df with 8019 rows
INFO [2025-03-29 13:25:09] Created ladies' individual df with 68253 rows
INFO [2025-03-29 13:25:14] Training models for Leg 1
INFO [2025-03-29 13:25:14] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:25:14] Training podium model using glm
INFO [2025-03-29 13:25:14] Training win model using glm
INFO [2025-03-29 13:25:14] Training top5 model using glm
INFO [2025-03-29 13:25:14] Training top10 model using glm
INFO [2025-03-29 13:25:14] Top features for Leg 1 podium prediction:
INFO [2025-03-29 13:25:14] Training models for Leg 2
INFO [2025-03-29 13:25:14] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:25:14] Training podium model using glm
INFO [2025-03-29 13:25:15] Training win model using glm
INFO [2025-03-29 13:25:15] Training top5 model using glm
INFO [2025-03-29 13:25:15] Training top10 model using glm
INFO [2025-03-29 13:25:15] Top features for Leg 2 podium prediction:
INFO [2025-03-29 13:25:15] Training models for Leg 3
INFO [2025-03-29 13:25:15] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:25:15] Training podium model using glm
INFO [2025-03-29 13:25:15] Training win model using glm
INFO [2025-03-29 13:25:15] Training top5 model using glm
INFO [2025-03-29 13:25:15] Training top10 model using glm
INFO [2025-03-29 13:25:15] Top features for Leg 3 podium prediction:
INFO [2025-03-29 13:25:15] Training models for Leg 4
INFO [2025-03-29 13:25:15] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:25:15] Training podium model using glm
INFO [2025-03-29 13:25:15] Training win model using glm
INFO [2025-03-29 13:25:15] Training top5 model using glm
INFO [2025-03-29 13:25:15] Training top10 model using glm
INFO [2025-03-29 13:25:15] Top features for Leg 4 podium prediction:
INFO [2025-03-29 13:25:15] Training models for Leg 1
INFO [2025-03-29 13:25:15] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:25:15] Training podium model using glm
INFO [2025-03-29 13:25:16] Training win model using glm
INFO [2025-03-29 13:25:16] Training top5 model using glm
INFO [2025-03-29 13:25:16] Training top10 model using glm
INFO [2025-03-29 13:25:16] Top features for Leg 1 podium prediction:
INFO [2025-03-29 13:25:16] Training models for Leg 2
INFO [2025-03-29 13:25:16] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:25:16] Training podium model using glm
INFO [2025-03-29 13:25:16] Training win model using glm
INFO [2025-03-29 13:25:16] Training top5 model using glm
INFO [2025-03-29 13:25:16] Training top10 model using glm
INFO [2025-03-29 13:25:16] Top features for Leg 2 podium prediction:
INFO [2025-03-29 13:25:16] Training models for Leg 3
INFO [2025-03-29 13:25:16] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:25:16] Training podium model using glm
INFO [2025-03-29 13:25:16] Training win model using glm
INFO [2025-03-29 13:25:16] Training top5 model using glm
INFO [2025-03-29 13:25:16] Training top10 model using glm
INFO [2025-03-29 13:25:17] Top features for Leg 3 podium prediction:
INFO [2025-03-29 13:25:17] Training models for Leg 4
INFO [2025-03-29 13:25:17] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:25:17] Training podium model using glm
INFO [2025-03-29 13:25:17] Training win model using glm
INFO [2025-03-29 13:25:17] Training top5 model using glm
INFO [2025-03-29 13:25:17] Training top10 model using glm
INFO [2025-03-29 13:25:17] Top features for Leg 4 podium prediction:
INFO [2025-03-29 13:25:17] Processing men's relay predictions
INFO [2025-03-29 13:25:17] Loaded men relay teams startlist with 24 rows
INFO [2025-03-29 13:25:17] Loaded men relay individuals startlist with 96 rows
INFO [2025-03-29 13:25:17] Preparing current men skier data
INFO [2025-03-29 13:25:17] Found 9 Elo columns for current skiers
INFO [2025-03-29 13:25:17] Replaced NAs in Distance_Elo with first quartile: 1207.23243912712
INFO [2025-03-29 13:25:17] Replaced NAs in Distance_C_Elo with first quartile: 1233.40200699225
INFO [2025-03-29 13:25:17] Replaced NAs in Distance_F_Elo with first quartile: 1236.48554062178
INFO [2025-03-29 13:25:17] Replaced NAs in Sprint_Elo with first quartile: 1223.60107000698
INFO [2025-03-29 13:25:17] Replaced NAs in Sprint_C_Elo with first quartile: 1241.28715500947
INFO [2025-03-29 13:25:17] Replaced NAs in Sprint_F_Elo with first quartile: 1234.45151108772
INFO [2025-03-29 13:25:17] Replaced NAs in Classic_Elo with first quartile: 1241.52867310024
INFO [2025-03-29 13:25:17] Replaced NAs in Freestyle_Elo with first quartile: 1228.48649348109
INFO [2025-03-29 13:25:17] Replaced NAs in Distance_Pelo with first quartile: 1211.63035979047
INFO [2025-03-29 13:25:17] Replaced NAs in Distance_C_Pelo with first quartile: 1234.81091928129
INFO [2025-03-29 13:25:17] Replaced NAs in Distance_F_Pelo with first quartile: 1239.65331180248
INFO [2025-03-29 13:25:17] Replaced NAs in Sprint_Pelo with first quartile: 1240.94751821383
INFO [2025-03-29 13:25:17] Replaced NAs in Sprint_C_Pelo with first quartile: 1241.28715500947
INFO [2025-03-29 13:25:17] Replaced NAs in Sprint_F_Pelo with first quartile: 1252.45166310493
INFO [2025-03-29 13:25:17] Replaced NAs in Classic_Pelo with first quartile: 1243.63746068082
INFO [2025-03-29 13:25:17] Replaced NAs in Freestyle_Pelo with first quartile: 1249.30280713791
INFO [2025-03-29 13:25:17] Replaced NAs in Classic_Last_5 with first quartile: 0
INFO [2025-03-29 13:25:17] Replaced NAs in Freestyle_Last_5 with first quartile: 0
INFO [2025-03-29 13:25:17] Created Pelo_Pct from Elo with max value: 1946.6211651574
INFO [2025-03-29 13:25:17] Created Distance_Pelo_Pct from Distance_Elo with max value: 1869.1251911742
INFO [2025-03-29 13:25:17] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1777.16297253153
INFO [2025-03-29 13:25:17] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1695.2053212904
INFO [2025-03-29 13:25:17] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1886.80363942481
INFO [2025-03-29 13:25:17] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1711.08486899169
INFO [2025-03-29 13:25:17] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1792.65157560707
INFO [2025-03-29 13:25:17] Created Classic_Pelo_Pct from Classic_Elo with max value: 1807.56773496777
INFO [2025-03-29 13:25:17] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1814.60460629541
INFO [2025-03-29 13:25:17] Prepared data for 381 men skiers with 33 features
INFO [2025-03-29 13:25:17] Using FIS startlist for men's leg predictions
INFO [2025-03-29 13:25:17] Using FIS startlist for men
INFO [2025-03-29 13:25:17] Attempting Option 1: Team model coefficients
INFO [2025-03-29 13:25:17] Option 1 failed: No team_podium model found
INFO [2025-03-29 13:25:17] Option 1 failed: No team model
INFO [2025-03-29 13:25:17] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 13:25:17] Leg 1 accuracy: 0.851242937853107
INFO [2025-03-29 13:25:17] Leg 2 accuracy: 0.858022598870056
INFO [2025-03-29 13:25:17] Leg 3 accuracy: 0.864095071108514
INFO [2025-03-29 13:25:17] Leg 4 accuracy: 0.887765439314241
INFO [2025-03-29 13:25:17] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 13:25:17] Leg importance weights: Leg 1: 0.25, Leg 2: 0.25, Leg 3: 0.25, Leg 4: 0.26
INFO [2025-03-29 13:25:17] Processing ladies's relay predictions
INFO [2025-03-29 13:25:18] Loaded ladies relay teams startlist with 35 rows
INFO [2025-03-29 13:25:18] Loaded ladies relay individuals startlist with 231 rows
INFO [2025-03-29 13:25:18] Preparing current ladies skier data
INFO [2025-03-29 13:25:18] Found 9 Elo columns for current skiers
INFO [2025-03-29 13:25:18] Replaced NAs in Distance_Elo with first quartile: 1237.38564383256
INFO [2025-03-29 13:25:18] Replaced NAs in Distance_C_Elo with first quartile: 1243.87329106944
INFO [2025-03-29 13:25:18] Replaced NAs in Distance_F_Elo with first quartile: 1256.69628195708
INFO [2025-03-29 13:25:18] Replaced NAs in Sprint_Elo with first quartile: 1246.32574824425
INFO [2025-03-29 13:25:18] Replaced NAs in Sprint_C_Elo with first quartile: 1257.67866787334
INFO [2025-03-29 13:25:18] Replaced NAs in Sprint_F_Elo with first quartile: 1244.84742904868
INFO [2025-03-29 13:25:18] Replaced NAs in Classic_Elo with first quartile: 1252.44868703669
INFO [2025-03-29 13:25:18] Replaced NAs in Freestyle_Elo with first quartile: 1244.44508230281
INFO [2025-03-29 13:25:18] Replaced NAs in Distance_Pelo with first quartile: 1241.11854419952
INFO [2025-03-29 13:25:18] Replaced NAs in Distance_C_Pelo with first quartile: 1245.57367555166
INFO [2025-03-29 13:25:18] Replaced NAs in Distance_F_Pelo with first quartile: 1259.54282973153
INFO [2025-03-29 13:25:18] Replaced NAs in Sprint_Pelo with first quartile: 1254.58885254623
INFO [2025-03-29 13:25:18] Replaced NAs in Sprint_C_Pelo with first quartile: 1257.58302026178
INFO [2025-03-29 13:25:18] Replaced NAs in Sprint_F_Pelo with first quartile: 1257.67755691493
INFO [2025-03-29 13:25:18] Replaced NAs in Classic_Pelo with first quartile: 1256.79275004544
INFO [2025-03-29 13:25:18] Replaced NAs in Freestyle_Pelo with first quartile: 1256.79999900008
INFO [2025-03-29 13:25:18] Replaced NAs in Classic_Last_5 with first quartile: 3.5
INFO [2025-03-29 13:25:18] Replaced NAs in Freestyle_Last_5 with first quartile: 2.4
INFO [2025-03-29 13:25:18] Created Pelo_Pct from Elo with max value: 1841.00191142018
INFO [2025-03-29 13:25:18] Created Distance_Pelo_Pct from Distance_Elo with max value: 1889.46974050597
INFO [2025-03-29 13:25:18] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1763.33572074398
INFO [2025-03-29 13:25:18] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1693.85026290322
INFO [2025-03-29 13:25:18] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1742.74758850835
INFO [2025-03-29 13:25:18] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1601.5820663103
INFO [2025-03-29 13:25:18] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1681.09824552997
INFO [2025-03-29 13:25:18] Created Classic_Pelo_Pct from Classic_Elo with max value: 1698.69428891549
INFO [2025-03-29 13:25:18] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1707.58410982918
INFO [2025-03-29 13:25:18] Prepared data for 255 ladies skiers with 33 features
INFO [2025-03-29 13:25:18] No FIS startlist, predicting for all skiers in all legs
INFO [2025-03-29 13:25:18] No valid FIS startlist for ladies, building optimized teams
INFO [2025-03-29 13:25:18] Attempting Option 1: Team model coefficients
INFO [2025-03-29 13:25:18] Option 1 failed: No team_podium model found
INFO [2025-03-29 13:25:18] Option 1 failed: No team model
INFO [2025-03-29 13:25:18] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 13:25:18] Leg 1 accuracy: 0.787179487179487
INFO [2025-03-29 13:25:18] Leg 2 accuracy: 0.866666666666667
INFO [2025-03-29 13:25:18] Leg 3 accuracy: 0.817948717948718
INFO [2025-03-29 13:25:18] Leg 4 accuracy: 0.815151515151515
INFO [2025-03-29 13:25:18] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 13:25:18] Using leg importance weights for team optimization: Leg 1: 0.24, Leg 2: 0.26, Leg 3: 0.25, Leg 4: 0.25
INFO [2025-03-29 13:25:18] Optimizing team for Sweden
INFO [2025-03-29 13:25:18] Optimizing team for Norway
INFO [2025-03-29 13:25:18] Optimizing team for Germany
INFO [2025-03-29 13:25:18] Optimizing team for USA
INFO [2025-03-29 13:25:18] Optimizing team for Austria
INFO [2025-03-29 13:25:18] Optimizing team for Finland
INFO [2025-03-29 13:25:18] Optimizing team for Czechia
INFO [2025-03-29 13:25:18] Optimizing team for Switzerland
INFO [2025-03-29 13:25:18] Optimizing team for Italy
INFO [2025-03-29 13:25:18] Optimizing team for France
INFO [2025-03-29 13:25:18] Optimizing team for Canada
INFO [2025-03-29 13:25:18] Optimizing team for Slovenia
INFO [2025-03-29 13:25:19] Optimizing team for Estonia
INFO [2025-03-29 13:25:19] Optimizing team for Australia
INFO [2025-03-29 13:25:19] Optimizing team for Ukraine
INFO [2025-03-29 13:25:19] Optimizing team for Kazakhstan
INFO [2025-03-29 13:25:19] Optimizing team for Armenia
INFO [2025-03-29 13:25:19] Optimizing team for Latvia
INFO [2025-03-29 13:25:19] Optimizing team for Japan
INFO [2025-03-29 13:25:19] Optimizing team for Poland
INFO [2025-03-29 13:25:19] Optimizing team for South Korea
INFO [2025-03-29 13:25:19] Optimizing team for Andorra
INFO [2025-03-29 13:25:19] Optimizing team for Taiwan
INFO [2025-03-29 13:25:19] Optimizing team for China
INFO [2025-03-29 13:25:19] Optimizing team for Croatia
INFO [2025-03-29 13:25:19] Optimizing team for Slovakia
INFO [2025-03-29 13:25:19] Optimizing team for Argentina
INFO [2025-03-29 13:25:19] Optimizing team for Mongolia
INFO [2025-03-29 13:25:19] Optimizing team for Brazil
INFO [2025-03-29 13:25:19] Optimizing team for Lithuania
INFO [2025-03-29 13:25:19] Optimizing team for Greece
INFO [2025-03-29 13:25:19] Optimizing team for Iceland
INFO [2025-03-29 13:25:19] Optimizing team for Bulgaria
INFO [2025-03-29 13:25:19] Optimizing team for Serbia
INFO [2025-03-29 13:25:19] Optimizing team for Hungary
INFO [2025-03-29 13:25:19] Optimizing team for Turkey
INFO [2025-03-29 13:25:19] Optimizing team for North Macedonia
INFO [2025-03-29 13:25:19] Optimizing team for Romania
INFO [2025-03-29 13:25:19] Optimizing team for Bosnia&Herzegovina
INFO [2025-03-29 13:25:19] Optimizing team for Mexico
INFO [2025-03-29 13:25:19] Optimizing team for Iran
INFO [2025-03-29 13:25:19] Optimizing team for Chile
INFO [2025-03-29 13:25:19] Optimizing team for India
INFO [2025-03-29 13:25:19] Optimizing team for Malaysia
INFO [2025-03-29 13:25:19] Optimizing team for Haiti
INFO [2025-03-29 13:25:19] Optimizing team for Lebanon
INFO [2025-03-29 13:25:19] Optimizing team for Liechtenstein
WARN [2025-03-29 13:25:19] Could not read individuals file: invalid 'description' argument
WARN [2025-03-29 13:25:19] Could not read teams file: invalid 'description' argument
INFO [2025-03-29 13:25:19] Resetting men's probabilities at or below the mode to zero
INFO [2025-03-29 13:25:19] No values appear more than twice for Win_Prob
INFO [2025-03-29 13:25:19] No values appear more than twice for Podium_Prob
INFO [2025-03-29 13:25:19] No values appear more than twice for Top5_Prob
INFO [2025-03-29 13:25:19] No values appear more than twice for Top10_Prob
INFO [2025-03-29 13:25:19] Resetting ladies' probabilities at or below the mode to zero
INFO [2025-03-29 13:25:19] Reset 20 values to 0 for Win_Prob (repeated values or values <  0 )
INFO [2025-03-29 13:25:19] Repeated values: 0, 0, 0, 0, 0
INFO [2025-03-29 13:25:19] No values appear more than twice for Podium_Prob
INFO [2025-03-29 13:25:19] No values appear more than twice for Top5_Prob
INFO [2025-03-29 13:25:19] No values appear more than twice for Top10_Prob
INFO [2025-03-29 13:25:19] Normalizing men's team probabilities
INFO [2025-03-29 13:25:19] Normalized Win_Prob from sum of 0.72 to 1
INFO [2025-03-29 13:25:19] Normalized Podium_Prob from sum of 2.35 to 3
INFO [2025-03-29 13:25:19] Normalized Top5_Prob from sum of 4.21 to 5
INFO [2025-03-29 13:25:19] Normalized Top10_Prob from sum of 10.33 to 10
INFO [2025-03-29 13:25:19] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 13:25:19] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 13:25:19] Normalizing ladies' team probabilities
INFO [2025-03-29 13:25:19] Normalized Win_Prob from sum of 1.77 to 1
INFO [2025-03-29 13:25:19] Normalized Podium_Prob from sum of 4.27 to 3
INFO [2025-03-29 13:25:19] Normalized Top5_Prob from sum of 5.11 to 5
INFO [2025-03-29 13:25:19] Normalized Top10_Prob from sum of 13.51 to 10
INFO [2025-03-29 13:25:19] Final capping of probabilities to maximum of 1
INFO [2025-03-29 13:25:19] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 13:25:19] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 13:25:19] Optimizing fantasy relay team
INFO [2025-03-29 13:25:20] Fantasy team optimization complete. Selected 6 teams.
INFO [2025-03-29 13:25:20] Total price: 92546 of max 1e+05
INFO [2025-03-29 13:25:20] Expected total points: 543.5
INFO [2025-03-29 13:25:20] Men's teams: 6 ( 6 )
INFO [2025-03-29 13:25:20] Ladies' teams: 0 ( 0 )
INFO [2025-03-29 13:25:20] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_points.xlsx
INFO [2025-03-29 13:25:20] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_probabilities.xlsx
INFO [2025-03-29 13:25:20] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_points.xlsx
INFO [2025-03-29 13:25:20] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_probabilities.xlsx
INFO [2025-03-29 13:25:20] Saved fantasy team results to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/fantasy_relay_team.xlsx
INFO [2025-03-29 13:25:20] Relay predictions completed successfully
INFO [2025-03-29 13:28:19] Starting relay predictions process
INFO [2025-03-29 13:28:19] Loading weekend race data
INFO [2025-03-29 13:28:19] Tomorrow's date: 2025-03-29
INFO [2025-03-29 13:28:19] Found 1 men's relay races and 1 ladies' relay races
INFO [2025-03-29 13:28:19] Loading chrono data
INFO [2025-03-29 13:28:24] Loaded men's chrono with 105122 rows and 36 columns
INFO [2025-03-29 13:28:24] Loaded ladies' chrono with 78706 rows and 36 columns
INFO [2025-03-29 13:28:24] Created men's relay df with 9688 rows
INFO [2025-03-29 13:28:24] Created men's individual df with 92143 rows
INFO [2025-03-29 13:28:24] Created ladies' relay df with 8019 rows
INFO [2025-03-29 13:28:24] Created ladies' individual df with 68253 rows
INFO [2025-03-29 13:28:29] Training models for Leg 1
INFO [2025-03-29 13:28:29] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:28:29] Training podium model using glm
INFO [2025-03-29 13:28:29] Training win model using glm
INFO [2025-03-29 13:28:30] Training top5 model using glm
INFO [2025-03-29 13:28:30] Training top10 model using glm
INFO [2025-03-29 13:28:30] Top features for Leg 1 podium prediction:
INFO [2025-03-29 13:28:30] Training models for Leg 2
INFO [2025-03-29 13:28:30] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:28:30] Training podium model using glm
INFO [2025-03-29 13:28:30] Training win model using glm
INFO [2025-03-29 13:28:30] Training top5 model using glm
INFO [2025-03-29 13:28:30] Training top10 model using glm
INFO [2025-03-29 13:28:30] Top features for Leg 2 podium prediction:
INFO [2025-03-29 13:28:30] Training models for Leg 3
INFO [2025-03-29 13:28:30] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:28:30] Training podium model using glm
INFO [2025-03-29 13:28:30] Training win model using glm
INFO [2025-03-29 13:28:30] Training top5 model using glm
INFO [2025-03-29 13:28:30] Training top10 model using glm
INFO [2025-03-29 13:28:30] Top features for Leg 3 podium prediction:
INFO [2025-03-29 13:28:30] Training models for Leg 4
INFO [2025-03-29 13:28:30] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:28:30] Training podium model using glm
INFO [2025-03-29 13:28:30] Training win model using glm
INFO [2025-03-29 13:28:31] Training top5 model using glm
INFO [2025-03-29 13:28:31] Training top10 model using glm
INFO [2025-03-29 13:28:31] Top features for Leg 4 podium prediction:
INFO [2025-03-29 13:28:31] Training models for Leg 1
INFO [2025-03-29 13:28:31] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:28:31] Training podium model using glm
INFO [2025-03-29 13:28:31] Training win model using glm
INFO [2025-03-29 13:28:31] Training top5 model using glm
INFO [2025-03-29 13:28:31] Training top10 model using glm
INFO [2025-03-29 13:28:31] Top features for Leg 1 podium prediction:
INFO [2025-03-29 13:28:31] Training models for Leg 2
INFO [2025-03-29 13:28:31] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:28:31] Training podium model using glm
INFO [2025-03-29 13:28:31] Training win model using glm
INFO [2025-03-29 13:28:31] Training top5 model using glm
INFO [2025-03-29 13:28:31] Training top10 model using glm
INFO [2025-03-29 13:28:31] Top features for Leg 2 podium prediction:
INFO [2025-03-29 13:28:31] Training models for Leg 3
INFO [2025-03-29 13:28:31] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:28:31] Training podium model using glm
INFO [2025-03-29 13:28:31] Training win model using glm
INFO [2025-03-29 13:28:32] Training top5 model using glm
INFO [2025-03-29 13:28:32] Training top10 model using glm
INFO [2025-03-29 13:28:32] Top features for Leg 3 podium prediction:
INFO [2025-03-29 13:28:32] Training models for Leg 4
INFO [2025-03-29 13:28:32] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:28:32] Training podium model using glm
INFO [2025-03-29 13:28:32] Training win model using glm
INFO [2025-03-29 13:28:32] Training top5 model using glm
INFO [2025-03-29 13:28:32] Training top10 model using glm
INFO [2025-03-29 13:28:32] Top features for Leg 4 podium prediction:
INFO [2025-03-29 13:28:32] Processing men's relay predictions
INFO [2025-03-29 13:28:32] Loaded men relay teams startlist with 24 rows
INFO [2025-03-29 13:28:32] Loaded men relay individuals startlist with 96 rows
INFO [2025-03-29 13:28:32] Preparing current men skier data
INFO [2025-03-29 13:28:32] Found 9 Elo columns for current skiers
INFO [2025-03-29 13:28:32] Replaced NAs in Distance_Elo with first quartile: 1207.23243912712
INFO [2025-03-29 13:28:32] Replaced NAs in Distance_C_Elo with first quartile: 1233.40200699225
INFO [2025-03-29 13:28:32] Replaced NAs in Distance_F_Elo with first quartile: 1236.48554062178
INFO [2025-03-29 13:28:32] Replaced NAs in Sprint_Elo with first quartile: 1223.60107000698
INFO [2025-03-29 13:28:32] Replaced NAs in Sprint_C_Elo with first quartile: 1241.28715500947
INFO [2025-03-29 13:28:32] Replaced NAs in Sprint_F_Elo with first quartile: 1234.45151108772
INFO [2025-03-29 13:28:32] Replaced NAs in Classic_Elo with first quartile: 1241.52867310024
INFO [2025-03-29 13:28:32] Replaced NAs in Freestyle_Elo with first quartile: 1228.48649348109
INFO [2025-03-29 13:28:32] Replaced NAs in Distance_Pelo with first quartile: 1211.63035979047
INFO [2025-03-29 13:28:32] Replaced NAs in Distance_C_Pelo with first quartile: 1234.81091928129
INFO [2025-03-29 13:28:32] Replaced NAs in Distance_F_Pelo with first quartile: 1239.65331180248
INFO [2025-03-29 13:28:32] Replaced NAs in Sprint_Pelo with first quartile: 1240.94751821383
INFO [2025-03-29 13:28:32] Replaced NAs in Sprint_C_Pelo with first quartile: 1241.28715500947
INFO [2025-03-29 13:28:32] Replaced NAs in Sprint_F_Pelo with first quartile: 1252.45166310493
INFO [2025-03-29 13:28:32] Replaced NAs in Classic_Pelo with first quartile: 1243.63746068082
INFO [2025-03-29 13:28:32] Replaced NAs in Freestyle_Pelo with first quartile: 1249.30280713791
INFO [2025-03-29 13:28:32] Replaced NAs in Classic_Last_5 with first quartile: 0
INFO [2025-03-29 13:28:32] Replaced NAs in Freestyle_Last_5 with first quartile: 0
INFO [2025-03-29 13:28:32] Created Pelo_Pct from Elo with max value: 1946.6211651574
INFO [2025-03-29 13:28:32] Created Distance_Pelo_Pct from Distance_Elo with max value: 1869.1251911742
INFO [2025-03-29 13:28:32] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1777.16297253153
INFO [2025-03-29 13:28:32] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1695.2053212904
INFO [2025-03-29 13:28:32] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1886.80363942481
INFO [2025-03-29 13:28:32] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1711.08486899169
INFO [2025-03-29 13:28:32] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1792.65157560707
INFO [2025-03-29 13:28:32] Created Classic_Pelo_Pct from Classic_Elo with max value: 1807.56773496777
INFO [2025-03-29 13:28:32] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1814.60460629541
INFO [2025-03-29 13:28:32] Prepared data for 381 men skiers with 33 features
INFO [2025-03-29 13:28:32] Using FIS startlist for men's leg predictions
INFO [2025-03-29 13:28:32] Using FIS startlist for men
INFO [2025-03-29 13:28:32] Attempting Option 1: Team model coefficients
INFO [2025-03-29 13:28:32] Option 1 failed: No team_podium model found
INFO [2025-03-29 13:28:32] Option 1 failed: No team model
INFO [2025-03-29 13:28:32] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 13:28:32] Leg 1 accuracy: 0.854971751412429
INFO [2025-03-29 13:28:32] Leg 2 accuracy: 0.831285797779077
INFO [2025-03-29 13:28:32] Leg 3 accuracy: 0.86725696473797
INFO [2025-03-29 13:28:32] Leg 4 accuracy: 0.888340151957919
INFO [2025-03-29 13:28:32] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 13:28:32] Leg importance weights: Leg 1: 0.25, Leg 2: 0.24, Leg 3: 0.25, Leg 4: 0.26
INFO [2025-03-29 13:28:33] Processing ladies's relay predictions
INFO [2025-03-29 13:28:33] Loaded ladies relay teams startlist with 35 rows
INFO [2025-03-29 13:28:33] Loaded ladies relay individuals startlist with 231 rows
INFO [2025-03-29 13:28:33] Preparing current ladies skier data
INFO [2025-03-29 13:28:33] Found 9 Elo columns for current skiers
INFO [2025-03-29 13:28:33] Replaced NAs in Distance_Elo with first quartile: 1237.38564383256
INFO [2025-03-29 13:28:33] Replaced NAs in Distance_C_Elo with first quartile: 1243.87329106944
INFO [2025-03-29 13:28:33] Replaced NAs in Distance_F_Elo with first quartile: 1256.69628195708
INFO [2025-03-29 13:28:33] Replaced NAs in Sprint_Elo with first quartile: 1246.32574824425
INFO [2025-03-29 13:28:33] Replaced NAs in Sprint_C_Elo with first quartile: 1257.67866787334
INFO [2025-03-29 13:28:33] Replaced NAs in Sprint_F_Elo with first quartile: 1244.84742904868
INFO [2025-03-29 13:28:33] Replaced NAs in Classic_Elo with first quartile: 1252.44868703669
INFO [2025-03-29 13:28:33] Replaced NAs in Freestyle_Elo with first quartile: 1244.44508230281
INFO [2025-03-29 13:28:33] Replaced NAs in Distance_Pelo with first quartile: 1241.11854419952
INFO [2025-03-29 13:28:33] Replaced NAs in Distance_C_Pelo with first quartile: 1245.57367555166
INFO [2025-03-29 13:28:33] Replaced NAs in Distance_F_Pelo with first quartile: 1259.54282973153
INFO [2025-03-29 13:28:33] Replaced NAs in Sprint_Pelo with first quartile: 1254.58885254623
INFO [2025-03-29 13:28:33] Replaced NAs in Sprint_C_Pelo with first quartile: 1257.58302026178
INFO [2025-03-29 13:28:33] Replaced NAs in Sprint_F_Pelo with first quartile: 1257.67755691493
INFO [2025-03-29 13:28:33] Replaced NAs in Classic_Pelo with first quartile: 1256.79275004544
INFO [2025-03-29 13:28:33] Replaced NAs in Freestyle_Pelo with first quartile: 1256.79999900008
INFO [2025-03-29 13:28:33] Replaced NAs in Classic_Last_5 with first quartile: 3.5
INFO [2025-03-29 13:28:33] Replaced NAs in Freestyle_Last_5 with first quartile: 2.4
INFO [2025-03-29 13:28:33] Created Pelo_Pct from Elo with max value: 1841.00191142018
INFO [2025-03-29 13:28:33] Created Distance_Pelo_Pct from Distance_Elo with max value: 1889.46974050597
INFO [2025-03-29 13:28:33] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1763.33572074398
INFO [2025-03-29 13:28:33] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1693.85026290322
INFO [2025-03-29 13:28:33] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1742.74758850835
INFO [2025-03-29 13:28:33] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1601.5820663103
INFO [2025-03-29 13:28:33] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1681.09824552997
INFO [2025-03-29 13:28:33] Created Classic_Pelo_Pct from Classic_Elo with max value: 1698.69428891549
INFO [2025-03-29 13:28:33] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1707.58410982918
INFO [2025-03-29 13:28:33] Prepared data for 255 ladies skiers with 33 features
INFO [2025-03-29 13:28:33] No FIS startlist, predicting for all skiers in all legs
INFO [2025-03-29 13:28:33] No valid FIS startlist for ladies, building optimized teams
INFO [2025-03-29 13:28:33] Attempting Option 1: Team model coefficients
INFO [2025-03-29 13:28:33] Option 1 failed: No team_podium model found
INFO [2025-03-29 13:28:33] Option 1 failed: No team model
INFO [2025-03-29 13:28:33] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 13:28:33] Leg 1 accuracy: 0.787179487179487
INFO [2025-03-29 13:28:33] Leg 2 accuracy: 0.833333333333333
INFO [2025-03-29 13:28:33] Leg 3 accuracy: 0.817948717948718
INFO [2025-03-29 13:28:33] Leg 4 accuracy: 0.8
INFO [2025-03-29 13:28:33] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 13:28:33] Using leg importance weights for team optimization: Leg 1: 0.24, Leg 2: 0.26, Leg 3: 0.25, Leg 4: 0.25
INFO [2025-03-29 13:28:33] Optimizing team for Sweden
INFO [2025-03-29 13:28:33] Optimizing team for Norway
INFO [2025-03-29 13:28:33] Optimizing team for Germany
INFO [2025-03-29 13:28:33] Optimizing team for USA
INFO [2025-03-29 13:28:33] Optimizing team for Austria
INFO [2025-03-29 13:28:33] Optimizing team for Finland
INFO [2025-03-29 13:28:33] Optimizing team for Czechia
INFO [2025-03-29 13:28:33] Optimizing team for Switzerland
INFO [2025-03-29 13:28:33] Optimizing team for Italy
INFO [2025-03-29 13:28:33] Optimizing team for France
INFO [2025-03-29 13:28:33] Optimizing team for Canada
INFO [2025-03-29 13:28:33] Optimizing team for Slovenia
INFO [2025-03-29 13:28:33] Optimizing team for Estonia
INFO [2025-03-29 13:28:33] Optimizing team for Australia
INFO [2025-03-29 13:28:33] Optimizing team for Ukraine
INFO [2025-03-29 13:28:33] Optimizing team for Kazakhstan
INFO [2025-03-29 13:28:34] Optimizing team for Armenia
INFO [2025-03-29 13:28:34] Optimizing team for Latvia
INFO [2025-03-29 13:28:34] Optimizing team for Japan
INFO [2025-03-29 13:28:34] Optimizing team for Poland
INFO [2025-03-29 13:28:34] Optimizing team for South Korea
INFO [2025-03-29 13:28:34] Optimizing team for Andorra
INFO [2025-03-29 13:28:34] Optimizing team for Taiwan
INFO [2025-03-29 13:28:34] Optimizing team for China
INFO [2025-03-29 13:28:34] Optimizing team for Croatia
INFO [2025-03-29 13:28:34] Optimizing team for Slovakia
INFO [2025-03-29 13:28:34] Optimizing team for Argentina
INFO [2025-03-29 13:28:34] Optimizing team for Mongolia
INFO [2025-03-29 13:28:34] Optimizing team for Brazil
INFO [2025-03-29 13:28:34] Optimizing team for Lithuania
INFO [2025-03-29 13:28:34] Optimizing team for Greece
INFO [2025-03-29 13:28:34] Optimizing team for Iceland
INFO [2025-03-29 13:28:34] Optimizing team for Bulgaria
INFO [2025-03-29 13:28:34] Optimizing team for Serbia
INFO [2025-03-29 13:28:34] Optimizing team for Hungary
INFO [2025-03-29 13:28:34] Optimizing team for Turkey
INFO [2025-03-29 13:28:34] Optimizing team for North Macedonia
INFO [2025-03-29 13:28:34] Optimizing team for Romania
INFO [2025-03-29 13:28:34] Optimizing team for Bosnia&Herzegovina
INFO [2025-03-29 13:28:34] Optimizing team for Mexico
INFO [2025-03-29 13:28:34] Optimizing team for Iran
INFO [2025-03-29 13:28:34] Optimizing team for Chile
INFO [2025-03-29 13:28:34] Optimizing team for India
INFO [2025-03-29 13:28:34] Optimizing team for Malaysia
INFO [2025-03-29 13:28:34] Optimizing team for Haiti
INFO [2025-03-29 13:28:34] Optimizing team for Lebanon
INFO [2025-03-29 13:28:34] Optimizing team for Liechtenstein
WARN [2025-03-29 13:28:34] Could not read individuals file: invalid 'description' argument
WARN [2025-03-29 13:28:34] Could not read teams file: invalid 'description' argument
INFO [2025-03-29 13:28:34] Resetting men's probabilities at or below the mode to zero
INFO [2025-03-29 13:28:34] No values appear more than twice for Win_Prob
INFO [2025-03-29 13:28:34] No values appear more than twice for Podium_Prob
INFO [2025-03-29 13:28:34] No values appear more than twice for Top5_Prob
INFO [2025-03-29 13:28:34] No values appear more than twice for Top10_Prob
INFO [2025-03-29 13:28:34] Resetting ladies' probabilities at or below the mode to zero
INFO [2025-03-29 13:28:34] Reset 20 values to 0 for Win_Prob (repeated values or values <  0 )
INFO [2025-03-29 13:28:34] Repeated values: 0, 0, 0, 0
INFO [2025-03-29 13:28:34] No values appear more than twice for Podium_Prob
INFO [2025-03-29 13:28:34] No values appear more than twice for Top5_Prob
INFO [2025-03-29 13:28:34] No values appear more than twice for Top10_Prob
INFO [2025-03-29 13:28:34] Normalizing men's team probabilities
INFO [2025-03-29 13:28:34] Normalized Win_Prob from sum of 0.71 to 1
INFO [2025-03-29 13:28:34] Normalized Podium_Prob from sum of 2.34 to 3
INFO [2025-03-29 13:28:34] Normalized Top5_Prob from sum of 4.2 to 5
INFO [2025-03-29 13:28:34] Normalized Top10_Prob from sum of 10.33 to 10
INFO [2025-03-29 13:28:34] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 13:28:34] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 13:28:34] Normalizing ladies' team probabilities
INFO [2025-03-29 13:28:34] Normalized Win_Prob from sum of 1.76 to 1
INFO [2025-03-29 13:28:34] Normalized Podium_Prob from sum of 4.28 to 3
INFO [2025-03-29 13:28:34] Normalized Top5_Prob from sum of 5.13 to 5
INFO [2025-03-29 13:28:34] Normalized Top10_Prob from sum of 13.58 to 10
INFO [2025-03-29 13:28:34] Final capping of probabilities to maximum of 1
INFO [2025-03-29 13:28:34] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 13:28:34] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 13:28:34] Optimizing fantasy relay team
INFO [2025-03-29 13:28:34] Fantasy team optimization complete. Selected 6 teams.
INFO [2025-03-29 13:28:34] Total price: 92546 of max 1e+05
INFO [2025-03-29 13:28:34] Expected total points: 542.9
INFO [2025-03-29 13:28:34] Men's teams: 6 ( 6 )
INFO [2025-03-29 13:28:34] Ladies' teams: 0 ( 0 )
INFO [2025-03-29 13:28:34] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_points.xlsx
INFO [2025-03-29 13:28:34] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_probabilities.xlsx
INFO [2025-03-29 13:28:34] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_points.xlsx
INFO [2025-03-29 13:28:34] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_probabilities.xlsx
INFO [2025-03-29 13:28:35] Saved fantasy team results to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/fantasy_relay_team.xlsx
INFO [2025-03-29 13:28:35] Relay predictions completed successfully
INFO [2025-03-29 13:29:58] Starting relay predictions process
INFO [2025-03-29 13:29:58] Loading weekend race data
INFO [2025-03-29 13:29:58] Tomorrow's date: 2025-03-29
INFO [2025-03-29 13:29:58] Found 1 men's relay races and 1 ladies' relay races
INFO [2025-03-29 13:29:58] Loading chrono data
INFO [2025-03-29 13:30:03] Loaded men's chrono with 105122 rows and 36 columns
INFO [2025-03-29 13:30:03] Loaded ladies' chrono with 78706 rows and 36 columns
INFO [2025-03-29 13:30:03] Created men's relay df with 9688 rows
INFO [2025-03-29 13:30:03] Created men's individual df with 92143 rows
INFO [2025-03-29 13:30:03] Created ladies' relay df with 8019 rows
INFO [2025-03-29 13:30:03] Created ladies' individual df with 68253 rows
INFO [2025-03-29 13:30:08] Training models for Leg 1
INFO [2025-03-29 13:30:08] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:30:08] Training podium model using glm
INFO [2025-03-29 13:30:08] Training win model using glm
INFO [2025-03-29 13:30:08] Training top5 model using glm
INFO [2025-03-29 13:30:08] Training top10 model using glm
INFO [2025-03-29 13:30:08] Top features for Leg 1 podium prediction:
INFO [2025-03-29 13:30:08] Training models for Leg 2
INFO [2025-03-29 13:30:08] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:30:08] Training podium model using glm
INFO [2025-03-29 13:30:08] Training win model using glm
INFO [2025-03-29 13:30:08] Training top5 model using glm
INFO [2025-03-29 13:30:08] Training top10 model using glm
INFO [2025-03-29 13:30:08] Top features for Leg 2 podium prediction:
INFO [2025-03-29 13:30:08] Training models for Leg 3
INFO [2025-03-29 13:30:08] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:30:08] Training podium model using glm
INFO [2025-03-29 13:30:09] Training win model using glm
INFO [2025-03-29 13:30:09] Training top5 model using glm
INFO [2025-03-29 13:30:09] Training top10 model using glm
INFO [2025-03-29 13:30:09] Top features for Leg 3 podium prediction:
INFO [2025-03-29 13:30:09] Training models for Leg 4
INFO [2025-03-29 13:30:09] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:30:09] Training podium model using glm
INFO [2025-03-29 13:30:09] Training win model using glm
INFO [2025-03-29 13:30:09] Training top5 model using glm
INFO [2025-03-29 13:30:09] Training top10 model using glm
INFO [2025-03-29 13:30:09] Top features for Leg 4 podium prediction:
INFO [2025-03-29 13:30:09] Training models for Leg 1
INFO [2025-03-29 13:30:09] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:30:09] Training podium model using glm
INFO [2025-03-29 13:30:09] Training win model using glm
INFO [2025-03-29 13:30:09] Training top5 model using glm
INFO [2025-03-29 13:30:09] Training top10 model using glm
INFO [2025-03-29 13:30:09] Top features for Leg 1 podium prediction:
INFO [2025-03-29 13:30:09] Training models for Leg 2
INFO [2025-03-29 13:30:09] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:30:09] Training podium model using glm
INFO [2025-03-29 13:30:10] Training win model using glm
INFO [2025-03-29 13:30:10] Training top5 model using glm
INFO [2025-03-29 13:30:10] Training top10 model using glm
INFO [2025-03-29 13:30:10] Top features for Leg 2 podium prediction:
INFO [2025-03-29 13:30:10] Training models for Leg 3
INFO [2025-03-29 13:30:10] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:30:10] Training podium model using glm
INFO [2025-03-29 13:30:10] Training win model using glm
INFO [2025-03-29 13:30:10] Training top5 model using glm
INFO [2025-03-29 13:30:10] Training top10 model using glm
INFO [2025-03-29 13:30:10] Top features for Leg 3 podium prediction:
INFO [2025-03-29 13:30:10] Training models for Leg 4
INFO [2025-03-29 13:30:10] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:30:10] Training podium model using glm
INFO [2025-03-29 13:30:10] Training win model using glm
INFO [2025-03-29 13:30:10] Training top5 model using glm
INFO [2025-03-29 13:30:10] Training top10 model using glm
INFO [2025-03-29 13:30:10] Top features for Leg 4 podium prediction:
INFO [2025-03-29 13:30:10] Processing men's relay predictions
INFO [2025-03-29 13:30:10] Loaded men relay teams startlist with 24 rows
INFO [2025-03-29 13:30:10] Loaded men relay individuals startlist with 96 rows
INFO [2025-03-29 13:30:11] Preparing current men skier data
INFO [2025-03-29 13:30:11] Found 9 Elo columns for current skiers
INFO [2025-03-29 13:30:11] Replaced NAs in Distance_Elo with first quartile: 1207.23243912712
INFO [2025-03-29 13:30:11] Replaced NAs in Distance_C_Elo with first quartile: 1233.40200699225
INFO [2025-03-29 13:30:11] Replaced NAs in Distance_F_Elo with first quartile: 1236.48554062178
INFO [2025-03-29 13:30:11] Replaced NAs in Sprint_Elo with first quartile: 1223.60107000698
INFO [2025-03-29 13:30:11] Replaced NAs in Sprint_C_Elo with first quartile: 1241.28715500947
INFO [2025-03-29 13:30:11] Replaced NAs in Sprint_F_Elo with first quartile: 1234.45151108772
INFO [2025-03-29 13:30:11] Replaced NAs in Classic_Elo with first quartile: 1241.52867310024
INFO [2025-03-29 13:30:11] Replaced NAs in Freestyle_Elo with first quartile: 1228.48649348109
INFO [2025-03-29 13:30:11] Replaced NAs in Distance_Pelo with first quartile: 1211.63035979047
INFO [2025-03-29 13:30:11] Replaced NAs in Distance_C_Pelo with first quartile: 1234.81091928129
INFO [2025-03-29 13:30:11] Replaced NAs in Distance_F_Pelo with first quartile: 1239.65331180248
INFO [2025-03-29 13:30:11] Replaced NAs in Sprint_Pelo with first quartile: 1240.94751821383
INFO [2025-03-29 13:30:11] Replaced NAs in Sprint_C_Pelo with first quartile: 1241.28715500947
INFO [2025-03-29 13:30:11] Replaced NAs in Sprint_F_Pelo with first quartile: 1252.45166310493
INFO [2025-03-29 13:30:11] Replaced NAs in Classic_Pelo with first quartile: 1243.63746068082
INFO [2025-03-29 13:30:11] Replaced NAs in Freestyle_Pelo with first quartile: 1249.30280713791
INFO [2025-03-29 13:30:11] Replaced NAs in Classic_Last_5 with first quartile: 0
INFO [2025-03-29 13:30:11] Replaced NAs in Freestyle_Last_5 with first quartile: 0
INFO [2025-03-29 13:30:11] Created Pelo_Pct from Elo with max value: 1946.6211651574
INFO [2025-03-29 13:30:11] Created Distance_Pelo_Pct from Distance_Elo with max value: 1869.1251911742
INFO [2025-03-29 13:30:11] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1777.16297253153
INFO [2025-03-29 13:30:11] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1695.2053212904
INFO [2025-03-29 13:30:11] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1886.80363942481
INFO [2025-03-29 13:30:11] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1711.08486899169
INFO [2025-03-29 13:30:11] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1792.65157560707
INFO [2025-03-29 13:30:11] Created Classic_Pelo_Pct from Classic_Elo with max value: 1807.56773496777
INFO [2025-03-29 13:30:11] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1814.60460629541
INFO [2025-03-29 13:30:11] Prepared data for 381 men skiers with 33 features
INFO [2025-03-29 13:30:11] Using FIS startlist for men's leg predictions
INFO [2025-03-29 13:30:11] Using FIS startlist for men
INFO [2025-03-29 13:30:11] Attempting Option 1: Team model coefficients
INFO [2025-03-29 13:30:11] Option 1 failed: No team_podium model found
INFO [2025-03-29 13:30:11] Option 1 failed: No team model
INFO [2025-03-29 13:30:11] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 13:30:11] Leg 1 accuracy: 0.848118059614261
INFO [2025-03-29 13:30:11] Leg 2 accuracy: 0.85135593220339
INFO [2025-03-29 13:30:11] Leg 3 accuracy: 0.874268458990844
INFO [2025-03-29 13:30:11] Leg 4 accuracy: 0.898061562439119
INFO [2025-03-29 13:30:11] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 13:30:11] Leg importance weights: Leg 1: 0.24, Leg 2: 0.25, Leg 3: 0.25, Leg 4: 0.26
INFO [2025-03-29 13:30:11] Processing ladies's relay predictions
INFO [2025-03-29 13:30:11] Loaded ladies relay teams startlist with 35 rows
INFO [2025-03-29 13:30:11] Loaded ladies relay individuals startlist with 231 rows
INFO [2025-03-29 13:30:11] Preparing current ladies skier data
INFO [2025-03-29 13:30:11] Found 9 Elo columns for current skiers
INFO [2025-03-29 13:30:11] Replaced NAs in Distance_Elo with first quartile: 1237.38564383256
INFO [2025-03-29 13:30:11] Replaced NAs in Distance_C_Elo with first quartile: 1243.87329106944
INFO [2025-03-29 13:30:11] Replaced NAs in Distance_F_Elo with first quartile: 1256.69628195708
INFO [2025-03-29 13:30:11] Replaced NAs in Sprint_Elo with first quartile: 1246.32574824425
INFO [2025-03-29 13:30:11] Replaced NAs in Sprint_C_Elo with first quartile: 1257.67866787334
INFO [2025-03-29 13:30:11] Replaced NAs in Sprint_F_Elo with first quartile: 1244.84742904868
INFO [2025-03-29 13:30:11] Replaced NAs in Classic_Elo with first quartile: 1252.44868703669
INFO [2025-03-29 13:30:11] Replaced NAs in Freestyle_Elo with first quartile: 1244.44508230281
INFO [2025-03-29 13:30:11] Replaced NAs in Distance_Pelo with first quartile: 1241.11854419952
INFO [2025-03-29 13:30:11] Replaced NAs in Distance_C_Pelo with first quartile: 1245.57367555166
INFO [2025-03-29 13:30:11] Replaced NAs in Distance_F_Pelo with first quartile: 1259.54282973153
INFO [2025-03-29 13:30:11] Replaced NAs in Sprint_Pelo with first quartile: 1254.58885254623
INFO [2025-03-29 13:30:11] Replaced NAs in Sprint_C_Pelo with first quartile: 1257.58302026178
INFO [2025-03-29 13:30:11] Replaced NAs in Sprint_F_Pelo with first quartile: 1257.67755691493
INFO [2025-03-29 13:30:11] Replaced NAs in Classic_Pelo with first quartile: 1256.79275004544
INFO [2025-03-29 13:30:11] Replaced NAs in Freestyle_Pelo with first quartile: 1256.79999900008
INFO [2025-03-29 13:30:11] Replaced NAs in Classic_Last_5 with first quartile: 3.5
INFO [2025-03-29 13:30:11] Replaced NAs in Freestyle_Last_5 with first quartile: 2.4
INFO [2025-03-29 13:30:11] Created Pelo_Pct from Elo with max value: 1841.00191142018
INFO [2025-03-29 13:30:11] Created Distance_Pelo_Pct from Distance_Elo with max value: 1889.46974050597
INFO [2025-03-29 13:30:11] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1763.33572074398
INFO [2025-03-29 13:30:11] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1693.85026290322
INFO [2025-03-29 13:30:11] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1742.74758850835
INFO [2025-03-29 13:30:11] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1601.5820663103
INFO [2025-03-29 13:30:11] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1681.09824552997
INFO [2025-03-29 13:30:11] Created Classic_Pelo_Pct from Classic_Elo with max value: 1698.69428891549
INFO [2025-03-29 13:30:11] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1707.58410982918
INFO [2025-03-29 13:30:11] Prepared data for 255 ladies skiers with 33 features
INFO [2025-03-29 13:30:11] No FIS startlist, predicting for all skiers in all legs
INFO [2025-03-29 13:30:11] No valid FIS startlist for ladies, building optimized teams
INFO [2025-03-29 13:30:11] Attempting Option 1: Team model coefficients
INFO [2025-03-29 13:30:11] Option 1 failed: No team_podium model found
INFO [2025-03-29 13:30:11] Option 1 failed: No team model
INFO [2025-03-29 13:30:11] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 13:30:11] Leg 1 accuracy: 0.756410256410256
INFO [2025-03-29 13:30:11] Leg 2 accuracy: 0.866666666666667
INFO [2025-03-29 13:30:11] Leg 3 accuracy: 0.803846153846154
INFO [2025-03-29 13:30:11] Leg 4 accuracy: 0.793939393939394
INFO [2025-03-29 13:30:11] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 13:30:11] Using leg importance weights for team optimization: Leg 1: 0.23, Leg 2: 0.27, Leg 3: 0.25, Leg 4: 0.25
INFO [2025-03-29 13:30:11] Optimizing team for Sweden
INFO [2025-03-29 13:30:12] Optimizing team for Norway
INFO [2025-03-29 13:30:12] Optimizing team for Germany
INFO [2025-03-29 13:30:12] Optimizing team for USA
INFO [2025-03-29 13:30:12] Optimizing team for Austria
INFO [2025-03-29 13:30:12] Optimizing team for Finland
INFO [2025-03-29 13:30:12] Optimizing team for Czechia
INFO [2025-03-29 13:30:12] Optimizing team for Switzerland
INFO [2025-03-29 13:30:12] Optimizing team for Italy
INFO [2025-03-29 13:30:12] Optimizing team for France
INFO [2025-03-29 13:30:12] Optimizing team for Canada
INFO [2025-03-29 13:30:12] Optimizing team for Slovenia
INFO [2025-03-29 13:30:12] Optimizing team for Estonia
INFO [2025-03-29 13:30:12] Optimizing team for Australia
INFO [2025-03-29 13:30:12] Optimizing team for Ukraine
INFO [2025-03-29 13:30:12] Optimizing team for Kazakhstan
INFO [2025-03-29 13:30:12] Optimizing team for Armenia
INFO [2025-03-29 13:30:12] Optimizing team for Latvia
INFO [2025-03-29 13:30:12] Optimizing team for Japan
INFO [2025-03-29 13:30:12] Optimizing team for Poland
INFO [2025-03-29 13:30:12] Optimizing team for South Korea
INFO [2025-03-29 13:30:12] Optimizing team for Andorra
INFO [2025-03-29 13:30:12] Optimizing team for Taiwan
INFO [2025-03-29 13:30:12] Optimizing team for China
INFO [2025-03-29 13:30:12] Optimizing team for Croatia
INFO [2025-03-29 13:30:12] Optimizing team for Slovakia
INFO [2025-03-29 13:30:12] Optimizing team for Argentina
INFO [2025-03-29 13:30:12] Optimizing team for Mongolia
INFO [2025-03-29 13:30:12] Optimizing team for Brazil
INFO [2025-03-29 13:30:12] Optimizing team for Lithuania
INFO [2025-03-29 13:30:12] Optimizing team for Greece
INFO [2025-03-29 13:30:12] Optimizing team for Iceland
INFO [2025-03-29 13:30:12] Optimizing team for Bulgaria
INFO [2025-03-29 13:30:12] Optimizing team for Serbia
INFO [2025-03-29 13:30:12] Optimizing team for Hungary
INFO [2025-03-29 13:30:12] Optimizing team for Turkey
INFO [2025-03-29 13:30:12] Optimizing team for North Macedonia
INFO [2025-03-29 13:30:12] Optimizing team for Romania
INFO [2025-03-29 13:30:12] Optimizing team for Bosnia&Herzegovina
INFO [2025-03-29 13:30:12] Optimizing team for Mexico
INFO [2025-03-29 13:30:12] Optimizing team for Iran
INFO [2025-03-29 13:30:12] Optimizing team for Chile
INFO [2025-03-29 13:30:12] Optimizing team for India
INFO [2025-03-29 13:30:12] Optimizing team for Malaysia
INFO [2025-03-29 13:30:12] Optimizing team for Haiti
INFO [2025-03-29 13:30:12] Optimizing team for Lebanon
INFO [2025-03-29 13:30:13] Optimizing team for Liechtenstein
WARN [2025-03-29 13:30:13] Could not read individuals file: invalid 'description' argument
WARN [2025-03-29 13:30:13] Could not read teams file: invalid 'description' argument
INFO [2025-03-29 13:30:13] Resetting men's probabilities at or below the mode to zero
INFO [2025-03-29 13:30:13] No values appear more than twice for Win_Prob
INFO [2025-03-29 13:30:13] No values appear more than twice for Podium_Prob
INFO [2025-03-29 13:30:13] No values appear more than twice for Top5_Prob
INFO [2025-03-29 13:30:13] No values appear more than twice for Top10_Prob
INFO [2025-03-29 13:30:13] Resetting ladies' probabilities at or below the mode to zero
INFO [2025-03-29 13:30:13] Reset 21 values to 0 for Win_Prob (repeated values or values <  0 )
INFO [2025-03-29 13:30:13] Repeated values: 0, 0, 0, 0, 0
INFO [2025-03-29 13:30:13] No values appear more than twice for Podium_Prob
INFO [2025-03-29 13:30:13] No values appear more than twice for Top5_Prob
INFO [2025-03-29 13:30:13] No values appear more than twice for Top10_Prob
INFO [2025-03-29 13:30:13] Normalizing men's team probabilities
INFO [2025-03-29 13:30:13] Normalized Win_Prob from sum of 0.72 to 1
INFO [2025-03-29 13:30:13] Normalized Podium_Prob from sum of 2.34 to 3
INFO [2025-03-29 13:30:13] Normalized Top5_Prob from sum of 4.2 to 5
INFO [2025-03-29 13:30:13] Normalized Top10_Prob from sum of 10.33 to 10
INFO [2025-03-29 13:30:13] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 13:30:13] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 13:30:13] Normalizing ladies' team probabilities
INFO [2025-03-29 13:30:13] Normalized Win_Prob from sum of 1.87 to 1
INFO [2025-03-29 13:30:13] Normalized Podium_Prob from sum of 4.26 to 3
INFO [2025-03-29 13:30:13] Normalized Top5_Prob from sum of 4.83 to 5
INFO [2025-03-29 13:30:13] Normalized Top10_Prob from sum of 13.46 to 10
INFO [2025-03-29 13:30:13] Final capping of probabilities to maximum of 1
INFO [2025-03-29 13:30:13] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 13:30:13] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 13:30:13] Optimizing fantasy relay team
INFO [2025-03-29 13:30:13] Fantasy team optimization complete. Selected 6 teams.
INFO [2025-03-29 13:30:13] Total price: 92546 of max 1e+05
INFO [2025-03-29 13:30:13] Expected total points: 543.6
INFO [2025-03-29 13:30:13] Men's teams: 6 ( 6 )
INFO [2025-03-29 13:30:13] Ladies' teams: 0 ( 0 )
INFO [2025-03-29 13:30:13] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_points.xlsx
INFO [2025-03-29 13:30:13] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_probabilities.xlsx
INFO [2025-03-29 13:30:13] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_points.xlsx
INFO [2025-03-29 13:30:13] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_probabilities.xlsx
INFO [2025-03-29 13:30:13] Saved fantasy team results to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/fantasy_relay_team.xlsx
INFO [2025-03-29 13:30:13] Relay predictions completed successfully
INFO [2025-03-29 13:33:52] Starting relay predictions process
INFO [2025-03-29 13:33:52] Loading weekend race data
INFO [2025-03-29 13:33:52] Tomorrow's date: 2025-03-29
INFO [2025-03-29 13:33:53] Found 1 men's relay races and 1 ladies' relay races
INFO [2025-03-29 13:33:53] Loading chrono data
INFO [2025-03-29 13:33:58] Loaded men's chrono with 105122 rows and 36 columns
INFO [2025-03-29 13:33:58] Loaded ladies' chrono with 78706 rows and 36 columns
INFO [2025-03-29 13:33:58] Created men's relay df with 9688 rows
INFO [2025-03-29 13:33:58] Created men's individual df with 92143 rows
INFO [2025-03-29 13:33:58] Created ladies' relay df with 8019 rows
INFO [2025-03-29 13:33:58] Created ladies' individual df with 68253 rows
INFO [2025-03-29 13:34:04] Training models for Leg 1
INFO [2025-03-29 13:34:04] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:34:04] Training podium model using glm
INFO [2025-03-29 13:34:04] Training win model using glm
INFO [2025-03-29 13:34:04] Training top5 model using glm
INFO [2025-03-29 13:34:04] Training top10 model using glm
INFO [2025-03-29 13:34:04] Top features for Leg 1 podium prediction:
INFO [2025-03-29 13:34:04] Training models for Leg 2
INFO [2025-03-29 13:34:04] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:34:04] Training podium model using glm
INFO [2025-03-29 13:34:04] Training win model using glm
INFO [2025-03-29 13:34:04] Training top5 model using glm
INFO [2025-03-29 13:34:04] Training top10 model using glm
INFO [2025-03-29 13:34:04] Top features for Leg 2 podium prediction:
INFO [2025-03-29 13:34:04] Training models for Leg 3
INFO [2025-03-29 13:34:04] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:34:04] Training podium model using glm
INFO [2025-03-29 13:34:04] Training win model using glm
INFO [2025-03-29 13:34:04] Training top5 model using glm
INFO [2025-03-29 13:34:05] Training top10 model using glm
INFO [2025-03-29 13:34:05] Top features for Leg 3 podium prediction:
INFO [2025-03-29 13:34:05] Training models for Leg 4
INFO [2025-03-29 13:34:05] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:34:05] Training podium model using glm
INFO [2025-03-29 13:34:05] Training win model using glm
INFO [2025-03-29 13:34:05] Training top5 model using glm
INFO [2025-03-29 13:34:05] Training top10 model using glm
INFO [2025-03-29 13:34:05] Top features for Leg 4 podium prediction:
INFO [2025-03-29 13:34:05] Training models for Leg 1
INFO [2025-03-29 13:34:05] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:34:05] Training podium model using glm
INFO [2025-03-29 13:34:05] Training win model using glm
INFO [2025-03-29 13:34:05] Training top5 model using glm
INFO [2025-03-29 13:34:05] Training top10 model using glm
INFO [2025-03-29 13:34:05] Top features for Leg 1 podium prediction:
INFO [2025-03-29 13:34:05] Training models for Leg 2
INFO [2025-03-29 13:34:05] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:34:05] Training podium model using glm
INFO [2025-03-29 13:34:05] Training win model using glm
INFO [2025-03-29 13:34:06] Training top5 model using glm
INFO [2025-03-29 13:34:06] Training top10 model using glm
INFO [2025-03-29 13:34:06] Top features for Leg 2 podium prediction:
INFO [2025-03-29 13:34:06] Training models for Leg 3
INFO [2025-03-29 13:34:06] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:34:06] Training podium model using glm
INFO [2025-03-29 13:34:06] Training win model using glm
INFO [2025-03-29 13:34:06] Training top5 model using glm
INFO [2025-03-29 13:34:06] Training top10 model using glm
INFO [2025-03-29 13:34:06] Top features for Leg 3 podium prediction:
INFO [2025-03-29 13:34:06] Training models for Leg 4
INFO [2025-03-29 13:34:06] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:34:06] Training podium model using glm
INFO [2025-03-29 13:34:06] Training win model using glm
INFO [2025-03-29 13:34:06] Training top5 model using glm
INFO [2025-03-29 13:34:06] Training top10 model using glm
INFO [2025-03-29 13:34:06] Top features for Leg 4 podium prediction:
INFO [2025-03-29 13:34:06] Processing men's relay predictions
INFO [2025-03-29 13:34:06] Loaded men relay teams startlist with 24 rows
INFO [2025-03-29 13:34:06] Loaded men relay individuals startlist with 96 rows
INFO [2025-03-29 13:34:06] Preparing current men skier data
INFO [2025-03-29 13:34:06] Found 9 Elo columns for current skiers
INFO [2025-03-29 13:34:07] Replaced NAs in Distance_Elo with first quartile: 1207.23243912712
INFO [2025-03-29 13:34:07] Replaced NAs in Distance_C_Elo with first quartile: 1233.40200699225
INFO [2025-03-29 13:34:07] Replaced NAs in Distance_F_Elo with first quartile: 1236.48554062178
INFO [2025-03-29 13:34:07] Replaced NAs in Sprint_Elo with first quartile: 1223.60107000698
INFO [2025-03-29 13:34:07] Replaced NAs in Sprint_C_Elo with first quartile: 1241.28715500947
INFO [2025-03-29 13:34:07] Replaced NAs in Sprint_F_Elo with first quartile: 1234.45151108772
INFO [2025-03-29 13:34:07] Replaced NAs in Classic_Elo with first quartile: 1241.52867310024
INFO [2025-03-29 13:34:07] Replaced NAs in Freestyle_Elo with first quartile: 1228.48649348109
INFO [2025-03-29 13:34:07] Replaced NAs in Distance_Pelo with first quartile: 1211.63035979047
INFO [2025-03-29 13:34:07] Replaced NAs in Distance_C_Pelo with first quartile: 1234.81091928129
INFO [2025-03-29 13:34:07] Replaced NAs in Distance_F_Pelo with first quartile: 1239.65331180248
INFO [2025-03-29 13:34:07] Replaced NAs in Sprint_Pelo with first quartile: 1240.94751821383
INFO [2025-03-29 13:34:07] Replaced NAs in Sprint_C_Pelo with first quartile: 1241.28715500947
INFO [2025-03-29 13:34:07] Replaced NAs in Sprint_F_Pelo with first quartile: 1252.45166310493
INFO [2025-03-29 13:34:07] Replaced NAs in Classic_Pelo with first quartile: 1243.63746068082
INFO [2025-03-29 13:34:07] Replaced NAs in Freestyle_Pelo with first quartile: 1249.30280713791
INFO [2025-03-29 13:34:07] Replaced NAs in Classic_Last_5 with first quartile: 0
INFO [2025-03-29 13:34:07] Replaced NAs in Freestyle_Last_5 with first quartile: 0
INFO [2025-03-29 13:34:07] Created Pelo_Pct from Elo with max value: 1946.6211651574
INFO [2025-03-29 13:34:07] Created Distance_Pelo_Pct from Distance_Elo with max value: 1869.1251911742
INFO [2025-03-29 13:34:07] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1777.16297253153
INFO [2025-03-29 13:34:07] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1695.2053212904
INFO [2025-03-29 13:34:07] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1886.80363942481
INFO [2025-03-29 13:34:07] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1711.08486899169
INFO [2025-03-29 13:34:07] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1792.65157560707
INFO [2025-03-29 13:34:07] Created Classic_Pelo_Pct from Classic_Elo with max value: 1807.56773496777
INFO [2025-03-29 13:34:07] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1814.60460629541
INFO [2025-03-29 13:34:07] Prepared data for 381 men skiers with 33 features
INFO [2025-03-29 13:34:07] Using FIS startlist for men's leg predictions
INFO [2025-03-29 13:34:07] Using FIS startlist for men
INFO [2025-03-29 13:34:07] Attempting Option 1: Team model coefficients
INFO [2025-03-29 13:34:07] Option 1 failed: No team_podium model found
INFO [2025-03-29 13:34:07] Option 1 failed: No team model
INFO [2025-03-29 13:34:07] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 13:34:07] Leg 1 accuracy: 0.861511786479642
INFO [2025-03-29 13:34:07] Leg 2 accuracy: 0.820960451977401
INFO [2025-03-29 13:34:07] Leg 3 accuracy: 0.863929475939996
INFO [2025-03-29 13:34:07] Leg 4 accuracy: 0.877966101694915
INFO [2025-03-29 13:34:07] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 13:34:07] Leg importance weights: Leg 1: 0.25, Leg 2: 0.24, Leg 3: 0.25, Leg 4: 0.26
INFO [2025-03-29 13:34:07] Processing ladies's relay predictions
INFO [2025-03-29 13:34:07] Loaded ladies relay teams startlist with 35 rows
INFO [2025-03-29 13:34:07] Loaded ladies relay individuals startlist with 231 rows
INFO [2025-03-29 13:34:07] Preparing current ladies skier data
INFO [2025-03-29 13:34:07] Found 9 Elo columns for current skiers
INFO [2025-03-29 13:34:07] Replaced NAs in Distance_Elo with first quartile: 1237.38564383256
INFO [2025-03-29 13:34:07] Replaced NAs in Distance_C_Elo with first quartile: 1243.87329106944
INFO [2025-03-29 13:34:07] Replaced NAs in Distance_F_Elo with first quartile: 1256.69628195708
INFO [2025-03-29 13:34:07] Replaced NAs in Sprint_Elo with first quartile: 1246.32574824425
INFO [2025-03-29 13:34:07] Replaced NAs in Sprint_C_Elo with first quartile: 1257.67866787334
INFO [2025-03-29 13:34:07] Replaced NAs in Sprint_F_Elo with first quartile: 1244.84742904868
INFO [2025-03-29 13:34:07] Replaced NAs in Classic_Elo with first quartile: 1252.44868703669
INFO [2025-03-29 13:34:07] Replaced NAs in Freestyle_Elo with first quartile: 1244.44508230281
INFO [2025-03-29 13:34:07] Replaced NAs in Distance_Pelo with first quartile: 1241.11854419952
INFO [2025-03-29 13:34:07] Replaced NAs in Distance_C_Pelo with first quartile: 1245.57367555166
INFO [2025-03-29 13:34:07] Replaced NAs in Distance_F_Pelo with first quartile: 1259.54282973153
INFO [2025-03-29 13:34:07] Replaced NAs in Sprint_Pelo with first quartile: 1254.58885254623
INFO [2025-03-29 13:34:07] Replaced NAs in Sprint_C_Pelo with first quartile: 1257.58302026178
INFO [2025-03-29 13:34:07] Replaced NAs in Sprint_F_Pelo with first quartile: 1257.67755691493
INFO [2025-03-29 13:34:07] Replaced NAs in Classic_Pelo with first quartile: 1256.79275004544
INFO [2025-03-29 13:34:07] Replaced NAs in Freestyle_Pelo with first quartile: 1256.79999900008
INFO [2025-03-29 13:34:07] Replaced NAs in Classic_Last_5 with first quartile: 3.5
INFO [2025-03-29 13:34:07] Replaced NAs in Freestyle_Last_5 with first quartile: 2.4
INFO [2025-03-29 13:34:07] Created Pelo_Pct from Elo with max value: 1841.00191142018
INFO [2025-03-29 13:34:07] Created Distance_Pelo_Pct from Distance_Elo with max value: 1889.46974050597
INFO [2025-03-29 13:34:07] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1763.33572074398
INFO [2025-03-29 13:34:07] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1693.85026290322
INFO [2025-03-29 13:34:07] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1742.74758850835
INFO [2025-03-29 13:34:07] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1601.5820663103
INFO [2025-03-29 13:34:07] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1681.09824552997
INFO [2025-03-29 13:34:07] Created Classic_Pelo_Pct from Classic_Elo with max value: 1698.69428891549
INFO [2025-03-29 13:34:07] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1707.58410982918
INFO [2025-03-29 13:34:07] Prepared data for 255 ladies skiers with 33 features
INFO [2025-03-29 13:34:07] No FIS startlist, predicting for all skiers in all legs
INFO [2025-03-29 13:34:07] No valid FIS startlist for ladies, building optimized teams
INFO [2025-03-29 13:34:07] Attempting Option 1: Team model coefficients
INFO [2025-03-29 13:34:07] Option 1 failed: No team_podium model found
INFO [2025-03-29 13:34:07] Option 1 failed: No team model
INFO [2025-03-29 13:34:07] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 13:34:07] Leg 1 accuracy: 0.819230769230769
INFO [2025-03-29 13:34:07] Leg 2 accuracy: 0.8
INFO [2025-03-29 13:34:07] Leg 3 accuracy: 0.803846153846154
INFO [2025-03-29 13:34:07] Leg 4 accuracy: 0.846969696969697
INFO [2025-03-29 13:34:07] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 13:34:07] Using leg importance weights for team optimization: Leg 1: 0.25, Leg 2: 0.24, Leg 3: 0.25, Leg 4: 0.26
INFO [2025-03-29 13:34:07] Optimizing team for Sweden
INFO [2025-03-29 13:34:08] Optimizing team for Norway
INFO [2025-03-29 13:34:08] Optimizing team for Germany
INFO [2025-03-29 13:34:08] Optimizing team for USA
INFO [2025-03-29 13:34:08] Optimizing team for Austria
INFO [2025-03-29 13:34:08] Optimizing team for Finland
INFO [2025-03-29 13:34:08] Optimizing team for Czechia
INFO [2025-03-29 13:34:08] Optimizing team for Switzerland
INFO [2025-03-29 13:34:08] Optimizing team for Italy
INFO [2025-03-29 13:34:08] Optimizing team for France
INFO [2025-03-29 13:34:08] Optimizing team for Canada
INFO [2025-03-29 13:34:08] Optimizing team for Slovenia
INFO [2025-03-29 13:34:08] Optimizing team for Estonia
INFO [2025-03-29 13:34:08] Optimizing team for Australia
INFO [2025-03-29 13:34:08] Optimizing team for Ukraine
INFO [2025-03-29 13:34:08] Optimizing team for Kazakhstan
INFO [2025-03-29 13:34:08] Optimizing team for Armenia
INFO [2025-03-29 13:34:08] Optimizing team for Latvia
INFO [2025-03-29 13:34:08] Optimizing team for Japan
INFO [2025-03-29 13:34:08] Optimizing team for Poland
INFO [2025-03-29 13:34:08] Optimizing team for South Korea
INFO [2025-03-29 13:34:08] Optimizing team for Andorra
INFO [2025-03-29 13:34:08] Optimizing team for Taiwan
INFO [2025-03-29 13:34:08] Optimizing team for China
INFO [2025-03-29 13:34:08] Optimizing team for Croatia
INFO [2025-03-29 13:34:08] Optimizing team for Slovakia
INFO [2025-03-29 13:34:08] Optimizing team for Argentina
INFO [2025-03-29 13:34:08] Optimizing team for Mongolia
INFO [2025-03-29 13:34:08] Optimizing team for Brazil
INFO [2025-03-29 13:34:08] Optimizing team for Lithuania
INFO [2025-03-29 13:34:08] Optimizing team for Greece
INFO [2025-03-29 13:34:08] Optimizing team for Iceland
INFO [2025-03-29 13:34:08] Optimizing team for Bulgaria
INFO [2025-03-29 13:34:08] Optimizing team for Serbia
INFO [2025-03-29 13:34:08] Optimizing team for Hungary
INFO [2025-03-29 13:34:08] Optimizing team for Turkey
INFO [2025-03-29 13:34:08] Optimizing team for North Macedonia
INFO [2025-03-29 13:34:08] Optimizing team for Romania
INFO [2025-03-29 13:34:08] Optimizing team for Bosnia&Herzegovina
INFO [2025-03-29 13:34:08] Optimizing team for Mexico
INFO [2025-03-29 13:34:08] Optimizing team for Iran
INFO [2025-03-29 13:34:08] Optimizing team for Chile
INFO [2025-03-29 13:34:08] Optimizing team for India
INFO [2025-03-29 13:34:08] Optimizing team for Malaysia
INFO [2025-03-29 13:34:09] Optimizing team for Haiti
INFO [2025-03-29 13:34:09] Optimizing team for Lebanon
INFO [2025-03-29 13:34:09] Optimizing team for Liechtenstein
WARN [2025-03-29 13:34:09] Could not read individuals file: invalid 'description' argument
WARN [2025-03-29 13:34:09] Could not read teams file: invalid 'description' argument
INFO [2025-03-29 13:34:09] Resetting men's probabilities at or below the mode to zero
INFO [2025-03-29 13:34:09] No values appear more than twice for Win_Prob
INFO [2025-03-29 13:34:09] No values appear more than twice for Podium_Prob
INFO [2025-03-29 13:34:09] No values appear more than twice for Top5_Prob
INFO [2025-03-29 13:34:09] No values appear more than twice for Top10_Prob
INFO [2025-03-29 13:34:09] Resetting ladies' probabilities at or below the mode to zero
INFO [2025-03-29 13:34:09] Reset 11 values to 0 for Win_Prob (repeated values or values <  0 )
INFO [2025-03-29 13:34:09] Repeated values: 0, 0, 0
INFO [2025-03-29 13:34:09] No values appear more than twice for Podium_Prob
INFO [2025-03-29 13:34:09] No values appear more than twice for Top5_Prob
INFO [2025-03-29 13:34:09] No values appear more than twice for Top10_Prob
INFO [2025-03-29 13:34:09] Normalizing men's team probabilities
INFO [2025-03-29 13:34:09] Normalized Win_Prob from sum of 0.71 to 1
INFO [2025-03-29 13:34:09] Normalized Podium_Prob from sum of 2.34 to 3
INFO [2025-03-29 13:34:09] Normalized Top5_Prob from sum of 4.2 to 5
INFO [2025-03-29 13:34:09] Normalized Top10_Prob from sum of 10.32 to 10
INFO [2025-03-29 13:34:09] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 13:34:09] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 13:34:09] Normalizing ladies' team probabilities
INFO [2025-03-29 13:34:09] Normalized Win_Prob from sum of 1.85 to 1
INFO [2025-03-29 13:34:09] Normalized Podium_Prob from sum of 4.31 to 3
INFO [2025-03-29 13:34:09] Normalized Top5_Prob from sum of 5.14 to 5
INFO [2025-03-29 13:34:09] Normalized Top10_Prob from sum of 13.83 to 10
INFO [2025-03-29 13:34:09] Final capping of probabilities to maximum of 1
INFO [2025-03-29 13:34:09] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 13:34:09] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 13:34:09] Optimizing fantasy relay team
INFO [2025-03-29 13:34:09] Fantasy team optimization complete. Selected 6 teams.
INFO [2025-03-29 13:34:09] Total price: 92546 of max 1e+05
INFO [2025-03-29 13:34:09] Expected total points: 542.4
INFO [2025-03-29 13:34:09] Men's teams: 6 ( 6 )
INFO [2025-03-29 13:34:09] Ladies' teams: 0 ( 0 )
INFO [2025-03-29 13:34:09] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_points.xlsx
INFO [2025-03-29 13:34:09] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_probabilities.xlsx
INFO [2025-03-29 13:34:09] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_points.xlsx
INFO [2025-03-29 13:34:09] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_probabilities.xlsx
INFO [2025-03-29 13:34:09] Saved fantasy team results to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/fantasy_relay_team.xlsx
INFO [2025-03-29 13:34:09] Relay predictions completed successfully
INFO [2025-03-29 13:34:16] Starting relay predictions process
INFO [2025-03-29 13:34:16] Loading weekend race data
INFO [2025-03-29 13:34:16] Tomorrow's date: 2025-03-29
INFO [2025-03-29 13:34:16] Found 1 men's relay races and 1 ladies' relay races
INFO [2025-03-29 13:34:16] Loading chrono data
INFO [2025-03-29 13:34:21] Loaded men's chrono with 105122 rows and 36 columns
INFO [2025-03-29 13:34:21] Loaded ladies' chrono with 78706 rows and 36 columns
INFO [2025-03-29 13:34:21] Created men's relay df with 9688 rows
INFO [2025-03-29 13:34:21] Created men's individual df with 92143 rows
INFO [2025-03-29 13:34:21] Created ladies' relay df with 8019 rows
INFO [2025-03-29 13:34:21] Created ladies' individual df with 68253 rows
INFO [2025-03-29 13:34:26] Training models for Leg 1
INFO [2025-03-29 13:34:26] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:34:26] Training podium model using glm
INFO [2025-03-29 13:34:26] Training win model using glm
INFO [2025-03-29 13:34:26] Training top5 model using glm
INFO [2025-03-29 13:34:26] Training top10 model using glm
INFO [2025-03-29 13:34:27] Top features for Leg 1 podium prediction:
INFO [2025-03-29 13:34:27] Training models for Leg 2
INFO [2025-03-29 13:34:27] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:34:27] Training podium model using glm
INFO [2025-03-29 13:34:27] Training win model using glm
INFO [2025-03-29 13:34:27] Training top5 model using glm
INFO [2025-03-29 13:34:27] Training top10 model using glm
INFO [2025-03-29 13:34:27] Top features for Leg 2 podium prediction:
INFO [2025-03-29 13:34:27] Training models for Leg 3
INFO [2025-03-29 13:34:27] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:34:27] Training podium model using glm
INFO [2025-03-29 13:34:27] Training win model using glm
INFO [2025-03-29 13:34:27] Training top5 model using glm
INFO [2025-03-29 13:34:27] Training top10 model using glm
INFO [2025-03-29 13:34:27] Top features for Leg 3 podium prediction:
INFO [2025-03-29 13:34:27] Training models for Leg 4
INFO [2025-03-29 13:34:27] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:34:27] Training podium model using glm
INFO [2025-03-29 13:34:27] Training win model using glm
INFO [2025-03-29 13:34:27] Training top5 model using glm
INFO [2025-03-29 13:34:28] Training top10 model using glm
INFO [2025-03-29 13:34:28] Top features for Leg 4 podium prediction:
INFO [2025-03-29 13:34:28] Training models for Leg 1
INFO [2025-03-29 13:34:28] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:34:28] Training podium model using glm
INFO [2025-03-29 13:34:28] Training win model using glm
INFO [2025-03-29 13:34:28] Training top5 model using glm
INFO [2025-03-29 13:34:28] Training top10 model using glm
INFO [2025-03-29 13:34:28] Top features for Leg 1 podium prediction:
INFO [2025-03-29 13:34:28] Training models for Leg 2
INFO [2025-03-29 13:34:28] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:34:28] Training podium model using glm
INFO [2025-03-29 13:34:28] Training win model using glm
INFO [2025-03-29 13:34:28] Training top5 model using glm
INFO [2025-03-29 13:34:28] Training top10 model using glm
INFO [2025-03-29 13:34:28] Top features for Leg 2 podium prediction:
INFO [2025-03-29 13:34:28] Training models for Leg 3
INFO [2025-03-29 13:34:28] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:34:28] Training podium model using glm
INFO [2025-03-29 13:34:28] Training win model using glm
INFO [2025-03-29 13:34:29] Training top5 model using glm
INFO [2025-03-29 13:34:29] Training top10 model using glm
INFO [2025-03-29 13:34:29] Top features for Leg 3 podium prediction:
INFO [2025-03-29 13:34:29] Training models for Leg 4
INFO [2025-03-29 13:34:29] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:34:29] Training podium model using glm
INFO [2025-03-29 13:34:29] Training win model using glm
INFO [2025-03-29 13:34:29] Training top5 model using glm
INFO [2025-03-29 13:34:29] Training top10 model using glm
INFO [2025-03-29 13:34:29] Top features for Leg 4 podium prediction:
INFO [2025-03-29 13:34:29] Processing men's relay predictions
INFO [2025-03-29 13:34:29] Loaded men relay teams startlist with 24 rows
INFO [2025-03-29 13:34:29] Loaded men relay individuals startlist with 96 rows
INFO [2025-03-29 13:34:29] Preparing current men skier data
INFO [2025-03-29 13:34:29] Found 9 Elo columns for current skiers
INFO [2025-03-29 13:34:29] Replaced NAs in Distance_Elo with first quartile: 1207.23243912712
INFO [2025-03-29 13:34:29] Replaced NAs in Distance_C_Elo with first quartile: 1233.40200699225
INFO [2025-03-29 13:34:29] Replaced NAs in Distance_F_Elo with first quartile: 1236.48554062178
INFO [2025-03-29 13:34:29] Replaced NAs in Sprint_Elo with first quartile: 1223.60107000698
INFO [2025-03-29 13:34:29] Replaced NAs in Sprint_C_Elo with first quartile: 1241.28715500947
INFO [2025-03-29 13:34:29] Replaced NAs in Sprint_F_Elo with first quartile: 1234.45151108772
INFO [2025-03-29 13:34:29] Replaced NAs in Classic_Elo with first quartile: 1241.52867310024
INFO [2025-03-29 13:34:29] Replaced NAs in Freestyle_Elo with first quartile: 1228.48649348109
INFO [2025-03-29 13:34:29] Replaced NAs in Distance_Pelo with first quartile: 1211.63035979047
INFO [2025-03-29 13:34:29] Replaced NAs in Distance_C_Pelo with first quartile: 1234.81091928129
INFO [2025-03-29 13:34:29] Replaced NAs in Distance_F_Pelo with first quartile: 1239.65331180248
INFO [2025-03-29 13:34:29] Replaced NAs in Sprint_Pelo with first quartile: 1240.94751821383
INFO [2025-03-29 13:34:29] Replaced NAs in Sprint_C_Pelo with first quartile: 1241.28715500947
INFO [2025-03-29 13:34:29] Replaced NAs in Sprint_F_Pelo with first quartile: 1252.45166310493
INFO [2025-03-29 13:34:29] Replaced NAs in Classic_Pelo with first quartile: 1243.63746068082
INFO [2025-03-29 13:34:29] Replaced NAs in Freestyle_Pelo with first quartile: 1249.30280713791
INFO [2025-03-29 13:34:29] Replaced NAs in Classic_Last_5 with first quartile: 0
INFO [2025-03-29 13:34:29] Replaced NAs in Freestyle_Last_5 with first quartile: 0
INFO [2025-03-29 13:34:29] Created Pelo_Pct from Elo with max value: 1946.6211651574
INFO [2025-03-29 13:34:29] Created Distance_Pelo_Pct from Distance_Elo with max value: 1869.1251911742
INFO [2025-03-29 13:34:29] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1777.16297253153
INFO [2025-03-29 13:34:29] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1695.2053212904
INFO [2025-03-29 13:34:29] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1886.80363942481
INFO [2025-03-29 13:34:29] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1711.08486899169
INFO [2025-03-29 13:34:29] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1792.65157560707
INFO [2025-03-29 13:34:29] Created Classic_Pelo_Pct from Classic_Elo with max value: 1807.56773496777
INFO [2025-03-29 13:34:29] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1814.60460629541
INFO [2025-03-29 13:34:29] Prepared data for 381 men skiers with 33 features
INFO [2025-03-29 13:34:29] Using FIS startlist for men's leg predictions
INFO [2025-03-29 13:34:30] Using FIS startlist for men
INFO [2025-03-29 13:34:30] Attempting Option 1: Team model coefficients
INFO [2025-03-29 13:34:30] Option 1 failed: No team_podium model found
INFO [2025-03-29 13:34:30] Option 1 failed: No team model
INFO [2025-03-29 13:34:30] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 13:34:30] Leg 1 accuracy: 0.854915254237288
INFO [2025-03-29 13:34:30] Leg 2 accuracy: 0.848065458796026
INFO [2025-03-29 13:34:30] Leg 3 accuracy: 0.856808883693746
INFO [2025-03-29 13:34:30] Leg 4 accuracy: 0.88829729203195
INFO [2025-03-29 13:34:30] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 13:34:30] Leg importance weights: Leg 1: 0.25, Leg 2: 0.25, Leg 3: 0.25, Leg 4: 0.26
INFO [2025-03-29 13:34:30] Processing ladies's relay predictions
INFO [2025-03-29 13:34:30] Loaded ladies relay teams startlist with 35 rows
INFO [2025-03-29 13:34:30] Loaded ladies relay individuals startlist with 231 rows
INFO [2025-03-29 13:34:30] Preparing current ladies skier data
INFO [2025-03-29 13:34:30] Found 9 Elo columns for current skiers
INFO [2025-03-29 13:34:30] Replaced NAs in Distance_Elo with first quartile: 1237.38564383256
INFO [2025-03-29 13:34:30] Replaced NAs in Distance_C_Elo with first quartile: 1243.87329106944
INFO [2025-03-29 13:34:30] Replaced NAs in Distance_F_Elo with first quartile: 1256.69628195708
INFO [2025-03-29 13:34:30] Replaced NAs in Sprint_Elo with first quartile: 1246.32574824425
INFO [2025-03-29 13:34:30] Replaced NAs in Sprint_C_Elo with first quartile: 1257.67866787334
INFO [2025-03-29 13:34:30] Replaced NAs in Sprint_F_Elo with first quartile: 1244.84742904868
INFO [2025-03-29 13:34:30] Replaced NAs in Classic_Elo with first quartile: 1252.44868703669
INFO [2025-03-29 13:34:30] Replaced NAs in Freestyle_Elo with first quartile: 1244.44508230281
INFO [2025-03-29 13:34:30] Replaced NAs in Distance_Pelo with first quartile: 1241.11854419952
INFO [2025-03-29 13:34:30] Replaced NAs in Distance_C_Pelo with first quartile: 1245.57367555166
INFO [2025-03-29 13:34:30] Replaced NAs in Distance_F_Pelo with first quartile: 1259.54282973153
INFO [2025-03-29 13:34:30] Replaced NAs in Sprint_Pelo with first quartile: 1254.58885254623
INFO [2025-03-29 13:34:30] Replaced NAs in Sprint_C_Pelo with first quartile: 1257.58302026178
INFO [2025-03-29 13:34:30] Replaced NAs in Sprint_F_Pelo with first quartile: 1257.67755691493
INFO [2025-03-29 13:34:30] Replaced NAs in Classic_Pelo with first quartile: 1256.79275004544
INFO [2025-03-29 13:34:30] Replaced NAs in Freestyle_Pelo with first quartile: 1256.79999900008
INFO [2025-03-29 13:34:30] Replaced NAs in Classic_Last_5 with first quartile: 3.5
INFO [2025-03-29 13:34:30] Replaced NAs in Freestyle_Last_5 with first quartile: 2.4
INFO [2025-03-29 13:34:30] Created Pelo_Pct from Elo with max value: 1841.00191142018
INFO [2025-03-29 13:34:30] Created Distance_Pelo_Pct from Distance_Elo with max value: 1889.46974050597
INFO [2025-03-29 13:34:30] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1763.33572074398
INFO [2025-03-29 13:34:30] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1693.85026290322
INFO [2025-03-29 13:34:30] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1742.74758850835
INFO [2025-03-29 13:34:30] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1601.5820663103
INFO [2025-03-29 13:34:30] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1681.09824552997
INFO [2025-03-29 13:34:30] Created Classic_Pelo_Pct from Classic_Elo with max value: 1698.69428891549
INFO [2025-03-29 13:34:30] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1707.58410982918
INFO [2025-03-29 13:34:30] Prepared data for 255 ladies skiers with 33 features
INFO [2025-03-29 13:34:30] No FIS startlist, predicting for all skiers in all legs
INFO [2025-03-29 13:34:30] No valid FIS startlist for ladies, building optimized teams
INFO [2025-03-29 13:34:30] Attempting Option 1: Team model coefficients
INFO [2025-03-29 13:34:30] Option 1 failed: No team_podium model found
INFO [2025-03-29 13:34:30] Option 1 failed: No team model
INFO [2025-03-29 13:34:30] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 13:34:30] Leg 1 accuracy: 0.788461538461538
INFO [2025-03-29 13:34:30] Leg 2 accuracy: 0.833333333333333
INFO [2025-03-29 13:34:30] Leg 3 accuracy: 0.82051282051282
INFO [2025-03-29 13:34:30] Leg 4 accuracy: 0.810606060606061
INFO [2025-03-29 13:34:30] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 13:34:30] Using leg importance weights for team optimization: Leg 1: 0.24, Leg 2: 0.26, Leg 3: 0.25, Leg 4: 0.25
INFO [2025-03-29 13:34:30] Optimizing team for Sweden
INFO [2025-03-29 13:34:30] Optimizing team for Norway
INFO [2025-03-29 13:34:30] Optimizing team for Germany
INFO [2025-03-29 13:34:30] Optimizing team for USA
INFO [2025-03-29 13:34:30] Optimizing team for Austria
INFO [2025-03-29 13:34:30] Optimizing team for Finland
INFO [2025-03-29 13:34:30] Optimizing team for Czechia
INFO [2025-03-29 13:34:30] Optimizing team for Switzerland
INFO [2025-03-29 13:34:30] Optimizing team for Italy
INFO [2025-03-29 13:34:31] Optimizing team for France
INFO [2025-03-29 13:34:31] Optimizing team for Canada
INFO [2025-03-29 13:34:31] Optimizing team for Slovenia
INFO [2025-03-29 13:34:31] Optimizing team for Estonia
INFO [2025-03-29 13:34:31] Optimizing team for Australia
INFO [2025-03-29 13:34:31] Optimizing team for Ukraine
INFO [2025-03-29 13:34:31] Optimizing team for Kazakhstan
INFO [2025-03-29 13:34:31] Optimizing team for Armenia
INFO [2025-03-29 13:34:31] Optimizing team for Latvia
INFO [2025-03-29 13:34:31] Optimizing team for Japan
INFO [2025-03-29 13:34:31] Optimizing team for Poland
INFO [2025-03-29 13:34:31] Optimizing team for South Korea
INFO [2025-03-29 13:34:31] Optimizing team for Andorra
INFO [2025-03-29 13:34:31] Optimizing team for Taiwan
INFO [2025-03-29 13:34:31] Optimizing team for China
INFO [2025-03-29 13:34:31] Optimizing team for Croatia
INFO [2025-03-29 13:34:31] Optimizing team for Slovakia
INFO [2025-03-29 13:34:31] Optimizing team for Argentina
INFO [2025-03-29 13:34:31] Optimizing team for Mongolia
INFO [2025-03-29 13:34:31] Optimizing team for Brazil
INFO [2025-03-29 13:34:31] Optimizing team for Lithuania
INFO [2025-03-29 13:34:31] Optimizing team for Greece
INFO [2025-03-29 13:34:31] Optimizing team for Iceland
INFO [2025-03-29 13:34:31] Optimizing team for Bulgaria
INFO [2025-03-29 13:34:31] Optimizing team for Serbia
INFO [2025-03-29 13:34:31] Optimizing team for Hungary
INFO [2025-03-29 13:34:31] Optimizing team for Turkey
INFO [2025-03-29 13:34:31] Optimizing team for North Macedonia
INFO [2025-03-29 13:34:31] Optimizing team for Romania
INFO [2025-03-29 13:34:31] Optimizing team for Bosnia&Herzegovina
INFO [2025-03-29 13:34:31] Optimizing team for Mexico
INFO [2025-03-29 13:34:31] Optimizing team for Iran
INFO [2025-03-29 13:34:31] Optimizing team for Chile
INFO [2025-03-29 13:34:31] Optimizing team for India
INFO [2025-03-29 13:34:31] Optimizing team for Malaysia
INFO [2025-03-29 13:34:31] Optimizing team for Haiti
INFO [2025-03-29 13:34:31] Optimizing team for Lebanon
INFO [2025-03-29 13:34:31] Optimizing team for Liechtenstein
WARN [2025-03-29 13:34:31] Could not read individuals file: invalid 'description' argument
WARN [2025-03-29 13:34:31] Could not read teams file: invalid 'description' argument
INFO [2025-03-29 13:34:31] Resetting men's probabilities at or below the mode to zero
INFO [2025-03-29 13:34:31] No values appear more than twice for Win_Prob
INFO [2025-03-29 13:34:31] No values appear more than twice for Podium_Prob
INFO [2025-03-29 13:34:31] No values appear more than twice for Top5_Prob
INFO [2025-03-29 13:34:31] No values appear more than twice for Top10_Prob
INFO [2025-03-29 13:34:31] Resetting ladies' probabilities at or below the mode to zero
INFO [2025-03-29 13:34:31] Reset 20 values to 0 for Win_Prob (repeated values or values <  0 )
INFO [2025-03-29 13:34:31] Repeated values: 0, 0, 0, 0
INFO [2025-03-29 13:34:31] No values appear more than twice for Podium_Prob
INFO [2025-03-29 13:34:31] No values appear more than twice for Top5_Prob
INFO [2025-03-29 13:34:31] No values appear more than twice for Top10_Prob
INFO [2025-03-29 13:34:31] Normalizing men's team probabilities
INFO [2025-03-29 13:34:31] Normalized Win_Prob from sum of 0.72 to 1
INFO [2025-03-29 13:34:31] Normalized Podium_Prob from sum of 2.34 to 3
INFO [2025-03-29 13:34:31] Normalized Top5_Prob from sum of 4.2 to 5
INFO [2025-03-29 13:34:31] Normalized Top10_Prob from sum of 10.33 to 10
INFO [2025-03-29 13:34:31] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 13:34:31] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 13:34:31] Normalizing ladies' team probabilities
INFO [2025-03-29 13:34:31] Normalized Win_Prob from sum of 1.77 to 1
INFO [2025-03-29 13:34:31] Normalized Podium_Prob from sum of 4.28 to 3
INFO [2025-03-29 13:34:31] Normalized Top5_Prob from sum of 5.12 to 5
INFO [2025-03-29 13:34:31] Normalized Top10_Prob from sum of 13.58 to 10
INFO [2025-03-29 13:34:31] Final capping of probabilities to maximum of 1
INFO [2025-03-29 13:34:31] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 13:34:31] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 13:34:31] Optimizing fantasy relay team
INFO [2025-03-29 13:34:32] Fantasy team optimization complete. Selected 6 teams.
INFO [2025-03-29 13:34:32] Total price: 92546 of max 1e+05
INFO [2025-03-29 13:34:32] Expected total points: 543.2
INFO [2025-03-29 13:34:32] Men's teams: 6 ( 6 )
INFO [2025-03-29 13:34:32] Ladies' teams: 0 ( 0 )
INFO [2025-03-29 13:34:32] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_points.xlsx
INFO [2025-03-29 13:34:32] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_probabilities.xlsx
INFO [2025-03-29 13:34:32] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_points.xlsx
INFO [2025-03-29 13:34:32] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_probabilities.xlsx
INFO [2025-03-29 13:34:32] Saved fantasy team results to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/fantasy_relay_team.xlsx
INFO [2025-03-29 13:34:32] Relay predictions completed successfully
INFO [2025-03-29 13:35:08] Starting relay predictions process
INFO [2025-03-29 13:35:08] Loading weekend race data
INFO [2025-03-29 13:35:08] Tomorrow's date: 2025-03-29
INFO [2025-03-29 13:35:08] Found 1 men's relay races and 1 ladies' relay races
INFO [2025-03-29 13:35:08] Loading chrono data
INFO [2025-03-29 13:35:13] Loaded men's chrono with 105122 rows and 36 columns
INFO [2025-03-29 13:35:13] Loaded ladies' chrono with 78706 rows and 36 columns
INFO [2025-03-29 13:35:13] Created men's relay df with 9688 rows
INFO [2025-03-29 13:35:13] Created men's individual df with 92143 rows
INFO [2025-03-29 13:35:13] Created ladies' relay df with 8019 rows
INFO [2025-03-29 13:35:13] Created ladies' individual df with 68253 rows
INFO [2025-03-29 13:35:18] Training models for Leg 1
INFO [2025-03-29 13:35:18] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:35:18] Training podium model using glm
INFO [2025-03-29 13:35:18] Training win model using glm
INFO [2025-03-29 13:35:18] Training top5 model using glm
INFO [2025-03-29 13:35:18] Training top10 model using glm
INFO [2025-03-29 13:35:19] Top features for Leg 1 podium prediction:
INFO [2025-03-29 13:35:19] Training models for Leg 2
INFO [2025-03-29 13:35:19] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:35:19] Training podium model using glm
INFO [2025-03-29 13:35:19] Training win model using glm
INFO [2025-03-29 13:35:19] Training top5 model using glm
INFO [2025-03-29 13:35:19] Training top10 model using glm
INFO [2025-03-29 13:35:19] Top features for Leg 2 podium prediction:
INFO [2025-03-29 13:35:19] Training models for Leg 3
INFO [2025-03-29 13:35:19] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:35:19] Training podium model using glm
INFO [2025-03-29 13:35:19] Training win model using glm
INFO [2025-03-29 13:35:19] Training top5 model using glm
INFO [2025-03-29 13:35:19] Training top10 model using glm
INFO [2025-03-29 13:35:19] Top features for Leg 3 podium prediction:
INFO [2025-03-29 13:35:19] Training models for Leg 4
INFO [2025-03-29 13:35:19] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:35:19] Training podium model using glm
INFO [2025-03-29 13:35:19] Training win model using glm
INFO [2025-03-29 13:35:19] Training top5 model using glm
INFO [2025-03-29 13:35:19] Training top10 model using glm
INFO [2025-03-29 13:35:20] Top features for Leg 4 podium prediction:
INFO [2025-03-29 13:35:20] Training models for Leg 1
INFO [2025-03-29 13:35:20] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:35:20] Training podium model using glm
INFO [2025-03-29 13:35:20] Training win model using glm
INFO [2025-03-29 13:35:20] Training top5 model using glm
INFO [2025-03-29 13:35:20] Training top10 model using glm
INFO [2025-03-29 13:35:20] Top features for Leg 1 podium prediction:
INFO [2025-03-29 13:35:20] Training models for Leg 2
INFO [2025-03-29 13:35:20] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:35:20] Training podium model using glm
INFO [2025-03-29 13:35:20] Training win model using glm
INFO [2025-03-29 13:35:20] Training top5 model using glm
INFO [2025-03-29 13:35:20] Training top10 model using glm
INFO [2025-03-29 13:35:20] Top features for Leg 2 podium prediction:
INFO [2025-03-29 13:35:20] Training models for Leg 3
INFO [2025-03-29 13:35:20] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:35:20] Training podium model using glm
INFO [2025-03-29 13:35:20] Training win model using glm
INFO [2025-03-29 13:35:20] Training top5 model using glm
INFO [2025-03-29 13:35:20] Training top10 model using glm
INFO [2025-03-29 13:35:20] Top features for Leg 3 podium prediction:
INFO [2025-03-29 13:35:20] Training models for Leg 4
INFO [2025-03-29 13:35:20] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:35:20] Training podium model using glm
INFO [2025-03-29 13:35:21] Training win model using glm
INFO [2025-03-29 13:35:21] Training top5 model using glm
INFO [2025-03-29 13:35:21] Training top10 model using glm
INFO [2025-03-29 13:35:21] Top features for Leg 4 podium prediction:
INFO [2025-03-29 13:35:21] Processing men's relay predictions
INFO [2025-03-29 13:35:21] Loaded men relay teams startlist with 24 rows
INFO [2025-03-29 13:35:21] Loaded men relay individuals startlist with 96 rows
INFO [2025-03-29 13:35:21] Preparing current men skier data
INFO [2025-03-29 13:35:21] Found 9 Elo columns for current skiers
INFO [2025-03-29 13:35:21] Replaced NAs in Distance_Elo with first quartile: 1207.23243912712
INFO [2025-03-29 13:35:21] Replaced NAs in Distance_C_Elo with first quartile: 1233.40200699225
INFO [2025-03-29 13:35:21] Replaced NAs in Distance_F_Elo with first quartile: 1236.48554062178
INFO [2025-03-29 13:35:21] Replaced NAs in Sprint_Elo with first quartile: 1223.60107000698
INFO [2025-03-29 13:35:21] Replaced NAs in Sprint_C_Elo with first quartile: 1241.28715500947
INFO [2025-03-29 13:35:21] Replaced NAs in Sprint_F_Elo with first quartile: 1234.45151108772
INFO [2025-03-29 13:35:21] Replaced NAs in Classic_Elo with first quartile: 1241.52867310024
INFO [2025-03-29 13:35:21] Replaced NAs in Freestyle_Elo with first quartile: 1228.48649348109
INFO [2025-03-29 13:35:21] Replaced NAs in Distance_Pelo with first quartile: 1211.63035979047
INFO [2025-03-29 13:35:21] Replaced NAs in Distance_C_Pelo with first quartile: 1234.81091928129
INFO [2025-03-29 13:35:21] Replaced NAs in Distance_F_Pelo with first quartile: 1239.65331180248
INFO [2025-03-29 13:35:21] Replaced NAs in Sprint_Pelo with first quartile: 1240.94751821383
INFO [2025-03-29 13:35:21] Replaced NAs in Sprint_C_Pelo with first quartile: 1241.28715500947
INFO [2025-03-29 13:35:21] Replaced NAs in Sprint_F_Pelo with first quartile: 1252.45166310493
INFO [2025-03-29 13:35:21] Replaced NAs in Classic_Pelo with first quartile: 1243.63746068082
INFO [2025-03-29 13:35:21] Replaced NAs in Freestyle_Pelo with first quartile: 1249.30280713791
INFO [2025-03-29 13:35:21] Replaced NAs in Classic_Last_5 with first quartile: 0
INFO [2025-03-29 13:35:21] Replaced NAs in Freestyle_Last_5 with first quartile: 0
INFO [2025-03-29 13:35:21] Created Pelo_Pct from Elo with max value: 1946.6211651574
INFO [2025-03-29 13:35:21] Created Distance_Pelo_Pct from Distance_Elo with max value: 1869.1251911742
INFO [2025-03-29 13:35:21] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1777.16297253153
INFO [2025-03-29 13:35:21] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1695.2053212904
INFO [2025-03-29 13:35:21] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1886.80363942481
INFO [2025-03-29 13:35:21] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1711.08486899169
INFO [2025-03-29 13:35:21] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1792.65157560707
INFO [2025-03-29 13:35:21] Created Classic_Pelo_Pct from Classic_Elo with max value: 1807.56773496777
INFO [2025-03-29 13:35:21] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1814.60460629541
INFO [2025-03-29 13:35:21] Prepared data for 381 men skiers with 33 features
INFO [2025-03-29 13:35:21] Using FIS startlist for men's leg predictions
INFO [2025-03-29 13:35:21] Using FIS startlist for men
INFO [2025-03-29 13:35:21] Attempting Option 1: Team model coefficients
INFO [2025-03-29 13:35:21] Option 1 failed: No team_podium model found
INFO [2025-03-29 13:35:21] Option 1 failed: No team model
INFO [2025-03-29 13:35:21] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 13:35:21] Leg 1 accuracy: 0.851412429378531
INFO [2025-03-29 13:35:21] Leg 2 accuracy: 0.854689265536723
INFO [2025-03-29 13:35:21] Leg 3 accuracy: 0.860644847067991
INFO [2025-03-29 13:35:21] Leg 4 accuracy: 0.888299240210403
INFO [2025-03-29 13:35:21] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 13:35:21] Leg importance weights: Leg 1: 0.25, Leg 2: 0.25, Leg 3: 0.25, Leg 4: 0.26
INFO [2025-03-29 13:35:21] Processing ladies's relay predictions
INFO [2025-03-29 13:35:21] Loaded ladies relay teams startlist with 35 rows
INFO [2025-03-29 13:35:21] Loaded ladies relay individuals startlist with 231 rows
INFO [2025-03-29 13:35:21] Preparing current ladies skier data
INFO [2025-03-29 13:35:21] Found 9 Elo columns for current skiers
INFO [2025-03-29 13:35:21] Replaced NAs in Distance_Elo with first quartile: 1237.38564383256
INFO [2025-03-29 13:35:21] Replaced NAs in Distance_C_Elo with first quartile: 1243.87329106944
INFO [2025-03-29 13:35:21] Replaced NAs in Distance_F_Elo with first quartile: 1256.69628195708
INFO [2025-03-29 13:35:21] Replaced NAs in Sprint_Elo with first quartile: 1246.32574824425
INFO [2025-03-29 13:35:21] Replaced NAs in Sprint_C_Elo with first quartile: 1257.67866787334
INFO [2025-03-29 13:35:21] Replaced NAs in Sprint_F_Elo with first quartile: 1244.84742904868
INFO [2025-03-29 13:35:21] Replaced NAs in Classic_Elo with first quartile: 1252.44868703669
INFO [2025-03-29 13:35:21] Replaced NAs in Freestyle_Elo with first quartile: 1244.44508230281
INFO [2025-03-29 13:35:21] Replaced NAs in Distance_Pelo with first quartile: 1241.11854419952
INFO [2025-03-29 13:35:21] Replaced NAs in Distance_C_Pelo with first quartile: 1245.57367555166
INFO [2025-03-29 13:35:21] Replaced NAs in Distance_F_Pelo with first quartile: 1259.54282973153
INFO [2025-03-29 13:35:21] Replaced NAs in Sprint_Pelo with first quartile: 1254.58885254623
INFO [2025-03-29 13:35:21] Replaced NAs in Sprint_C_Pelo with first quartile: 1257.58302026178
INFO [2025-03-29 13:35:21] Replaced NAs in Sprint_F_Pelo with first quartile: 1257.67755691493
INFO [2025-03-29 13:35:21] Replaced NAs in Classic_Pelo with first quartile: 1256.79275004544
INFO [2025-03-29 13:35:21] Replaced NAs in Freestyle_Pelo with first quartile: 1256.79999900008
INFO [2025-03-29 13:35:21] Replaced NAs in Classic_Last_5 with first quartile: 3.5
INFO [2025-03-29 13:35:21] Replaced NAs in Freestyle_Last_5 with first quartile: 2.4
INFO [2025-03-29 13:35:21] Created Pelo_Pct from Elo with max value: 1841.00191142018
INFO [2025-03-29 13:35:21] Created Distance_Pelo_Pct from Distance_Elo with max value: 1889.46974050597
INFO [2025-03-29 13:35:21] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1763.33572074398
INFO [2025-03-29 13:35:21] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1693.85026290322
INFO [2025-03-29 13:35:21] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1742.74758850835
INFO [2025-03-29 13:35:21] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1601.5820663103
INFO [2025-03-29 13:35:21] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1681.09824552997
INFO [2025-03-29 13:35:21] Created Classic_Pelo_Pct from Classic_Elo with max value: 1698.69428891549
INFO [2025-03-29 13:35:21] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1707.58410982918
INFO [2025-03-29 13:35:21] Prepared data for 255 ladies skiers with 33 features
INFO [2025-03-29 13:35:22] No FIS startlist, predicting for all skiers in all legs
INFO [2025-03-29 13:35:22] No valid FIS startlist for ladies, building optimized teams
INFO [2025-03-29 13:35:22] Attempting Option 1: Team model coefficients
INFO [2025-03-29 13:35:22] Option 1 failed: No team_podium model found
INFO [2025-03-29 13:35:22] Option 1 failed: No team model
INFO [2025-03-29 13:35:22] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 13:35:22] Leg 1 accuracy: 0.82051282051282
INFO [2025-03-29 13:35:22] Leg 2 accuracy: 0.85
INFO [2025-03-29 13:35:22] Leg 3 accuracy: 0.82051282051282
INFO [2025-03-29 13:35:22] Leg 4 accuracy: 0.812121212121212
INFO [2025-03-29 13:35:22] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 13:35:22] Using leg importance weights for team optimization: Leg 1: 0.25, Leg 2: 0.26, Leg 3: 0.25, Leg 4: 0.25
INFO [2025-03-29 13:35:22] Optimizing team for Sweden
INFO [2025-03-29 13:35:22] Optimizing team for Norway
INFO [2025-03-29 13:35:22] Optimizing team for Germany
INFO [2025-03-29 13:35:22] Optimizing team for USA
INFO [2025-03-29 13:35:22] Optimizing team for Austria
INFO [2025-03-29 13:35:22] Optimizing team for Finland
INFO [2025-03-29 13:35:22] Optimizing team for Czechia
INFO [2025-03-29 13:35:22] Optimizing team for Switzerland
INFO [2025-03-29 13:35:22] Optimizing team for Italy
INFO [2025-03-29 13:35:22] Optimizing team for France
INFO [2025-03-29 13:35:22] Optimizing team for Canada
INFO [2025-03-29 13:35:22] Optimizing team for Slovenia
INFO [2025-03-29 13:35:22] Optimizing team for Estonia
INFO [2025-03-29 13:35:22] Optimizing team for Australia
INFO [2025-03-29 13:35:22] Optimizing team for Ukraine
INFO [2025-03-29 13:35:22] Optimizing team for Kazakhstan
INFO [2025-03-29 13:35:22] Optimizing team for Armenia
INFO [2025-03-29 13:35:22] Optimizing team for Latvia
INFO [2025-03-29 13:35:22] Optimizing team for Japan
INFO [2025-03-29 13:35:22] Optimizing team for Poland
INFO [2025-03-29 13:35:22] Optimizing team for South Korea
INFO [2025-03-29 13:35:22] Optimizing team for Andorra
INFO [2025-03-29 13:35:22] Optimizing team for Taiwan
INFO [2025-03-29 13:35:22] Optimizing team for China
INFO [2025-03-29 13:35:22] Optimizing team for Croatia
INFO [2025-03-29 13:35:22] Optimizing team for Slovakia
INFO [2025-03-29 13:35:23] Optimizing team for Argentina
INFO [2025-03-29 13:35:23] Optimizing team for Mongolia
INFO [2025-03-29 13:35:23] Optimizing team for Brazil
INFO [2025-03-29 13:35:23] Optimizing team for Lithuania
INFO [2025-03-29 13:35:23] Optimizing team for Greece
INFO [2025-03-29 13:35:23] Optimizing team for Iceland
INFO [2025-03-29 13:35:23] Optimizing team for Bulgaria
INFO [2025-03-29 13:35:23] Optimizing team for Serbia
INFO [2025-03-29 13:35:23] Optimizing team for Hungary
INFO [2025-03-29 13:35:23] Optimizing team for Turkey
INFO [2025-03-29 13:35:23] Optimizing team for North Macedonia
INFO [2025-03-29 13:35:23] Optimizing team for Romania
INFO [2025-03-29 13:35:23] Optimizing team for Bosnia&Herzegovina
INFO [2025-03-29 13:35:23] Optimizing team for Mexico
INFO [2025-03-29 13:35:23] Optimizing team for Iran
INFO [2025-03-29 13:35:23] Optimizing team for Chile
INFO [2025-03-29 13:35:23] Optimizing team for India
INFO [2025-03-29 13:35:23] Optimizing team for Malaysia
INFO [2025-03-29 13:35:23] Optimizing team for Haiti
INFO [2025-03-29 13:35:23] Optimizing team for Lebanon
INFO [2025-03-29 13:35:23] Optimizing team for Liechtenstein
WARN [2025-03-29 13:35:23] Could not read individuals file: invalid 'description' argument
WARN [2025-03-29 13:35:23] Could not read teams file: invalid 'description' argument
INFO [2025-03-29 13:35:23] Resetting men's probabilities at or below the mode to zero
INFO [2025-03-29 13:35:23] No values appear more than twice for Win_Prob
INFO [2025-03-29 13:35:23] No values appear more than twice for Podium_Prob
INFO [2025-03-29 13:35:23] No values appear more than twice for Top5_Prob
INFO [2025-03-29 13:35:23] No values appear more than twice for Top10_Prob
INFO [2025-03-29 13:35:23] Resetting ladies' probabilities at or below the mode to zero
INFO [2025-03-29 13:35:23] Reset 20 values to 0 for Win_Prob (repeated values or values <  0 )
INFO [2025-03-29 13:35:23] Repeated values: 0, 0, 0, 0
INFO [2025-03-29 13:35:23] No values appear more than twice for Podium_Prob
INFO [2025-03-29 13:35:23] Reset 9 values to 0 for Top5_Prob (repeated values or values <  4e-04 )
INFO [2025-03-29 13:35:23] Repeated values: 4e-04
INFO [2025-03-29 13:35:23] No values appear more than twice for Top10_Prob
INFO [2025-03-29 13:35:23] Normalizing men's team probabilities
INFO [2025-03-29 13:35:23] Normalized Win_Prob from sum of 0.72 to 1
INFO [2025-03-29 13:35:23] Normalized Podium_Prob from sum of 2.34 to 3
INFO [2025-03-29 13:35:23] Normalized Top5_Prob from sum of 4.21 to 5
INFO [2025-03-29 13:35:23] Normalized Top10_Prob from sum of 10.33 to 10
INFO [2025-03-29 13:35:23] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 13:35:23] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 13:35:23] Normalizing ladies' team probabilities
INFO [2025-03-29 13:35:23] Normalized Win_Prob from sum of 1.78 to 1
INFO [2025-03-29 13:35:23] Normalized Podium_Prob from sum of 4.29 to 3
INFO [2025-03-29 13:35:23] Normalized Top5_Prob from sum of 5.14 to 5
INFO [2025-03-29 13:35:23] Normalized Top10_Prob from sum of 13.6 to 10
INFO [2025-03-29 13:35:23] Final capping of probabilities to maximum of 1
INFO [2025-03-29 13:35:23] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 13:35:23] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 13:35:23] Optimizing fantasy relay team
INFO [2025-03-29 13:35:23] Fantasy team optimization complete. Selected 6 teams.
INFO [2025-03-29 13:35:23] Total price: 92546 of max 1e+05
INFO [2025-03-29 13:35:23] Expected total points: 543.4
INFO [2025-03-29 13:35:23] Men's teams: 6 ( 6 )
INFO [2025-03-29 13:35:23] Ladies' teams: 0 ( 0 )
INFO [2025-03-29 13:35:23] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_points.xlsx
INFO [2025-03-29 13:35:23] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_probabilities.xlsx
INFO [2025-03-29 13:35:23] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_points.xlsx
INFO [2025-03-29 13:35:23] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_probabilities.xlsx
INFO [2025-03-29 13:35:23] Saved fantasy team results to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/fantasy_relay_team.xlsx
INFO [2025-03-29 13:35:23] Relay predictions completed successfully
INFO [2025-03-29 13:37:31] Starting relay predictions process
INFO [2025-03-29 13:37:31] Loading weekend race data
INFO [2025-03-29 13:37:31] Tomorrow's date: 2025-03-29
INFO [2025-03-29 13:37:31] Found 1 men's relay races and 1 ladies' relay races
INFO [2025-03-29 13:37:31] Loading chrono data
INFO [2025-03-29 13:37:37] Loaded men's chrono with 105122 rows and 36 columns
INFO [2025-03-29 13:37:37] Loaded ladies' chrono with 78706 rows and 36 columns
INFO [2025-03-29 13:37:37] Created men's relay df with 9688 rows
INFO [2025-03-29 13:37:37] Created men's individual df with 92143 rows
INFO [2025-03-29 13:37:37] Created ladies' relay df with 8019 rows
INFO [2025-03-29 13:37:37] Created ladies' individual df with 68253 rows
INFO [2025-03-29 13:37:42] Training models for Leg 1
INFO [2025-03-29 13:37:42] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:37:42] Training podium model using glm
INFO [2025-03-29 13:37:42] Training win model using glm
INFO [2025-03-29 13:37:42] Training top5 model using glm
INFO [2025-03-29 13:37:42] Training top10 model using glm
INFO [2025-03-29 13:37:42] Top features for Leg 1 podium prediction:
INFO [2025-03-29 13:37:42] Training models for Leg 2
INFO [2025-03-29 13:37:42] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:37:42] Training podium model using glm
INFO [2025-03-29 13:37:42] Training win model using glm
INFO [2025-03-29 13:37:42] Training top5 model using glm
INFO [2025-03-29 13:37:42] Training top10 model using glm
INFO [2025-03-29 13:37:42] Top features for Leg 2 podium prediction:
INFO [2025-03-29 13:37:42] Training models for Leg 3
INFO [2025-03-29 13:37:42] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:37:42] Training podium model using glm
INFO [2025-03-29 13:37:42] Training win model using glm
INFO [2025-03-29 13:37:43] Training top5 model using glm
INFO [2025-03-29 13:37:43] Training top10 model using glm
INFO [2025-03-29 13:37:43] Top features for Leg 3 podium prediction:
INFO [2025-03-29 13:37:43] Training models for Leg 4
INFO [2025-03-29 13:37:43] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:37:43] Training podium model using glm
INFO [2025-03-29 13:37:43] Training win model using glm
INFO [2025-03-29 13:37:43] Training top5 model using glm
INFO [2025-03-29 13:37:43] Training top10 model using glm
INFO [2025-03-29 13:37:43] Top features for Leg 4 podium prediction:
INFO [2025-03-29 13:37:43] Training models for Leg 1
INFO [2025-03-29 13:37:43] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:37:43] Training podium model using glm
INFO [2025-03-29 13:37:43] Training win model using glm
INFO [2025-03-29 13:37:43] Training top5 model using glm
INFO [2025-03-29 13:37:43] Training top10 model using glm
INFO [2025-03-29 13:37:43] Top features for Leg 1 podium prediction:
INFO [2025-03-29 13:37:43] Training models for Leg 2
INFO [2025-03-29 13:37:43] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:37:43] Training podium model using glm
INFO [2025-03-29 13:37:43] Training win model using glm
INFO [2025-03-29 13:37:44] Training top5 model using glm
INFO [2025-03-29 13:37:44] Training top10 model using glm
INFO [2025-03-29 13:37:44] Top features for Leg 2 podium prediction:
INFO [2025-03-29 13:37:44] Training models for Leg 3
INFO [2025-03-29 13:37:44] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:37:44] Training podium model using glm
INFO [2025-03-29 13:37:44] Training win model using glm
INFO [2025-03-29 13:37:44] Training top5 model using glm
INFO [2025-03-29 13:37:44] Training top10 model using glm
INFO [2025-03-29 13:37:44] Top features for Leg 3 podium prediction:
INFO [2025-03-29 13:37:44] Training models for Leg 4
INFO [2025-03-29 13:37:44] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:37:44] Training podium model using glm
INFO [2025-03-29 13:37:44] Training win model using glm
INFO [2025-03-29 13:37:44] Training top5 model using glm
INFO [2025-03-29 13:37:44] Training top10 model using glm
INFO [2025-03-29 13:37:44] Top features for Leg 4 podium prediction:
INFO [2025-03-29 13:37:44] Processing men's relay predictions
INFO [2025-03-29 13:37:44] Loaded men relay teams startlist with 24 rows
INFO [2025-03-29 13:37:44] Loaded men relay individuals startlist with 96 rows
INFO [2025-03-29 13:37:44] Preparing current men skier data
INFO [2025-03-29 13:37:44] Found 9 Elo columns for current skiers
INFO [2025-03-29 13:37:45] Replaced NAs in Distance_Elo with first quartile: 1207.23243912712
INFO [2025-03-29 13:37:45] Replaced NAs in Distance_C_Elo with first quartile: 1233.40200699225
INFO [2025-03-29 13:37:45] Replaced NAs in Distance_F_Elo with first quartile: 1236.48554062178
INFO [2025-03-29 13:37:45] Replaced NAs in Sprint_Elo with first quartile: 1223.60107000698
INFO [2025-03-29 13:37:45] Replaced NAs in Sprint_C_Elo with first quartile: 1241.28715500947
INFO [2025-03-29 13:37:45] Replaced NAs in Sprint_F_Elo with first quartile: 1234.45151108772
INFO [2025-03-29 13:37:45] Replaced NAs in Classic_Elo with first quartile: 1241.52867310024
INFO [2025-03-29 13:37:45] Replaced NAs in Freestyle_Elo with first quartile: 1228.48649348109
INFO [2025-03-29 13:37:45] Replaced NAs in Distance_Pelo with first quartile: 1211.63035979047
INFO [2025-03-29 13:37:45] Replaced NAs in Distance_C_Pelo with first quartile: 1234.81091928129
INFO [2025-03-29 13:37:45] Replaced NAs in Distance_F_Pelo with first quartile: 1239.65331180248
INFO [2025-03-29 13:37:45] Replaced NAs in Sprint_Pelo with first quartile: 1240.94751821383
INFO [2025-03-29 13:37:45] Replaced NAs in Sprint_C_Pelo with first quartile: 1241.28715500947
INFO [2025-03-29 13:37:45] Replaced NAs in Sprint_F_Pelo with first quartile: 1252.45166310493
INFO [2025-03-29 13:37:45] Replaced NAs in Classic_Pelo with first quartile: 1243.63746068082
INFO [2025-03-29 13:37:45] Replaced NAs in Freestyle_Pelo with first quartile: 1249.30280713791
INFO [2025-03-29 13:37:45] Replaced NAs in Classic_Last_5 with first quartile: 0
INFO [2025-03-29 13:37:45] Replaced NAs in Freestyle_Last_5 with first quartile: 0
INFO [2025-03-29 13:37:45] Created Pelo_Pct from Elo with max value: 1946.6211651574
INFO [2025-03-29 13:37:45] Created Distance_Pelo_Pct from Distance_Elo with max value: 1869.1251911742
INFO [2025-03-29 13:37:45] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1777.16297253153
INFO [2025-03-29 13:37:45] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1695.2053212904
INFO [2025-03-29 13:37:45] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1886.80363942481
INFO [2025-03-29 13:37:45] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1711.08486899169
INFO [2025-03-29 13:37:45] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1792.65157560707
INFO [2025-03-29 13:37:45] Created Classic_Pelo_Pct from Classic_Elo with max value: 1807.56773496777
INFO [2025-03-29 13:37:45] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1814.60460629541
INFO [2025-03-29 13:37:45] Prepared data for 381 men skiers with 33 features
INFO [2025-03-29 13:37:45] Using FIS startlist for men's leg predictions
INFO [2025-03-29 13:37:45] Using FIS startlist for men
INFO [2025-03-29 13:37:45] Attempting Option 1: Team model coefficients
INFO [2025-03-29 13:37:45] Option 1 failed: No team_podium model found
INFO [2025-03-29 13:37:45] Option 1 failed: No team model
INFO [2025-03-29 13:37:45] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 13:37:45] Leg 1 accuracy: 0.857946619910384
INFO [2025-03-29 13:37:45] Leg 2 accuracy: 0.851525423728814
INFO [2025-03-29 13:37:45] Leg 3 accuracy: 0.873923631404637
INFO [2025-03-29 13:37:45] Leg 4 accuracy: 0.881743619715566
INFO [2025-03-29 13:37:45] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 13:37:45] Leg importance weights: Leg 1: 0.25, Leg 2: 0.25, Leg 3: 0.25, Leg 4: 0.25
INFO [2025-03-29 13:37:45] Processing ladies's relay predictions
INFO [2025-03-29 13:37:45] Loaded ladies relay teams startlist with 35 rows
INFO [2025-03-29 13:37:45] Loaded ladies relay individuals startlist with 231 rows
INFO [2025-03-29 13:37:45] Preparing current ladies skier data
INFO [2025-03-29 13:37:45] Found 9 Elo columns for current skiers
INFO [2025-03-29 13:37:45] Replaced NAs in Distance_Elo with first quartile: 1237.38564383256
INFO [2025-03-29 13:37:45] Replaced NAs in Distance_C_Elo with first quartile: 1243.87329106944
INFO [2025-03-29 13:37:45] Replaced NAs in Distance_F_Elo with first quartile: 1256.69628195708
INFO [2025-03-29 13:37:45] Replaced NAs in Sprint_Elo with first quartile: 1246.32574824425
INFO [2025-03-29 13:37:45] Replaced NAs in Sprint_C_Elo with first quartile: 1257.67866787334
INFO [2025-03-29 13:37:45] Replaced NAs in Sprint_F_Elo with first quartile: 1244.84742904868
INFO [2025-03-29 13:37:45] Replaced NAs in Classic_Elo with first quartile: 1252.44868703669
INFO [2025-03-29 13:37:45] Replaced NAs in Freestyle_Elo with first quartile: 1244.44508230281
INFO [2025-03-29 13:37:45] Replaced NAs in Distance_Pelo with first quartile: 1241.11854419952
INFO [2025-03-29 13:37:45] Replaced NAs in Distance_C_Pelo with first quartile: 1245.57367555166
INFO [2025-03-29 13:37:45] Replaced NAs in Distance_F_Pelo with first quartile: 1259.54282973153
INFO [2025-03-29 13:37:45] Replaced NAs in Sprint_Pelo with first quartile: 1254.58885254623
INFO [2025-03-29 13:37:45] Replaced NAs in Sprint_C_Pelo with first quartile: 1257.58302026178
INFO [2025-03-29 13:37:45] Replaced NAs in Sprint_F_Pelo with first quartile: 1257.67755691493
INFO [2025-03-29 13:37:45] Replaced NAs in Classic_Pelo with first quartile: 1256.79275004544
INFO [2025-03-29 13:37:45] Replaced NAs in Freestyle_Pelo with first quartile: 1256.79999900008
INFO [2025-03-29 13:37:45] Replaced NAs in Classic_Last_5 with first quartile: 3.5
INFO [2025-03-29 13:37:45] Replaced NAs in Freestyle_Last_5 with first quartile: 2.4
INFO [2025-03-29 13:37:45] Created Pelo_Pct from Elo with max value: 1841.00191142018
INFO [2025-03-29 13:37:45] Created Distance_Pelo_Pct from Distance_Elo with max value: 1889.46974050597
INFO [2025-03-29 13:37:45] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1763.33572074398
INFO [2025-03-29 13:37:45] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1693.85026290322
INFO [2025-03-29 13:37:45] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1742.74758850835
INFO [2025-03-29 13:37:45] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1601.5820663103
INFO [2025-03-29 13:37:45] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1681.09824552997
INFO [2025-03-29 13:37:45] Created Classic_Pelo_Pct from Classic_Elo with max value: 1698.69428891549
INFO [2025-03-29 13:37:45] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1707.58410982918
INFO [2025-03-29 13:37:45] Prepared data for 255 ladies skiers with 33 features
INFO [2025-03-29 13:37:45] No FIS startlist, predicting for all skiers in all legs
INFO [2025-03-29 13:37:45] No valid FIS startlist for ladies, building optimized teams
INFO [2025-03-29 13:37:45] Attempting Option 1: Team model coefficients
INFO [2025-03-29 13:37:45] Option 1 failed: No team_podium model found
INFO [2025-03-29 13:37:45] Option 1 failed: No team model
INFO [2025-03-29 13:37:45] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 13:37:45] Leg 1 accuracy: 0.753846153846154
INFO [2025-03-29 13:37:45] Leg 2 accuracy: 0.866666666666667
INFO [2025-03-29 13:37:45] Leg 3 accuracy: 0.838461538461538
INFO [2025-03-29 13:37:45] Leg 4 accuracy: 0.778787878787879
INFO [2025-03-29 13:37:45] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 13:37:45] Using leg importance weights for team optimization: Leg 1: 0.23, Leg 2: 0.27, Leg 3: 0.26, Leg 4: 0.24
INFO [2025-03-29 13:37:45] Optimizing team for Sweden
INFO [2025-03-29 13:37:45] Optimizing team for Norway
INFO [2025-03-29 13:37:46] Optimizing team for Germany
INFO [2025-03-29 13:37:46] Optimizing team for USA
INFO [2025-03-29 13:37:46] Optimizing team for Austria
INFO [2025-03-29 13:37:46] Optimizing team for Finland
INFO [2025-03-29 13:37:46] Optimizing team for Czechia
INFO [2025-03-29 13:37:46] Optimizing team for Switzerland
INFO [2025-03-29 13:37:46] Optimizing team for Italy
INFO [2025-03-29 13:37:46] Optimizing team for France
INFO [2025-03-29 13:37:46] Optimizing team for Canada
INFO [2025-03-29 13:37:46] Optimizing team for Slovenia
INFO [2025-03-29 13:37:46] Optimizing team for Estonia
INFO [2025-03-29 13:37:46] Optimizing team for Australia
INFO [2025-03-29 13:37:46] Optimizing team for Ukraine
INFO [2025-03-29 13:37:46] Optimizing team for Kazakhstan
INFO [2025-03-29 13:37:46] Optimizing team for Armenia
INFO [2025-03-29 13:37:46] Optimizing team for Latvia
INFO [2025-03-29 13:37:46] Optimizing team for Japan
INFO [2025-03-29 13:37:46] Optimizing team for Poland
INFO [2025-03-29 13:37:46] Optimizing team for South Korea
INFO [2025-03-29 13:37:46] Optimizing team for Andorra
INFO [2025-03-29 13:37:46] Optimizing team for Taiwan
INFO [2025-03-29 13:37:46] Optimizing team for China
INFO [2025-03-29 13:37:46] Optimizing team for Croatia
INFO [2025-03-29 13:37:46] Optimizing team for Slovakia
INFO [2025-03-29 13:37:46] Optimizing team for Argentina
INFO [2025-03-29 13:37:46] Optimizing team for Mongolia
INFO [2025-03-29 13:37:46] Optimizing team for Brazil
INFO [2025-03-29 13:37:46] Optimizing team for Lithuania
INFO [2025-03-29 13:37:46] Optimizing team for Greece
INFO [2025-03-29 13:37:46] Optimizing team for Iceland
INFO [2025-03-29 13:37:46] Optimizing team for Bulgaria
INFO [2025-03-29 13:37:46] Optimizing team for Serbia
INFO [2025-03-29 13:37:46] Optimizing team for Hungary
INFO [2025-03-29 13:37:46] Optimizing team for Turkey
INFO [2025-03-29 13:37:46] Optimizing team for North Macedonia
INFO [2025-03-29 13:37:46] Optimizing team for Romania
INFO [2025-03-29 13:37:46] Optimizing team for Bosnia&Herzegovina
INFO [2025-03-29 13:37:46] Optimizing team for Mexico
INFO [2025-03-29 13:37:46] Optimizing team for Iran
INFO [2025-03-29 13:37:46] Optimizing team for Chile
INFO [2025-03-29 13:37:46] Optimizing team for India
INFO [2025-03-29 13:37:46] Optimizing team for Malaysia
INFO [2025-03-29 13:37:46] Optimizing team for Haiti
INFO [2025-03-29 13:37:46] Optimizing team for Lebanon
INFO [2025-03-29 13:37:46] Optimizing team for Liechtenstein
INFO [2025-03-29 13:37:47] Matching optimized teams with startlist team names and prices
INFO [2025-03-29 13:37:47] Resetting men's probabilities at or below the mode to zero
INFO [2025-03-29 13:37:47] No values appear more than twice for Win_Prob
INFO [2025-03-29 13:37:47] No values appear more than twice for Podium_Prob
INFO [2025-03-29 13:37:47] No values appear more than twice for Top5_Prob
INFO [2025-03-29 13:37:47] No values appear more than twice for Top10_Prob
INFO [2025-03-29 13:37:47] Resetting ladies' probabilities at or below the mode to zero
INFO [2025-03-29 13:37:47] Reset 21 values to 0 for Win_Prob (repeated values or values <  0 )
INFO [2025-03-29 13:37:47] Repeated values: 0, 0, 0, 0, 0
INFO [2025-03-29 13:37:47] No values appear more than twice for Podium_Prob
INFO [2025-03-29 13:37:47] No values appear more than twice for Top5_Prob
INFO [2025-03-29 13:37:47] No values appear more than twice for Top10_Prob
INFO [2025-03-29 13:37:47] Normalizing men's team probabilities
INFO [2025-03-29 13:37:47] Normalized Win_Prob from sum of 0.72 to 1
INFO [2025-03-29 13:37:47] Normalized Podium_Prob from sum of 2.34 to 3
INFO [2025-03-29 13:37:47] Normalized Top5_Prob from sum of 4.2 to 5
INFO [2025-03-29 13:37:47] Normalized Top10_Prob from sum of 10.33 to 10
INFO [2025-03-29 13:37:47] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 13:37:47] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 13:37:47] Normalizing ladies' team probabilities
INFO [2025-03-29 13:37:47] Normalized Win_Prob from sum of 1.85 to 1
INFO [2025-03-29 13:37:47] Normalized Podium_Prob from sum of 4.24 to 3
INFO [2025-03-29 13:37:47] Normalized Top5_Prob from sum of 4.84 to 5
INFO [2025-03-29 13:37:47] Normalized Top10_Prob from sum of 13.47 to 10
INFO [2025-03-29 13:37:47] Final capping of probabilities to maximum of 1
INFO [2025-03-29 13:37:47] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 13:37:47] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 13:37:48] Optimizing fantasy relay team
INFO [2025-03-29 13:37:48] Fantasy team optimization complete. Selected 11 teams.
INFO [2025-03-29 13:37:48] Total price: 99734 of max 1e+05
INFO [2025-03-29 13:37:48] Expected total points: 907.6
INFO [2025-03-29 13:37:48] Men's teams: 5 ( 5 )
INFO [2025-03-29 13:37:48] Ladies' teams: 6 ( 6 )
INFO [2025-03-29 13:37:48] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_points.xlsx
INFO [2025-03-29 13:37:48] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_probabilities.xlsx
INFO [2025-03-29 13:37:48] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_points.xlsx
INFO [2025-03-29 13:37:48] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_probabilities.xlsx
INFO [2025-03-29 13:37:48] Saved fantasy team results to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/fantasy_relay_team.xlsx
INFO [2025-03-29 13:37:48] Relay predictions completed successfully
INFO [2025-03-29 13:42:34] Starting relay predictions process
INFO [2025-03-29 13:42:34] Loading weekend race data
INFO [2025-03-29 13:42:34] Tomorrow's date: 2025-03-29
INFO [2025-03-29 13:42:34] Found 1 men's relay races and 1 ladies' relay races
INFO [2025-03-29 13:42:34] Loading chrono data
INFO [2025-03-29 13:42:40] Loaded men's chrono with 105122 rows and 36 columns
INFO [2025-03-29 13:42:40] Loaded ladies' chrono with 78706 rows and 36 columns
INFO [2025-03-29 13:42:40] Created men's relay df with 9688 rows
INFO [2025-03-29 13:42:40] Created men's individual df with 92143 rows
INFO [2025-03-29 13:42:40] Created ladies' relay df with 8019 rows
INFO [2025-03-29 13:42:40] Created ladies' individual df with 68253 rows
INFO [2025-03-29 13:42:45] Training models for Leg 1
INFO [2025-03-29 13:42:45] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:42:45] Training podium model using glm
INFO [2025-03-29 13:42:45] Training win model using glm
INFO [2025-03-29 13:42:45] Training top5 model using glm
INFO [2025-03-29 13:42:45] Training top10 model using glm
INFO [2025-03-29 13:42:45] Top features for Leg 1 podium prediction:
INFO [2025-03-29 13:42:45] Training models for Leg 2
INFO [2025-03-29 13:42:45] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:42:45] Training podium model using glm
INFO [2025-03-29 13:42:45] Training win model using glm
INFO [2025-03-29 13:42:45] Training top5 model using glm
INFO [2025-03-29 13:42:45] Training top10 model using glm
INFO [2025-03-29 13:42:46] Top features for Leg 2 podium prediction:
INFO [2025-03-29 13:42:46] Training models for Leg 3
INFO [2025-03-29 13:42:46] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:42:46] Training podium model using glm
INFO [2025-03-29 13:42:46] Training win model using glm
INFO [2025-03-29 13:42:46] Training top5 model using glm
INFO [2025-03-29 13:42:46] Training top10 model using glm
INFO [2025-03-29 13:42:46] Top features for Leg 3 podium prediction:
INFO [2025-03-29 13:42:46] Training models for Leg 4
INFO [2025-03-29 13:42:46] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:42:46] Training podium model using glm
INFO [2025-03-29 13:42:46] Training win model using glm
INFO [2025-03-29 13:42:46] Training top5 model using glm
INFO [2025-03-29 13:42:46] Training top10 model using glm
INFO [2025-03-29 13:42:46] Top features for Leg 4 podium prediction:
INFO [2025-03-29 13:42:46] Training models for Leg 1
INFO [2025-03-29 13:42:46] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:42:46] Training podium model using glm
INFO [2025-03-29 13:42:46] Training win model using glm
INFO [2025-03-29 13:42:46] Training top5 model using glm
INFO [2025-03-29 13:42:46] Training top10 model using glm
INFO [2025-03-29 13:42:47] Top features for Leg 1 podium prediction:
INFO [2025-03-29 13:42:47] Training models for Leg 2
INFO [2025-03-29 13:42:47] Using predictors: Distance_C_Pelo_Pct, Classic_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:42:47] Training podium model using glm
INFO [2025-03-29 13:42:47] Training win model using glm
INFO [2025-03-29 13:42:47] Training top5 model using glm
INFO [2025-03-29 13:42:47] Training top10 model using glm
INFO [2025-03-29 13:42:47] Top features for Leg 2 podium prediction:
INFO [2025-03-29 13:42:47] Training models for Leg 3
INFO [2025-03-29 13:42:47] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:42:47] Training podium model using glm
INFO [2025-03-29 13:42:47] Training win model using glm
INFO [2025-03-29 13:42:47] Training top5 model using glm
INFO [2025-03-29 13:42:47] Training top10 model using glm
INFO [2025-03-29 13:42:47] Top features for Leg 3 podium prediction:
INFO [2025-03-29 13:42:47] Training models for Leg 4
INFO [2025-03-29 13:42:47] Using predictors: Distance_F_Pelo_Pct, Freestyle_Pelo_Pct, Distance_Pelo_Pct, Sprint_Pelo_Pct, Pelo_Pct, Weighted_Last_5
INFO [2025-03-29 13:42:47] Training podium model using glm
INFO [2025-03-29 13:42:47] Training win model using glm
INFO [2025-03-29 13:42:47] Training top5 model using glm
INFO [2025-03-29 13:42:47] Training top10 model using glm
INFO [2025-03-29 13:42:48] Top features for Leg 4 podium prediction:
INFO [2025-03-29 13:42:48] Processing men's relay predictions
INFO [2025-03-29 13:42:48] Loaded men relay teams startlist with 24 rows
INFO [2025-03-29 13:42:48] Loaded men relay individuals startlist with 96 rows
INFO [2025-03-29 13:42:48] Preparing current men skier data
INFO [2025-03-29 13:42:48] Found 9 Elo columns for current skiers
INFO [2025-03-29 13:42:48] Replaced NAs in Distance_Elo with first quartile: 1207.23243912712
INFO [2025-03-29 13:42:48] Replaced NAs in Distance_C_Elo with first quartile: 1233.40200699225
INFO [2025-03-29 13:42:48] Replaced NAs in Distance_F_Elo with first quartile: 1236.48554062178
INFO [2025-03-29 13:42:48] Replaced NAs in Sprint_Elo with first quartile: 1223.60107000698
INFO [2025-03-29 13:42:48] Replaced NAs in Sprint_C_Elo with first quartile: 1241.28715500947
INFO [2025-03-29 13:42:48] Replaced NAs in Sprint_F_Elo with first quartile: 1234.45151108772
INFO [2025-03-29 13:42:48] Replaced NAs in Classic_Elo with first quartile: 1241.52867310024
INFO [2025-03-29 13:42:48] Replaced NAs in Freestyle_Elo with first quartile: 1228.48649348109
INFO [2025-03-29 13:42:48] Replaced NAs in Distance_Pelo with first quartile: 1211.63035979047
INFO [2025-03-29 13:42:48] Replaced NAs in Distance_C_Pelo with first quartile: 1234.81091928129
INFO [2025-03-29 13:42:48] Replaced NAs in Distance_F_Pelo with first quartile: 1239.65331180248
INFO [2025-03-29 13:42:48] Replaced NAs in Sprint_Pelo with first quartile: 1240.94751821383
INFO [2025-03-29 13:42:48] Replaced NAs in Sprint_C_Pelo with first quartile: 1241.28715500947
INFO [2025-03-29 13:42:48] Replaced NAs in Sprint_F_Pelo with first quartile: 1252.45166310493
INFO [2025-03-29 13:42:48] Replaced NAs in Classic_Pelo with first quartile: 1243.63746068082
INFO [2025-03-29 13:42:48] Replaced NAs in Freestyle_Pelo with first quartile: 1249.30280713791
INFO [2025-03-29 13:42:48] Replaced NAs in Classic_Last_5 with first quartile: 0
INFO [2025-03-29 13:42:48] Replaced NAs in Freestyle_Last_5 with first quartile: 0
INFO [2025-03-29 13:42:48] Created Pelo_Pct from Elo with max value: 1946.6211651574
INFO [2025-03-29 13:42:48] Created Distance_Pelo_Pct from Distance_Elo with max value: 1869.1251911742
INFO [2025-03-29 13:42:48] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1777.16297253153
INFO [2025-03-29 13:42:48] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1695.2053212904
INFO [2025-03-29 13:42:48] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1886.80363942481
INFO [2025-03-29 13:42:48] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1711.08486899169
INFO [2025-03-29 13:42:48] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1792.65157560707
INFO [2025-03-29 13:42:48] Created Classic_Pelo_Pct from Classic_Elo with max value: 1807.56773496777
INFO [2025-03-29 13:42:48] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1814.60460629541
INFO [2025-03-29 13:42:48] Prepared data for 381 men skiers with 33 features
INFO [2025-03-29 13:42:48] Using FIS startlist for men's leg predictions
INFO [2025-03-29 13:42:48] Using FIS startlist for men
INFO [2025-03-29 13:42:48] Attempting Option 1: Team model coefficients
INFO [2025-03-29 13:42:48] Option 1 failed: No team_podium model found
INFO [2025-03-29 13:42:48] Option 1 failed: No team model
INFO [2025-03-29 13:42:48] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 13:42:48] Leg 1 accuracy: 0.861525423728814
INFO [2025-03-29 13:42:48] Leg 2 accuracy: 0.834406779661017
INFO [2025-03-29 13:42:48] Leg 3 accuracy: 0.870952659263589
INFO [2025-03-29 13:42:48] Leg 4 accuracy: 0.891743619715566
INFO [2025-03-29 13:42:48] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 13:42:48] Leg importance weights: Leg 1: 0.25, Leg 2: 0.24, Leg 3: 0.25, Leg 4: 0.26
INFO [2025-03-29 13:42:48] Processing ladies's relay predictions
INFO [2025-03-29 13:42:48] Loaded ladies relay teams startlist with 35 rows
INFO [2025-03-29 13:42:48] Loaded ladies relay individuals startlist with 231 rows
INFO [2025-03-29 13:42:48] Preparing current ladies skier data
INFO [2025-03-29 13:42:48] Found 9 Elo columns for current skiers
INFO [2025-03-29 13:42:48] Replaced NAs in Distance_Elo with first quartile: 1237.38564383256
INFO [2025-03-29 13:42:48] Replaced NAs in Distance_C_Elo with first quartile: 1243.87329106944
INFO [2025-03-29 13:42:48] Replaced NAs in Distance_F_Elo with first quartile: 1256.69628195708
INFO [2025-03-29 13:42:48] Replaced NAs in Sprint_Elo with first quartile: 1246.32574824425
INFO [2025-03-29 13:42:48] Replaced NAs in Sprint_C_Elo with first quartile: 1257.67866787334
INFO [2025-03-29 13:42:48] Replaced NAs in Sprint_F_Elo with first quartile: 1244.84742904868
INFO [2025-03-29 13:42:48] Replaced NAs in Classic_Elo with first quartile: 1252.44868703669
INFO [2025-03-29 13:42:48] Replaced NAs in Freestyle_Elo with first quartile: 1244.44508230281
INFO [2025-03-29 13:42:48] Replaced NAs in Distance_Pelo with first quartile: 1241.11854419952
INFO [2025-03-29 13:42:48] Replaced NAs in Distance_C_Pelo with first quartile: 1245.57367555166
INFO [2025-03-29 13:42:48] Replaced NAs in Distance_F_Pelo with first quartile: 1259.54282973153
INFO [2025-03-29 13:42:48] Replaced NAs in Sprint_Pelo with first quartile: 1254.58885254623
INFO [2025-03-29 13:42:48] Replaced NAs in Sprint_C_Pelo with first quartile: 1257.58302026178
INFO [2025-03-29 13:42:48] Replaced NAs in Sprint_F_Pelo with first quartile: 1257.67755691493
INFO [2025-03-29 13:42:48] Replaced NAs in Classic_Pelo with first quartile: 1256.79275004544
INFO [2025-03-29 13:42:48] Replaced NAs in Freestyle_Pelo with first quartile: 1256.79999900008
INFO [2025-03-29 13:42:48] Replaced NAs in Classic_Last_5 with first quartile: 3.5
INFO [2025-03-29 13:42:48] Replaced NAs in Freestyle_Last_5 with first quartile: 2.4
INFO [2025-03-29 13:42:48] Created Pelo_Pct from Elo with max value: 1841.00191142018
INFO [2025-03-29 13:42:48] Created Distance_Pelo_Pct from Distance_Elo with max value: 1889.46974050597
INFO [2025-03-29 13:42:48] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1763.33572074398
INFO [2025-03-29 13:42:48] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1693.85026290322
INFO [2025-03-29 13:42:48] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1742.74758850835
INFO [2025-03-29 13:42:48] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1601.5820663103
INFO [2025-03-29 13:42:48] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1681.09824552997
INFO [2025-03-29 13:42:48] Created Classic_Pelo_Pct from Classic_Elo with max value: 1698.69428891549
INFO [2025-03-29 13:42:48] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1707.58410982918
INFO [2025-03-29 13:42:48] Prepared data for 255 ladies skiers with 33 features
INFO [2025-03-29 13:42:48] No FIS startlist, predicting for all skiers in all legs
INFO [2025-03-29 13:42:48] No valid FIS startlist for ladies, building optimized teams
INFO [2025-03-29 13:42:48] Attempting Option 1: Team model coefficients
INFO [2025-03-29 13:42:48] Option 1 failed: No team_podium model found
INFO [2025-03-29 13:42:48] Option 1 failed: No team model
INFO [2025-03-29 13:42:48] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 13:42:48] Leg 1 accuracy: 0.773076923076923
INFO [2025-03-29 13:42:48] Leg 2 accuracy: 0.866666666666667
INFO [2025-03-29 13:42:48] Leg 3 accuracy: 0.819230769230769
INFO [2025-03-29 13:42:48] Leg 4 accuracy: 0.813636363636364
INFO [2025-03-29 13:42:48] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 13:42:48] Using leg importance weights for team optimization: Leg 1: 0.24, Leg 2: 0.26, Leg 3: 0.25, Leg 4: 0.25
INFO [2025-03-29 13:42:48] Optimizing team for Sweden
INFO [2025-03-29 13:42:48] Optimizing team for Norway
INFO [2025-03-29 13:42:48] Optimizing team for Germany
INFO [2025-03-29 13:42:49] Optimizing team for USA
INFO [2025-03-29 13:42:49] Optimizing team for Austria
INFO [2025-03-29 13:42:49] Optimizing team for Finland
INFO [2025-03-29 13:42:49] Optimizing team for Czechia
INFO [2025-03-29 13:42:49] Optimizing team for Switzerland
INFO [2025-03-29 13:42:49] Optimizing team for Italy
INFO [2025-03-29 13:42:49] Optimizing team for France
INFO [2025-03-29 13:42:49] Optimizing team for Canada
INFO [2025-03-29 13:42:49] Optimizing team for Slovenia
INFO [2025-03-29 13:42:49] Optimizing team for Estonia
INFO [2025-03-29 13:42:49] Optimizing team for Australia
INFO [2025-03-29 13:42:49] Optimizing team for Ukraine
INFO [2025-03-29 13:42:49] Optimizing team for Kazakhstan
INFO [2025-03-29 13:42:49] Optimizing team for Armenia
INFO [2025-03-29 13:42:49] Optimizing team for Latvia
INFO [2025-03-29 13:42:49] Optimizing team for Japan
INFO [2025-03-29 13:42:49] Optimizing team for Poland
INFO [2025-03-29 13:42:49] Optimizing team for South Korea
INFO [2025-03-29 13:42:49] Optimizing team for Andorra
INFO [2025-03-29 13:42:49] Optimizing team for Taiwan
INFO [2025-03-29 13:42:49] Optimizing team for China
INFO [2025-03-29 13:42:49] Optimizing team for Croatia
INFO [2025-03-29 13:42:49] Optimizing team for Slovakia
INFO [2025-03-29 13:42:49] Optimizing team for Argentina
INFO [2025-03-29 13:42:49] Optimizing team for Mongolia
INFO [2025-03-29 13:42:49] Optimizing team for Brazil
INFO [2025-03-29 13:42:49] Optimizing team for Lithuania
INFO [2025-03-29 13:42:49] Optimizing team for Greece
INFO [2025-03-29 13:42:49] Optimizing team for Iceland
INFO [2025-03-29 13:42:49] Optimizing team for Bulgaria
INFO [2025-03-29 13:42:49] Optimizing team for Serbia
INFO [2025-03-29 13:42:49] Optimizing team for Hungary
INFO [2025-03-29 13:42:49] Optimizing team for Turkey
INFO [2025-03-29 13:42:49] Optimizing team for North Macedonia
INFO [2025-03-29 13:42:49] Optimizing team for Romania
INFO [2025-03-29 13:42:49] Optimizing team for Bosnia&Herzegovina
INFO [2025-03-29 13:42:49] Optimizing team for Mexico
INFO [2025-03-29 13:42:49] Optimizing team for Iran
INFO [2025-03-29 13:42:49] Optimizing team for Chile
INFO [2025-03-29 13:42:49] Optimizing team for India
INFO [2025-03-29 13:42:49] Optimizing team for Malaysia
INFO [2025-03-29 13:42:49] Optimizing team for Haiti
INFO [2025-03-29 13:42:49] Optimizing team for Lebanon
INFO [2025-03-29 13:42:49] Optimizing team for Liechtenstein
INFO [2025-03-29 13:42:50] Matching optimized teams with startlist team names and prices
INFO [2025-03-29 13:42:50] Resetting men's probabilities at or below the mode to zero
INFO [2025-03-29 13:42:50] No values appear more than twice for Win_Prob
INFO [2025-03-29 13:42:50] No values appear more than twice for Podium_Prob
INFO [2025-03-29 13:42:50] No values appear more than twice for Top5_Prob
INFO [2025-03-29 13:42:50] No values appear more than twice for Top10_Prob
INFO [2025-03-29 13:42:50] Resetting ladies' probabilities at or below the mode to zero
INFO [2025-03-29 13:42:50] Reset 21 values to 0 for Win_Prob (repeated values or values <  0 )
INFO [2025-03-29 13:42:50] Repeated values: 0, 0, 0, 0, 0
INFO [2025-03-29 13:42:50] No values appear more than twice for Podium_Prob
INFO [2025-03-29 13:42:50] No values appear more than twice for Top5_Prob
INFO [2025-03-29 13:42:50] No values appear more than twice for Top10_Prob
INFO [2025-03-29 13:42:50] Normalizing men's team probabilities
INFO [2025-03-29 13:42:50] Normalized Win_Prob from sum of 0.71 to 1
INFO [2025-03-29 13:42:50] Normalized Podium_Prob from sum of 2.34 to 3
INFO [2025-03-29 13:42:50] Normalized Top5_Prob from sum of 4.2 to 5
INFO [2025-03-29 13:42:50] Normalized Top10_Prob from sum of 10.33 to 10
INFO [2025-03-29 13:42:50] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 13:42:50] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 13:42:50] Normalizing ladies' team probabilities
INFO [2025-03-29 13:42:50] Normalized Win_Prob from sum of 1.87 to 1
INFO [2025-03-29 13:42:50] Normalized Podium_Prob from sum of 4.27 to 3
INFO [2025-03-29 13:42:50] Normalized Top5_Prob from sum of 4.84 to 5
INFO [2025-03-29 13:42:50] Normalized Top10_Prob from sum of 13.47 to 10
INFO [2025-03-29 13:42:50] Final capping of probabilities to maximum of 1
INFO [2025-03-29 13:42:50] Capped 1 values at 1 for Podium_Prob
INFO [2025-03-29 13:42:50] Capped 1 values at 1 for Top5_Prob
INFO [2025-03-29 13:42:50] Optimizing fantasy relay team
INFO [2025-03-29 13:42:50] Fantasy team optimization complete. Selected 11 teams.
INFO [2025-03-29 13:42:50] Total price: 99734 of max 1e+05
INFO [2025-03-29 13:42:50] Expected total points: 909
INFO [2025-03-29 13:42:50] Men's teams: 5 ( 5 )
INFO [2025-03-29 13:42:50] Ladies' teams: 6 ( 6 )
INFO [2025-03-29 13:42:50] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_points.xlsx
INFO [2025-03-29 13:42:50] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_relay_probabilities.xlsx
INFO [2025-03-29 13:42:50] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_points.xlsx
INFO [2025-03-29 13:42:50] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_relay_probabilities.xlsx
INFO [2025-03-29 13:42:50] Saved fantasy team results to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/fantasy_relay_team.xlsx
INFO [2025-03-29 13:42:50] Relay predictions completed successfully
