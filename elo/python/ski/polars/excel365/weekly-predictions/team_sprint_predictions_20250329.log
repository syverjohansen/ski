INFO [2025-03-29 14:15:34] Starting team sprint predictions process
INFO [2025-03-29 14:15:34] Loading weekend race data
INFO [2025-03-29 14:15:34] Tomorrow's date: 2025-03-30
INFO [2025-03-29 14:15:34] No team sprint races found for tomorrow, finding next team sprint race
WARN [2025-03-29 14:15:34] No upcoming team sprint races found in the schedule
INFO [2025-03-29 14:15:34] Found 0 men's team sprint races and 0 ladies' team sprint races
ERROR [2025-03-29 14:15:34] No upcoming team sprint races found. Exiting.
INFO [2025-03-29 14:15:52] Starting team sprint predictions process
INFO [2025-03-29 14:16:11] Loading weekend race data
INFO [2025-03-29 14:16:11] Tomorrow's date: 2025-03-30
INFO [2025-03-29 14:16:11] No team sprint races found for tomorrow, finding next team sprint race
WARN [2025-03-29 14:16:11] No upcoming team sprint races found in the schedule
INFO [2025-03-29 14:16:11] Found 0 men's team sprint races and 0 ladies' team sprint races
ERROR [2025-03-29 14:16:11] No upcoming team sprint races found. Exiting.
INFO [2025-03-29 14:17:03] Starting team sprint predictions process
INFO [2025-03-29 14:17:03] Loading weekend race data
INFO [2025-03-29 14:17:03] Tomorrow's date: 2025-03-29
INFO [2025-03-29 14:17:03] Found 1 men's team sprint races and 1 ladies' team sprint races
INFO [2025-03-29 14:17:03] Men's team sprint technique: C
INFO [2025-03-29 14:17:03] Ladies' team sprint technique: C
INFO [2025-03-29 14:17:03] Men's team sprint technique: C
INFO [2025-03-29 14:17:03] Ladies' team sprint technique: C
INFO [2025-03-29 14:17:03] Loading chrono data
INFO [2025-03-29 14:17:09] Loaded men's chrono with 105122 rows and 36 columns
INFO [2025-03-29 14:17:09] Loaded ladies' chrono with 78706 rows and 36 columns
INFO [2025-03-29 14:17:09] Created men's team sprint df with 3291 rows
INFO [2025-03-29 14:17:09] Created men's individual df with 92143 rows
INFO [2025-03-29 14:17:09] Created ladies' team sprint df with 2434 rows
INFO [2025-03-29 14:17:09] Created ladies' individual df with 68253 rows
INFO [2025-03-29 14:17:12] Filtered men's team sprint data by technique C - kept 997 of 3291 records
INFO [2025-03-29 14:17:12] Filtered ladies' team sprint data by technique C - kept 700 of 2434 records
INFO [2025-03-29 14:17:13] Training models for Leg 1
INFO [2025-03-29 14:17:13] Determined technique from leg data: C
INFO [2025-03-29 14:17:13] Race is classic technique - using classic-specific predictors
INFO [2025-03-29 14:17:13] Selected predictors for leg 1 : Pelo_Pct, Weighted_Last_5, Sprint_Pelo_Pct, Distance_Pelo_Pct, Sprint_C_Pelo_Pct, Classic_Pelo_Pct, Sprint_F_Pelo_Pct
INFO [2025-03-29 14:17:13] Using predictors: Pelo_Pct, Weighted_Last_5, Sprint_Pelo_Pct, Distance_Pelo_Pct, Sprint_C_Pelo_Pct, Classic_Pelo_Pct, Sprint_F_Pelo_Pct
INFO [2025-03-29 14:17:13] Training podium model using glm
INFO [2025-03-29 14:17:13] Training win model using glm
INFO [2025-03-29 14:17:13] Training top5 model using glm
INFO [2025-03-29 14:17:13] Training top10 model using glm
INFO [2025-03-29 14:17:13] Top features for Leg 1 podium prediction:
INFO [2025-03-29 14:17:13] Training models for Leg 2
INFO [2025-03-29 14:17:13] Determined technique from leg data: C
INFO [2025-03-29 14:17:13] Race is classic technique - using classic-specific predictors
INFO [2025-03-29 14:17:13] Selected predictors for leg 2 : Pelo_Pct, Weighted_Last_5, Sprint_Pelo_Pct, Distance_Pelo_Pct, Sprint_C_Pelo_Pct, Classic_Pelo_Pct, Sprint_F_Pelo_Pct
INFO [2025-03-29 14:17:13] Using predictors: Pelo_Pct, Weighted_Last_5, Sprint_Pelo_Pct, Distance_Pelo_Pct, Sprint_C_Pelo_Pct, Classic_Pelo_Pct, Sprint_F_Pelo_Pct
INFO [2025-03-29 14:17:13] Training podium model using glm
INFO [2025-03-29 14:17:13] Training win model using glm
INFO [2025-03-29 14:17:13] Training top5 model using glm
INFO [2025-03-29 14:17:14] Training top10 model using glm
INFO [2025-03-29 14:17:14] Top features for Leg 2 podium prediction:
INFO [2025-03-29 14:17:14] Training models for Leg 1
INFO [2025-03-29 14:17:14] Determined technique from leg data: C
INFO [2025-03-29 14:17:14] Race is classic technique - using classic-specific predictors
INFO [2025-03-29 14:17:14] Selected predictors for leg 1 : Pelo_Pct, Weighted_Last_5, Sprint_Pelo_Pct, Distance_Pelo_Pct, Sprint_C_Pelo_Pct, Classic_Pelo_Pct, Sprint_F_Pelo_Pct
INFO [2025-03-29 14:17:14] Using predictors: Pelo_Pct, Weighted_Last_5, Sprint_Pelo_Pct, Distance_Pelo_Pct, Sprint_C_Pelo_Pct, Classic_Pelo_Pct, Sprint_F_Pelo_Pct
INFO [2025-03-29 14:17:14] Training podium model using glm
INFO [2025-03-29 14:17:14] Training win model using glm
INFO [2025-03-29 14:17:14] Training top5 model using glm
INFO [2025-03-29 14:17:14] Training top10 model using glm
INFO [2025-03-29 14:17:14] Top features for Leg 1 podium prediction:
INFO [2025-03-29 14:17:14] Training models for Leg 2
INFO [2025-03-29 14:17:14] Determined technique from leg data: C
INFO [2025-03-29 14:17:14] Race is classic technique - using classic-specific predictors
INFO [2025-03-29 14:17:14] Selected predictors for leg 2 : Pelo_Pct, Weighted_Last_5, Sprint_Pelo_Pct, Distance_Pelo_Pct, Sprint_C_Pelo_Pct, Classic_Pelo_Pct, Sprint_F_Pelo_Pct
INFO [2025-03-29 14:17:14] Using predictors: Pelo_Pct, Weighted_Last_5, Sprint_Pelo_Pct, Distance_Pelo_Pct, Sprint_C_Pelo_Pct, Classic_Pelo_Pct, Sprint_F_Pelo_Pct
INFO [2025-03-29 14:17:14] Training podium model using glm
INFO [2025-03-29 14:17:14] Training win model using glm
INFO [2025-03-29 14:17:14] Training top5 model using glm
INFO [2025-03-29 14:17:14] Training top10 model using glm
INFO [2025-03-29 14:17:14] Top features for Leg 2 podium prediction:
INFO [2025-03-29 14:17:14] Processing men's team sprint predictions
INFO [2025-03-29 14:17:14] Loaded men team sprint teams startlist with 31 rows
INFO [2025-03-29 14:17:14] Loaded men team sprint individuals startlist with 62 rows
INFO [2025-03-29 14:17:14] Preparing current men skier data
INFO [2025-03-29 14:17:15] Replaced NAs in Distance_Elo with first quartile: 1207.23243912712
INFO [2025-03-29 14:17:15] Replaced NAs in Distance_C_Elo with first quartile: 1233.40200699225
INFO [2025-03-29 14:17:15] Replaced NAs in Distance_F_Elo with first quartile: 1236.48554062178
INFO [2025-03-29 14:17:15] Replaced NAs in Sprint_Elo with first quartile: 1223.60107000698
INFO [2025-03-29 14:17:15] Replaced NAs in Sprint_C_Elo with first quartile: 1241.28715500947
INFO [2025-03-29 14:17:15] Replaced NAs in Sprint_F_Elo with first quartile: 1234.45151108772
INFO [2025-03-29 14:17:15] Replaced NAs in Classic_Elo with first quartile: 1241.52867310024
INFO [2025-03-29 14:17:15] Replaced NAs in Freestyle_Elo with first quartile: 1228.48649348109
INFO [2025-03-29 14:17:15] Replaced NAs in Distance_Pelo with first quartile: 1211.63035979047
INFO [2025-03-29 14:17:15] Replaced NAs in Distance_C_Pelo with first quartile: 1234.81091928129
INFO [2025-03-29 14:17:15] Replaced NAs in Distance_F_Pelo with first quartile: 1239.65331180248
INFO [2025-03-29 14:17:15] Replaced NAs in Sprint_Pelo with first quartile: 1240.94751821383
INFO [2025-03-29 14:17:15] Replaced NAs in Sprint_C_Pelo with first quartile: 1241.28715500947
INFO [2025-03-29 14:17:15] Replaced NAs in Sprint_F_Pelo with first quartile: 1252.45166310493
INFO [2025-03-29 14:17:15] Replaced NAs in Classic_Pelo with first quartile: 1243.63746068082
INFO [2025-03-29 14:17:15] Replaced NAs in Freestyle_Pelo with first quartile: 1249.30280713791
INFO [2025-03-29 14:17:15] Replaced NAs in Sprint_Last_5 with first quartile: 0
INFO [2025-03-29 14:17:15] Created Pelo_Pct from Elo with max value: 1946.6211651574
INFO [2025-03-29 14:17:15] Created Distance_Pelo_Pct from Distance_Elo with max value: 1869.1251911742
INFO [2025-03-29 14:17:15] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1777.16297253153
INFO [2025-03-29 14:17:15] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1695.2053212904
INFO [2025-03-29 14:17:15] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1886.80363942481
INFO [2025-03-29 14:17:15] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1711.08486899169
INFO [2025-03-29 14:17:15] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1792.65157560707
INFO [2025-03-29 14:17:15] Created Classic_Pelo_Pct from Classic_Elo with max value: 1807.56773496777
INFO [2025-03-29 14:17:15] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1814.60460629541
INFO [2025-03-29 14:17:15] Prepared data for 381 men skiers with 31 features
INFO [2025-03-29 14:17:15] Using FIS startlist for men's leg predictions
INFO [2025-03-29 14:17:15] Using FIS startlist for men
INFO [2025-03-29 14:17:15] Attempting Option 1: Team model coefficients
INFO [2025-03-29 14:17:15] Option 1 failed: No team_podium model found
INFO [2025-03-29 14:17:15] Option 1 failed: No team model
INFO [2025-03-29 14:17:15] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 14:17:15] Leg 1 accuracy: 0.916428571428571
INFO [2025-03-29 14:17:15] Leg 2 accuracy: 0.931707317073171
INFO [2025-03-29 14:17:15] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 14:17:15] Leg importance weights: Leg 1: 0.50, Leg 2: 0.50
INFO [2025-03-29 14:17:15] Processing ladies' team sprint predictions
INFO [2025-03-29 14:17:15] Loaded ladies team sprint teams startlist with 26 rows
INFO [2025-03-29 14:17:15] Loaded ladies team sprint individuals startlist with 52 rows
INFO [2025-03-29 14:17:15] Preparing current ladies skier data
INFO [2025-03-29 14:17:15] Replaced NAs in Distance_Elo with first quartile: 1237.38564383256
INFO [2025-03-29 14:17:15] Replaced NAs in Distance_C_Elo with first quartile: 1243.87329106944
INFO [2025-03-29 14:17:15] Replaced NAs in Distance_F_Elo with first quartile: 1256.69628195708
INFO [2025-03-29 14:17:15] Replaced NAs in Sprint_Elo with first quartile: 1246.32574824425
INFO [2025-03-29 14:17:15] Replaced NAs in Sprint_C_Elo with first quartile: 1257.67866787334
INFO [2025-03-29 14:17:15] Replaced NAs in Sprint_F_Elo with first quartile: 1244.84742904868
INFO [2025-03-29 14:17:15] Replaced NAs in Classic_Elo with first quartile: 1252.44868703669
INFO [2025-03-29 14:17:15] Replaced NAs in Freestyle_Elo with first quartile: 1244.44508230281
INFO [2025-03-29 14:17:15] Replaced NAs in Distance_Pelo with first quartile: 1241.11854419952
INFO [2025-03-29 14:17:15] Replaced NAs in Distance_C_Pelo with first quartile: 1245.57367555166
INFO [2025-03-29 14:17:15] Replaced NAs in Distance_F_Pelo with first quartile: 1259.54282973153
INFO [2025-03-29 14:17:15] Replaced NAs in Sprint_Pelo with first quartile: 1254.58885254623
INFO [2025-03-29 14:17:15] Replaced NAs in Sprint_C_Pelo with first quartile: 1257.58302026178
INFO [2025-03-29 14:17:15] Replaced NAs in Sprint_F_Pelo with first quartile: 1257.67755691493
INFO [2025-03-29 14:17:15] Replaced NAs in Classic_Pelo with first quartile: 1256.79275004544
INFO [2025-03-29 14:17:15] Replaced NAs in Freestyle_Pelo with first quartile: 1256.79999900008
INFO [2025-03-29 14:17:15] Replaced NAs in Sprint_Last_5 with first quartile: 0
INFO [2025-03-29 14:17:15] Created Pelo_Pct from Elo with max value: 1841.00191142018
INFO [2025-03-29 14:17:15] Created Distance_Pelo_Pct from Distance_Elo with max value: 1889.46974050597
INFO [2025-03-29 14:17:15] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1763.33572074398
INFO [2025-03-29 14:17:15] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1693.85026290322
INFO [2025-03-29 14:17:15] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1742.74758850835
INFO [2025-03-29 14:17:15] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1601.5820663103
INFO [2025-03-29 14:17:15] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1681.09824552997
INFO [2025-03-29 14:17:15] Created Classic_Pelo_Pct from Classic_Elo with max value: 1698.69428891549
INFO [2025-03-29 14:17:15] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1707.58410982918
INFO [2025-03-29 14:17:15] Prepared data for 255 ladies skiers with 31 features
INFO [2025-03-29 14:17:15] Using FIS startlist for ladies' leg predictions
INFO [2025-03-29 14:17:15] Using FIS startlist for ladies
INFO [2025-03-29 14:17:15] Attempting Option 1: Team model coefficients
INFO [2025-03-29 14:17:15] Option 1 failed: No team_podium model found
INFO [2025-03-29 14:17:15] Option 1 failed: No team model
INFO [2025-03-29 14:17:15] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 14:17:15] Leg 1 accuracy: 0.865934065934066
INFO [2025-03-29 14:17:15] Leg 2 accuracy: 0.847985347985348
INFO [2025-03-29 14:17:15] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 14:17:15] Leg importance weights: Leg 1: 0.51, Leg 2: 0.49
INFO [2025-03-29 14:17:15] Resetting men's probabilities at or below the mode to zero
INFO [2025-03-29 14:17:15] Reset 30 values to 0 for Win_Prob (repeated values or values <  0 )
INFO [2025-03-29 14:17:15] Repeated values: 0
INFO [2025-03-29 14:17:15] No values appear more than twice for Podium_Prob
INFO [2025-03-29 14:17:15] No values appear more than twice for Top5_Prob
INFO [2025-03-29 14:17:15] No values appear more than twice for Top10_Prob
INFO [2025-03-29 14:17:15] Resetting ladies' probabilities at or below the mode to zero
INFO [2025-03-29 14:17:15] Reset 25 values to 0 for Win_Prob (repeated values or values <  0 )
INFO [2025-03-29 14:17:15] Repeated values: 0
INFO [2025-03-29 14:17:15] No values appear more than twice for Podium_Prob
INFO [2025-03-29 14:17:15] No values appear more than twice for Top5_Prob
INFO [2025-03-29 14:17:15] No values appear more than twice for Top10_Prob
INFO [2025-03-29 14:17:15] Normalizing men's team probabilities
INFO [2025-03-29 14:17:15] Normalized Win_Prob from sum of 1 to 1
INFO [2025-03-29 14:17:15] Normalized Podium_Prob from sum of 1.82 to 3
INFO [2025-03-29 14:17:15] Normalized Top5_Prob from sum of 3.41 to 5
INFO [2025-03-29 14:17:15] Normalized Top10_Prob from sum of 7.38 to 10
INFO [2025-03-29 14:17:15] Recalculated Expected_Points based on normalized probabilities
INFO [2025-03-29 14:17:15] Normalizing ladies' team probabilities
INFO [2025-03-29 14:17:15] Normalized Win_Prob from sum of 0.51 to 1
INFO [2025-03-29 14:17:15] Normalized Podium_Prob from sum of 2.57 to 3
INFO [2025-03-29 14:17:15] Normalized Top5_Prob from sum of 3.86 to 5
INFO [2025-03-29 14:17:15] Normalized Top10_Prob from sum of 7.75 to 10
INFO [2025-03-29 14:17:15] Recalculated Expected_Points based on normalized probabilities
INFO [2025-03-29 14:17:15] Optimizing fantasy team sprint team
INFO [2025-03-29 14:17:15] Fantasy team optimization complete. Selected 12 teams.
INFO [2025-03-29 14:17:15] Total price: 99968 of max 1e+05
INFO [2025-03-29 14:17:15] Expected total points: 919.1
INFO [2025-03-29 14:17:15] Men's teams: 6 ( 6 )
INFO [2025-03-29 14:17:15] Ladies' teams: 6 ( 6 )
INFO [2025-03-29 14:17:15] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_team_sprint_points.xlsx
INFO [2025-03-29 14:17:15] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_team_sprint_probabilities.xlsx
INFO [2025-03-29 14:17:15] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_team_sprint_points.xlsx
INFO [2025-03-29 14:17:15] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_team_sprint_probabilities.xlsx
INFO [2025-03-29 14:17:15] Saved fantasy team results to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/fantasy_team_sprint_team.xlsx
INFO [2025-03-29 14:17:15] Team sprint predictions completed successfully
INFO [2025-03-29 14:22:16] Starting team sprint predictions process
INFO [2025-03-29 14:22:16] Loading weekend race data
INFO [2025-03-29 14:22:16] Tomorrow's date: 2025-03-29
INFO [2025-03-29 14:22:16] Found 1 men's team sprint races and 1 ladies' team sprint races
INFO [2025-03-29 14:22:16] Men's team sprint technique: C
INFO [2025-03-29 14:22:16] Ladies' team sprint technique: C
INFO [2025-03-29 14:22:16] Men's team sprint technique: C
INFO [2025-03-29 14:22:16] Ladies' team sprint technique: C
INFO [2025-03-29 14:22:16] Loading chrono data
INFO [2025-03-29 14:22:22] Loaded men's chrono with 105122 rows and 36 columns
INFO [2025-03-29 14:22:22] Loaded ladies' chrono with 78706 rows and 36 columns
INFO [2025-03-29 14:22:22] Created men's team sprint df with 3291 rows
INFO [2025-03-29 14:22:22] Created men's individual df with 92143 rows
INFO [2025-03-29 14:22:22] Created ladies' team sprint df with 2434 rows
INFO [2025-03-29 14:22:22] Created ladies' individual df with 68253 rows
INFO [2025-03-29 14:22:26] Filtered men's team sprint data by technique C - kept 997 of 3291 records
INFO [2025-03-29 14:22:26] Filtered ladies' team sprint data by technique C - kept 700 of 2434 records
INFO [2025-03-29 14:22:26] Training models for Leg 1
INFO [2025-03-29 14:22:26] Determined technique from leg data: C
INFO [2025-03-29 14:22:26] Race is classic technique - using classic-specific predictors
INFO [2025-03-29 14:22:26] Selected predictors for leg 1 : Pelo_Pct, Weighted_Last_5, Sprint_Pelo_Pct, Distance_Pelo_Pct, Sprint_C_Pelo_Pct, Classic_Pelo_Pct, Sprint_F_Pelo_Pct
INFO [2025-03-29 14:22:26] Using predictors: Pelo_Pct, Weighted_Last_5, Sprint_Pelo_Pct, Distance_Pelo_Pct, Sprint_C_Pelo_Pct, Classic_Pelo_Pct, Sprint_F_Pelo_Pct
INFO [2025-03-29 14:22:26] Training podium model using glm
INFO [2025-03-29 14:22:26] Training win model using glm
INFO [2025-03-29 14:22:26] Training top5 model using glm
INFO [2025-03-29 14:22:26] Training top10 model using glm
INFO [2025-03-29 14:22:26] Top features for Leg 1 podium prediction:
INFO [2025-03-29 14:22:26] Training models for Leg 2
INFO [2025-03-29 14:22:26] Determined technique from leg data: C
INFO [2025-03-29 14:22:26] Race is classic technique - using classic-specific predictors
INFO [2025-03-29 14:22:26] Selected predictors for leg 2 : Pelo_Pct, Weighted_Last_5, Sprint_Pelo_Pct, Distance_Pelo_Pct, Sprint_C_Pelo_Pct, Classic_Pelo_Pct, Sprint_F_Pelo_Pct
INFO [2025-03-29 14:22:26] Using predictors: Pelo_Pct, Weighted_Last_5, Sprint_Pelo_Pct, Distance_Pelo_Pct, Sprint_C_Pelo_Pct, Classic_Pelo_Pct, Sprint_F_Pelo_Pct
INFO [2025-03-29 14:22:26] Training podium model using glm
INFO [2025-03-29 14:22:27] Training win model using glm
INFO [2025-03-29 14:22:27] Training top5 model using glm
INFO [2025-03-29 14:22:27] Training top10 model using glm
INFO [2025-03-29 14:22:27] Top features for Leg 2 podium prediction:
INFO [2025-03-29 14:22:27] Training models for Leg 1
INFO [2025-03-29 14:22:27] Determined technique from leg data: C
INFO [2025-03-29 14:22:27] Race is classic technique - using classic-specific predictors
INFO [2025-03-29 14:22:27] Selected predictors for leg 1 : Pelo_Pct, Weighted_Last_5, Sprint_Pelo_Pct, Distance_Pelo_Pct, Sprint_C_Pelo_Pct, Classic_Pelo_Pct, Sprint_F_Pelo_Pct
INFO [2025-03-29 14:22:27] Using predictors: Pelo_Pct, Weighted_Last_5, Sprint_Pelo_Pct, Distance_Pelo_Pct, Sprint_C_Pelo_Pct, Classic_Pelo_Pct, Sprint_F_Pelo_Pct
INFO [2025-03-29 14:22:27] Training podium model using glm
INFO [2025-03-29 14:22:27] Training win model using glm
INFO [2025-03-29 14:22:27] Training top5 model using glm
INFO [2025-03-29 14:22:27] Training top10 model using glm
INFO [2025-03-29 14:22:27] Top features for Leg 1 podium prediction:
INFO [2025-03-29 14:22:27] Training models for Leg 2
INFO [2025-03-29 14:22:27] Determined technique from leg data: C
INFO [2025-03-29 14:22:27] Race is classic technique - using classic-specific predictors
INFO [2025-03-29 14:22:27] Selected predictors for leg 2 : Pelo_Pct, Weighted_Last_5, Sprint_Pelo_Pct, Distance_Pelo_Pct, Sprint_C_Pelo_Pct, Classic_Pelo_Pct, Sprint_F_Pelo_Pct
INFO [2025-03-29 14:22:27] Using predictors: Pelo_Pct, Weighted_Last_5, Sprint_Pelo_Pct, Distance_Pelo_Pct, Sprint_C_Pelo_Pct, Classic_Pelo_Pct, Sprint_F_Pelo_Pct
INFO [2025-03-29 14:22:27] Training podium model using glm
INFO [2025-03-29 14:22:27] Training win model using glm
INFO [2025-03-29 14:22:27] Training top5 model using glm
INFO [2025-03-29 14:22:27] Training top10 model using glm
INFO [2025-03-29 14:22:28] Top features for Leg 2 podium prediction:
INFO [2025-03-29 14:22:28] Processing men's team sprint predictions
INFO [2025-03-29 14:22:28] Loaded men team sprint teams startlist with 31 rows
INFO [2025-03-29 14:22:28] Loaded men team sprint individuals startlist with 62 rows
INFO [2025-03-29 14:22:28] Preparing current men skier data
INFO [2025-03-29 14:22:28] Replaced NAs in Distance_Elo with first quartile: 1207.23243912712
INFO [2025-03-29 14:22:28] Replaced NAs in Distance_C_Elo with first quartile: 1233.40200699225
INFO [2025-03-29 14:22:28] Replaced NAs in Distance_F_Elo with first quartile: 1236.48554062178
INFO [2025-03-29 14:22:28] Replaced NAs in Sprint_Elo with first quartile: 1223.60107000698
INFO [2025-03-29 14:22:28] Replaced NAs in Sprint_C_Elo with first quartile: 1241.28715500947
INFO [2025-03-29 14:22:28] Replaced NAs in Sprint_F_Elo with first quartile: 1234.45151108772
INFO [2025-03-29 14:22:28] Replaced NAs in Classic_Elo with first quartile: 1241.52867310024
INFO [2025-03-29 14:22:28] Replaced NAs in Freestyle_Elo with first quartile: 1228.48649348109
INFO [2025-03-29 14:22:28] Replaced NAs in Distance_Pelo with first quartile: 1211.63035979047
INFO [2025-03-29 14:22:28] Replaced NAs in Distance_C_Pelo with first quartile: 1234.81091928129
INFO [2025-03-29 14:22:28] Replaced NAs in Distance_F_Pelo with first quartile: 1239.65331180248
INFO [2025-03-29 14:22:28] Replaced NAs in Sprint_Pelo with first quartile: 1240.94751821383
INFO [2025-03-29 14:22:28] Replaced NAs in Sprint_C_Pelo with first quartile: 1241.28715500947
INFO [2025-03-29 14:22:28] Replaced NAs in Sprint_F_Pelo with first quartile: 1252.45166310493
INFO [2025-03-29 14:22:28] Replaced NAs in Classic_Pelo with first quartile: 1243.63746068082
INFO [2025-03-29 14:22:28] Replaced NAs in Freestyle_Pelo with first quartile: 1249.30280713791
INFO [2025-03-29 14:22:28] Replaced NAs in Sprint_Last_5 with first quartile: 0
INFO [2025-03-29 14:22:28] Created Pelo_Pct from Elo with max value: 1946.6211651574
INFO [2025-03-29 14:22:28] Created Distance_Pelo_Pct from Distance_Elo with max value: 1869.1251911742
INFO [2025-03-29 14:22:28] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1777.16297253153
INFO [2025-03-29 14:22:28] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1695.2053212904
INFO [2025-03-29 14:22:28] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1886.80363942481
INFO [2025-03-29 14:22:28] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1711.08486899169
INFO [2025-03-29 14:22:28] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1792.65157560707
INFO [2025-03-29 14:22:28] Created Classic_Pelo_Pct from Classic_Elo with max value: 1807.56773496777
INFO [2025-03-29 14:22:28] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1814.60460629541
INFO [2025-03-29 14:22:28] Prepared data for 381 men skiers with 31 features
INFO [2025-03-29 14:22:28] Using FIS startlist for men's leg predictions
INFO [2025-03-29 14:22:28] Using FIS startlist for men
INFO [2025-03-29 14:22:28] Attempting Option 1: Team model coefficients
INFO [2025-03-29 14:22:28] Option 1 failed: No team_podium model found
INFO [2025-03-29 14:22:28] Option 1 failed: No team model
INFO [2025-03-29 14:22:28] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 14:22:28] Leg 1 accuracy: 0.91109756097561
INFO [2025-03-29 14:22:28] Leg 2 accuracy: 0.917073170731707
INFO [2025-03-29 14:22:28] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 14:22:28] Leg importance weights: Leg 1: 0.50, Leg 2: 0.50
INFO [2025-03-29 14:22:28] Processing ladies' team sprint predictions
INFO [2025-03-29 14:22:28] Loaded ladies team sprint teams startlist with 26 rows
INFO [2025-03-29 14:22:28] Loaded ladies team sprint individuals startlist with 52 rows
INFO [2025-03-29 14:22:28] Preparing current ladies skier data
INFO [2025-03-29 14:22:28] Replaced NAs in Distance_Elo with first quartile: 1237.38564383256
INFO [2025-03-29 14:22:28] Replaced NAs in Distance_C_Elo with first quartile: 1243.87329106944
INFO [2025-03-29 14:22:28] Replaced NAs in Distance_F_Elo with first quartile: 1256.69628195708
INFO [2025-03-29 14:22:28] Replaced NAs in Sprint_Elo with first quartile: 1246.32574824425
INFO [2025-03-29 14:22:28] Replaced NAs in Sprint_C_Elo with first quartile: 1257.67866787334
INFO [2025-03-29 14:22:28] Replaced NAs in Sprint_F_Elo with first quartile: 1244.84742904868
INFO [2025-03-29 14:22:28] Replaced NAs in Classic_Elo with first quartile: 1252.44868703669
INFO [2025-03-29 14:22:28] Replaced NAs in Freestyle_Elo with first quartile: 1244.44508230281
INFO [2025-03-29 14:22:28] Replaced NAs in Distance_Pelo with first quartile: 1241.11854419952
INFO [2025-03-29 14:22:28] Replaced NAs in Distance_C_Pelo with first quartile: 1245.57367555166
INFO [2025-03-29 14:22:28] Replaced NAs in Distance_F_Pelo with first quartile: 1259.54282973153
INFO [2025-03-29 14:22:28] Replaced NAs in Sprint_Pelo with first quartile: 1254.58885254623
INFO [2025-03-29 14:22:28] Replaced NAs in Sprint_C_Pelo with first quartile: 1257.58302026178
INFO [2025-03-29 14:22:28] Replaced NAs in Sprint_F_Pelo with first quartile: 1257.67755691493
INFO [2025-03-29 14:22:28] Replaced NAs in Classic_Pelo with first quartile: 1256.79275004544
INFO [2025-03-29 14:22:28] Replaced NAs in Freestyle_Pelo with first quartile: 1256.79999900008
INFO [2025-03-29 14:22:28] Replaced NAs in Sprint_Last_5 with first quartile: 0
INFO [2025-03-29 14:22:28] Created Pelo_Pct from Elo with max value: 1841.00191142018
INFO [2025-03-29 14:22:28] Created Distance_Pelo_Pct from Distance_Elo with max value: 1889.46974050597
INFO [2025-03-29 14:22:28] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1763.33572074398
INFO [2025-03-29 14:22:28] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1693.85026290322
INFO [2025-03-29 14:22:28] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1742.74758850835
INFO [2025-03-29 14:22:28] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1601.5820663103
INFO [2025-03-29 14:22:28] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1681.09824552997
INFO [2025-03-29 14:22:28] Created Classic_Pelo_Pct from Classic_Elo with max value: 1698.69428891549
INFO [2025-03-29 14:22:28] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1707.58410982918
INFO [2025-03-29 14:22:28] Prepared data for 255 ladies skiers with 31 features
INFO [2025-03-29 14:22:28] Using FIS startlist for ladies' leg predictions
INFO [2025-03-29 14:22:28] Using FIS startlist for ladies
INFO [2025-03-29 14:22:28] Attempting Option 1: Team model coefficients
INFO [2025-03-29 14:22:28] Option 1 failed: No team_podium model found
INFO [2025-03-29 14:22:28] Option 1 failed: No team model
INFO [2025-03-29 14:22:28] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 14:22:28] Leg 1 accuracy: 0.846886446886447
INFO [2025-03-29 14:22:28] Leg 2 accuracy: 0.832967032967033
INFO [2025-03-29 14:22:28] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 14:22:28] Leg importance weights: Leg 1: 0.50, Leg 2: 0.50
INFO [2025-03-29 14:22:28] Resetting men's probabilities at or below the mode to zero
INFO [2025-03-29 14:22:28] Reset 30 values to 0 for Win_Prob (repeated values or values <  0 )
INFO [2025-03-29 14:22:28] Repeated values: 0
INFO [2025-03-29 14:22:28] No values appear more than twice for Podium_Prob
INFO [2025-03-29 14:22:28] No values appear more than twice for Top5_Prob
INFO [2025-03-29 14:22:28] No values appear more than twice for Top10_Prob
INFO [2025-03-29 14:22:28] Resetting ladies' probabilities at or below the mode to zero
INFO [2025-03-29 14:22:28] Reset 25 values to 0 for Win_Prob (repeated values or values <  0 )
INFO [2025-03-29 14:22:28] Repeated values: 0
INFO [2025-03-29 14:22:28] No values appear more than twice for Podium_Prob
INFO [2025-03-29 14:22:28] No values appear more than twice for Top5_Prob
INFO [2025-03-29 14:22:28] No values appear more than twice for Top10_Prob
INFO [2025-03-29 14:22:28] Normalizing men's team probabilities
INFO [2025-03-29 14:22:28] Normalized Win_Prob from sum of 1 to 1
INFO [2025-03-29 14:22:28] Normalized Podium_Prob from sum of 1.82 to 3
INFO [2025-03-29 14:22:28] Normalized Top5_Prob from sum of 3.41 to 5
INFO [2025-03-29 14:22:28] Normalized Top10_Prob from sum of 7.37 to 10
INFO [2025-03-29 14:22:28] Recalculated Expected_Points based on normalized probabilities
INFO [2025-03-29 14:22:28] Normalizing ladies' team probabilities
INFO [2025-03-29 14:22:28] Normalized Win_Prob from sum of 0.5 to 1
INFO [2025-03-29 14:22:28] Normalized Podium_Prob from sum of 2.57 to 3
INFO [2025-03-29 14:22:28] Normalized Top5_Prob from sum of 3.85 to 5
INFO [2025-03-29 14:22:28] Normalized Top10_Prob from sum of 7.75 to 10
INFO [2025-03-29 14:22:28] Recalculated Expected_Points based on normalized probabilities
INFO [2025-03-29 14:22:28] Optimizing fantasy team sprint team
INFO [2025-03-29 14:22:28] Fantasy team optimization complete. Selected 12 teams.
INFO [2025-03-29 14:22:28] Total price: 99968 of max 1e+05
INFO [2025-03-29 14:22:28] Expected total points: 919.3
INFO [2025-03-29 14:22:28] Men's teams: 6 ( 6 )
INFO [2025-03-29 14:22:28] Ladies' teams: 6 ( 6 )
INFO [2025-03-29 14:22:28] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_team_sprint_points.xlsx
INFO [2025-03-29 14:22:28] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_team_sprint_probabilities.xlsx
INFO [2025-03-29 14:22:28] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_team_sprint_points.xlsx
INFO [2025-03-29 14:22:28] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_team_sprint_probabilities.xlsx
INFO [2025-03-29 14:22:28] Saved fantasy team results to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/fantasy_team_sprint_team.xlsx
INFO [2025-03-29 14:22:28] Team sprint predictions completed successfully
INFO [2025-03-29 14:27:01] Starting team sprint predictions process
INFO [2025-03-29 14:27:01] Loading weekend race data
INFO [2025-03-29 14:27:01] Tomorrow's date: 2025-03-29
INFO [2025-03-29 14:27:01] Found 1 men's team sprint races and 1 ladies' team sprint races
INFO [2025-03-29 14:27:01] Men's team sprint technique: C
INFO [2025-03-29 14:27:01] Ladies' team sprint technique: C
INFO [2025-03-29 14:27:01] Men's team sprint technique: C
INFO [2025-03-29 14:27:01] Ladies' team sprint technique: C
INFO [2025-03-29 14:27:01] Loading chrono data
INFO [2025-03-29 14:27:07] Loaded men's chrono with 105122 rows and 36 columns
INFO [2025-03-29 14:27:07] Loaded ladies' chrono with 78706 rows and 36 columns
INFO [2025-03-29 14:27:07] Created men's team sprint df with 3291 rows
INFO [2025-03-29 14:27:07] Created men's individual df with 92143 rows
INFO [2025-03-29 14:27:07] Created ladies' team sprint df with 2434 rows
INFO [2025-03-29 14:27:07] Created ladies' individual df with 68253 rows
INFO [2025-03-29 14:27:10] Filtered men's team sprint data by technique C - kept 997 of 3291 records
INFO [2025-03-29 14:27:10] Filtered ladies' team sprint data by technique C - kept 700 of 2434 records
INFO [2025-03-29 14:27:11] Training models for Leg 1
INFO [2025-03-29 14:27:11] Determined technique from leg data: C
INFO [2025-03-29 14:27:11] Race is classic technique - using classic-specific predictors
INFO [2025-03-29 14:27:11] Selected predictors for leg 1 : Pelo_Pct, Weighted_Last_5, Sprint_Pelo_Pct, Distance_Pelo_Pct, Sprint_C_Pelo_Pct, Classic_Pelo_Pct, Sprint_F_Pelo_Pct
INFO [2025-03-29 14:27:11] Using predictors: Pelo_Pct, Weighted_Last_5, Sprint_Pelo_Pct, Distance_Pelo_Pct, Sprint_C_Pelo_Pct, Classic_Pelo_Pct, Sprint_F_Pelo_Pct
INFO [2025-03-29 14:27:11] Training podium model using glm
INFO [2025-03-29 14:27:11] Training win model using glm
INFO [2025-03-29 14:27:11] Training top5 model using glm
INFO [2025-03-29 14:27:11] Training top10 model using glm
INFO [2025-03-29 14:27:11] Top features for Leg 1 podium prediction:
INFO [2025-03-29 14:27:11] Training models for Leg 2
INFO [2025-03-29 14:27:11] Determined technique from leg data: C
INFO [2025-03-29 14:27:11] Race is classic technique - using classic-specific predictors
INFO [2025-03-29 14:27:11] Selected predictors for leg 2 : Pelo_Pct, Weighted_Last_5, Sprint_Pelo_Pct, Distance_Pelo_Pct, Sprint_C_Pelo_Pct, Classic_Pelo_Pct, Sprint_F_Pelo_Pct
INFO [2025-03-29 14:27:11] Using predictors: Pelo_Pct, Weighted_Last_5, Sprint_Pelo_Pct, Distance_Pelo_Pct, Sprint_C_Pelo_Pct, Classic_Pelo_Pct, Sprint_F_Pelo_Pct
INFO [2025-03-29 14:27:11] Training podium model using glm
INFO [2025-03-29 14:27:11] Training win model using glm
INFO [2025-03-29 14:27:11] Training top5 model using glm
INFO [2025-03-29 14:27:11] Training top10 model using glm
INFO [2025-03-29 14:27:12] Top features for Leg 2 podium prediction:
INFO [2025-03-29 14:27:12] Training models for Leg 1
INFO [2025-03-29 14:27:12] Determined technique from leg data: C
INFO [2025-03-29 14:27:12] Race is classic technique - using classic-specific predictors
INFO [2025-03-29 14:27:12] Selected predictors for leg 1 : Pelo_Pct, Weighted_Last_5, Sprint_Pelo_Pct, Distance_Pelo_Pct, Sprint_C_Pelo_Pct, Classic_Pelo_Pct, Sprint_F_Pelo_Pct
INFO [2025-03-29 14:27:12] Using predictors: Pelo_Pct, Weighted_Last_5, Sprint_Pelo_Pct, Distance_Pelo_Pct, Sprint_C_Pelo_Pct, Classic_Pelo_Pct, Sprint_F_Pelo_Pct
INFO [2025-03-29 14:27:12] Training podium model using glm
INFO [2025-03-29 14:27:12] Training win model using glm
INFO [2025-03-29 14:27:12] Training top5 model using glm
INFO [2025-03-29 14:27:12] Training top10 model using glm
INFO [2025-03-29 14:27:12] Top features for Leg 1 podium prediction:
INFO [2025-03-29 14:27:12] Training models for Leg 2
INFO [2025-03-29 14:27:12] Determined technique from leg data: C
INFO [2025-03-29 14:27:12] Race is classic technique - using classic-specific predictors
INFO [2025-03-29 14:27:12] Selected predictors for leg 2 : Pelo_Pct, Weighted_Last_5, Sprint_Pelo_Pct, Distance_Pelo_Pct, Sprint_C_Pelo_Pct, Classic_Pelo_Pct, Sprint_F_Pelo_Pct
INFO [2025-03-29 14:27:12] Using predictors: Pelo_Pct, Weighted_Last_5, Sprint_Pelo_Pct, Distance_Pelo_Pct, Sprint_C_Pelo_Pct, Classic_Pelo_Pct, Sprint_F_Pelo_Pct
INFO [2025-03-29 14:27:12] Training podium model using glm
INFO [2025-03-29 14:27:12] Training win model using glm
INFO [2025-03-29 14:27:12] Training top5 model using glm
INFO [2025-03-29 14:27:12] Training top10 model using glm
INFO [2025-03-29 14:27:12] Top features for Leg 2 podium prediction:
INFO [2025-03-29 14:27:12] Processing men's team sprint predictions
INFO [2025-03-29 14:27:12] Loaded men team sprint teams startlist with 31 rows
INFO [2025-03-29 14:27:12] Loaded men team sprint individuals startlist with 62 rows
INFO [2025-03-29 14:27:12] Preparing current men skier data
INFO [2025-03-29 14:27:12] Replaced NAs in Distance_Elo with first quartile: 1207.23243912712
INFO [2025-03-29 14:27:12] Replaced NAs in Distance_C_Elo with first quartile: 1233.40200699225
INFO [2025-03-29 14:27:12] Replaced NAs in Distance_F_Elo with first quartile: 1236.48554062178
INFO [2025-03-29 14:27:12] Replaced NAs in Sprint_Elo with first quartile: 1223.60107000698
INFO [2025-03-29 14:27:12] Replaced NAs in Sprint_C_Elo with first quartile: 1241.28715500947
INFO [2025-03-29 14:27:12] Replaced NAs in Sprint_F_Elo with first quartile: 1234.45151108772
INFO [2025-03-29 14:27:12] Replaced NAs in Classic_Elo with first quartile: 1241.52867310024
INFO [2025-03-29 14:27:12] Replaced NAs in Freestyle_Elo with first quartile: 1228.48649348109
INFO [2025-03-29 14:27:12] Replaced NAs in Distance_Pelo with first quartile: 1211.63035979047
INFO [2025-03-29 14:27:12] Replaced NAs in Distance_C_Pelo with first quartile: 1234.81091928129
INFO [2025-03-29 14:27:12] Replaced NAs in Distance_F_Pelo with first quartile: 1239.65331180248
INFO [2025-03-29 14:27:12] Replaced NAs in Sprint_Pelo with first quartile: 1240.94751821383
INFO [2025-03-29 14:27:12] Replaced NAs in Sprint_C_Pelo with first quartile: 1241.28715500947
INFO [2025-03-29 14:27:12] Replaced NAs in Sprint_F_Pelo with first quartile: 1252.45166310493
INFO [2025-03-29 14:27:12] Replaced NAs in Classic_Pelo with first quartile: 1243.63746068082
INFO [2025-03-29 14:27:12] Replaced NAs in Freestyle_Pelo with first quartile: 1249.30280713791
INFO [2025-03-29 14:27:12] Replaced NAs in Sprint_Last_5 with first quartile: 0
INFO [2025-03-29 14:27:12] Created Pelo_Pct from Elo with max value: 1946.6211651574
INFO [2025-03-29 14:27:12] Created Distance_Pelo_Pct from Distance_Elo with max value: 1869.1251911742
INFO [2025-03-29 14:27:12] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1777.16297253153
INFO [2025-03-29 14:27:12] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1695.2053212904
INFO [2025-03-29 14:27:12] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1886.80363942481
INFO [2025-03-29 14:27:12] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1711.08486899169
INFO [2025-03-29 14:27:12] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1792.65157560707
INFO [2025-03-29 14:27:12] Created Classic_Pelo_Pct from Classic_Elo with max value: 1807.56773496777
INFO [2025-03-29 14:27:12] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1814.60460629541
INFO [2025-03-29 14:27:12] Prepared data for 381 men skiers with 31 features
INFO [2025-03-29 14:27:12] Using FIS startlist for men's leg predictions
INFO [2025-03-29 14:27:13] Using FIS startlist for men
INFO [2025-03-29 14:27:13] Attempting Option 1: Team model coefficients
INFO [2025-03-29 14:27:13] Option 1 failed: No team_podium model found
INFO [2025-03-29 14:27:13] Option 1 failed: No team model
INFO [2025-03-29 14:27:13] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 14:27:13] Leg 1 accuracy: 0.910731707317073
INFO [2025-03-29 14:27:13] Leg 2 accuracy: 0.921927990708479
INFO [2025-03-29 14:27:13] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 14:27:13] Leg importance weights: Leg 1: 0.50, Leg 2: 0.50
INFO [2025-03-29 14:27:13] Processing ladies' team sprint predictions
INFO [2025-03-29 14:27:13] Loaded ladies team sprint teams startlist with 26 rows
INFO [2025-03-29 14:27:13] Loaded ladies team sprint individuals startlist with 52 rows
INFO [2025-03-29 14:27:13] Preparing current ladies skier data
INFO [2025-03-29 14:27:13] Replaced NAs in Distance_Elo with first quartile: 1237.38564383256
INFO [2025-03-29 14:27:13] Replaced NAs in Distance_C_Elo with first quartile: 1243.87329106944
INFO [2025-03-29 14:27:13] Replaced NAs in Distance_F_Elo with first quartile: 1256.69628195708
INFO [2025-03-29 14:27:13] Replaced NAs in Sprint_Elo with first quartile: 1246.32574824425
INFO [2025-03-29 14:27:13] Replaced NAs in Sprint_C_Elo with first quartile: 1257.67866787334
INFO [2025-03-29 14:27:13] Replaced NAs in Sprint_F_Elo with first quartile: 1244.84742904868
INFO [2025-03-29 14:27:13] Replaced NAs in Classic_Elo with first quartile: 1252.44868703669
INFO [2025-03-29 14:27:13] Replaced NAs in Freestyle_Elo with first quartile: 1244.44508230281
INFO [2025-03-29 14:27:13] Replaced NAs in Distance_Pelo with first quartile: 1241.11854419952
INFO [2025-03-29 14:27:13] Replaced NAs in Distance_C_Pelo with first quartile: 1245.57367555166
INFO [2025-03-29 14:27:13] Replaced NAs in Distance_F_Pelo with first quartile: 1259.54282973153
INFO [2025-03-29 14:27:13] Replaced NAs in Sprint_Pelo with first quartile: 1254.58885254623
INFO [2025-03-29 14:27:13] Replaced NAs in Sprint_C_Pelo with first quartile: 1257.58302026178
INFO [2025-03-29 14:27:13] Replaced NAs in Sprint_F_Pelo with first quartile: 1257.67755691493
INFO [2025-03-29 14:27:13] Replaced NAs in Classic_Pelo with first quartile: 1256.79275004544
INFO [2025-03-29 14:27:13] Replaced NAs in Freestyle_Pelo with first quartile: 1256.79999900008
INFO [2025-03-29 14:27:13] Replaced NAs in Sprint_Last_5 with first quartile: 0
INFO [2025-03-29 14:27:13] Created Pelo_Pct from Elo with max value: 1841.00191142018
INFO [2025-03-29 14:27:13] Created Distance_Pelo_Pct from Distance_Elo with max value: 1889.46974050597
INFO [2025-03-29 14:27:13] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1763.33572074398
INFO [2025-03-29 14:27:13] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1693.85026290322
INFO [2025-03-29 14:27:13] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1742.74758850835
INFO [2025-03-29 14:27:13] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1601.5820663103
INFO [2025-03-29 14:27:13] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1681.09824552997
INFO [2025-03-29 14:27:13] Created Classic_Pelo_Pct from Classic_Elo with max value: 1698.69428891549
INFO [2025-03-29 14:27:13] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1707.58410982918
INFO [2025-03-29 14:27:13] Prepared data for 255 ladies skiers with 31 features
INFO [2025-03-29 14:27:13] Using FIS startlist for ladies' leg predictions
INFO [2025-03-29 14:27:13] Using FIS startlist for ladies
INFO [2025-03-29 14:27:13] Attempting Option 1: Team model coefficients
INFO [2025-03-29 14:27:13] Option 1 failed: No team_podium model found
INFO [2025-03-29 14:27:13] Option 1 failed: No team model
INFO [2025-03-29 14:27:13] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 14:27:13] Leg 1 accuracy: 0.787728937728938
INFO [2025-03-29 14:27:13] Leg 2 accuracy: 0.817582417582418
INFO [2025-03-29 14:27:13] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 14:27:13] Leg importance weights: Leg 1: 0.49, Leg 2: 0.51
INFO [2025-03-29 14:27:13] Resetting men's probabilities at or below the mode to zero
INFO [2025-03-29 14:27:13] Reset 30 values to 0 for Win_Prob (repeated values or values <  0 )
INFO [2025-03-29 14:27:13] Repeated values: 0
INFO [2025-03-29 14:27:13] No values appear more than twice for Podium_Prob
INFO [2025-03-29 14:27:13] No values appear more than twice for Top5_Prob
INFO [2025-03-29 14:27:13] No values appear more than twice for Top10_Prob
INFO [2025-03-29 14:27:13] Resetting ladies' probabilities at or below the mode to zero
INFO [2025-03-29 14:27:13] Reset 25 values to 0 for Win_Prob (repeated values or values <  0 )
INFO [2025-03-29 14:27:13] Repeated values: 0
INFO [2025-03-29 14:27:13] No values appear more than twice for Podium_Prob
INFO [2025-03-29 14:27:13] No values appear more than twice for Top5_Prob
INFO [2025-03-29 14:27:13] No values appear more than twice for Top10_Prob
INFO [2025-03-29 14:27:13] Normalizing men's team probabilities
INFO [2025-03-29 14:27:13] Normalized Win_Prob from sum of 1 to 1 and capped individual values at 1.0
INFO [2025-03-29 14:27:13] Normalized Podium_Prob from sum of 1.82 to 2.5 and capped individual values at 1.0
INFO [2025-03-29 14:27:13] Normalized Top5_Prob from sum of 3.41 to 4.61 and capped individual values at 1.0
INFO [2025-03-29 14:27:13] Normalized Top10_Prob from sum of 7.38 to 8.89 and capped individual values at 1.0
INFO [2025-03-29 14:27:13] Recalculated Expected_Points based on normalized probabilities
INFO [2025-03-29 14:27:13] Normalizing ladies' team probabilities
INFO [2025-03-29 14:27:13] Normalized Win_Prob from sum of 0.49 to 1 and capped individual values at 1.0
INFO [2025-03-29 14:27:13] Normalized Podium_Prob from sum of 2.56 to 3 and capped individual values at 1.0
INFO [2025-03-29 14:27:13] Normalized Top5_Prob from sum of 3.82 to 4.97 and capped individual values at 1.0
INFO [2025-03-29 14:27:13] Normalized Top10_Prob from sum of 7.73 to 9.11 and capped individual values at 1.0
INFO [2025-03-29 14:27:13] Recalculated Expected_Points based on normalized probabilities
INFO [2025-03-29 14:27:13] Optimizing fantasy team sprint team
INFO [2025-03-29 14:27:13] Fantasy team optimization complete. Selected 8 teams.
INFO [2025-03-29 14:27:13] Total price: 99973 of max 1e+05
INFO [2025-03-29 14:27:13] Expected total points: 815.8
INFO [2025-03-29 14:27:13] Men's teams: 4 ( 4 )
INFO [2025-03-29 14:27:13] Ladies' teams: 4 ( 4 )
INFO [2025-03-29 14:27:13] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_team_sprint_points.xlsx
INFO [2025-03-29 14:27:13] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_team_sprint_probabilities.xlsx
INFO [2025-03-29 14:27:13] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_team_sprint_points.xlsx
INFO [2025-03-29 14:27:13] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_team_sprint_probabilities.xlsx
INFO [2025-03-29 14:27:13] Saved fantasy team results to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/fantasy_team_sprint_team.xlsx
INFO [2025-03-29 14:27:13] Team sprint predictions completed successfully
INFO [2025-03-29 14:29:21] Starting team sprint predictions process
INFO [2025-03-29 14:29:21] Loading weekend race data
INFO [2025-03-29 14:29:21] Tomorrow's date: 2025-03-29
INFO [2025-03-29 14:29:21] Found 1 men's team sprint races and 1 ladies' team sprint races
INFO [2025-03-29 14:29:21] Men's team sprint technique: C
INFO [2025-03-29 14:29:21] Ladies' team sprint technique: C
INFO [2025-03-29 14:29:21] Men's team sprint technique: C
INFO [2025-03-29 14:29:21] Ladies' team sprint technique: C
INFO [2025-03-29 14:29:22] Loading chrono data
INFO [2025-03-29 14:29:27] Loaded men's chrono with 105122 rows and 36 columns
INFO [2025-03-29 14:29:27] Loaded ladies' chrono with 78706 rows and 36 columns
INFO [2025-03-29 14:29:27] Created men's team sprint df with 3291 rows
INFO [2025-03-29 14:29:27] Created men's individual df with 92143 rows
INFO [2025-03-29 14:29:27] Created ladies' team sprint df with 2434 rows
INFO [2025-03-29 14:29:27] Created ladies' individual df with 68253 rows
INFO [2025-03-29 14:29:32] Filtered men's team sprint data by technique C - kept 997 of 3291 records
INFO [2025-03-29 14:29:32] Filtered ladies' team sprint data by technique C - kept 700 of 2434 records
INFO [2025-03-29 14:29:32] Training models for Leg 1
INFO [2025-03-29 14:29:32] Determined technique from leg data: C
INFO [2025-03-29 14:29:32] Race is classic technique - using classic-specific predictors
INFO [2025-03-29 14:29:32] Selected predictors for leg 1 : Pelo_Pct, Weighted_Last_5, Sprint_Pelo_Pct, Distance_Pelo_Pct, Sprint_C_Pelo_Pct, Classic_Pelo_Pct, Sprint_F_Pelo_Pct
INFO [2025-03-29 14:29:32] Using predictors: Pelo_Pct, Weighted_Last_5, Sprint_Pelo_Pct, Distance_Pelo_Pct, Sprint_C_Pelo_Pct, Classic_Pelo_Pct, Sprint_F_Pelo_Pct
INFO [2025-03-29 14:29:32] Training podium model using glm
INFO [2025-03-29 14:29:32] Training win model using glm
INFO [2025-03-29 14:29:32] Training top5 model using glm
INFO [2025-03-29 14:29:32] Training top10 model using glm
INFO [2025-03-29 14:29:32] Top features for Leg 1 podium prediction:
INFO [2025-03-29 14:29:32] Training models for Leg 2
INFO [2025-03-29 14:29:32] Determined technique from leg data: C
INFO [2025-03-29 14:29:32] Race is classic technique - using classic-specific predictors
INFO [2025-03-29 14:29:32] Selected predictors for leg 2 : Pelo_Pct, Weighted_Last_5, Sprint_Pelo_Pct, Distance_Pelo_Pct, Sprint_C_Pelo_Pct, Classic_Pelo_Pct, Sprint_F_Pelo_Pct
INFO [2025-03-29 14:29:32] Using predictors: Pelo_Pct, Weighted_Last_5, Sprint_Pelo_Pct, Distance_Pelo_Pct, Sprint_C_Pelo_Pct, Classic_Pelo_Pct, Sprint_F_Pelo_Pct
INFO [2025-03-29 14:29:32] Training podium model using glm
INFO [2025-03-29 14:29:33] Training win model using glm
INFO [2025-03-29 14:29:33] Training top5 model using glm
INFO [2025-03-29 14:29:33] Training top10 model using glm
INFO [2025-03-29 14:29:33] Top features for Leg 2 podium prediction:
INFO [2025-03-29 14:29:33] Training models for Leg 1
INFO [2025-03-29 14:29:33] Determined technique from leg data: C
INFO [2025-03-29 14:29:33] Race is classic technique - using classic-specific predictors
INFO [2025-03-29 14:29:33] Selected predictors for leg 1 : Pelo_Pct, Weighted_Last_5, Sprint_Pelo_Pct, Distance_Pelo_Pct, Sprint_C_Pelo_Pct, Classic_Pelo_Pct, Sprint_F_Pelo_Pct
INFO [2025-03-29 14:29:33] Using predictors: Pelo_Pct, Weighted_Last_5, Sprint_Pelo_Pct, Distance_Pelo_Pct, Sprint_C_Pelo_Pct, Classic_Pelo_Pct, Sprint_F_Pelo_Pct
INFO [2025-03-29 14:29:33] Training podium model using glm
INFO [2025-03-29 14:29:33] Training win model using glm
INFO [2025-03-29 14:29:33] Training top5 model using glm
INFO [2025-03-29 14:29:33] Training top10 model using glm
INFO [2025-03-29 14:29:33] Top features for Leg 1 podium prediction:
INFO [2025-03-29 14:29:33] Training models for Leg 2
INFO [2025-03-29 14:29:33] Determined technique from leg data: C
INFO [2025-03-29 14:29:33] Race is classic technique - using classic-specific predictors
INFO [2025-03-29 14:29:33] Selected predictors for leg 2 : Pelo_Pct, Weighted_Last_5, Sprint_Pelo_Pct, Distance_Pelo_Pct, Sprint_C_Pelo_Pct, Classic_Pelo_Pct, Sprint_F_Pelo_Pct
INFO [2025-03-29 14:29:33] Using predictors: Pelo_Pct, Weighted_Last_5, Sprint_Pelo_Pct, Distance_Pelo_Pct, Sprint_C_Pelo_Pct, Classic_Pelo_Pct, Sprint_F_Pelo_Pct
INFO [2025-03-29 14:29:33] Training podium model using glm
INFO [2025-03-29 14:29:33] Training win model using glm
INFO [2025-03-29 14:29:33] Training top5 model using glm
INFO [2025-03-29 14:29:33] Training top10 model using glm
INFO [2025-03-29 14:29:34] Top features for Leg 2 podium prediction:
INFO [2025-03-29 14:29:34] Processing men's team sprint predictions
INFO [2025-03-29 14:29:34] Loaded men team sprint teams startlist with 31 rows
INFO [2025-03-29 14:29:34] Loaded men team sprint individuals startlist with 62 rows
INFO [2025-03-29 14:29:34] Preparing current men skier data
INFO [2025-03-29 14:29:34] Replaced NAs in Distance_Elo with first quartile: 1207.23243912712
INFO [2025-03-29 14:29:34] Replaced NAs in Distance_C_Elo with first quartile: 1233.40200699225
INFO [2025-03-29 14:29:34] Replaced NAs in Distance_F_Elo with first quartile: 1236.48554062178
INFO [2025-03-29 14:29:34] Replaced NAs in Sprint_Elo with first quartile: 1223.60107000698
INFO [2025-03-29 14:29:34] Replaced NAs in Sprint_C_Elo with first quartile: 1241.28715500947
INFO [2025-03-29 14:29:34] Replaced NAs in Sprint_F_Elo with first quartile: 1234.45151108772
INFO [2025-03-29 14:29:34] Replaced NAs in Classic_Elo with first quartile: 1241.52867310024
INFO [2025-03-29 14:29:34] Replaced NAs in Freestyle_Elo with first quartile: 1228.48649348109
INFO [2025-03-29 14:29:34] Replaced NAs in Distance_Pelo with first quartile: 1211.63035979047
INFO [2025-03-29 14:29:34] Replaced NAs in Distance_C_Pelo with first quartile: 1234.81091928129
INFO [2025-03-29 14:29:34] Replaced NAs in Distance_F_Pelo with first quartile: 1239.65331180248
INFO [2025-03-29 14:29:34] Replaced NAs in Sprint_Pelo with first quartile: 1240.94751821383
INFO [2025-03-29 14:29:34] Replaced NAs in Sprint_C_Pelo with first quartile: 1241.28715500947
INFO [2025-03-29 14:29:34] Replaced NAs in Sprint_F_Pelo with first quartile: 1252.45166310493
INFO [2025-03-29 14:29:34] Replaced NAs in Classic_Pelo with first quartile: 1243.63746068082
INFO [2025-03-29 14:29:34] Replaced NAs in Freestyle_Pelo with first quartile: 1249.30280713791
INFO [2025-03-29 14:29:34] Replaced NAs in Sprint_Last_5 with first quartile: 0
INFO [2025-03-29 14:29:34] Created Pelo_Pct from Elo with max value: 1946.6211651574
INFO [2025-03-29 14:29:34] Created Distance_Pelo_Pct from Distance_Elo with max value: 1869.1251911742
INFO [2025-03-29 14:29:34] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1777.16297253153
INFO [2025-03-29 14:29:34] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1695.2053212904
INFO [2025-03-29 14:29:34] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1886.80363942481
INFO [2025-03-29 14:29:34] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1711.08486899169
INFO [2025-03-29 14:29:34] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1792.65157560707
INFO [2025-03-29 14:29:34] Created Classic_Pelo_Pct from Classic_Elo with max value: 1807.56773496777
INFO [2025-03-29 14:29:34] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1814.60460629541
INFO [2025-03-29 14:29:34] Prepared data for 381 men skiers with 31 features
INFO [2025-03-29 14:29:34] Using FIS startlist for men's leg predictions
INFO [2025-03-29 14:29:34] Using FIS startlist for men
INFO [2025-03-29 14:29:34] Attempting Option 1: Team model coefficients
INFO [2025-03-29 14:29:34] Option 1 failed: No team_podium model found
INFO [2025-03-29 14:29:34] Option 1 failed: No team model
INFO [2025-03-29 14:29:34] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 14:29:34] Leg 1 accuracy: 0.910853658536585
INFO [2025-03-29 14:29:34] Leg 2 accuracy: 0.917177700348432
INFO [2025-03-29 14:29:34] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 14:29:34] Leg importance weights: Leg 1: 0.50, Leg 2: 0.50
INFO [2025-03-29 14:29:34] Processing ladies' team sprint predictions
INFO [2025-03-29 14:29:34] Loaded ladies team sprint teams startlist with 35 rows
INFO [2025-03-29 14:29:34] Loaded ladies team sprint individuals startlist with 231 rows
INFO [2025-03-29 14:29:34] Preparing current ladies skier data
INFO [2025-03-29 14:29:34] Replaced NAs in Distance_Elo with first quartile: 1237.38564383256
INFO [2025-03-29 14:29:34] Replaced NAs in Distance_C_Elo with first quartile: 1243.87329106944
INFO [2025-03-29 14:29:34] Replaced NAs in Distance_F_Elo with first quartile: 1256.69628195708
INFO [2025-03-29 14:29:34] Replaced NAs in Sprint_Elo with first quartile: 1246.32574824425
INFO [2025-03-29 14:29:34] Replaced NAs in Sprint_C_Elo with first quartile: 1257.67866787334
INFO [2025-03-29 14:29:34] Replaced NAs in Sprint_F_Elo with first quartile: 1244.84742904868
INFO [2025-03-29 14:29:34] Replaced NAs in Classic_Elo with first quartile: 1252.44868703669
INFO [2025-03-29 14:29:34] Replaced NAs in Freestyle_Elo with first quartile: 1244.44508230281
INFO [2025-03-29 14:29:34] Replaced NAs in Distance_Pelo with first quartile: 1241.11854419952
INFO [2025-03-29 14:29:34] Replaced NAs in Distance_C_Pelo with first quartile: 1245.57367555166
INFO [2025-03-29 14:29:34] Replaced NAs in Distance_F_Pelo with first quartile: 1259.54282973153
INFO [2025-03-29 14:29:34] Replaced NAs in Sprint_Pelo with first quartile: 1254.58885254623
INFO [2025-03-29 14:29:34] Replaced NAs in Sprint_C_Pelo with first quartile: 1257.58302026178
INFO [2025-03-29 14:29:34] Replaced NAs in Sprint_F_Pelo with first quartile: 1257.67755691493
INFO [2025-03-29 14:29:34] Replaced NAs in Classic_Pelo with first quartile: 1256.79275004544
INFO [2025-03-29 14:29:34] Replaced NAs in Freestyle_Pelo with first quartile: 1256.79999900008
INFO [2025-03-29 14:29:34] Replaced NAs in Sprint_Last_5 with first quartile: 0
INFO [2025-03-29 14:29:34] Created Pelo_Pct from Elo with max value: 1841.00191142018
INFO [2025-03-29 14:29:34] Created Distance_Pelo_Pct from Distance_Elo with max value: 1889.46974050597
INFO [2025-03-29 14:29:34] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1763.33572074398
INFO [2025-03-29 14:29:34] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1693.85026290322
INFO [2025-03-29 14:29:34] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1742.74758850835
INFO [2025-03-29 14:29:34] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1601.5820663103
INFO [2025-03-29 14:29:34] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1681.09824552997
INFO [2025-03-29 14:29:34] Created Classic_Pelo_Pct from Classic_Elo with max value: 1698.69428891549
INFO [2025-03-29 14:29:34] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1707.58410982918
INFO [2025-03-29 14:29:34] Prepared data for 255 ladies skiers with 31 features
INFO [2025-03-29 14:29:34] No FIS startlist, predicting for all skiers in all legs
INFO [2025-03-29 14:30:10] Starting team sprint predictions process
INFO [2025-03-29 14:30:10] Loading weekend race data
INFO [2025-03-29 14:30:10] Tomorrow's date: 2025-03-29
INFO [2025-03-29 14:30:10] Found 1 men's team sprint races and 1 ladies' team sprint races
INFO [2025-03-29 14:30:10] Men's team sprint technique: C
INFO [2025-03-29 14:30:10] Ladies' team sprint technique: C
INFO [2025-03-29 14:30:10] Men's team sprint technique: C
INFO [2025-03-29 14:30:10] Ladies' team sprint technique: C
INFO [2025-03-29 14:30:10] Loading chrono data
INFO [2025-03-29 14:30:16] Loaded men's chrono with 105122 rows and 36 columns
INFO [2025-03-29 14:30:16] Loaded ladies' chrono with 78706 rows and 36 columns
INFO [2025-03-29 14:30:16] Created men's team sprint df with 3291 rows
INFO [2025-03-29 14:30:16] Created men's individual df with 92143 rows
INFO [2025-03-29 14:30:16] Created ladies' team sprint df with 2434 rows
INFO [2025-03-29 14:30:16] Created ladies' individual df with 68253 rows
INFO [2025-03-29 14:30:20] Filtered men's team sprint data by technique C - kept 997 of 3291 records
INFO [2025-03-29 14:30:20] Filtered ladies' team sprint data by technique C - kept 700 of 2434 records
INFO [2025-03-29 14:30:21] Training models for Leg 1
INFO [2025-03-29 14:30:21] Determined technique from leg data: C
INFO [2025-03-29 14:30:21] Race is classic technique - using classic-specific predictors
INFO [2025-03-29 14:30:21] Selected predictors for leg 1 : Pelo_Pct, Weighted_Last_5, Sprint_Pelo_Pct, Distance_Pelo_Pct, Sprint_C_Pelo_Pct, Classic_Pelo_Pct, Sprint_F_Pelo_Pct
INFO [2025-03-29 14:30:21] Using predictors: Pelo_Pct, Weighted_Last_5, Sprint_Pelo_Pct, Distance_Pelo_Pct, Sprint_C_Pelo_Pct, Classic_Pelo_Pct, Sprint_F_Pelo_Pct
INFO [2025-03-29 14:30:21] Training podium model using glm
INFO [2025-03-29 14:30:21] Training win model using glm
INFO [2025-03-29 14:30:21] Training top5 model using glm
INFO [2025-03-29 14:30:21] Training top10 model using glm
INFO [2025-03-29 14:30:21] Top features for Leg 1 podium prediction:
INFO [2025-03-29 14:30:21] Training models for Leg 2
INFO [2025-03-29 14:30:21] Determined technique from leg data: C
INFO [2025-03-29 14:30:21] Race is classic technique - using classic-specific predictors
INFO [2025-03-29 14:30:21] Selected predictors for leg 2 : Pelo_Pct, Weighted_Last_5, Sprint_Pelo_Pct, Distance_Pelo_Pct, Sprint_C_Pelo_Pct, Classic_Pelo_Pct, Sprint_F_Pelo_Pct
INFO [2025-03-29 14:30:21] Using predictors: Pelo_Pct, Weighted_Last_5, Sprint_Pelo_Pct, Distance_Pelo_Pct, Sprint_C_Pelo_Pct, Classic_Pelo_Pct, Sprint_F_Pelo_Pct
INFO [2025-03-29 14:30:21] Training podium model using glm
INFO [2025-03-29 14:30:21] Training win model using glm
INFO [2025-03-29 14:30:21] Training top5 model using glm
INFO [2025-03-29 14:30:21] Training top10 model using glm
INFO [2025-03-29 14:30:21] Top features for Leg 2 podium prediction:
INFO [2025-03-29 14:30:21] Training models for Leg 1
INFO [2025-03-29 14:30:21] Determined technique from leg data: C
INFO [2025-03-29 14:30:21] Race is classic technique - using classic-specific predictors
INFO [2025-03-29 14:30:21] Selected predictors for leg 1 : Pelo_Pct, Weighted_Last_5, Sprint_Pelo_Pct, Distance_Pelo_Pct, Sprint_C_Pelo_Pct, Classic_Pelo_Pct, Sprint_F_Pelo_Pct
INFO [2025-03-29 14:30:21] Using predictors: Pelo_Pct, Weighted_Last_5, Sprint_Pelo_Pct, Distance_Pelo_Pct, Sprint_C_Pelo_Pct, Classic_Pelo_Pct, Sprint_F_Pelo_Pct
INFO [2025-03-29 14:30:21] Training podium model using glm
INFO [2025-03-29 14:30:22] Training win model using glm
INFO [2025-03-29 14:30:22] Training top5 model using glm
INFO [2025-03-29 14:30:22] Training top10 model using glm
INFO [2025-03-29 14:30:22] Top features for Leg 1 podium prediction:
INFO [2025-03-29 14:30:22] Training models for Leg 2
INFO [2025-03-29 14:30:22] Determined technique from leg data: C
INFO [2025-03-29 14:30:22] Race is classic technique - using classic-specific predictors
INFO [2025-03-29 14:30:22] Selected predictors for leg 2 : Pelo_Pct, Weighted_Last_5, Sprint_Pelo_Pct, Distance_Pelo_Pct, Sprint_C_Pelo_Pct, Classic_Pelo_Pct, Sprint_F_Pelo_Pct
INFO [2025-03-29 14:30:22] Using predictors: Pelo_Pct, Weighted_Last_5, Sprint_Pelo_Pct, Distance_Pelo_Pct, Sprint_C_Pelo_Pct, Classic_Pelo_Pct, Sprint_F_Pelo_Pct
INFO [2025-03-29 14:30:22] Training podium model using glm
INFO [2025-03-29 14:30:22] Training win model using glm
INFO [2025-03-29 14:30:22] Training top5 model using glm
INFO [2025-03-29 14:30:22] Training top10 model using glm
INFO [2025-03-29 14:30:22] Top features for Leg 2 podium prediction:
INFO [2025-03-29 14:30:22] Processing men's team sprint predictions
INFO [2025-03-29 14:30:22] Loaded men team sprint teams startlist with 31 rows
INFO [2025-03-29 14:30:22] Loaded men team sprint individuals startlist with 62 rows
INFO [2025-03-29 14:30:22] Preparing current men skier data
INFO [2025-03-29 14:30:22] Replaced NAs in Distance_Elo with first quartile: 1207.23243912712
INFO [2025-03-29 14:30:22] Replaced NAs in Distance_C_Elo with first quartile: 1233.40200699225
INFO [2025-03-29 14:30:22] Replaced NAs in Distance_F_Elo with first quartile: 1236.48554062178
INFO [2025-03-29 14:30:22] Replaced NAs in Sprint_Elo with first quartile: 1223.60107000698
INFO [2025-03-29 14:30:22] Replaced NAs in Sprint_C_Elo with first quartile: 1241.28715500947
INFO [2025-03-29 14:30:22] Replaced NAs in Sprint_F_Elo with first quartile: 1234.45151108772
INFO [2025-03-29 14:30:22] Replaced NAs in Classic_Elo with first quartile: 1241.52867310024
INFO [2025-03-29 14:30:22] Replaced NAs in Freestyle_Elo with first quartile: 1228.48649348109
INFO [2025-03-29 14:30:22] Replaced NAs in Distance_Pelo with first quartile: 1211.63035979047
INFO [2025-03-29 14:30:22] Replaced NAs in Distance_C_Pelo with first quartile: 1234.81091928129
INFO [2025-03-29 14:30:22] Replaced NAs in Distance_F_Pelo with first quartile: 1239.65331180248
INFO [2025-03-29 14:30:22] Replaced NAs in Sprint_Pelo with first quartile: 1240.94751821383
INFO [2025-03-29 14:30:22] Replaced NAs in Sprint_C_Pelo with first quartile: 1241.28715500947
INFO [2025-03-29 14:30:22] Replaced NAs in Sprint_F_Pelo with first quartile: 1252.45166310493
INFO [2025-03-29 14:30:22] Replaced NAs in Classic_Pelo with first quartile: 1243.63746068082
INFO [2025-03-29 14:30:22] Replaced NAs in Freestyle_Pelo with first quartile: 1249.30280713791
INFO [2025-03-29 14:30:22] Replaced NAs in Sprint_Last_5 with first quartile: 0
INFO [2025-03-29 14:30:22] Created Pelo_Pct from Elo with max value: 1946.6211651574
INFO [2025-03-29 14:30:22] Created Distance_Pelo_Pct from Distance_Elo with max value: 1869.1251911742
INFO [2025-03-29 14:30:22] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1777.16297253153
INFO [2025-03-29 14:30:22] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1695.2053212904
INFO [2025-03-29 14:30:22] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1886.80363942481
INFO [2025-03-29 14:30:22] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1711.08486899169
INFO [2025-03-29 14:30:22] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1792.65157560707
INFO [2025-03-29 14:30:22] Created Classic_Pelo_Pct from Classic_Elo with max value: 1807.56773496777
INFO [2025-03-29 14:30:22] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1814.60460629541
INFO [2025-03-29 14:30:22] Prepared data for 381 men skiers with 31 features
INFO [2025-03-29 14:30:22] Using FIS startlist for men's leg predictions
INFO [2025-03-29 14:30:22] Using FIS startlist for men
INFO [2025-03-29 14:30:22] Attempting Option 1: Team model coefficients
INFO [2025-03-29 14:30:22] Option 1 failed: No team_podium model found
INFO [2025-03-29 14:30:22] Option 1 failed: No team model
INFO [2025-03-29 14:30:22] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 14:30:22] Leg 1 accuracy: 0.905952380952381
INFO [2025-03-29 14:30:22] Leg 2 accuracy: 0.927171893147503
INFO [2025-03-29 14:30:22] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 14:30:22] Leg importance weights: Leg 1: 0.49, Leg 2: 0.51
INFO [2025-03-29 14:30:22] Processing ladies' team sprint predictions
INFO [2025-03-29 14:30:22] Loaded ladies team sprint teams startlist with 35 rows
INFO [2025-03-29 14:30:22] Loaded ladies team sprint individuals startlist with 231 rows
INFO [2025-03-29 14:30:23] Preparing current ladies skier data
INFO [2025-03-29 14:30:23] Replaced NAs in Distance_Elo with first quartile: 1237.38564383256
INFO [2025-03-29 14:30:23] Replaced NAs in Distance_C_Elo with first quartile: 1243.87329106944
INFO [2025-03-29 14:30:23] Replaced NAs in Distance_F_Elo with first quartile: 1256.69628195708
INFO [2025-03-29 14:30:23] Replaced NAs in Sprint_Elo with first quartile: 1246.32574824425
INFO [2025-03-29 14:30:23] Replaced NAs in Sprint_C_Elo with first quartile: 1257.67866787334
INFO [2025-03-29 14:30:23] Replaced NAs in Sprint_F_Elo with first quartile: 1244.84742904868
INFO [2025-03-29 14:30:23] Replaced NAs in Classic_Elo with first quartile: 1252.44868703669
INFO [2025-03-29 14:30:23] Replaced NAs in Freestyle_Elo with first quartile: 1244.44508230281
INFO [2025-03-29 14:30:23] Replaced NAs in Distance_Pelo with first quartile: 1241.11854419952
INFO [2025-03-29 14:30:23] Replaced NAs in Distance_C_Pelo with first quartile: 1245.57367555166
INFO [2025-03-29 14:30:23] Replaced NAs in Distance_F_Pelo with first quartile: 1259.54282973153
INFO [2025-03-29 14:30:23] Replaced NAs in Sprint_Pelo with first quartile: 1254.58885254623
INFO [2025-03-29 14:30:23] Replaced NAs in Sprint_C_Pelo with first quartile: 1257.58302026178
INFO [2025-03-29 14:30:23] Replaced NAs in Sprint_F_Pelo with first quartile: 1257.67755691493
INFO [2025-03-29 14:30:23] Replaced NAs in Classic_Pelo with first quartile: 1256.79275004544
INFO [2025-03-29 14:30:23] Replaced NAs in Freestyle_Pelo with first quartile: 1256.79999900008
INFO [2025-03-29 14:30:23] Replaced NAs in Sprint_Last_5 with first quartile: 0
INFO [2025-03-29 14:30:23] Created Pelo_Pct from Elo with max value: 1841.00191142018
INFO [2025-03-29 14:30:23] Created Distance_Pelo_Pct from Distance_Elo with max value: 1889.46974050597
INFO [2025-03-29 14:30:23] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1763.33572074398
INFO [2025-03-29 14:30:23] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1693.85026290322
INFO [2025-03-29 14:30:23] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1742.74758850835
INFO [2025-03-29 14:30:23] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1601.5820663103
INFO [2025-03-29 14:30:23] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1681.09824552997
INFO [2025-03-29 14:30:23] Created Classic_Pelo_Pct from Classic_Elo with max value: 1698.69428891549
INFO [2025-03-29 14:30:23] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1707.58410982918
INFO [2025-03-29 14:30:23] Prepared data for 255 ladies skiers with 31 features
INFO [2025-03-29 14:30:23] No FIS startlist, predicting for all skiers in all legs
INFO [2025-03-29 14:30:23] No valid FIS startlist for ladies, building optimized teams
INFO [2025-03-29 14:30:23] Attempting Option 1: Team model coefficients
INFO [2025-03-29 14:30:23] Option 1 failed: No team_podium model found
INFO [2025-03-29 14:30:23] Option 1 failed: No team model
INFO [2025-03-29 14:30:23] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 14:30:23] Leg 1 accuracy: 0.862637362637363
INFO [2025-03-29 14:30:23] Leg 2 accuracy: 0.832967032967033
INFO [2025-03-29 14:30:23] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 14:30:23] Using leg importance weights for team optimization: Leg 1: 0.51, Leg 2: 0.49
INFO [2025-03-29 14:30:23] Optimizing team for Sweden
INFO [2025-03-29 14:30:23] Optimizing team for Norway
INFO [2025-03-29 14:30:23] Optimizing team for Germany
INFO [2025-03-29 14:30:23] Optimizing team for USA
INFO [2025-03-29 14:30:23] Optimizing team for Austria
INFO [2025-03-29 14:30:23] Optimizing team for Finland
INFO [2025-03-29 14:30:23] Optimizing team for Czechia
INFO [2025-03-29 14:30:23] Optimizing team for Switzerland
INFO [2025-03-29 14:30:23] Optimizing team for Italy
INFO [2025-03-29 14:30:23] Optimizing team for France
INFO [2025-03-29 14:30:23] Optimizing team for Canada
INFO [2025-03-29 14:30:23] Optimizing team for Slovenia
INFO [2025-03-29 14:30:23] Optimizing team for Estonia
INFO [2025-03-29 14:30:23] Optimizing team for Australia
INFO [2025-03-29 14:30:23] Optimizing team for Ukraine
INFO [2025-03-29 14:30:23] Optimizing team for Kazakhstan
INFO [2025-03-29 14:30:23] Optimizing team for Armenia
INFO [2025-03-29 14:30:23] Optimizing team for Latvia
INFO [2025-03-29 14:30:23] Optimizing team for Japan
INFO [2025-03-29 14:30:23] Optimizing team for Poland
INFO [2025-03-29 14:30:23] Optimizing team for South Korea
INFO [2025-03-29 14:30:23] Optimizing team for Andorra
INFO [2025-03-29 14:30:23] Optimizing team for Taiwan
INFO [2025-03-29 14:30:23] Optimizing team for China
INFO [2025-03-29 14:30:23] Optimizing team for Croatia
INFO [2025-03-29 14:30:23] Optimizing team for Slovakia
INFO [2025-03-29 14:30:23] Optimizing team for Argentina
INFO [2025-03-29 14:30:23] Optimizing team for Mongolia
INFO [2025-03-29 14:30:23] Optimizing team for Brazil
INFO [2025-03-29 14:30:23] Optimizing team for Lithuania
INFO [2025-03-29 14:30:23] Optimizing team for Greece
INFO [2025-03-29 14:30:23] Optimizing team for Iceland
INFO [2025-03-29 14:30:23] Optimizing team for Bulgaria
INFO [2025-03-29 14:30:23] Optimizing team for Serbia
INFO [2025-03-29 14:30:23] Optimizing team for Hungary
INFO [2025-03-29 14:30:23] Optimizing team for Turkey
INFO [2025-03-29 14:30:23] Optimizing team for North Macedonia
INFO [2025-03-29 14:30:23] Optimizing team for Romania
INFO [2025-03-29 14:30:23] Optimizing team for Bosnia&Herzegovina
INFO [2025-03-29 14:30:23] Optimizing team for Mexico
INFO [2025-03-29 14:30:23] Optimizing team for Iran
INFO [2025-03-29 14:30:23] Optimizing team for Chile
INFO [2025-03-29 14:30:23] Optimizing team for India
INFO [2025-03-29 14:30:23] Optimizing team for Malaysia
INFO [2025-03-29 14:30:23] Optimizing team for Haiti
INFO [2025-03-29 14:30:23] Optimizing team for Lebanon
INFO [2025-03-29 14:30:23] Optimizing team for Liechtenstein
INFO [2025-03-29 14:30:23] Matching optimized teams with startlist team names and prices
INFO [2025-03-29 14:30:23] Resetting men's probabilities at or below the mode to zero
INFO [2025-03-29 14:30:23] Reset 30 values to 0 for Win_Prob (repeated values or values <  0 )
INFO [2025-03-29 14:30:23] Repeated values: 0
INFO [2025-03-29 14:30:23] No values appear more than twice for Podium_Prob
INFO [2025-03-29 14:30:23] No values appear more than twice for Top5_Prob
INFO [2025-03-29 14:30:23] No values appear more than twice for Top10_Prob
INFO [2025-03-29 14:30:23] Resetting ladies' probabilities at or below the mode to zero
INFO [2025-03-29 14:30:23] Reset 47 values to 0 for Win_Prob (repeated values or values <  0.4913 )
INFO [2025-03-29 14:30:23] Repeated values: 0, 0.4913
INFO [2025-03-29 14:30:23] No values appear more than twice for Podium_Prob
INFO [2025-03-29 14:30:23] No values appear more than twice for Top5_Prob
INFO [2025-03-29 14:30:23] No values appear more than twice for Top10_Prob
INFO [2025-03-29 14:30:23] Normalizing men's team probabilities
INFO [2025-03-29 14:30:23] Normalized Win_Prob from sum of 1 to 1 and capped individual values at 1.0
INFO [2025-03-29 14:30:23] Normalized Podium_Prob from sum of 1.82 to 2.51 and capped individual values at 1.0
INFO [2025-03-29 14:30:23] Normalized Top5_Prob from sum of 3.41 to 4.61 and capped individual values at 1.0
INFO [2025-03-29 14:30:23] Normalized Top10_Prob from sum of 7.38 to 8.89 and capped individual values at 1.0
INFO [2025-03-29 14:30:23] Recalculated Expected_Points based on normalized probabilities
INFO [2025-03-29 14:30:23] Normalizing ladies' team probabilities
INFO [2025-03-29 14:30:23] Normalized Podium_Prob from sum of 5.19 to 3 and capped individual values at 1.0
INFO [2025-03-29 14:30:23] Normalized Top5_Prob from sum of 7.49 to 5 and capped individual values at 1.0
INFO [2025-03-29 14:30:23] Normalized Top10_Prob from sum of 9.5 to 9.93 and capped individual values at 1.0
INFO [2025-03-29 14:30:23] Recalculated Expected_Points based on normalized probabilities
INFO [2025-03-29 14:30:23] Optimizing fantasy team sprint team
INFO [2025-03-29 14:30:24] Fantasy team optimization complete. Selected 12 teams.
INFO [2025-03-29 14:30:24] Total price: 99944 of max 1e+05
INFO [2025-03-29 14:30:24] Expected total points: 794.3
INFO [2025-03-29 14:30:24] Men's teams: 6 ( 6 )
INFO [2025-03-29 14:30:24] Ladies' teams: 6 ( 6 )
INFO [2025-03-29 14:30:24] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_team_sprint_points.xlsx
INFO [2025-03-29 14:30:24] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_team_sprint_probabilities.xlsx
INFO [2025-03-29 14:30:24] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_team_sprint_points.xlsx
INFO [2025-03-29 14:30:24] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_team_sprint_probabilities.xlsx
INFO [2025-03-29 14:30:24] Saved fantasy team results to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/fantasy_team_sprint_team.xlsx
INFO [2025-03-29 14:30:24] Team sprint predictions completed successfully
INFO [2025-03-29 14:32:52] Starting team sprint predictions process
INFO [2025-03-29 14:32:52] Loading weekend race data
INFO [2025-03-29 14:32:52] Tomorrow's date: 2025-03-29
INFO [2025-03-29 14:32:52] Found 1 men's team sprint races and 1 ladies' team sprint races
INFO [2025-03-29 14:32:52] Men's team sprint technique: C
INFO [2025-03-29 14:32:52] Ladies' team sprint technique: C
INFO [2025-03-29 14:32:52] Men's team sprint technique: C
INFO [2025-03-29 14:32:52] Ladies' team sprint technique: C
INFO [2025-03-29 14:32:52] Loading chrono data
INFO [2025-03-29 14:32:58] Loaded men's chrono with 105122 rows and 36 columns
INFO [2025-03-29 14:32:58] Loaded ladies' chrono with 78706 rows and 36 columns
INFO [2025-03-29 14:32:58] Created men's team sprint df with 3291 rows
INFO [2025-03-29 14:32:58] Created men's individual df with 92143 rows
INFO [2025-03-29 14:32:58] Created ladies' team sprint df with 2434 rows
INFO [2025-03-29 14:32:58] Created ladies' individual df with 68253 rows
INFO [2025-03-29 14:33:02] Filtered men's team sprint data by technique C - kept 997 of 3291 records
INFO [2025-03-29 14:33:02] Filtered ladies' team sprint data by technique C - kept 700 of 2434 records
INFO [2025-03-29 14:33:02] Training models for Leg 1
INFO [2025-03-29 14:33:02] Determined technique from leg data: C
INFO [2025-03-29 14:33:02] Race is classic technique - using classic-specific predictors
INFO [2025-03-29 14:33:02] Selected predictors for leg 1 : Pelo_Pct, Weighted_Last_5, Sprint_Pelo_Pct, Distance_Pelo_Pct, Sprint_C_Pelo_Pct, Classic_Pelo_Pct, Sprint_F_Pelo_Pct
INFO [2025-03-29 14:33:02] Using predictors: Pelo_Pct, Weighted_Last_5, Sprint_Pelo_Pct, Distance_Pelo_Pct, Sprint_C_Pelo_Pct, Classic_Pelo_Pct, Sprint_F_Pelo_Pct
INFO [2025-03-29 14:33:02] Training podium model using glm
INFO [2025-03-29 14:33:03] Training win model using glm
INFO [2025-03-29 14:33:03] Training top5 model using glm
INFO [2025-03-29 14:33:03] Training top10 model using glm
INFO [2025-03-29 14:33:03] Top features for Leg 1 podium prediction:
INFO [2025-03-29 14:33:03] Training models for Leg 2
INFO [2025-03-29 14:33:03] Determined technique from leg data: C
INFO [2025-03-29 14:33:03] Race is classic technique - using classic-specific predictors
INFO [2025-03-29 14:33:03] Selected predictors for leg 2 : Pelo_Pct, Weighted_Last_5, Sprint_Pelo_Pct, Distance_Pelo_Pct, Sprint_C_Pelo_Pct, Classic_Pelo_Pct, Sprint_F_Pelo_Pct
INFO [2025-03-29 14:33:03] Using predictors: Pelo_Pct, Weighted_Last_5, Sprint_Pelo_Pct, Distance_Pelo_Pct, Sprint_C_Pelo_Pct, Classic_Pelo_Pct, Sprint_F_Pelo_Pct
INFO [2025-03-29 14:33:03] Training podium model using glm
INFO [2025-03-29 14:33:03] Training win model using glm
INFO [2025-03-29 14:33:03] Training top5 model using glm
INFO [2025-03-29 14:33:03] Training top10 model using glm
INFO [2025-03-29 14:33:03] Top features for Leg 2 podium prediction:
INFO [2025-03-29 14:33:03] Training models for Leg 1
INFO [2025-03-29 14:33:03] Determined technique from leg data: C
INFO [2025-03-29 14:33:03] Race is classic technique - using classic-specific predictors
INFO [2025-03-29 14:33:03] Selected predictors for leg 1 : Pelo_Pct, Weighted_Last_5, Sprint_Pelo_Pct, Distance_Pelo_Pct, Sprint_C_Pelo_Pct, Classic_Pelo_Pct, Sprint_F_Pelo_Pct
INFO [2025-03-29 14:33:03] Using predictors: Pelo_Pct, Weighted_Last_5, Sprint_Pelo_Pct, Distance_Pelo_Pct, Sprint_C_Pelo_Pct, Classic_Pelo_Pct, Sprint_F_Pelo_Pct
INFO [2025-03-29 14:33:03] Training podium model using glm
INFO [2025-03-29 14:33:03] Training win model using glm
INFO [2025-03-29 14:33:03] Training top5 model using glm
INFO [2025-03-29 14:33:04] Training top10 model using glm
INFO [2025-03-29 14:33:04] Top features for Leg 1 podium prediction:
INFO [2025-03-29 14:33:04] Training models for Leg 2
INFO [2025-03-29 14:33:04] Determined technique from leg data: C
INFO [2025-03-29 14:33:04] Race is classic technique - using classic-specific predictors
INFO [2025-03-29 14:33:04] Selected predictors for leg 2 : Pelo_Pct, Weighted_Last_5, Sprint_Pelo_Pct, Distance_Pelo_Pct, Sprint_C_Pelo_Pct, Classic_Pelo_Pct, Sprint_F_Pelo_Pct
INFO [2025-03-29 14:33:04] Using predictors: Pelo_Pct, Weighted_Last_5, Sprint_Pelo_Pct, Distance_Pelo_Pct, Sprint_C_Pelo_Pct, Classic_Pelo_Pct, Sprint_F_Pelo_Pct
INFO [2025-03-29 14:33:04] Training podium model using glm
INFO [2025-03-29 14:33:04] Training win model using glm
INFO [2025-03-29 14:33:04] Training top5 model using glm
INFO [2025-03-29 14:33:04] Training top10 model using glm
INFO [2025-03-29 14:33:04] Top features for Leg 2 podium prediction:
INFO [2025-03-29 14:33:04] Processing men's team sprint predictions
INFO [2025-03-29 14:33:04] Loaded men team sprint teams startlist with 31 rows
INFO [2025-03-29 14:33:04] Loaded men team sprint individuals startlist with 62 rows
INFO [2025-03-29 14:33:04] Preparing current men skier data
INFO [2025-03-29 14:33:04] Replaced NAs in Distance_Elo with first quartile: 1207.23243912712
INFO [2025-03-29 14:33:04] Replaced NAs in Distance_C_Elo with first quartile: 1233.40200699225
INFO [2025-03-29 14:33:04] Replaced NAs in Distance_F_Elo with first quartile: 1236.48554062178
INFO [2025-03-29 14:33:04] Replaced NAs in Sprint_Elo with first quartile: 1223.60107000698
INFO [2025-03-29 14:33:04] Replaced NAs in Sprint_C_Elo with first quartile: 1241.28715500947
INFO [2025-03-29 14:33:04] Replaced NAs in Sprint_F_Elo with first quartile: 1234.45151108772
INFO [2025-03-29 14:33:04] Replaced NAs in Classic_Elo with first quartile: 1241.52867310024
INFO [2025-03-29 14:33:04] Replaced NAs in Freestyle_Elo with first quartile: 1228.48649348109
INFO [2025-03-29 14:33:04] Replaced NAs in Distance_Pelo with first quartile: 1211.63035979047
INFO [2025-03-29 14:33:04] Replaced NAs in Distance_C_Pelo with first quartile: 1234.81091928129
INFO [2025-03-29 14:33:04] Replaced NAs in Distance_F_Pelo with first quartile: 1239.65331180248
INFO [2025-03-29 14:33:04] Replaced NAs in Sprint_Pelo with first quartile: 1240.94751821383
INFO [2025-03-29 14:33:04] Replaced NAs in Sprint_C_Pelo with first quartile: 1241.28715500947
INFO [2025-03-29 14:33:04] Replaced NAs in Sprint_F_Pelo with first quartile: 1252.45166310493
INFO [2025-03-29 14:33:04] Replaced NAs in Classic_Pelo with first quartile: 1243.63746068082
INFO [2025-03-29 14:33:04] Replaced NAs in Freestyle_Pelo with first quartile: 1249.30280713791
INFO [2025-03-29 14:33:04] Replaced NAs in Sprint_Last_5 with first quartile: 0
INFO [2025-03-29 14:33:04] Created Pelo_Pct from Elo with max value: 1946.6211651574
INFO [2025-03-29 14:33:04] Created Distance_Pelo_Pct from Distance_Elo with max value: 1869.1251911742
INFO [2025-03-29 14:33:04] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1777.16297253153
INFO [2025-03-29 14:33:04] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1695.2053212904
INFO [2025-03-29 14:33:04] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1886.80363942481
INFO [2025-03-29 14:33:04] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1711.08486899169
INFO [2025-03-29 14:33:04] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1792.65157560707
INFO [2025-03-29 14:33:04] Created Classic_Pelo_Pct from Classic_Elo with max value: 1807.56773496777
INFO [2025-03-29 14:33:04] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1814.60460629541
INFO [2025-03-29 14:33:04] Prepared data for 381 men skiers with 31 features
INFO [2025-03-29 14:33:04] Using FIS startlist for men's leg predictions
INFO [2025-03-29 14:33:04] Using FIS startlist for men
INFO [2025-03-29 14:33:04] Attempting Option 1: Team model coefficients
INFO [2025-03-29 14:33:04] Option 1 failed: No team_podium model found
INFO [2025-03-29 14:33:04] Option 1 failed: No team model
INFO [2025-03-29 14:33:04] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 14:33:04] Leg 1 accuracy: 0.905952380952381
INFO [2025-03-29 14:33:04] Leg 2 accuracy: 0.921951219512195
INFO [2025-03-29 14:33:04] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 14:33:04] Leg importance weights: Leg 1: 0.50, Leg 2: 0.50
INFO [2025-03-29 14:33:04] Processing ladies' team sprint predictions
INFO [2025-03-29 14:33:04] Loaded ladies team sprint teams startlist with 35 rows
INFO [2025-03-29 14:33:04] Loaded ladies team sprint individuals startlist with 231 rows
INFO [2025-03-29 14:33:04] Preparing current ladies skier data
INFO [2025-03-29 14:33:04] Replaced NAs in Distance_Elo with first quartile: 1237.38564383256
INFO [2025-03-29 14:33:04] Replaced NAs in Distance_C_Elo with first quartile: 1243.87329106944
INFO [2025-03-29 14:33:04] Replaced NAs in Distance_F_Elo with first quartile: 1256.69628195708
INFO [2025-03-29 14:33:04] Replaced NAs in Sprint_Elo with first quartile: 1246.32574824425
INFO [2025-03-29 14:33:04] Replaced NAs in Sprint_C_Elo with first quartile: 1257.67866787334
INFO [2025-03-29 14:33:04] Replaced NAs in Sprint_F_Elo with first quartile: 1244.84742904868
INFO [2025-03-29 14:33:04] Replaced NAs in Classic_Elo with first quartile: 1252.44868703669
INFO [2025-03-29 14:33:04] Replaced NAs in Freestyle_Elo with first quartile: 1244.44508230281
INFO [2025-03-29 14:33:04] Replaced NAs in Distance_Pelo with first quartile: 1241.11854419952
INFO [2025-03-29 14:33:04] Replaced NAs in Distance_C_Pelo with first quartile: 1245.57367555166
INFO [2025-03-29 14:33:04] Replaced NAs in Distance_F_Pelo with first quartile: 1259.54282973153
INFO [2025-03-29 14:33:04] Replaced NAs in Sprint_Pelo with first quartile: 1254.58885254623
INFO [2025-03-29 14:33:04] Replaced NAs in Sprint_C_Pelo with first quartile: 1257.58302026178
INFO [2025-03-29 14:33:04] Replaced NAs in Sprint_F_Pelo with first quartile: 1257.67755691493
INFO [2025-03-29 14:33:04] Replaced NAs in Classic_Pelo with first quartile: 1256.79275004544
INFO [2025-03-29 14:33:04] Replaced NAs in Freestyle_Pelo with first quartile: 1256.79999900008
INFO [2025-03-29 14:33:04] Replaced NAs in Sprint_Last_5 with first quartile: 0
INFO [2025-03-29 14:33:04] Created Pelo_Pct from Elo with max value: 1841.00191142018
INFO [2025-03-29 14:33:04] Created Distance_Pelo_Pct from Distance_Elo with max value: 1889.46974050597
INFO [2025-03-29 14:33:04] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1763.33572074398
INFO [2025-03-29 14:33:04] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1693.85026290322
INFO [2025-03-29 14:33:04] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1742.74758850835
INFO [2025-03-29 14:33:04] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1601.5820663103
INFO [2025-03-29 14:33:04] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1681.09824552997
INFO [2025-03-29 14:33:04] Created Classic_Pelo_Pct from Classic_Elo with max value: 1698.69428891549
INFO [2025-03-29 14:33:04] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1707.58410982918
INFO [2025-03-29 14:33:04] Prepared data for 255 ladies skiers with 31 features
INFO [2025-03-29 14:33:04] No FIS startlist, predicting for all skiers in all legs
INFO [2025-03-29 14:33:04] No valid FIS startlist for ladies, building optimized teams
INFO [2025-03-29 14:33:04] Attempting Option 1: Team model coefficients
INFO [2025-03-29 14:33:04] Option 1 failed: No team_podium model found
INFO [2025-03-29 14:33:04] Option 1 failed: No team model
INFO [2025-03-29 14:33:04] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 14:33:04] Leg 1 accuracy: 0.844322344322344
INFO [2025-03-29 14:33:04] Leg 2 accuracy: 0.845787545787546
INFO [2025-03-29 14:33:04] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 14:33:04] Using leg importance weights for team optimization: Leg 1: 0.50, Leg 2: 0.50
INFO [2025-03-29 14:33:04] Optimizing team for Sweden
INFO [2025-03-29 14:33:04] Optimizing team for Norway
INFO [2025-03-29 14:33:04] Optimizing team for Germany
INFO [2025-03-29 14:33:05] Optimizing team for USA
INFO [2025-03-29 14:33:05] Optimizing team for Austria
INFO [2025-03-29 14:33:05] Optimizing team for Finland
INFO [2025-03-29 14:33:05] Optimizing team for Czechia
INFO [2025-03-29 14:33:05] Optimizing team for Switzerland
INFO [2025-03-29 14:33:05] Optimizing team for Italy
INFO [2025-03-29 14:33:05] Optimizing team for France
INFO [2025-03-29 14:33:05] Optimizing team for Canada
INFO [2025-03-29 14:33:05] Optimizing team for Slovenia
INFO [2025-03-29 14:33:05] Optimizing team for Estonia
INFO [2025-03-29 14:33:05] Optimizing team for Australia
INFO [2025-03-29 14:33:05] Optimizing team for Ukraine
INFO [2025-03-29 14:33:05] Optimizing team for Kazakhstan
INFO [2025-03-29 14:33:05] Optimizing team for Armenia
INFO [2025-03-29 14:33:05] Optimizing team for Latvia
INFO [2025-03-29 14:33:05] Optimizing team for Japan
INFO [2025-03-29 14:33:05] Optimizing team for Poland
INFO [2025-03-29 14:33:05] Optimizing team for South Korea
INFO [2025-03-29 14:33:05] Optimizing team for Andorra
INFO [2025-03-29 14:33:05] Optimizing team for Taiwan
INFO [2025-03-29 14:33:05] Optimizing team for China
INFO [2025-03-29 14:33:05] Optimizing team for Croatia
INFO [2025-03-29 14:33:05] Optimizing team for Slovakia
INFO [2025-03-29 14:33:05] Optimizing team for Argentina
INFO [2025-03-29 14:33:05] Optimizing team for Mongolia
INFO [2025-03-29 14:33:05] Optimizing team for Brazil
INFO [2025-03-29 14:33:05] Optimizing team for Lithuania
INFO [2025-03-29 14:33:05] Optimizing team for Greece
INFO [2025-03-29 14:33:05] Optimizing team for Iceland
INFO [2025-03-29 14:33:05] Optimizing team for Bulgaria
INFO [2025-03-29 14:33:05] Optimizing team for Serbia
INFO [2025-03-29 14:33:05] Optimizing team for Hungary
INFO [2025-03-29 14:33:05] Optimizing team for Turkey
INFO [2025-03-29 14:33:05] Optimizing team for North Macedonia
INFO [2025-03-29 14:33:05] Optimizing team for Romania
INFO [2025-03-29 14:33:05] Optimizing team for Bosnia&Herzegovina
INFO [2025-03-29 14:33:05] Optimizing team for Mexico
INFO [2025-03-29 14:33:05] Optimizing team for Iran
INFO [2025-03-29 14:33:05] Optimizing team for Chile
INFO [2025-03-29 14:33:05] Optimizing team for India
INFO [2025-03-29 14:33:05] Optimizing team for Malaysia
INFO [2025-03-29 14:33:05] Optimizing team for Haiti
INFO [2025-03-29 14:33:05] Optimizing team for Lebanon
INFO [2025-03-29 14:33:05] Optimizing team for Liechtenstein
INFO [2025-03-29 14:33:05] Matching optimized teams with startlist team names and prices
INFO [2025-03-29 14:33:05] Resetting men's probabilities at or below the mode to zero
INFO [2025-03-29 14:33:05] Reset 30 values to 0 for Win_Prob (repeated values or values <  0 )
INFO [2025-03-29 14:33:05] Repeated values: 0
INFO [2025-03-29 14:33:05] No values appear more than twice for Podium_Prob
INFO [2025-03-29 14:33:05] No values appear more than twice for Top5_Prob
INFO [2025-03-29 14:33:05] No values appear more than twice for Top10_Prob
INFO [2025-03-29 14:33:05] Resetting ladies' probabilities at or below the mode to zero
INFO [2025-03-29 14:33:05] Reset 47 values to 0 for Win_Prob (repeated values or values <  0.5004 )
INFO [2025-03-29 14:33:05] Repeated values: 0, 0.5004
INFO [2025-03-29 14:33:05] No values appear more than twice for Podium_Prob
INFO [2025-03-29 14:33:05] No values appear more than twice for Top5_Prob
INFO [2025-03-29 14:33:05] No values appear more than twice for Top10_Prob
INFO [2025-03-29 14:33:05] Normalizing men's team probabilities
INFO [2025-03-29 14:33:05] Normalized Win_Prob from sum of 1 to 1 and capped individual values at 1.0
INFO [2025-03-29 14:33:05] Normalized Podium_Prob from sum of 1.82 to 2.51 and capped individual values at 1.0
INFO [2025-03-29 14:33:05] Normalized Top5_Prob from sum of 3.41 to 4.61 and capped individual values at 1.0
INFO [2025-03-29 14:33:05] Normalized Top10_Prob from sum of 7.38 to 8.89 and capped individual values at 1.0
INFO [2025-03-29 14:33:05] Recalculated Expected_Points based on normalized probabilities
INFO [2025-03-29 14:33:05] Normalizing ladies' team probabilities
INFO [2025-03-29 14:33:05] Normalized Podium_Prob from sum of 5.18 to 3 and capped individual values at 1.0
INFO [2025-03-29 14:33:05] Normalized Top5_Prob from sum of 7.48 to 5 and capped individual values at 1.0
INFO [2025-03-29 14:33:05] Normalized Top10_Prob from sum of 9.5 to 9.93 and capped individual values at 1.0
INFO [2025-03-29 14:33:05] Recalculated Expected_Points based on normalized probabilities
INFO [2025-03-29 14:33:06] Optimizing fantasy team sprint team
INFO [2025-03-29 14:33:06] Fantasy team optimization complete. Selected 12 teams.
INFO [2025-03-29 14:33:06] Total price: 99944 of max 1e+05
INFO [2025-03-29 14:33:06] Expected total points: 794.9
INFO [2025-03-29 14:33:06] Men's teams: 6 ( 6 )
INFO [2025-03-29 14:33:06] Ladies' teams: 6 ( 6 )
INFO [2025-03-29 14:33:06] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_team_sprint_points.xlsx
INFO [2025-03-29 14:33:06] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_team_sprint_probabilities.xlsx
INFO [2025-03-29 14:33:06] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_team_sprint_points.xlsx
INFO [2025-03-29 14:33:06] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_team_sprint_probabilities.xlsx
INFO [2025-03-29 14:33:06] Saved fantasy team results to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/fantasy_team_sprint_team.xlsx
INFO [2025-03-29 14:33:06] Team sprint predictions completed successfully
INFO [2025-03-29 14:35:04] Starting team sprint predictions process
INFO [2025-03-29 14:35:04] Loading weekend race data
INFO [2025-03-29 14:35:04] Tomorrow's date: 2025-03-29
INFO [2025-03-29 14:35:04] Found 1 men's team sprint races and 1 ladies' team sprint races
INFO [2025-03-29 14:35:04] Men's team sprint technique: C
INFO [2025-03-29 14:35:04] Ladies' team sprint technique: C
INFO [2025-03-29 14:35:04] Men's team sprint technique: C
INFO [2025-03-29 14:35:04] Ladies' team sprint technique: C
INFO [2025-03-29 14:35:04] Loading chrono data
INFO [2025-03-29 14:35:09] Loaded men's chrono with 105122 rows and 36 columns
INFO [2025-03-29 14:35:09] Loaded ladies' chrono with 78706 rows and 36 columns
INFO [2025-03-29 14:35:09] Created men's team sprint df with 3291 rows
INFO [2025-03-29 14:35:09] Created men's individual df with 92143 rows
INFO [2025-03-29 14:35:09] Created ladies' team sprint df with 2434 rows
INFO [2025-03-29 14:35:09] Created ladies' individual df with 68253 rows
INFO [2025-03-29 14:35:13] Filtered men's team sprint data by technique C - kept 997 of 3291 records
INFO [2025-03-29 14:35:13] Filtered ladies' team sprint data by technique C - kept 700 of 2434 records
INFO [2025-03-29 14:35:14] Training models for Leg 1
INFO [2025-03-29 14:35:14] Determined technique from leg data: C
INFO [2025-03-29 14:35:14] Race is classic technique - using classic-specific predictors
INFO [2025-03-29 14:35:14] Selected predictors for leg 1 : Pelo_Pct, Weighted_Last_5, Sprint_Pelo_Pct, Distance_Pelo_Pct, Sprint_C_Pelo_Pct, Classic_Pelo_Pct, Sprint_F_Pelo_Pct
INFO [2025-03-29 14:35:14] Using predictors: Pelo_Pct, Weighted_Last_5, Sprint_Pelo_Pct, Distance_Pelo_Pct, Sprint_C_Pelo_Pct, Classic_Pelo_Pct, Sprint_F_Pelo_Pct
INFO [2025-03-29 14:35:14] Training podium model using glm
INFO [2025-03-29 14:35:14] Training win model using glm
INFO [2025-03-29 14:35:14] Training top5 model using glm
INFO [2025-03-29 14:35:14] Training top10 model using glm
INFO [2025-03-29 14:35:14] Top features for Leg 1 podium prediction:
INFO [2025-03-29 14:35:14] Training models for Leg 2
INFO [2025-03-29 14:35:14] Determined technique from leg data: C
INFO [2025-03-29 14:35:14] Race is classic technique - using classic-specific predictors
INFO [2025-03-29 14:35:14] Selected predictors for leg 2 : Pelo_Pct, Weighted_Last_5, Sprint_Pelo_Pct, Distance_Pelo_Pct, Sprint_C_Pelo_Pct, Classic_Pelo_Pct, Sprint_F_Pelo_Pct
INFO [2025-03-29 14:35:14] Using predictors: Pelo_Pct, Weighted_Last_5, Sprint_Pelo_Pct, Distance_Pelo_Pct, Sprint_C_Pelo_Pct, Classic_Pelo_Pct, Sprint_F_Pelo_Pct
INFO [2025-03-29 14:35:14] Training podium model using glm
INFO [2025-03-29 14:35:14] Training win model using glm
INFO [2025-03-29 14:35:15] Training top5 model using glm
INFO [2025-03-29 14:35:15] Training top10 model using glm
INFO [2025-03-29 14:35:15] Top features for Leg 2 podium prediction:
INFO [2025-03-29 14:35:15] Training models for Leg 1
INFO [2025-03-29 14:35:15] Determined technique from leg data: C
INFO [2025-03-29 14:35:15] Race is classic technique - using classic-specific predictors
INFO [2025-03-29 14:35:15] Selected predictors for leg 1 : Pelo_Pct, Weighted_Last_5, Sprint_Pelo_Pct, Distance_Pelo_Pct, Sprint_C_Pelo_Pct, Classic_Pelo_Pct, Sprint_F_Pelo_Pct
INFO [2025-03-29 14:35:15] Using predictors: Pelo_Pct, Weighted_Last_5, Sprint_Pelo_Pct, Distance_Pelo_Pct, Sprint_C_Pelo_Pct, Classic_Pelo_Pct, Sprint_F_Pelo_Pct
INFO [2025-03-29 14:35:15] Training podium model using glm
INFO [2025-03-29 14:35:15] Training win model using glm
INFO [2025-03-29 14:35:15] Training top5 model using glm
INFO [2025-03-29 14:35:15] Training top10 model using glm
INFO [2025-03-29 14:35:15] Top features for Leg 1 podium prediction:
INFO [2025-03-29 14:35:15] Training models for Leg 2
INFO [2025-03-29 14:35:15] Determined technique from leg data: C
INFO [2025-03-29 14:35:15] Race is classic technique - using classic-specific predictors
INFO [2025-03-29 14:35:15] Selected predictors for leg 2 : Pelo_Pct, Weighted_Last_5, Sprint_Pelo_Pct, Distance_Pelo_Pct, Sprint_C_Pelo_Pct, Classic_Pelo_Pct, Sprint_F_Pelo_Pct
INFO [2025-03-29 14:35:15] Using predictors: Pelo_Pct, Weighted_Last_5, Sprint_Pelo_Pct, Distance_Pelo_Pct, Sprint_C_Pelo_Pct, Classic_Pelo_Pct, Sprint_F_Pelo_Pct
INFO [2025-03-29 14:35:15] Training podium model using glm
INFO [2025-03-29 14:35:15] Training win model using glm
INFO [2025-03-29 14:35:15] Training top5 model using glm
INFO [2025-03-29 14:35:15] Training top10 model using glm
INFO [2025-03-29 14:35:15] Top features for Leg 2 podium prediction:
INFO [2025-03-29 14:35:15] Processing men's team sprint predictions
INFO [2025-03-29 14:35:15] Loaded men team sprint teams startlist with 31 rows
INFO [2025-03-29 14:35:15] Loaded men team sprint individuals startlist with 62 rows
INFO [2025-03-29 14:35:16] Preparing current men skier data
INFO [2025-03-29 14:35:16] Replaced NAs in Distance_Elo with first quartile: 1207.23243912712
INFO [2025-03-29 14:35:16] Replaced NAs in Distance_C_Elo with first quartile: 1233.40200699225
INFO [2025-03-29 14:35:16] Replaced NAs in Distance_F_Elo with first quartile: 1236.48554062178
INFO [2025-03-29 14:35:16] Replaced NAs in Sprint_Elo with first quartile: 1223.60107000698
INFO [2025-03-29 14:35:16] Replaced NAs in Sprint_C_Elo with first quartile: 1241.28715500947
INFO [2025-03-29 14:35:16] Replaced NAs in Sprint_F_Elo with first quartile: 1234.45151108772
INFO [2025-03-29 14:35:16] Replaced NAs in Classic_Elo with first quartile: 1241.52867310024
INFO [2025-03-29 14:35:16] Replaced NAs in Freestyle_Elo with first quartile: 1228.48649348109
INFO [2025-03-29 14:35:16] Replaced NAs in Distance_Pelo with first quartile: 1211.63035979047
INFO [2025-03-29 14:35:16] Replaced NAs in Distance_C_Pelo with first quartile: 1234.81091928129
INFO [2025-03-29 14:35:16] Replaced NAs in Distance_F_Pelo with first quartile: 1239.65331180248
INFO [2025-03-29 14:35:16] Replaced NAs in Sprint_Pelo with first quartile: 1240.94751821383
INFO [2025-03-29 14:35:16] Replaced NAs in Sprint_C_Pelo with first quartile: 1241.28715500947
INFO [2025-03-29 14:35:16] Replaced NAs in Sprint_F_Pelo with first quartile: 1252.45166310493
INFO [2025-03-29 14:35:16] Replaced NAs in Classic_Pelo with first quartile: 1243.63746068082
INFO [2025-03-29 14:35:16] Replaced NAs in Freestyle_Pelo with first quartile: 1249.30280713791
INFO [2025-03-29 14:35:16] Replaced NAs in Sprint_Last_5 with first quartile: 0
INFO [2025-03-29 14:35:16] Created Pelo_Pct from Elo with max value: 1946.6211651574
INFO [2025-03-29 14:35:16] Created Distance_Pelo_Pct from Distance_Elo with max value: 1869.1251911742
INFO [2025-03-29 14:35:16] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1777.16297253153
INFO [2025-03-29 14:35:16] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1695.2053212904
INFO [2025-03-29 14:35:16] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1886.80363942481
INFO [2025-03-29 14:35:16] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1711.08486899169
INFO [2025-03-29 14:35:16] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1792.65157560707
INFO [2025-03-29 14:35:16] Created Classic_Pelo_Pct from Classic_Elo with max value: 1807.56773496777
INFO [2025-03-29 14:35:16] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1814.60460629541
INFO [2025-03-29 14:35:16] Prepared data for 381 men skiers with 31 features
INFO [2025-03-29 14:35:16] Using FIS startlist for men's leg predictions
INFO [2025-03-29 14:35:16] Using FIS startlist for men
INFO [2025-03-29 14:35:16] Attempting Option 1: Team model coefficients
INFO [2025-03-29 14:35:16] Option 1 failed: No team_podium model found
INFO [2025-03-29 14:35:16] Option 1 failed: No team model
INFO [2025-03-29 14:35:16] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 14:35:16] Leg 1 accuracy: 0.905731707317073
INFO [2025-03-29 14:35:16] Leg 2 accuracy: 0.917073170731707
INFO [2025-03-29 14:35:16] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 14:35:16] Leg importance weights: Leg 1: 0.50, Leg 2: 0.50
INFO [2025-03-29 14:35:16] Processing ladies' team sprint predictions
INFO [2025-03-29 14:35:16] Loaded ladies team sprint teams startlist with 35 rows
INFO [2025-03-29 14:35:16] Loaded ladies team sprint individuals startlist with 231 rows
INFO [2025-03-29 14:35:16] Preparing current ladies skier data
INFO [2025-03-29 14:35:16] Replaced NAs in Distance_Elo with first quartile: 1237.38564383256
INFO [2025-03-29 14:35:16] Replaced NAs in Distance_C_Elo with first quartile: 1243.87329106944
INFO [2025-03-29 14:35:16] Replaced NAs in Distance_F_Elo with first quartile: 1256.69628195708
INFO [2025-03-29 14:35:16] Replaced NAs in Sprint_Elo with first quartile: 1246.32574824425
INFO [2025-03-29 14:35:16] Replaced NAs in Sprint_C_Elo with first quartile: 1257.67866787334
INFO [2025-03-29 14:35:16] Replaced NAs in Sprint_F_Elo with first quartile: 1244.84742904868
INFO [2025-03-29 14:35:16] Replaced NAs in Classic_Elo with first quartile: 1252.44868703669
INFO [2025-03-29 14:35:16] Replaced NAs in Freestyle_Elo with first quartile: 1244.44508230281
INFO [2025-03-29 14:35:16] Replaced NAs in Distance_Pelo with first quartile: 1241.11854419952
INFO [2025-03-29 14:35:16] Replaced NAs in Distance_C_Pelo with first quartile: 1245.57367555166
INFO [2025-03-29 14:35:16] Replaced NAs in Distance_F_Pelo with first quartile: 1259.54282973153
INFO [2025-03-29 14:35:16] Replaced NAs in Sprint_Pelo with first quartile: 1254.58885254623
INFO [2025-03-29 14:35:16] Replaced NAs in Sprint_C_Pelo with first quartile: 1257.58302026178
INFO [2025-03-29 14:35:16] Replaced NAs in Sprint_F_Pelo with first quartile: 1257.67755691493
INFO [2025-03-29 14:35:16] Replaced NAs in Classic_Pelo with first quartile: 1256.79275004544
INFO [2025-03-29 14:35:16] Replaced NAs in Freestyle_Pelo with first quartile: 1256.79999900008
INFO [2025-03-29 14:35:16] Replaced NAs in Sprint_Last_5 with first quartile: 0
INFO [2025-03-29 14:35:16] Created Pelo_Pct from Elo with max value: 1841.00191142018
INFO [2025-03-29 14:35:16] Created Distance_Pelo_Pct from Distance_Elo with max value: 1889.46974050597
INFO [2025-03-29 14:35:16] Created Distance_C_Pelo_Pct from Distance_C_Elo with max value: 1763.33572074398
INFO [2025-03-29 14:35:16] Created Distance_F_Pelo_Pct from Distance_F_Elo with max value: 1693.85026290322
INFO [2025-03-29 14:35:16] Created Sprint_Pelo_Pct from Sprint_Elo with max value: 1742.74758850835
INFO [2025-03-29 14:35:16] Created Sprint_C_Pelo_Pct from Sprint_C_Elo with max value: 1601.5820663103
INFO [2025-03-29 14:35:16] Created Sprint_F_Pelo_Pct from Sprint_F_Elo with max value: 1681.09824552997
INFO [2025-03-29 14:35:16] Created Classic_Pelo_Pct from Classic_Elo with max value: 1698.69428891549
INFO [2025-03-29 14:35:16] Created Freestyle_Pelo_Pct from Freestyle_Elo with max value: 1707.58410982918
INFO [2025-03-29 14:35:16] Prepared data for 255 ladies skiers with 31 features
INFO [2025-03-29 14:35:16] No FIS startlist, predicting for all skiers in all legs
INFO [2025-03-29 14:35:16] No valid FIS startlist for ladies, building optimized teams
INFO [2025-03-29 14:35:16] Attempting Option 1: Team model coefficients
INFO [2025-03-29 14:35:16] Option 1 failed: No team_podium model found
INFO [2025-03-29 14:35:16] Option 1 failed: No team model
INFO [2025-03-29 14:35:16] Attempting Option 2: Individual model accuracy
INFO [2025-03-29 14:35:16] Leg 1 accuracy: 0.878021978021978
INFO [2025-03-29 14:35:16] Leg 2 accuracy: 0.817582417582418
INFO [2025-03-29 14:35:16] Option 2 succeeded: Using model accuracy weights
INFO [2025-03-29 14:35:16] Using leg importance weights for team optimization: Leg 1: 0.52, Leg 2: 0.48
INFO [2025-03-29 14:35:16] Optimizing team for Sweden
INFO [2025-03-29 14:35:16] Optimizing team for Norway
INFO [2025-03-29 14:35:16] Optimizing team for Germany
INFO [2025-03-29 14:35:16] Optimizing team for USA
INFO [2025-03-29 14:35:16] Optimizing team for Austria
INFO [2025-03-29 14:35:16] Optimizing team for Finland
INFO [2025-03-29 14:35:16] Optimizing team for Czechia
INFO [2025-03-29 14:35:16] Optimizing team for Switzerland
INFO [2025-03-29 14:35:16] Optimizing team for Italy
INFO [2025-03-29 14:35:16] Optimizing team for France
INFO [2025-03-29 14:35:16] Optimizing team for Canada
INFO [2025-03-29 14:35:16] Optimizing team for Slovenia
INFO [2025-03-29 14:35:16] Optimizing team for Estonia
INFO [2025-03-29 14:35:16] Optimizing team for Australia
INFO [2025-03-29 14:35:16] Optimizing team for Ukraine
INFO [2025-03-29 14:35:16] Optimizing team for Kazakhstan
INFO [2025-03-29 14:35:16] Optimizing team for Armenia
INFO [2025-03-29 14:35:16] Optimizing team for Latvia
INFO [2025-03-29 14:35:16] Optimizing team for Japan
INFO [2025-03-29 14:35:16] Optimizing team for Poland
INFO [2025-03-29 14:35:16] Optimizing team for South Korea
INFO [2025-03-29 14:35:16] Optimizing team for Andorra
INFO [2025-03-29 14:35:16] Optimizing team for Taiwan
INFO [2025-03-29 14:35:16] Optimizing team for China
INFO [2025-03-29 14:35:16] Optimizing team for Croatia
INFO [2025-03-29 14:35:16] Optimizing team for Slovakia
INFO [2025-03-29 14:35:16] Optimizing team for Argentina
INFO [2025-03-29 14:35:16] Optimizing team for Mongolia
INFO [2025-03-29 14:35:16] Optimizing team for Brazil
INFO [2025-03-29 14:35:16] Optimizing team for Lithuania
INFO [2025-03-29 14:35:16] Optimizing team for Greece
INFO [2025-03-29 14:35:16] Optimizing team for Iceland
INFO [2025-03-29 14:35:17] Optimizing team for Bulgaria
INFO [2025-03-29 14:35:17] Optimizing team for Serbia
INFO [2025-03-29 14:35:17] Optimizing team for Hungary
INFO [2025-03-29 14:35:17] Optimizing team for Turkey
INFO [2025-03-29 14:35:17] Optimizing team for North Macedonia
INFO [2025-03-29 14:35:17] Optimizing team for Romania
INFO [2025-03-29 14:35:17] Optimizing team for Bosnia&Herzegovina
INFO [2025-03-29 14:35:17] Optimizing team for Mexico
INFO [2025-03-29 14:35:17] Optimizing team for Iran
INFO [2025-03-29 14:35:17] Optimizing team for Chile
INFO [2025-03-29 14:35:17] Optimizing team for India
INFO [2025-03-29 14:35:17] Optimizing team for Malaysia
INFO [2025-03-29 14:35:17] Optimizing team for Haiti
INFO [2025-03-29 14:35:17] Optimizing team for Lebanon
INFO [2025-03-29 14:35:17] Optimizing team for Liechtenstein
INFO [2025-03-29 14:35:17] Matching optimized teams with startlist team names and prices
INFO [2025-03-29 14:35:17] Resetting men's probabilities at or below the mode to zero
INFO [2025-03-29 14:35:17] Resetting ladies' probabilities at or below the mode to zero
INFO [2025-03-29 14:35:17] Normalizing men's team probabilities
INFO [2025-03-29 14:35:17] Normalized Win_Prob from sum of 1 to 1 and capped individual values at 1.0
INFO [2025-03-29 14:35:17] Normalized Podium_Prob from sum of 1.82 to 2.5 and capped individual values at 1.0
INFO [2025-03-29 14:35:17] Normalized Top5_Prob from sum of 3.41 to 4.61 and capped individual values at 1.0
INFO [2025-03-29 14:35:17] Normalized Top10_Prob from sum of 7.38 to 8.89 and capped individual values at 1.0
INFO [2025-03-29 14:35:17] Recalculated Expected_Points based on normalized probabilities
INFO [2025-03-29 14:35:17] Normalizing ladies' team probabilities
INFO [2025-03-29 14:35:17] Normalized Win_Prob from sum of 2.41 to 1 and capped individual values at 1.0
INFO [2025-03-29 14:35:17] Normalized Podium_Prob from sum of 5.21 to 3 and capped individual values at 1.0
INFO [2025-03-29 14:35:17] Normalized Top5_Prob from sum of 7.49 to 5 and capped individual values at 1.0
INFO [2025-03-29 14:35:17] Normalized Top10_Prob from sum of 9.51 to 9.93 and capped individual values at 1.0
INFO [2025-03-29 14:35:17] Recalculated Expected_Points based on normalized probabilities
INFO [2025-03-29 14:35:17] Optimizing fantasy team sprint team
INFO [2025-03-29 14:35:17] Fantasy team optimization complete. Selected 12 teams.
INFO [2025-03-29 14:35:17] Total price: 99944 of max 1e+05
INFO [2025-03-29 14:35:17] Expected total points: 805.4
INFO [2025-03-29 14:35:17] Men's teams: 6 ( 6 )
INFO [2025-03-29 14:35:17] Ladies' teams: 6 ( 6 )
INFO [2025-03-29 14:35:17] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_team_sprint_points.xlsx
INFO [2025-03-29 14:35:17] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/men_team_sprint_probabilities.xlsx
INFO [2025-03-29 14:35:17] Saved points predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_team_sprint_points.xlsx
INFO [2025-03-29 14:35:17] Saved probability predictions to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/ladies_team_sprint_probabilities.xlsx
INFO [2025-03-29 14:35:17] Saved fantasy team results to ~/blog/daehl-e/content/post/cross-country/drafts/weekly-picks/20250329/fantasy_team_sprint_team.xlsx
INFO [2025-03-29 14:35:17] Team sprint predictions completed successfully
